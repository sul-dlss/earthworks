(function(Ir,hi){typeof exports=="object"&&typeof module<"u"?module.exports=hi():typeof define=="function"&&define.amd?define(hi):(Ir=typeof globalThis<"u"?globalThis:Ir||self,Ir["@geoblacklight/frontend"]=hi())})(this,function(){"use strict";var Wme=Object.defineProperty;var Kme=(Ir,hi,Kr)=>hi in Ir?Wme(Ir,hi,{enumerable:!0,configurable:!0,writable:!0,value:Kr}):Ir[hi]=Kr;var Ni=(Ir,hi,Kr)=>Kme(Ir,typeof hi!="symbol"?hi+"":hi,Kr);function Ir(i,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in i)){const s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(i,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}class hi{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const Kr={PROPERTYCHANGE:"propertychange"};class wg{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function u5(i,e,t){let n,r;t=t||bo;let s=0,o=i.length,a=!1;for(;s<o;)n=s+(o-s>>1),r=+t(i[n],e),r<0?s=n+1:(o=n,a=!r);return a?s:~s}function bo(i,e){return i>e?1:i<e?-1:0}function c5(i,e){return i<e?1:i>e?-1:0}function Ny(i,e,t){if(i[0]<=e)return 0;const n=i.length;if(e<=i[n-1])return n-1;if(typeof t=="function"){for(let r=1;r<n;++r){const s=i[r];if(s===e)return r;if(s<e)return t(e,i[r-1],s)>0?r-1:r}return n-1}if(t>0){for(let r=1;r<n;++r)if(i[r]<e)return r-1;return n-1}if(t<0){for(let r=1;r<n;++r)if(i[r]<=e)return r;return n-1}for(let r=1;r<n;++r){if(i[r]==e)return r;if(i[r]<e)return i[r-1]-e<e-i[r]?r-1:r}return n-1}function h5(i,e,t){for(;e<t;){const n=i[e];i[e]=i[t],i[t]=n,++e,--t}}function Rs(i,e){const t=Array.isArray(e)?e:[e],n=t.length;for(let r=0;r<n;r++)i[i.length]=t[r]}function Qa(i,e){const t=i.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(i[n]!==e[n])return!1;return!0}function d5(i,e,t){const n=e||bo;return i.every(function(r,s){if(s===0)return!0;const o=n(i[s-1],r);return!(o>0||o===0)})}function xg(){return!0}function bg(){return!1}function Sg(){}function f5(i){let e=!1,t,n,r;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==r||!Qa(s,n))&&(e=!0,r=this,n=s,t=i.apply(this,arguments)),t}}function g5(i){function e(){let t;try{t=i()}catch(n){return Promise.reject(n)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function eu(i){for(const e in i)delete i[e]}function Tg(i){let e;for(e in i)return!1;return!e}class Bh extends wg{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const n=this.listeners_||(this.listeners_={}),r=n[e]||(n[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",n=t?e:e.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const s=t?new hi(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,a[n]=0),++o[n];let l;for(let u=0,c=r.length;u<c;++u)if("handleEvent"in r[u]?l=r[u].handleEvent(s):l=r[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[n]===0){let u=a[n];for(delete a[n];u--;)this.removeEventListener(n,Sg);delete o[n]}return l}disposeInternal(){this.listeners_&&eu(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){const n=this.listeners_&&this.listeners_[e];if(n){const r=n.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(n[r]=Sg,++this.pendingRemovals_[e]):(n.splice(r,1),n.length===0&&delete this.listeners_[e]))}}}const $e={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Et(i,e,t,n,r){if(n&&n!==i&&(t=t.bind(n)),r){const o=t;t=function(){i.removeEventListener(e,t),o.apply(this,arguments)}}const s={target:i,type:e,listener:t};return i.addEventListener(e,t),s}function Bg(i,e,t,n){return Et(i,e,t,n,!0)}function Ot(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),eu(i))}class Rh extends Bh{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent($e.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const n=e.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=Et(this,e[s],t);return r}return Et(this,e,t)}onceInternal(e,t){let n;if(Array.isArray(e)){const r=e.length;n=new Array(r);for(let s=0;s<r;++s)n[s]=Bg(this,e[s],t)}else n=Bg(this,e,t);return t.ol_key=n,n}unInternal(e,t){const n=t.ol_key;if(n)A5(n);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}Rh.prototype.on,Rh.prototype.once,Rh.prototype.un;function A5(i){if(Array.isArray(i))for(let e=0,t=i.length;e<t;++e)Ot(i[e]);else Ot(i)}function je(){throw new Error("Unimplemented abstract method.")}let p5=0;function nt(i){return i.ol_uid||(i.ol_uid=String(++p5))}class Db extends hi{constructor(e,t,n){super(e),this.key=t,this.oldValue=n}}class Yr extends Rh{constructor(e){super(),this.on,this.once,this.un,nt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let n;n=`change:${e}`,this.hasListener(n)&&this.dispatchEvent(new Db(n,e,t)),n=Kr.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Db(n,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,n){const r=this.values_||(this.values_={});if(n)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const n in e)this.set(n,e[n],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const n=this.values_[e];delete this.values_[e],Tg(this.values_)&&(this.values_=null),t||this.notify(e,n)}}}const nr={ADD:"add",REMOVE:"remove"},kb={LENGTH:"length"};class Rg extends hi{constructor(e,t,n){super(e),this.element=t,this.index=n}}class Ls extends Yr{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let n=0,r=this.array_.length;n<r;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,n=e.length;t<n;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let n=0,r=t.length;n<r;++n)e(t[n],n,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(kb.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Rg(nr.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let n=0,r=t.length;n<r;++n)if(t[n]===e)return this.removeAt(n)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Rg(nr.REMOVE,t,e)),t}setAt(e,t){const n=this.getLength();if(e>=n){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Rg(nr.REMOVE,r,e)),this.dispatchEvent(new Rg(nr.ADD,t,e))}updateLength_(){this.set(kb.LENGTH,this.array_.length)}assertUnique_(e,t){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===e&&n!==t)throw new Error("Duplicate item added to a unique collection")}}function It(i,e){if(!i)throw new Error(e)}class Qy extends Yr{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new Qy(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ot(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Et(e,$e.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?m5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function m5(i){if(typeof i=="function")return i;let e;return Array.isArray(i)?e=i:(It(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[i]),function(){return e}}const So=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",y5=So.includes("firefox"),v5=So.includes("safari")&&!So.includes("chrom")&&(So.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(So)),E5=So.includes("webkit")&&!So.includes("edge"),Pb=So.includes("macintosh"),Mb=typeof devicePixelRatio<"u"?devicePixelRatio:1,Uy=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Fb=typeof Image<"u"&&Image.prototype.decode,Ob=function(){let i=!1;try{const e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return i}(),Gy=new Array(6);function Yi(){return[1,0,0,1,0,0]}function Hy(i){return Dg(i,1,0,0,1,0,0)}function Lg(i,e){const t=i[0],n=i[1],r=i[2],s=i[3],o=i[4],a=i[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],g=e[5];return i[0]=t*l+r*u,i[1]=n*l+s*u,i[2]=t*c+r*h,i[3]=n*c+s*h,i[4]=t*d+r*g+o,i[5]=n*d+s*g+a,i}function Dg(i,e,t,n,r,s,o){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i[4]=s,i[5]=o,i}function I5(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i}function yi(i,e){const t=e[0],n=e[1];return e[0]=i[0]*t+i[2]*n+i[4],e[1]=i[1]*t+i[3]*n+i[5],e}function _5(i,e){const t=Math.cos(e),n=Math.sin(e);return Lg(i,Dg(Gy,t,n,-n,t,0,0))}function Lh(i,e,t){return Lg(i,Dg(Gy,e,0,0,t,0,0))}function Nb(i,e,t){return Lg(i,Dg(Gy,1,0,0,1,e,t))}function _r(i,e,t,n,r,s,o,a){const l=Math.sin(s),u=Math.cos(s);return i[0]=n*u,i[1]=r*l,i[2]=-n*l,i[3]=r*u,i[4]=o*n*u-a*n*l+e,i[5]=o*r*l+a*r*u+t,i}function Qb(i,e){const t=C5(e);It(t!==0,"Transformation matrix cannot be inverted");const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return i[0]=o/t,i[1]=-r/t,i[2]=-s/t,i[3]=n/t,i[4]=(s*l-o*a)/t,i[5]=-(n*l-r*a)/t,i}function C5(i){return i[0]*i[3]-i[1]*i[2]}let Ub;function w5(i){const e="matrix("+i.join(", ")+")";if(Uy)return e;const t=Ub||(Ub=document.createElement("div"));return t.style.transform=e,t.style.transform}const Ci={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function kg(i){const e=Zr();for(let t=0,n=i.length;t<n;++t)Dh(e,i[t]);return e}function x5(i,e,t){const n=Math.min.apply(null,i),r=Math.min.apply(null,e),s=Math.max.apply(null,i),o=Math.max.apply(null,e);return To(n,r,s,o,t)}function Ua(i,e,t){return t?(t[0]=i[0]-e,t[1]=i[1]-e,t[2]=i[2]+e,t[3]=i[3]+e,t):[i[0]-e,i[1]-e,i[2]+e,i[3]+e]}function Gb(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i.slice()}function Ga(i,e,t){let n,r;return e<i[0]?n=i[0]-e:i[2]<e?n=e-i[2]:n=0,t<i[1]?r=i[1]-t:i[3]<t?r=t-i[3]:r=0,n*n+r*r}function tu(i,e){return zy(i,e[0],e[1])}function Hb(i,e){return i[0]<=e[0]&&e[2]<=i[2]&&i[1]<=e[1]&&e[3]<=i[3]}function zy(i,e,t){return i[0]<=e&&e<=i[2]&&i[1]<=t&&t<=i[3]}function Vy(i,e){const t=i[0],n=i[1],r=i[2],s=i[3],o=e[0],a=e[1];let l=Ci.UNKNOWN;return o<t?l=l|Ci.LEFT:o>r&&(l=l|Ci.RIGHT),a<n?l=l|Ci.BELOW:a>s&&(l=l|Ci.ABOVE),l===Ci.UNKNOWN&&(l=Ci.INTERSECTING),l}function Zr(){return[1/0,1/0,-1/0,-1/0]}function To(i,e,t,n,r){return r?(r[0]=i,r[1]=e,r[2]=t,r[3]=n,r):[i,e,t,n]}function iu(i){return To(1/0,1/0,-1/0,-1/0,i)}function zb(i,e){const t=i[0],n=i[1];return To(t,n,t,n,e)}function qy(i,e,t,n,r){const s=iu(r);return qb(s,i,e,t,n)}function Pg(i,e){return i[0]==e[0]&&i[2]==e[2]&&i[1]==e[1]&&i[3]==e[3]}function Vb(i,e){return e[0]<i[0]&&(i[0]=e[0]),e[2]>i[2]&&(i[2]=e[2]),e[1]<i[1]&&(i[1]=e[1]),e[3]>i[3]&&(i[3]=e[3]),i}function Dh(i,e){e[0]<i[0]&&(i[0]=e[0]),e[0]>i[2]&&(i[2]=e[0]),e[1]<i[1]&&(i[1]=e[1]),e[1]>i[3]&&(i[3]=e[1])}function qb(i,e,t,n,r){for(;t<n;t+=r)b5(i,e[t],e[t+1]);return i}function b5(i,e,t){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}function $b(i,e){let t;return t=e(Mg(i)),t||(t=e(Fg(i)),t)||(t=e(Og(i)),t)||(t=e(Ro(i)),t)?t:!1}function kh(i){let e=0;return nu(i)||(e=wi(i)*rr(i)),e}function Mg(i){return[i[0],i[1]]}function Fg(i){return[i[2],i[1]]}function Bo(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function S5(i,e){let t;if(e==="bottom-left")t=Mg(i);else if(e==="bottom-right")t=Fg(i);else if(e==="top-left")t=Ro(i);else if(e==="top-right")t=Og(i);else throw new Error("Invalid corner");return t}function $y(i,e,t,n,r){const[s,o,a,l,u,c,h,d]=jy(i,e,t,n);return To(Math.min(s,a,u,h),Math.min(o,l,c,d),Math.max(s,a,u,h),Math.max(o,l,c,d),r)}function jy(i,e,t,n){const r=e*n[0]/2,s=e*n[1]/2,o=Math.cos(t),a=Math.sin(t),l=r*o,u=r*a,c=s*o,h=s*a,d=i[0],g=i[1];return[d-l+h,g-u-c,d-l-h,g-u+c,d+l-h,g+u+c,d+l+h,g+u-c,d-l+h,g-u-c]}function rr(i){return i[3]-i[1]}function Cn(i,e,t){const n=t||Zr();return vi(i,e)?(i[0]>e[0]?n[0]=i[0]:n[0]=e[0],i[1]>e[1]?n[1]=i[1]:n[1]=e[1],i[2]<e[2]?n[2]=i[2]:n[2]=e[2],i[3]<e[3]?n[3]=i[3]:n[3]=e[3]):iu(n),n}function Ro(i){return[i[0],i[3]]}function Og(i){return[i[2],i[3]]}function wi(i){return i[2]-i[0]}function vi(i,e){return i[0]<=e[2]&&i[2]>=e[0]&&i[1]<=e[3]&&i[3]>=e[1]}function nu(i){return i[2]<i[0]||i[3]<i[1]}function T5(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i}function B5(i,e,t){let n=!1;const r=Vy(i,e),s=Vy(i,t);if(r===Ci.INTERSECTING||s===Ci.INTERSECTING)n=!0;else{const o=i[0],a=i[1],l=i[2],u=i[3],c=e[0],h=e[1],d=t[0],g=t[1],A=(g-h)/(d-c);let p,y;s&Ci.ABOVE&&!(r&Ci.ABOVE)&&(p=d-(g-u)/A,n=p>=o&&p<=l),!n&&s&Ci.RIGHT&&!(r&Ci.RIGHT)&&(y=g-(d-l)*A,n=y>=a&&y<=u),!n&&s&Ci.BELOW&&!(r&Ci.BELOW)&&(p=d-(g-a)/A,n=p>=o&&p<=l),!n&&s&Ci.LEFT&&!(r&Ci.LEFT)&&(y=g-(d-o)*A,n=y>=a&&y<=u)}return n}function R5(i,e,t,n){if(nu(i))return iu(t);let r=[];r=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]],e(r,r,2);const s=[],o=[];for(let a=0,l=r.length;a<l;a+=2)s.push(r[a]),o.push(r[a+1]);return x5(s,o,t)}const L5={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function jb(i){return L5[i]}const Wy={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Ph{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Wy[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Mh=6378137,ru=Math.PI*Mh,D5=[-ru,-ru,ru,ru],k5=[-180,-85,180,85],Ng=Mh*Math.log(Math.tan(Math.PI/2));class su extends Ph{constructor(e){super({code:e,units:"m",extent:D5,global:!0,worldExtent:k5,getPointResolution:function(t,n){return t/Math.cosh(n[1]/Mh)}})}}const Wb=[new su("EPSG:3857"),new su("EPSG:102100"),new su("EPSG:102113"),new su("EPSG:900913"),new su("http://www.opengis.net/def/crs/EPSG/0/3857"),new su("http://www.opengis.net/gml/srs/epsg.xml#3857")];function P5(i,e,t){const n=i.length;t=t>1?t:2,e===void 0&&(t>2?e=i.slice():e=new Array(n));for(let r=0;r<n;r+=t){e[r]=ru*i[r]/180;let s=Mh*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));s>Ng?s=Ng:s<-Ng&&(s=-Ng),e[r+1]=s}return e}function M5(i,e,t){const n=i.length;t=t>1?t:2,e===void 0&&(t>2?e=i.slice():e=new Array(n));for(let r=0;r<n;r+=t)e[r]=180*i[r]/ru,e[r+1]=360*Math.atan(Math.exp(i[r+1]/Mh))/Math.PI-90;return e}const F5=6378137,Kb=[-180,-90,180,90],O5=Math.PI*F5/180;class Ha extends Ph{constructor(e,t){super({code:e,units:"degrees",extent:Kb,axisOrientation:t,global:!0,metersPerUnit:O5,worldExtent:Kb})}}const Yb=[new Ha("CRS:84"),new Ha("EPSG:4326","neu"),new Ha("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ha("urn:ogc:def:crs:OGC:2:84"),new Ha("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ha("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ha("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ky={};function N5(i){return Ky[i]||Ky[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Q5(i,e){Ky[i]=e}let ou={};function Qg(i,e,t){const n=i.getCode(),r=e.getCode();n in ou||(ou[n]={}),ou[n][r]=t}function U5(i,e){let t;return i in ou&&e in ou[i]&&(t=ou[i][e]),t}function Xt(i,e,t){return Math.min(Math.max(i,e),t)}function G5(i,e,t,n,r,s){const o=r-t,a=s-n;if(o!==0||a!==0){const l=((i-t)*o+(e-n)*a)/(o*o+a*a);l>1?(t=r,n=s):l>0&&(t+=o*l,n+=a*l)}return za(i,e,t,n)}function za(i,e,t,n){const r=t-i,s=n-e;return r*r+s*s}function H5(i){const e=i.length;for(let n=0;n<e;n++){let r=n,s=Math.abs(i[n][n]);for(let a=n+1;a<e;a++){const l=Math.abs(i[a][n]);l>s&&(s=l,r=a)}if(s===0)return null;const o=i[r];i[r]=i[n],i[n]=o;for(let a=n+1;a<e;a++){const l=-i[a][n]/i[n][n];for(let u=n;u<e+1;u++)n==u?i[a][u]=0:i[a][u]+=l*i[n][u]}}const t=new Array(e);for(let n=e-1;n>=0;n--){t[n]=i[n][e]/i[n][n];for(let r=n-1;r>=0;r--)i[r][e]-=i[r][n]*t[n]}return t}function Ug(i){return i*Math.PI/180}function au(i,e){const t=i%e;return t*e<0?t+e:t}function Hn(i,e,t){return i+t*(e-i)}function Yy(i,e){const t=Math.pow(10,e);return Math.round(i*t)/t}function Gg(i,e){return Math.floor(Yy(i,e))}function Hg(i,e){return Math.ceil(Yy(i,e))}function z5(i,e){return i[0]+=+e[0],i[1]+=+e[1],i}function zg(i,e){let t=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=e[n]){t=!1;break}return t}function Zy(i,e){const t=Math.cos(e),n=Math.sin(e),r=i[0]*t-i[1]*n,s=i[1]*t+i[0]*n;return i[0]=r,i[1]=s,i}function V5(i,e){return i[0]*=e,i[1]*=e,i}function Zb(i,e){if(e.canWrapX()){const t=wi(e.getExtent()),n=q5(i,e,t);n&&(i[0]-=n*t)}return i}function q5(i,e,t){const n=e.getExtent();let r=0;return e.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(t=t||wi(n),r=Math.floor((i[0]-n[0])/t)),r}const $5=63710088e-1;function Xb(i,e,t){t=t||$5;const n=Ug(i[1]),r=Ug(e[1]),s=(r-n)/2,o=Ug(e[0]-i[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Jb(...i){console.warn(...i)}function eS(...i){console.error(...i)}let Xy=!0;function j5(i){Xy=!1}function Jy(i,e){if(e!==void 0){for(let t=0,n=i.length;t<n;++t)e[t]=i[t];e=e}else e=i.slice();return e}function tS(i,e){if(e!==void 0&&i!==e){for(let t=0,n=i.length;t<n;++t)e[t]=i[t];i=e}return i}function W5(i){Q5(i.getCode(),i),Qg(i,i,Jy)}function K5(i){i.forEach(W5)}function Vt(i){return typeof i=="string"?N5(i):i||null}function iS(i,e,t,n){i=Vt(i);let r;const s=i.getPointResolutionFunc();if(s)r=s(e,t);else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")r=e;else{const a=tv(i,Vt("EPSG:4326"));if(a===tS&&o!=="degrees")r=e*i.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=a(u,u,2);const c=Xb(u.slice(0,2),u.slice(2,4)),h=Xb(u.slice(4,6),u.slice(6,8));r=(c+h)/2}const l=i.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function nS(i){K5(i),i.forEach(function(e){i.forEach(function(t){e!==t&&Qg(e,t,Jy)})})}function Y5(i,e,t,n){i.forEach(function(r){e.forEach(function(s){Qg(r,s,t),Qg(s,r,n)})})}function ev(i,e){return i?typeof i=="string"?Vt(i):i:Vt(e)}function Cr(i,e){if(i===e)return!0;const t=i.getUnits()===e.getUnits();return(i.getCode()===e.getCode()||tv(i,e)===Jy)&&t}function tv(i,e){const t=i.getCode(),n=e.getCode();let r=U5(t,n);return r||(r=tS),r}function Fh(i,e){const t=Vt(i),n=Vt(e);return tv(t,n)}function iv(i,e,t){return Fh(e,t)(i,void 0,i.length)}function rS(i,e,t,n){const r=Fh(e,t);return R5(i,r,void 0)}let Xr=null;function Z5(i){Xr=Vt(i)}function X5(){return Xr}function J5(){Z5("EPSG:4326")}function Vg(i,e){return Xr?iv(i,e,Xr):i}function Ds(i,e){return Xr?iv(i,Xr,e):(Xy&&!zg(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Xy=!1,Jb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i)}function sS(i,e){return Xr?rS(i,e,Xr):i}function Lo(i,e){return Xr?rS(i,Xr,e):i}function eU(){nS(Wb),nS(Yb),Y5(Yb,Wb,P5,M5)}eU();function Do(i,e,t,n,r,s){s=s||[];let o=0;for(let a=e;a<t;a+=n){const l=i[a],u=i[a+1];s[o++]=r[0]*l+r[2]*u+r[4],s[o++]=r[1]*l+r[3]*u+r[5]}return s&&s.length!=o&&(s.length=o),s}function oS(i,e,t,n,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),u=s[0],c=s[1];let h=0;for(let d=e;d<t;d+=n){const g=i[d]-u,A=i[d+1]-c;o[h++]=u+g*a-A*l,o[h++]=c+g*l+A*a;for(let p=d+2;p<d+n;++p)o[h++]=i[p]}return o&&o.length!=h&&(o.length=h),o}function tU(i,e,t,n,r,s,o,a){a=a||[];const l=o[0],u=o[1];let c=0;for(let h=e;h<t;h+=n){const d=i[h]-l,g=i[h+1]-u;a[c++]=l+r*d,a[c++]=u+s*g;for(let A=h+2;A<h+n;++A)a[c++]=i[A]}return a&&a.length!=c&&(a.length=c),a}function iU(i,e,t,n,r,s,o){o=o||[];let a=0;for(let l=e;l<t;l+=n){o[a++]=i[l]+r,o[a++]=i[l+1]+s;for(let u=l+2;u<l+n;++u)o[a++]=i[u]}return o&&o.length!=a&&(o.length=a),o}const aS=Yi();class lS extends Yr{constructor(){super(),this.extent_=Zr(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=f5(function(e,t,n){if(!n)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return je()}closestPointXY(e,t,n,r){return je()}containsXY(e,t){const n=this.getClosestPoint([e,t]);return n[0]===e&&n[1]===t}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return je()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&iu(t),this.extentRevision_=this.getRevision()}return T5(this.extent_,e)}rotate(e,t){je()}scale(e,t,n){je()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return je()}getType(){return je()}applyTransform(e){je()}intersectsExtent(e){return je()}translate(e,t){je()}transform(e,t){const n=Vt(e),r=n.getUnits()=="tile-pixels"?function(s,o,a){const l=n.getExtent(),u=n.getWorldExtent(),c=rr(u)/rr(l);return _r(aS,u[0],u[3],c,-c,0,0,0),Do(s,0,s.length,a,aS,o),Fh(n,t)(s,o,a)}:Fh(n,t);return this.applyTransform(r),this}}class Va extends lS{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(e){return qy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return je()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=uS(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){je()}setLayout(e,t,n){let r;if(e)r=uS(e);else{for(let s=0;s<n;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=nU(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(e,t){const n=this.getFlatCoordinates();if(n){const r=this.getStride();oS(n,0,n.length,r,e,t,n),this.changed()}}scale(e,t,n){t===void 0&&(t=e),n||(n=Bo(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();tU(r,0,r.length,s,e,t,n,r),this.changed()}}translate(e,t){const n=this.getFlatCoordinates();if(n){const r=this.getStride();iU(n,0,n.length,r,e,t,n),this.changed()}}}function nU(i){let e;return i==2?e="XY":i==3?e="XYZ":i==4&&(e="XYZM"),e}function uS(i){let e;return i=="XY"?e=2:i=="XYZ"||i=="XYM"?e=3:i=="XYZM"&&(e=4),e}function rU(i,e,t){const n=i.getFlatCoordinates();if(!n)return null;const r=i.getStride();return Do(n,0,n.length,r,e,t)}function cS(i,e,t,n,r,s,o){const a=i[e],l=i[e+1],u=i[t]-a,c=i[t+1]-l;let h;if(u===0&&c===0)h=e;else{const d=((r-a)*u+(s-l)*c)/(u*u+c*c);if(d>1)h=t;else if(d>0){for(let g=0;g<n;++g)o[g]=Hn(i[e+g],i[t+g],d);o.length=n;return}else h=e}for(let d=0;d<n;++d)o[d]=i[h+d];o.length=n}function nv(i,e,t,n,r){let s=i[e],o=i[e+1];for(e+=n;e<t;e+=n){const a=i[e],l=i[e+1],u=za(s,o,a,l);u>r&&(r=u),s=a,o=l}return r}function rv(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=nv(i,e,a,n,r),e=a}return r}function sU(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=rv(i,e,a,n,r),e=a[a.length-1]}return r}function sv(i,e,t,n,r,s,o,a,l,u,c){if(e==t)return u;let h,d;if(r===0){if(d=za(o,a,i[e],i[e+1]),d<u){for(h=0;h<n;++h)l[h]=i[e+h];return l.length=n,d}return u}c=c||[NaN,NaN];let g=e+n;for(;g<t;)if(cS(i,g-n,g,n,o,a,c),d=za(o,a,c[0],c[1]),d<u){for(u=d,h=0;h<n;++h)l[h]=c[h];l.length=n,g+=n}else g+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(s&&(cS(i,t-n,e,n,o,a,c),d=za(o,a,c[0],c[1]),d<u)){for(u=d,h=0;h<n;++h)l[h]=c[h];l.length=n}return u}function ov(i,e,t,n,r,s,o,a,l,u,c){c=c||[NaN,NaN];for(let h=0,d=t.length;h<d;++h){const g=t[h];u=sv(i,e,g,n,r,s,o,a,l,u,c),e=g}return u}function oU(i,e,t,n,r,s,o,a,l,u,c){c=c||[NaN,NaN];for(let h=0,d=t.length;h<d;++h){const g=t[h];u=ov(i,e,g,n,r,s,o,a,l,u,c),e=g[g.length-1]}return u}function aU(i,e,t,n){for(let r=0,s=t.length;r<s;++r)i[e++]=t[r];return e}function qg(i,e,t,n){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<n;++a)i[e++]=o[a]}return e}function av(i,e,t,n,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=qg(i,e,t[o],n);r[s++]=l,e=l}return r.length=s,r}function lU(i,e,t,n,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=av(i,e,t[o],n,r[s]);l.length===0&&(l[0]=e),r[s++]=l,e=l[l.length-1]}return r.length=s,r}function lv(i,e,t,n,r,s,o){const a=(t-e)/n;if(a<3){for(;e<t;e+=n)s[o++]=i[e],s[o++]=i[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const u=[e,t-n];let c=0;for(;u.length>0;){const h=u.pop(),d=u.pop();let g=0;const A=i[d],p=i[d+1],y=i[h],v=i[h+1];for(let E=d+n;E<h;E+=n){const I=i[E],C=i[E+1],w=G5(I,C,A,p,y,v);w>g&&(c=E,g=w)}g>r&&(l[(c-e)/n]=1,d+n<c&&u.push(d,c),c+n<h&&u.push(c,h))}for(let h=0;h<a;++h)l[h]&&(s[o++]=i[e+h*n],s[o++]=i[e+h*n+1]);return o}function uU(i,e,t,n,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const c=t[l];o=lv(i,e,c,n,r,s,o),a.push(o),e=c}return o}function qa(i,e){return e*Math.round(i/e)}function cU(i,e,t,n,r,s,o){if(e==t)return o;let a=qa(i[e],r),l=qa(i[e+1],r);e+=n,s[o++]=a,s[o++]=l;let u,c;do if(u=qa(i[e],r),c=qa(i[e+1],r),e+=n,e==t)return s[o++]=u,s[o++]=c,o;while(u==a&&c==l);for(;e<t;){const h=qa(i[e],r),d=qa(i[e+1],r);if(e+=n,h==u&&d==c)continue;const g=u-a,A=c-l,p=h-a,y=d-l;if(g*y==A*p&&(g<0&&p<g||g==p||g>0&&p>g)&&(A<0&&y<A||A==y||A>0&&y>A)){u=h,c=d;continue}s[o++]=u,s[o++]=c,a=u,l=c,u=h,c=d}return s[o++]=u,s[o++]=c,o}function hS(i,e,t,n,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const c=t[l];o=cU(i,e,c,n,r,s,o),a.push(o),e=c}return o}function hU(i,e,t,n,r,s,o,a){for(let l=0,u=t.length;l<u;++l){const c=t[l],h=[];o=hS(i,e,c,n,r,s,o,h),a.push(h),e=c[c.length-1]}return o}function ko(i,e,t,n,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=n)r[s++]=i.slice(o,o+n);return r.length=s,r}function Oh(i,e,t,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=ko(i,e,l,n,r[s]),e=l}return r.length=s,r}function uv(i,e,t,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=l.length===1&&l[0]===e?[]:Oh(i,e,l,n,r[s]),e=l[l.length-1]}return r.length=s,r}function dS(i,e,t,n){let r=0,s=i[t-n],o=i[t-n+1];for(;e<t;e+=n){const a=i[e],l=i[e+1];r+=o*a-s*l,s=a,o=l}return r/2}function fS(i,e,t,n){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=dS(i,e,a,n),e=a}return r}function dU(i,e,t,n){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=fS(i,e,a,n),e=a[a.length-1]}return r}class Nh extends Va{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Nh(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,n,r){return r<Ga(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(nv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,n,r))}getArea(){return dS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ko(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=lv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Nh(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qg(this.flatCoordinates,0,e,this.stride),this.changed()}}class $a extends Va{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new $a(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,r){const s=this.flatCoordinates,o=za(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)n[l]=s[l];return n.length=a,o}return r}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(e){return zb(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return zy(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=aU(this.flatCoordinates,0,e,this.stride),this.changed()}}function fU(i,e,t,n,r){return!$b(r,function(o){return!ja(i,e,t,n,o[0],o[1])})}function ja(i,e,t,n,r,s){let o=0,a=i[t-n],l=i[t-n+1];for(;e<t;e+=n){const u=i[e],c=i[e+1];l<=s?c>s&&(u-a)*(s-l)-(r-a)*(c-l)>0&&o++:c<=s&&(u-a)*(s-l)-(r-a)*(c-l)<0&&o--,a=u,l=c}return o!==0}function cv(i,e,t,n,r,s){if(t.length===0||!ja(i,e,t[0],n,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(ja(i,t[o-1],t[o],n,r,s))return!1;return!0}function gU(i,e,t,n,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const l=t[o];if(cv(i,e,l,n,r,s))return!0;e=l[l.length-1]}return!1}function hv(i,e,t,n,r,s,o){let a,l,u,c,h,d,g;const A=r[s+1],p=[];for(let E=0,I=t.length;E<I;++E){const C=t[E];for(c=i[C-n],d=i[C-n+1],a=e;a<C;a+=n)h=i[a],g=i[a+1],(A<=d&&g<=A||d<=A&&A<=g)&&(u=(A-d)/(g-d)*(h-c)+c,p.push(u)),c=h,d=g}let y=NaN,v=-1/0;for(p.sort(bo),c=p[0],a=1,l=p.length;a<l;++a){h=p[a];const E=Math.abs(h-c);E>v&&(u=(c+h)/2,cv(i,e,t,n,u,A)&&(y=u,v=E)),c=h}return isNaN(y)&&(y=r[s]),o?(o.push(y,A,v),o):[y,A,v]}function gS(i,e,t,n,r){let s=[];for(let o=0,a=t.length;o<a;++o){const l=t[o];s=hv(i,e,l,n,r,2*o,s),e=l[l.length-1]}return s}function AS(i,e,t,n,r){let s;for(e+=n;e<t;e+=n)if(s=r(i.slice(e-n,e),i.slice(e,e+n)),s)return s;return!1}function $g(i,e,t,n,r){const s=qb(Zr(),i,e,t,n);return vi(r,s)?Hb(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:AS(i,e,t,n,function(o,a){return B5(r,o,a)}):!1}function AU(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s){if($g(i,e,t[s],n,r))return!0;e=t[s]}return!1}function pS(i,e,t,n,r){return!!($g(i,e,t,n,r)||ja(i,e,t,n,r[0],r[1])||ja(i,e,t,n,r[0],r[3])||ja(i,e,t,n,r[2],r[1])||ja(i,e,t,n,r[2],r[3]))}function mS(i,e,t,n,r){if(!pS(i,e,t[0],n,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(fU(i,t[s-1],t[s],n,r)&&!$g(i,t[s-1],t[s],n,r))return!1;return!0}function pU(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(mS(i,e,a,n,r))return!0;e=a[a.length-1]}return!1}function mU(i,e,t,n){for(;e<t-n;){for(let r=0;r<n;++r){const s=i[e+r];i[e+r]=i[t-n+r],i[t-n+r]=s}e+=n,t-=n}}function dv(i,e,t,n){let r=0,s=i[t-n],o=i[t-n+1];for(;e<t;e+=n){const a=i[e],l=i[e+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function yS(i,e,t,n,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=dv(i,e,a,n);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=a}return!0}function yU(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!yS(i,e,a,n,r))return!1;a.length&&(e=a[a.length-1])}return!0}function fv(i,e,t,n,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=dv(i,e,a,n);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&mU(i,e,a,n),e=a}return e}function vS(i,e,t,n,r){for(let s=0,o=t.length;s<o;++s)e=fv(i,e,t[s],n,r);return e}function vU(i,e){const t=[];let n=0,r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!dv(i,n,a,2))t.push(e.slice(r,s+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=s+1,n=a}return t}class ks extends Va{constructor(e,t,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&n?(this.setFlatCoordinates(t,e),this.ends_=n):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Rs(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ks(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,n,r){return r<Ga(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rv(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ov(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,n,r))}containsXY(e,t){return cv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return fS(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),fv(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Oh(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Bo(this.getExtent());this.flatInteriorPoint_=hv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new $a(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Nh(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,n=this.ends_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],u=new Nh(t.slice(s,l),e);r.push(u),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;yS(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=fv(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=hS(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,n),new ks(t,"XY",n)}getType(){return"Polygon"}intersectsExtent(e){return mS(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=av(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function ES(i){if(nu(i))throw new Error("Cannot create polygon from empty extent");const e=i[0],t=i[1],n=i[2],r=i[3],s=[e,t,e,r,n,r,n,t,e,t];return new ks(s,"XY",[s.length])}const wn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class Wa{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null}clone(){const e=this.getColor();return new Wa({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){this.color_=e}}function jg(i,e,t,n,r,s,o){let a,l;const u=(t-e)/n;if(u===1)a=e;else if(u===2)a=e,l=r;else if(u!==0){let c=i[e],h=i[e+1],d=0;const g=[0];for(let y=e+n;y<t;y+=n){const v=i[y],E=i[y+1];d+=Math.sqrt((v-c)*(v-c)+(E-h)*(E-h)),g.push(d),c=v,h=E}const A=r*d,p=u5(g,A);p<0?(l=(A-g[-p-2])/(g[-p-1]-g[-p-2]),a=e+(-p-2)*n):a=e+p*n}o=o>1?o:2,s=s||new Array(o);for(let c=0;c<o;++c)s[c]=a===void 0?NaN:l===void 0?i[a+c]:Hn(i[a+c],i[a+n+c],l);return s}function gv(i,e,t,n,r,s){if(t==e)return null;let o;if(r<i[e+n-1])return s?(o=i.slice(e,e+n),o[n-1]=r,o):null;if(i[t-1]<r)return s?(o=i.slice(t-n,t),o[n-1]=r,o):null;if(r==i[e+n-1])return i.slice(e,e+n);let a=e/n,l=t/n;for(;a<l;){const d=a+l>>1;r<i[(d+1)*n-1]?l=d:a=d+1}const u=i[a*n-1];if(r==u)return i.slice((a-1)*n,(a-1)*n+n);const c=i[(a+1)*n-1],h=(r-u)/(c-u);o=[];for(let d=0;d<n-1;++d)o.push(Hn(i[(a-1)*n+d],i[a*n+d],h));return o.push(r),o}function EU(i,e,t,n,r,s,o){if(o)return gv(i,e,t[t.length-1],n,r,s);let a;if(r<i[n-1])return s?(a=i.slice(0,n),a[n-1]=r,a):null;if(i[i.length-1]<r)return s?(a=i.slice(i.length-n),a[n-1]=r,a):null;for(let l=0,u=t.length;l<u;++l){const c=t[l];if(e!=c){if(r<i[e+n-1])return null;if(r<=i[c-1])return gv(i,e,c,n,r,!1);e=c}}return null}function IS(i,e,t,n){let r=i[e],s=i[e+1],o=0;for(let a=e+n;a<t;a+=n){const l=i[a],u=i[a+1];o+=Math.sqrt((l-r)*(l-r)+(u-s)*(u-s)),r=l,s=u}return o}class Ka extends Va{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){this.flatCoordinates?Rs(this.flatCoordinates,e):this.flatCoordinates=e.slice(),this.changed()}clone(){const e=new Ka(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,r){return r<Ga(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(nv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,n,r))}forEachSegment(e){return AS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,gv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return ko(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return jg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return IS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=lv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ka(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return $g(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qg(this.flatCoordinates,0,e,this.stride),this.changed()}}class lu{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new lu({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}const Nt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function _S(i){return i[0]>0&&i[1]>0}function IU(i,e,t){return t===void 0&&(t=[0,0]),t[0]=i[0]*e+.5|0,t[1]=i[1]*e+.5|0,t}function ai(i,e){return Array.isArray(i)?i:(e===void 0?e=[i,i]:(e[0]=i,e[1]=i),e)}class Wg{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=ai(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Wg({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return je()}getImage(e){return je()}getHitDetectionImage(){return je()}getPixelRatio(e){return 1}getImageState(){return je()}getImageSize(){return je()}getOrigin(){return je()}getSize(){return je()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ai(e)}listenImageChange(e){je()}load(){je()}unlistenImageChange(e){je()}}const CS=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,wS=/^([a-z]*)$|^hsla?\(.*\)$/i;function xS(i){return typeof i=="string"?i:BS(i)}function bS(i){const e=document.createElement("div");if(e.style.color=i,e.style.color!==""){document.body.appendChild(e);const t=getComputedStyle(e).color;return document.body.removeChild(e),t}return""}const SS=function(){const e={};let t=0;return function(n){let r;if(e.hasOwnProperty(n))r=e[n];else{if(t>=1024){let s=0;for(const o in e)s++&3||(delete e[o],--t)}r=_U(n),e[n]=r,++t}return r}}();function Qh(i){return Array.isArray(i)?i:SS(i)}function _U(i){let e,t,n,r,s;if(wS.exec(i)&&(i=bS(i)),CS.exec(i)){const o=i.length-1;let a;o<=4?a=1:a=2;const l=o===4||o===8;e=parseInt(i.substr(1+0*a,a),16),t=parseInt(i.substr(1+1*a,a),16),n=parseInt(i.substr(1+2*a,a),16),l?r=parseInt(i.substr(1+3*a,a),16):r=255,a==1&&(e=(e<<4)+e,t=(t<<4)+t,n=(n<<4)+n,l&&(r=(r<<4)+r)),s=[e,t,n,r/255]}else if(i.startsWith("rgba("))s=i.slice(5,-1).split(",").map(Number),TS(s);else if(i.startsWith("rgb("))s=i.slice(4,-1).split(",").map(Number),s.push(1),TS(s);else throw new Error("Invalid color");return s}function TS(i){return i[0]=Xt(i[0]+.5|0,0,255),i[1]=Xt(i[1]+.5|0,0,255),i[2]=Xt(i[2]+.5|0,0,255),i[3]=Xt(i[3],0,1),i}function BS(i){let e=i[0];e!=(e|0)&&(e=e+.5|0);let t=i[1];t!=(t|0)&&(t=t+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const r=i[3]===void 0?1:Math.round(i[3]*100)/100;return"rgba("+e+","+t+","+n+","+r+")"}function CU(i){return wS.test(i)&&(i=bS(i)),CS.test(i)||i.startsWith("rgba(")||i.startsWith("rgb(")}function Jr(i){return Array.isArray(i)?BS(i):i}function xi(i,e,t,n){let r;return t&&t.length?r=t.shift():Uy?r=new OffscreenCanvas(i||300,e||300):r=document.createElement("canvas"),i&&(r.width=i),e&&(r.height=e),r.getContext("2d",n)}function uu(i){const e=i.canvas;e.width=1,e.height=1,i.clearRect(0,0,1,1)}function Kg(i,e){const t=e.parentNode;t&&t.replaceChild(i,e)}function Av(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function wU(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function xU(i,e){const t=i.childNodes;for(let n=0;;++n){const r=t[n],s=e[n];if(!r&&!s)break;if(r!==s){if(!r){i.appendChild(s);continue}if(!s){i.removeChild(r),--n;continue}i.insertBefore(s,r)}}}const Yg="ol-hidden",Uh="ol-unselectable",RS="ol-unsupported",Zg="ol-control",LS="ol-collapsed",bU=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),DS=["style","variant","weight","size","lineHeight","family"],kS=function(i){const e=i.match(bU);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,r=DS.length;n<r;++n){const s=e[n+1];s!==void 0&&(t[DS[n]]=s)}return t.families=t.family.split(/,\s?/),t},PS="10px sans-serif",xn="#000",cu="round",Ps=[],Ms=0,hu="round",Gh=10,Hh="#000",zh="center",Xg="middle",Ya=[0,0,0,0],Vh=1,Fs=new Yr;let du=null,pv;const mv={},SU=function(){const e="32px ",t=["monospace","serif"],n=t.length,r="wmytzilWMYTZIL@#/&?$%10";let s,o;function a(u,c,h){let d=!0;for(let g=0;g<n;++g){const A=t[g];if(o=Jg(u+" "+c+" "+e+A,r),h!=A){const p=Jg(u+" "+c+" "+e+h+","+A,r);d=d&&p!=o}}return!!d}function l(){let u=!0;const c=Fs.getKeys();for(let h=0,d=c.length;h<d;++h){const g=c[h];Fs.get(g)<100&&(a.apply(this,g.split(`
`))?(eu(mv),du=null,pv=void 0,Fs.set(g,100)):(Fs.set(g,Fs.get(g)+1,!0),u=!1))}u&&(clearInterval(s),s=void 0)}return function(u){const c=kS(u);if(!c)return;const h=c.families;for(let d=0,g=h.length;d<g;++d){const A=h[d],p=c.style+`
`+c.weight+`
`+A;Fs.get(p)===void 0&&(Fs.set(p,100,!0),a(c.style,c.weight,A)||(Fs.set(p,0,!0),s===void 0&&(s=setInterval(l,32))))}}}(),TU=function(){let i;return function(e){let t=mv[e];if(t==null){if(Uy){const n=kS(e),r=MS(e,"Žg");t=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=e,document.body.appendChild(i),t=i.offsetHeight,document.body.removeChild(i);mv[e]=t}return t}}();function MS(i,e){return du||(du=xi(1,1)),i!=pv&&(du.font=i,pv=du.font),du.measureText(e)}function Jg(i,e){return MS(i,e).width}function FS(i,e,t){if(e in t)return t[e];const n=e.split(`
`).reduce((r,s)=>Math.max(r,Jg(i,s)),0);return t[e]=n,n}function BU(i,e){const t=[],n=[],r=[];let s=0,o=0,a=0,l=0;for(let u=0,c=e.length;u<=c;u+=2){const h=e[u];if(h===`
`||u===c){s=Math.max(s,o),r.push(o),o=0,a+=l;continue}const d=e[u+1]||i.font,g=Jg(d,h);t.push(g),o+=g;const A=TU(d);n.push(A),l=Math.max(l,A)}return{width:s,height:a,widths:t,heights:n,lineWidths:r}}function RU(i,e,t,n,r,s,o,a,l,u,c){i.save(),t!==1&&(i.globalAlpha*=t),e&&i.transform.apply(i,e),n.contextInstructions?(i.translate(l,u),i.scale(c[0],c[1]),LU(n,i)):c[0]<0||c[1]<0?(i.translate(l,u),i.scale(c[0],c[1]),i.drawImage(n,r,s,o,a,0,0,o,a)):i.drawImage(n,r,s,o,a,l,u,o*c[0],a*c[1]),i.restore()}function LU(i,e){const t=i.contextInstructions;for(let n=0,r=t.length;n<r;n+=2)Array.isArray(t[n+1])?e[t[n]].apply(e,t[n+1]):e[t[n]]=t[n+1]}class eA extends Wg{constructor(e){const t=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:1,rotateWithView:t,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=e.radius!==void 0?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const e=this.getScale(),t=new eA({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_;if(!e)return null;const t=this.getDisplacement(),n=this.getScaleArray();return[e[0]/2-t[0]/n[0],e[1]/2+t[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(e){let t=this.canvas_[e];if(!t){const n=this.renderOptions_,r=xi(n.size*e,n.size*e);this.draw_(n,r,e),t=r.canvas,this.canvas_[e]=t}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return Nt.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,n){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius_,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const S=r;r=s,s=S}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),u=Math.sqrt(s*s-l*l),c=r-u,h=Math.sqrt(l*l+c*c),d=h/l;if(e==="miter"&&d<=n)return d*t;const g=t/2/d,A=t/2*(c/h),y=Math.sqrt((r+g)*(r+g)+A*A)-r;if(this.radius2_===void 0||e==="bevel")return y*2;const v=r*Math.sin(a),E=Math.sqrt(r*r-v*v),I=s-E,w=Math.sqrt(v*v+I*I)/v;if(w<=n){const S=w*t/2-s-r;return 2*Math.max(y,S)}return y*2}createRenderOptions(){let e=cu,t=hu,n=0,r=null,s=0,o,a=0;this.stroke_&&(o=this.stroke_.getColor(),o===null&&(o=Hh),o=Jr(o),a=this.stroke_.getWidth(),a===void 0&&(a=Vh),r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=hu),e=this.stroke_.getLineCap(),e===void 0&&(e=cu),n=this.stroke_.getMiterLimit(),n===void 0&&(n=Gh));const l=this.calculateLineJoinSize_(t,a,n),u=Math.max(this.radius_,this.radius2_||0),c=Math.ceil(2*u+l);return{strokeStyle:o,strokeWidth:a,size:c,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.canvas_={},this.size_=[e,e]}draw_(e,t,n){if(t.scale(n,n),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=xn),t.fillStyle=Jr(r),t.fill()}this.stroke_&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){if(this.fill_){let t=this.fill_.getColor(),n=0;if(typeof t=="string"&&(t=Qh(t)),t===null?n=1:Array.isArray(t)&&(n=t.length===4?t[3]:1),n===0){const r=xi(e.size,e.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(e,r)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(e){let t=this.points_;const n=this.radius_;if(t===1/0)e.arc(0,0,n,0,2*Math.PI);else{const r=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=s+a*o,u=a%2===0?n:r;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=xn,t.fill(),this.stroke_&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}}class qh extends eA{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new qh({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius_=e,this.render()}}let fu=class r5{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=OS,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new r5({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=OS,this.geometry_=e}setZIndex(e){this.zIndex_=e}};function DU(i){let e;if(typeof i=="function")e=i;else{let t;Array.isArray(i)?t=i:(It(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[i]),e=function(){return t}}return e}let yv=null;function kU(i,e){if(!yv){const t=new Wa({color:"rgba(255,255,255,0.4)"}),n=new lu({color:"#3399CC",width:1.25});yv=[new fu({image:new qh({fill:t,stroke:n,radius:5}),fill:t,stroke:n})]}return yv}function OS(i){return i.getGeometry()}const PU="#333";let MU=class s5{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=ai(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Wa({color:PU}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding}clone(){const e=this.getScale();return new s5({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=ai(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}};const bt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class NS extends Yr{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[bt.OPACITY]=e.opacity!==void 0?e.opacity:1,It(typeof t[bt.OPACITY]=="number","Layer opacity must be a number"),t[bt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[bt.Z_INDEX]=e.zIndex,t[bt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[bt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[bt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[bt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},n=this.getZIndex();return t.opacity=Xt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=n===void 0&&!t.managed?1/0:n,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return je()}getLayerStatesArray(e){return je()}getExtent(){return this.get(bt.EXTENT)}getMaxResolution(){return this.get(bt.MAX_RESOLUTION)}getMinResolution(){return this.get(bt.MIN_RESOLUTION)}getMinZoom(){return this.get(bt.MIN_ZOOM)}getMaxZoom(){return this.get(bt.MAX_ZOOM)}getOpacity(){return this.get(bt.OPACITY)}getSourceState(){return je()}getVisible(){return this.get(bt.VISIBLE)}getZIndex(){return this.get(bt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(bt.EXTENT,e)}setMaxResolution(e){this.set(bt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(bt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(bt.MAX_ZOOM,e)}setMinZoom(e){this.set(bt.MIN_ZOOM,e)}setOpacity(e){It(typeof e=="number","Layer opacity must be a number"),this.set(bt.OPACITY,e)}setVisible(e){this.set(bt.VISIBLE,e)}setZIndex(e){this.set(bt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const bi={ANIMATING:0,INTERACTING:1},wr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},QS=42,vv=256;function US(i,e,t){return function(n,r,s,o,a){if(!n)return;if(!r&&!e)return n;const l=e?0:s[0]*r,u=e?0:s[1]*r,c=a?a[0]:0,h=a?a[1]:0;let d=i[0]+l/2+c,g=i[2]-l/2+c,A=i[1]+u/2+h,p=i[3]-u/2+h;d>g&&(d=(g+d)/2,g=d),A>p&&(A=(p+A)/2,p=A);let y=Xt(n[0],d,g),v=Xt(n[1],A,p);if(o&&t&&r){const E=30*r;y+=-E*Math.log(1+Math.max(0,d-n[0])/E)+E*Math.log(1+Math.max(0,n[0]-g)/E),v+=-E*Math.log(1+Math.max(0,A-n[1])/E)+E*Math.log(1+Math.max(0,n[1]-p)/E)}return[y,v]}}function FU(i){return i}function Ev(i,e,t,n){const r=wi(e)/t[0],s=rr(e)/t[1];return n?Math.min(i,Math.max(r,s)):Math.min(i,Math.min(r,s))}function Iv(i,e,t){let n=Math.min(i,e);const r=50;return n*=Math.log(1+r*Math.max(0,i/e-1))/r+1,t&&(n=Math.max(n,t),n/=Math.log(1+r*Math.max(0,t/i-1))/r+1),Xt(n,t/2,e*2)}function OU(i,e,t,n){return e=e!==void 0?e:!0,function(r,s,o,a){if(r!==void 0){const l=i[0],u=i[i.length-1],c=t?Ev(l,t,o,n):l;if(a)return e?Iv(r,c,u):Xt(r,u,c);const h=Math.min(c,r),d=Math.floor(Ny(i,h,s));return i[d]>c&&d<i.length-1?i[d+1]:i[d]}}}function NU(i,e,t,n,r,s){return n=n!==void 0?n:!0,t=t!==void 0?t:0,function(o,a,l,u){if(o!==void 0){const c=r?Ev(e,r,l,s):e;if(u)return n?Iv(o,c,t):Xt(o,t,c);const h=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(i)-h),g=-a*(.5-h)+.5,A=Math.min(c,o),p=Math.floor(Math.log(e/A)/Math.log(i)+g),y=Math.max(d,p),v=e/Math.pow(i,y);return Xt(v,t,c)}}}function GS(i,e,t,n,r){return t=t!==void 0?t:!0,function(s,o,a,l){if(s!==void 0){const u=n?Ev(i,n,a,r):i;return!t||!l?Xt(s,e,u):Iv(s,u,e)}}}function _v(i){if(i!==void 0)return 0}function HS(i){if(i!==void 0)return i}function QU(i){const e=2*Math.PI/i;return function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function UU(i){return i=i||Ug(5),function(e,t){if(t)return e;if(e!==void 0)return Math.abs(e)<=i?0:e}}function zS(i){return Math.pow(i,3)}function gu(i){return 1-zS(1-i)}function GU(i){return 3*i*i-2*i*i*i}function HU(i){return i}const Cv=0;class Os extends Yr{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ev(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&j5(),e.center&&(e.center=Ds(e.center,this.projection_)),e.extent&&(e.extent=Lo(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in wr)delete t[a];this.setProperties(t,!0);const n=VU(e);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=n.minZoom;const r=zU(e),s=n.constraint,o=qU(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const n=this.getCenterInternal();if(n){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let n=0;n<t.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=Ds(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ds(r.anchor,this.getProjection())),t[n]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,n;t>1&&typeof arguments[t-1]=="function"&&(n=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const c=arguments[r];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(r===t){n&&tA(n,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const u=[];for(;r<t;++r){const c=arguments[r],h={start:s,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||GU,callback:n};if(c.center&&(h.sourceCenter=o,h.targetCenter=c.center.slice(),o=h.targetCenter),c.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),c.rotation!==void 0){h.sourceRotation=l;const d=au(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+d,l=h.targetRotation}$U(h)?h.complete=!0:s+=h.duration,u.push(h)}this.animations_.push(u),this.setHint(bi.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[bi.ANIMATING]>0}getInteracting(){return this.hints_[bi.INTERACTING]>0}cancelAnimations(){this.setHint(bi.ANIMATING,-this.hints_[bi.ANIMATING]);let e;for(let t=0,n=this.animations_.length;t<n;++t){const r=this.animations_[t];if(r[0].callback&&tA(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let n=this.animations_.length-1;n>=0;--n){const r=this.animations_[n];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const u=e-l.start;let c=l.duration>0?u/l.duration:1;c>=1?(l.complete=!0,c=1):s=!1;const h=l.easing(c);if(l.sourceCenter){const d=l.sourceCenter[0],g=l.sourceCenter[1],A=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const y=d+h*(A-d),v=g+h*(p-g);this.targetCenter_=[y,v]}if(l.sourceResolution&&l.targetResolution){const d=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),A=this.constraints_.resolution(d,0,g,!0);this.targetCenter_=this.calculateCenterZoom(A,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=h===1?au(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[n]=null,this.setHint(bi.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&tA(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let n;const r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-t[0],r[1]-t[1]],Zy(n,e-this.getRotation()),z5(n,t)),n}calculateCenterZoom(e,t){let n;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;n=[o,a]}return n}getViewportSize_(e){const t=this.viewportSize_;if(e){const n=t[0],r=t[1];return[Math.abs(n*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(n*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Vg(e,this.getProjection())}getCenterInternal(){return this.get(wr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return sS(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();It(t,"The view center is not defined");const n=this.getResolution();It(n!==void 0,"The view resolution is not defined");const r=this.getRotation();return It(r!==void 0,"The view rotation is not defined"),$y(t,n,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(wr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Lo(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const n=wi(e)/t[0],r=rr(e)/t[1];return Math.max(n,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(t/n)/Math.log(e);return function(s){return t/Math.pow(e,s*r)}}getRotation(){return this.get(wr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(n/r)/t;return function(o){return Math.log(n/o)/t/s}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const n=this.padding_;return n&&(t=[t[0]-n[1]-n[3],t[1]-n[0]-n[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),n=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=wv(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,n)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,n,r;if(this.resolutions_){const s=Ny(this.resolutions_,e,1);t=s,n=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=n/this.resolutions_[s+1]}else n=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(n/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const t=Xt(Math.floor(e),0,this.resolutions_.length-2),n=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(n,Xt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let n;if(It(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){It(!nu(e),"Cannot fit empty extent provided as `geometry`");const r=Lo(e,this.getProjection());n=ES(r)}else if(e.getType()==="Circle"){const r=Lo(e.getExtent(),this.getProjection());n=ES(r),n.rotate(this.getRotation(),Bo(r))}else{const r=X5();r?n=e.clone().transform(r,this.getProjection()):n=e}this.fitInternal(n,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),n=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let h=0,d=s.length;h<d;h+=o){const g=s[h]*n-s[h+1]*r,A=s[h]*r+s[h+1]*n;a=Math.min(a,g),l=Math.min(l,A),u=Math.max(u,g),c=Math.max(c,A)}return[a,l,u,c]}fitInternal(e,t){t=t||{};let n=t.size;n||(n=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),c=Math.sin(u),h=Math.cos(u),d=Bo(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;const g=d[0]*h-d[1]*c,A=d[1]*h+d[0]*c,p=this.getConstrainedCenter([g,A],l),y=t.callback?t.callback:Sg;t.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:t.duration,easing:t.easing},y):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),tA(y,!0))}centerOn(e,t,n){this.centerOnInternal(Ds(e,this.getProjection()),t,n)}centerOnInternal(e,t,n){this.setCenterInternal(wv(e,t,n,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,n,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-n),l=wv(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,n);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Vg(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Ds(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,n);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Ds(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,n);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ds(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const n=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,n),a=this.constraints_.center(this.targetCenter_,o,s,n,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(wr.ROTATION)!==r&&this.set(wr.ROTATION,r),this.get(wr.RESOLUTION)!==o&&(this.set(wr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(wr.CENTER)||!zg(this.get(wr.CENTER),a))&&this.set(wr.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,n){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}n=n||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!zg(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:gu,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(bi.INTERACTING,1)}endInteraction(e,t,n){n=n&&Ds(n,this.getProjection()),this.endInteractionInternal(e,t,n)}endInteractionInternal(e,t,n){this.getInteracting()&&(this.setHint(bi.INTERACTING,-1),this.resolveConstraints(e,t,n))}getConstrainedCenter(e,t){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),n)}getConstrainedZoom(e,t){const n=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(n,t))}getConstrainedResolution(e,t){t=t||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,n)}}function tA(i,e){setTimeout(function(){i(e)},0)}function zU(i){if(i.extent!==void 0){const t=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return US(i.extent,i.constrainOnlyCenter,t)}const e=ev(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,US(t,!1,!1)}return FU}function VU(i){let e,t,n,o=i.minZoom!==void 0?i.minZoom:Cv,a=i.maxZoom!==void 0?i.maxZoom:28;const l=i.zoomFactor!==void 0?i.zoomFactor:2,u=i.multiWorld!==void 0?i.multiWorld:!1,c=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,h=i.showFullExtent!==void 0?i.showFullExtent:!1,d=ev(i.projection,"EPSG:3857"),g=d.getExtent();let A=i.constrainOnlyCenter,p=i.extent;if(!u&&!p&&d.isGlobal()&&(A=!1,p=g),i.resolutions!==void 0){const y=i.resolutions;t=y[o],n=y[a]!==void 0?y[a]:y[y.length-1],i.constrainResolution?e=OU(y,c,!A&&p,h):e=GS(t,n,c,!A&&p,h)}else{const v=(g?Math.max(wi(g),rr(g)):360*Wy.degrees/d.getMetersPerUnit())/vv/Math.pow(2,Cv),E=v/Math.pow(2,28-Cv);t=i.maxResolution,t!==void 0?o=0:t=v/Math.pow(l,o),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=t/Math.pow(l,a):n=v/Math.pow(l,a):n=E),a=o+Math.floor(Math.log(t/n)/Math.log(l)),n=t/Math.pow(l,a-o),i.constrainResolution?e=NU(l,t,n,c,!A&&p,h):e=GS(t,n,c,!A&&p,h)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:o,zoomFactor:l}}function qU(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const t=i.constrainRotation;return t===void 0||t===!0?UU():t===!1?HS:typeof t=="number"?QU(t):HS}return _v}function $U(i){return!(i.sourceCenter&&i.targetCenter&&!zg(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function wv(i,e,t,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=i[0]*s-i[1]*o,l=i[1]*s+i[0]*o;a+=(e[0]/2-t[0])*n,l+=(t[1]-e[1]/2)*n,o=-o;const u=a*s-l*o,c=l*s+a*o;return[u,c]}class jU extends NS{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(bt.SOURCE,this.handleSourcePropertyChange_);const n=e.source?e.source:null;this.setSource(n)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(bt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ot(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Et(e,$e.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const n=this.getMapInternal();!e&&n&&(e=n.getView()),e instanceof Os?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&n&&(t.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let r;t.layerStatesArray?r=t.layerStatesArray.find(o=>o.layer===this):r=this.getLayerState();const s=this.getExtent();return xv(r,t.viewState)&&(!s||vi(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];let t;const n=this.getSource();if(n&&(t=n.getAttributions()),!t)return[];const r=e instanceof Os?e.getViewStateAndExtent():e;let s=t(r);return Array.isArray(s)||(s=[s]),s}render(e,t){const n=this.getRenderer();return n.prepareFrame(e)?(this.rendered=!0,n.renderFrame(e,t)):null}unrender(){this.rendered=!1}setMapInternal(e){e||this.unrender(),this.set(bt.MAP,e)}getMapInternal(){return this.get(bt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ot(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ot(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Et(e,wn.PRECOMPOSE,function(t){const r=t.frameState.layerStatesArray,s=this.getLayerState(!1);It(!r.some(function(o){return o.layer===s.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),r.push(s)},this),this.mapRenderKey_=Et(this,$e.CHANGE,e.render,e),this.changed())}setSource(e){this.set(bt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function xv(i,e){if(!i.visible)return!1;const t=e.resolution;if(t<i.minResolution||t>=i.maxResolution)return!1;const n=e.zoom;return n>i.minZoom&&n<=i.maxZoom}const iA=jU;function WU(i,e,t,n,r){VS(i,e,t||0,n||i.length-1,r||KU)}function VS(i,e,t,n,r){for(;n>t;){if(n-t>600){var s=n-t+1,o=e-t+1,a=Math.log(s),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1),c=Math.max(t,Math.floor(e-o*l/s+u)),h=Math.min(n,Math.floor(e+(s-o)*l/s+u));VS(i,e,c,h,r)}var d=i[e],g=t,A=n;for($h(i,t,e),r(i[n],d)>0&&$h(i,t,n);g<A;){for($h(i,g,A),g++,A--;r(i[g],d)<0;)g++;for(;r(i[A],d)>0;)A--}r(i[t],d)===0?$h(i,t,A):(A++,$h(i,A,n)),A<=e&&(t=A+1),e<=A&&(n=A-1)}}function $h(i,e,t){var n=i[e];i[e]=i[t],i[t]=n}function KU(i,e){return i<e?-1:i>e?1:0}class YU{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!rA(e,t))return n;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?r(a):a;rA(e,l)&&(t.leaf?n.push(a):Sv(e,l)?this._all(a,n):s.push(a))}t=s.pop()}return n}collides(e){let t=this.data;if(!rA(e,t))return!1;const n=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(rA(e,o)){if(t.leaf||Sv(e,o))return!0;n.push(s)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=pu([]),this}remove(e,t){if(!e)return this;let n=this.data;const r=this.toBBox(e),s=[],o=[];let a,l,u;for(;n||s.length;){if(n||(n=s.pop(),l=s[s.length-1],a=o.pop(),u=!0),n.leaf){const c=ZU(e,n.children,t);if(c!==-1)return n.children.splice(c,1),s.push(n),this._condense(s),this}!u&&!n.leaf&&Sv(n,r)?(s.push(n),o.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],u=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,r){const s=n-t+1;let o=this._maxEntries,a;if(s<=o)return a=pu(e.slice(t,n+1)),Au(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=pu([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),u=l*Math.ceil(Math.sqrt(o));qS(e,t,n,u,this.compareMinX);for(let c=t;c<=n;c+=u){const h=Math.min(c+u-1,n);qS(e,c,h,l,this.compareMinY);for(let d=c;d<=h;d+=l){const g=Math.min(d+l-1,h);a.children.push(this._build(e,d,g,r-1))}}return Au(a,this.toBBox),a}_chooseSubtree(e,t,n,r){for(;r.push(t),!(t.leaf||r.length-1===n);){let s=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const u=t.children[l],c=bv(u),h=eG(e,u)-c;h<o?(o=h,s=c<s?c:s,a=u):h===o&&c<s&&(s=c,a=u)}t=a||t.children[0]}return t}_insert(e,t,n){const r=n?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Wh(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const n=e[t],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);const o=this._chooseSplitIndex(n,s,r),a=pu(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Au(n,this.toBBox),Au(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this.data=pu([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Au(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let r,s=1/0,o=1/0;for(let a=t;a<=n-t;a++){const l=jh(e,0,a,this.toBBox),u=jh(e,a,n,this.toBBox),c=tG(l,u),h=bv(l)+bv(u);c<s?(s=c,r=a,o=h<o?h:o):c===s&&h<o&&(o=h,r=a)}return r||n-t}_chooseSplitAxis(e,t,n){const r=e.leaf?this.compareMinX:XU,s=e.leaf?this.compareMinY:JU,o=this._allDistMargin(e,t,n,r),a=this._allDistMargin(e,t,n,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const s=this.toBBox,o=jh(e,0,t,s),a=jh(e,n-t,n,s);let l=nA(o)+nA(a);for(let u=t;u<n-t;u++){const c=e.children[u];Wh(o,e.leaf?s(c):c),l+=nA(o)}for(let u=n-t-1;u>=t;u--){const c=e.children[u];Wh(a,e.leaf?s(c):c),l+=nA(a)}return l}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)Wh(t[r],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():Au(e[t],this.toBBox)}}function ZU(i,e,t){if(!t)return e.indexOf(i);for(let n=0;n<e.length;n++)if(t(i,e[n]))return n;return-1}function Au(i,e){jh(i,0,i.children.length,e,i)}function jh(i,e,t,n,r){r||(r=pu(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=i.children[s];Wh(r,i.leaf?n(o):o)}return r}function Wh(i,e){return i.minX=Math.min(i.minX,e.minX),i.minY=Math.min(i.minY,e.minY),i.maxX=Math.max(i.maxX,e.maxX),i.maxY=Math.max(i.maxY,e.maxY),i}function XU(i,e){return i.minX-e.minX}function JU(i,e){return i.minY-e.minY}function bv(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function nA(i){return i.maxX-i.minX+(i.maxY-i.minY)}function eG(i,e){return(Math.max(e.maxX,i.maxX)-Math.min(e.minX,i.minX))*(Math.max(e.maxY,i.maxY)-Math.min(e.minY,i.minY))}function tG(i,e){const t=Math.max(i.minX,e.minX),n=Math.max(i.minY,e.minY),r=Math.min(i.maxX,e.maxX),s=Math.min(i.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-n)}function Sv(i,e){return i.minX<=e.minX&&i.minY<=e.minY&&e.maxX<=i.maxX&&e.maxY<=i.maxY}function rA(i,e){return e.minX<=i.maxX&&e.minY<=i.maxY&&e.maxX>=i.minX&&e.maxY>=i.minY}function pu(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function qS(i,e,t,n,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=n)continue;const o=e+Math.ceil((t-e)/n/2)*n;WU(i,o,e,t,r),s.push(e,o,o,t)}}function iG(i,e,t){const n=i;let r=!0,s=!1,o=!1;const a=[Bg(n,$e.LOAD,function(){o=!0,s||e()})];return n.src&&Fb?(s=!0,n.decode().then(function(){r&&e()}).catch(function(l){r&&(o?e():t())})):a.push(Bg(n,$e.ERROR,t)),function(){r=!1,a.forEach(Ot)}}function nG(i,e){return new Promise((t,n)=>{function r(){o(),t(i)}function s(){o(),n(new Error("Image load error"))}function o(){i.removeEventListener("load",r),i.removeEventListener("error",s)}i.addEventListener("load",r),i.addEventListener("error",s)})}function rG(i,e){return e&&(i.src=e),Fb?new Promise((t,n)=>i.decode().then(()=>t(i),n)):nG(i)}class sG{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const n=this.cache_[t];!(e++&3)&&!n.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}}get(e,t,n){const r=$S(e,t,n);return r in this.cache_?this.cache_[r]:null}set(e,t,n,r){const s=$S(e,t,n);this.cache_[s]=r,++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function $S(i,e,t){const n=t?xS(t):"null";return e+":"+i+":"+n}const sA=new sG;let Kh=null;class oG extends Bh{constructor(e,t,n,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=n,this.canvas_={},this.color_=s,this.imageState_=r===void 0?Nt.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Nt.LOADED){Kh||(Kh=xi(1,1,void 0,{willReadFrequently:!0})),Kh.drawImage(this.image_,0,0);try{Kh.getImageData(0,0,1,1),this.tainted_=!1}catch{Kh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent($e.CHANGE)}handleImageError_(){this.imageState_=Nt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Nt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],n=xi(e,t);n.fillRect(0,0,e,t),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Nt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Nt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&rG(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Nt.LOADED)return;const t=this.image_,n=document.createElement("canvas");n.width=Math.ceil(t.width*e),n.height=Math.ceil(t.height*e);const r=n.getContext("2d");r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=xS(this.color_),r.fillRect(0,0,n.width/e,n.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=n}}function aG(i,e,t,n,r){let s=e===void 0?void 0:sA.get(e,t,r);return s||(s=new oG(i,i instanceof HTMLImageElement?i.src||void 0:e,t,n,r),sA.set(e,t,r,s)),s}function jS(i,e,t,n){return t!==void 0&&n!==void 0?[t/i,n/e]:t!==void 0?t/i:n!==void 0?n/e:1}class oA extends Wg{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,n=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:n,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;It(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||nt(o)),It(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),It(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Nt.IDLE:o!==void 0&&(o instanceof HTMLImageElement?o.complete?l=o.src?Nt.LOADED:Nt.IDLE:l=Nt.LOADING:l=Nt.LOADED),this.color_=e.color!==void 0?Qh(e.color):null,this.iconImage_=aG(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,e.width!==void 0||e.height!==void 0){let u,c;if(e.size)[u,c]=e.size;else{const h=this.getImage(1);if(h.width&&h.height)u=h.width,c=h.height;else if(h instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(jS(g[0],g[1],e.width,e.height))};this.listenImageChange(d);return}}u!==void 0&&this.setScale(jS(u,c,e.width,e.height))}}clone(){let e,t,n;return this.initialOptions_?(t=this.initialOptions_.width,n=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new oA({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),n=this.getScaleArray();return[e[0]-t[0]/n[0],e[1]+t[1]/n[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),n=this.iconImage_.getSize();if(!t||!n)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=n[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=n[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Nt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Nt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener($e.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener($e.CHANGE,e)}}let mu=0;const Zi=1<<mu++,ut=1<<mu++,yu=1<<mu++,Tv=1<<mu++,Yh=1<<mu++,xr=Math.pow(2,mu)-1,WS={[Zi]:"boolean",[ut]:"number",[yu]:"string",[Tv]:"color",[Yh]:"number[]"},lG=Object.keys(WS).map(Number).sort(bo);function aA(i){const e=[];for(const t of lG)uG(i,t)&&e.push(WS[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function uG(i,e){return(i&e)===e}function KS(i,e){return!!(i&e)}class Po{constructor(e,t){this.type=e,this.value=t}}class cG{constructor(e,t,...n){this.type=e,this.operator=t,this.args=n}}function YS(){return{variables:new Set,properties:new Set}}function lA(i,e){switch(typeof i){case"boolean":return new Po(Zi,i);case"number":return new Po(ut,i);case"string":return new Po(yu,i)}if(!Array.isArray(i))throw new Error("Expression must be an array or a primitive value");if(i.length===0)throw new Error("Empty expression");if(typeof i[0]=="string")return AG(i,e);for(const n of i)if(typeof n!="number")throw new Error("Expected an array of numbers");let t=Yh;return(i.length===3||i.length===4)&&(t|=Tv),new Po(t,i)}const be={Number:"number",String:"string",Get:"get",Var:"var",Any:"any",All:"all",Not:"!",Resolution:"resolution",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match"},hG={[be.Number]:Rt(Ft(1,1/0,xr),ut),[be.String]:Rt(Ft(1,1/0,xr),yu),[be.Get]:Rt(dG,xr),[be.Var]:Rt(fG,xr),[be.Resolution]:Rt(gG,ut),[be.Any]:Rt(Ft(2,1/0,Zi),Zi),[be.All]:Rt(Ft(2,1/0,Zi),Zi),[be.Not]:Rt(Ft(1,1,Zi),Zi),[be.Equal]:Rt(Ft(2,2,xr),Zi),[be.NotEqual]:Rt(Ft(2,2,xr),Zi),[be.GreaterThan]:Rt(Ft(2,2,xr),Zi),[be.GreaterThanOrEqualTo]:Rt(Ft(2,2,xr),Zi),[be.LessThan]:Rt(Ft(2,2,xr),Zi),[be.LessThanOrEqualTo]:Rt(Ft(2,2,xr),Zi),[be.Multiply]:Rt(Ft(2,1/0,ut),ut),[be.Divide]:Rt(Ft(2,2,ut),ut),[be.Add]:Rt(Ft(2,1/0,ut),ut),[be.Subtract]:Rt(Ft(2,2,ut),ut),[be.Clamp]:Rt(Ft(3,3,ut),ut),[be.Mod]:Rt(Ft(2,2,ut),ut),[be.Pow]:Rt(Ft(2,2,ut),ut),[be.Abs]:Rt(Ft(1,1,ut),ut),[be.Floor]:Rt(Ft(1,1,ut),ut),[be.Ceil]:Rt(Ft(1,1,ut),ut),[be.Round]:Rt(Ft(1,1,ut),ut),[be.Sin]:Rt(Ft(1,1,ut),ut),[be.Cos]:Rt(Ft(1,1,ut),ut),[be.Atan]:Rt(Ft(1,2,ut),ut),[be.Sqrt]:Rt(Ft(1,1,ut),ut),[be.Match]:Rt(Ft(4,1/0,yu|ut),xr)};function dG(i,e){if(i.length!==2)throw new Error("Expected 1 argument for get operation");const t=lA(i[1],e);if(!(t instanceof Po))throw new Error("Expected a literal argument for get operation");if(typeof t.value!="string")throw new Error("Expected a string argument for get operation");return e.properties.add(t.value),[t]}function fG(i,e){if(i.length!==2)throw new Error("Expected 1 argument for var operation");const t=lA(i[1],e);if(!(t instanceof Po))throw new Error("Expected a literal argument for var operation");if(typeof t.value!="string")throw new Error("Expected a string argument for get operation");return e.variables.add(t.value),[t]}function gG(i,e){const t=i[0];if(i.length!==1)throw new Error(`Expected no arguments for ${t} operation`);return[]}function Ft(i,e,t){return function(n,r){const s=n[0],o=n.length-1;if(i===e){if(o!==i){const l=i===1?"":"s";throw new Error(`Expected ${i} argument${l} for operation ${s}, got ${o}`)}}else if(o<i||o>e)throw new Error(`Expected ${i} to ${e} arguments for operation ${s}, got ${o}`);const a=new Array(o);for(let l=0;l<o;++l){const u=lA(n[l+1],r);if(!KS(t,u.type)){const c=aA(t),h=aA(u.type);throw new Error(`Unexpected type for argument ${l} of ${s} operation : got ${c} but expected ${h}`)}a[l]=u}return a}}function Rt(i,e){return function(t,n){const r=t[0],s=i(t,n);return new cG(e,r,...s)}}function AG(i,e){const t=i[0],n=hG[t];if(!n)throw new Error(`Unknown operator: ${t}`);return n(i,e)}function ZS(){return{variables:{},properties:{},resolution:NaN}}function Mo(i,e,t){const n=lA(i,t);if(!KS(e,n.type)){const r=aA(e),s=aA(n.type);throw new Error(`Expected expression to be of type ${r}, got ${s}`)}return Za(n)}function Za(i,e){if(i instanceof Po)return function(){return i.value};const t=i.operator;switch(t){case be.Number:case be.String:return pG(i);case be.Get:case be.Var:return mG(i);case be.Resolution:return n=>n.resolution;case be.Any:case be.All:case be.Not:return vG(i);case be.Equal:case be.NotEqual:case be.LessThan:case be.LessThanOrEqualTo:case be.GreaterThan:case be.GreaterThanOrEqualTo:return yG(i);case be.Multiply:case be.Divide:case be.Add:case be.Subtract:case be.Clamp:case be.Mod:case be.Pow:case be.Abs:case be.Floor:case be.Ceil:case be.Round:case be.Sin:case be.Cos:case be.Atan:case be.Sqrt:return EG(i);case be.Match:return IG(i);default:throw new Error(`Unsupported operator ${t}`)}}function pG(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=Za(i.args[s]);switch(t){case be.Number:case be.String:return s=>{for(let o=0;o<n;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function mG(i,e){const t=i.args[0];if(!(t instanceof Po))throw new Error("Expected literal name");const n=t.value;if(typeof n!="string")throw new Error("Expected string name");switch(i.operator){case be.Get:return r=>r.properties[n];case be.Var:return r=>r.variables[n];default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function yG(i,e){const t=i.operator,n=Za(i.args[0]),r=Za(i.args[1]);switch(t){case be.Equal:return s=>n(s)===r(s);case be.NotEqual:return s=>n(s)!==r(s);case be.LessThan:return s=>n(s)<r(s);case be.LessThanOrEqualTo:return s=>n(s)<=r(s);case be.GreaterThan:return s=>n(s)>r(s);case be.GreaterThanOrEqualTo:return s=>n(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function vG(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=Za(i.args[s]);switch(t){case be.Any:return s=>{for(let o=0;o<n;++o)if(r[o](s))return!0;return!1};case be.All:return s=>{for(let o=0;o<n;++o)if(!r[o](s))return!1;return!0};case be.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function EG(i,e){const t=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=Za(i.args[s]);switch(t){case be.Multiply:return s=>{let o=1;for(let a=0;a<n;++a)o*=r[a](s);return o};case be.Divide:return s=>r[0](s)/r[1](s);case be.Add:return s=>{let o=0;for(let a=0;a<n;++a)o+=r[a](s);return o};case be.Subtract:return s=>r[0](s)-r[1](s);case be.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case be.Mod:return s=>r[0](s)%r[1](s);case be.Pow:return s=>Math.pow(r[0](s),r[1](s));case be.Abs:return s=>Math.abs(r[0](s));case be.Floor:return s=>Math.floor(r[0](s));case be.Ceil:return s=>Math.ceil(r[0](s));case be.Round:return s=>Math.round(r[0](s));case be.Sin:return s=>Math.sin(r[0](s));case be.Cos:return s=>Math.cos(r[0](s));case be.Atan:return n===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case be.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function IG(i,e){const t=i.args.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=Za(i.args[r]);return r=>{const s=n[0](r);for(let o=1;o<t;o+=2)if(s===n[o](r))return n[o+1](r);return n[t-1](r)}}function _G(i){return!0}function CG(i){const e=YS(),t=wG(i,e),n=ZS();return function(r,s){return n.properties=r.getPropertiesInternal(),n.resolution=s,t(n)}}function XS(i){const e=YS(),t=i.length,n=new Array(t);for(let o=0;o<t;++o)n[o]=Bv(i[o],e);const r=ZS(),s=new Array(t);return function(o,a){r.properties=o.getPropertiesInternal(),r.resolution=a;for(let l=0;l<t;++l)s[l]=n[l](r);return s}}function wG(i,e){const t=i.length,n=new Array(t);for(let r=0;r<t;++r){const s=i[r],o="filter"in s?Mo(s.filter,Zi,e):_G;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let u=0;u<l;++u)a[u]=Bv(s.style[u],e)}else a=[Bv(s.style,e)];n[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const l=n[a].filter;if(l(r)&&!(i[a].else&&o)){o=!0;for(const u of n[a].styles){const c=u(r);c&&s.push(c)}}}return s}}function Bv(i,e){const t=Zh(i,"",e),n=Xh(i,"",e),r=xG(i,e),s=bG(i,e),o=bn(i,"z-index",e),a=new fu;return function(l){let u=!0;if(t){const c=t(l);c&&(u=!1),a.setFill(c)}if(n){const c=n(l);c&&(u=!1),a.setStroke(c)}if(r){const c=r(l);c&&(u=!1),a.setText(c)}if(s){const c=s(l);c&&(u=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),u?null:a}}function Zh(i,e,t){const n=JS(i,e+"fill-color",t);if(!n)return null;const r=new Wa;return function(s){const o=n(s);return o==="none"?null:(r.setColor(o),r)}}function Xh(i,e,t){const n=bn(i,e+"stroke-width",t),r=JS(i,e+"stroke-color",t);if(!n&&!r)return null;const s=Fo(i,e+"stroke-line-cap",t),o=Fo(i,e+"stroke-line-join",t),a=eT(i,e+"stroke-line-dash",t),l=bn(i,e+"stroke-line-dash-offset",t),u=bn(i,e+"stroke-miter-limit",t),c=new lu;return function(h){if(r){const d=r(h);if(d==="none")return null;c.setColor(d)}if(n&&c.setWidth(n(h)),s){const d=s(h);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(d)}if(o){const d=o(h);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(d)}return a&&c.setLineDash(a(h)),l&&c.setLineDashOffset(l(h)),u&&c.setMiterLimit(u(h)),c}}function xG(i,e){const t="text-",n=Fo(i,t+"value",e);if(!n)return null;const r=Zh(i,t,e),s=Zh(i,t+"background-",e),o=Xh(i,t,e),a=Xh(i,t+"background-",e),l=Fo(i,t+"font",e),u=bn(i,t+"max-angle",e),c=bn(i,t+"offset-x",e),h=bn(i,t+"offset-y",e),d=Jh(i,t+"overflow",e),g=Fo(i,t+"placement",e),A=bn(i,t+"repeat",e),p=cA(i,t+"scale",e),y=Jh(i,t+"rotate-with-view",e),v=bn(i,t+"rotation",e),E=Fo(i,t+"align",e),I=Fo(i,t+"justify",e),C=Fo(i,t+"baseline",e),w=eT(i,t+"padding",e),S=new MU({});return function(x){if(S.setText(n(x)),r&&S.setFill(r(x)),s&&S.setBackgroundFill(s(x)),o&&S.setStroke(o(x)),a&&S.setBackgroundStroke(a(x)),l&&S.setFont(l(x)),u&&S.setMaxAngle(u(x)),c&&S.setOffsetX(c(x)),h&&S.setOffsetY(h(x)),d&&S.setOverflow(d(x)),g){const T=g(x);if(T!=="point"&&T!=="line")throw new Error("Expected point or line for text-placement");S.setPlacement(T)}if(A&&S.setRepeat(A(x)),p&&S.setScale(p(x)),y&&S.setRotateWithView(y(x)),v&&S.setRotation(v(x)),E){const T=E(x);if(T!=="left"&&T!=="center"&&T!=="right"&&T!=="end"&&T!=="start")throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(T)}if(I){const T=I(x);if(T!=="left"&&T!=="right"&&T!=="center")throw new Error("Expected left, right, or center for text-justify");S.setJustify(T)}if(C){const T=C(x);if(T!=="bottom"&&T!=="top"&&T!=="middle"&&T!=="alphabetic"&&T!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(T)}return w&&S.setPadding(w(x)),S}}function bG(i,e){return"icon-src"in i?SG(i,e):"shape-points"in i?TG(i,e):"circle-radius"in i?BG(i,e):null}function SG(i,e){const t="icon-",n=t+"src",r=nT(i[n],n),s=uA(i,t+"anchor",e),o=cA(i,t+"scale",e),a=bn(i,t+"opacity",e),l=uA(i,t+"displacement",e),u=bn(i,t+"rotation",e),c=Jh(i,t+"rotate-with-view",e),h=tT(i,t+"anchor-origin"),d=iT(i,t+"anchor-x-units"),g=iT(i,t+"anchor-y-units"),A=kG(i,t+"color"),p=LG(i,t+"cross-origin"),y=DG(i,t+"offset"),v=tT(i,t+"offset-origin"),E=vu(i,t+"width"),I=vu(i,t+"height"),C=RG(i,t+"size"),w=Rv(i,t+"declutter"),S=new oA({src:r,anchorOrigin:h,anchorXUnits:d,anchorYUnits:g,color:A,crossOrigin:p,offset:y,offsetOrigin:v,height:I,width:E,size:C,declutterMode:w});return function(x){return a&&S.setOpacity(a(x)),l&&S.setDisplacement(l(x)),u&&S.setRotation(u(x)),c&&S.setRotateWithView(c(x)),o&&S.setScale(o(x)),s&&S.setAnchor(s(x)),S}}function TG(i,e){const t="shape-",n=t+"points",r=rT(i[n],n),s=Zh(i,t,e),o=Xh(i,t,e),a=cA(i,t+"scale",e),l=uA(i,t+"displacement",e),u=bn(i,t+"rotation",e),c=Jh(i,t+"rotate-with-view",e),h=vu(i,t+"radius"),d=vu(i,t+"radius1"),g=vu(i,t+"radius2"),A=vu(i,t+"angle"),p=Rv(i,t+"declutter-mode"),y=new eA({points:r,radius:h,radius1:d,radius2:g,angle:A,declutterMode:p});return function(v){return s&&y.setFill(s(v)),o&&y.setStroke(o(v)),l&&y.setDisplacement(l(v)),u&&y.setRotation(u(v)),c&&y.setRotateWithView(c(v)),a&&y.setScale(a(v)),y}}function BG(i,e){const t="circle-",n=Zh(i,t,e),r=Xh(i,t,e),s=bn(i,t+"radius",e),o=cA(i,t+"scale",e),a=uA(i,t+"displacement",e),l=bn(i,t+"rotation",e),u=Jh(i,t+"rotate-with-view",e),c=Rv(i,t+"declutter-mode"),h=new qh({radius:5,declutterMode:c});return function(d){return s&&h.setRadius(s(d)),n&&h.setFill(n(d)),r&&h.setStroke(r(d)),a&&h.setDisplacement(a(d)),l&&h.setRotation(l(d)),u&&h.setRotateWithView(u(d)),o&&h.setScale(o(d)),h}}function bn(i,e,t){if(!(e in i))return;const n=Mo(i[e],ut,t);return function(r){return rT(n(r),e)}}function Fo(i,e,t){if(!(e in i))return null;const n=Mo(i[e],yu,t);return function(r){return nT(n(r),e)}}function Jh(i,e,t){if(!(e in i))return null;const n=Mo(i[e],Zi,t);return function(r){const s=n(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function JS(i,e,t){if(!(e in i))return null;const n=Mo(i[e],Tv|yu,t);return function(r){return sT(n(r),e)}}function eT(i,e,t){if(!(e in i))return null;const n=Mo(i[e],Yh,t);return function(r){return ed(n(r),e)}}function uA(i,e,t){if(!(e in i))return null;const n=Mo(i[e],Yh,t);return function(r){const s=ed(n(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function cA(i,e,t){if(!(e in i))return null;const n=Mo(i[e],Yh|ut,t);return function(r){return PG(n(r),e)}}function vu(i,e){const t=i[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function RG(i,e){const t=i[e];if(t!==void 0){if(typeof t=="number")return ai(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function LG(i,e){const t=i[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function tT(i,e){const t=i[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function iT(i,e){const t=i[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function DG(i,e){const t=i[e];if(t!==void 0)return ed(t,e)}function Rv(i,e){const t=i[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function kG(i,e){const t=i[e];if(t!==void 0)return sT(t,e)}function ed(i,e){if(!Array.isArray(i))throw new Error(`Expected an array for ${e}`);const t=i.length;for(let n=0;n<t;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${e}`);return i}function nT(i,e){if(typeof i!="string")throw new Error(`Expected a string for ${e}`);return i}function rT(i,e){if(typeof i!="number")throw new Error(`Expected a number for ${e}`);return i}function sT(i,e){if(typeof i=="string")return i;const t=ed(i,e),n=t.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function PG(i,e){if(typeof i=="number")return i;const t=ed(i,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}const oT={RENDER_ORDER:"renderOrder"};class MG extends iA{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter!==void 0?e.declutter:!1,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(oT.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e){e.declutterTree||(e.declutterTree=new YU(9)),this.getRenderer().renderDeclutter(e)}setRenderOrder(e){this.set(oT.RENDER_ORDER,e)}setStyle(e){this.style_=FG(e),this.styleFunction_=e===null?void 0:DU(this.style_),this.changed()}}function FG(i){if(i===void 0)return kU;if(!i)return null;if(typeof i=="function"||i instanceof fu)return i;if(!Array.isArray(i))return XS([i]);if(i.length===0)return[];const e=i.length,t=i[0];if(t instanceof fu){const r=new Array(e);for(let s=0;s<e;++s){const o=i[s];if(!(o instanceof fu))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=i[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return CG(r)}return XS(i)}const ze={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},hA=[ze.FILL],Oo=[ze.STROKE],Xa=[ze.BEGIN_PATH],aT=[ze.CLOSE_PATH];class lT{drawCustom(e,t,n,r){}drawGeometry(e){}setStyle(e){}drawCircle(e,t){}drawFeature(e,t){}drawGeometryCollection(e,t){}drawLineString(e,t){}drawMultiLineString(e,t){}drawMultiPoint(e,t){}drawMultiPolygon(e,t){}drawPoint(e,t){}drawPolygon(e,t){}drawText(e,t){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}class td extends lT{constructor(e,t,n,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(n){return n*t})}appendFlatPointCoordinates(e,t){const n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=t)r[0]=e[a],r[1]=e[a+1],tu(n,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,n,r,s,o){const a=this.coordinates;let l=a.length;const u=this.getBufferedMaxExtent();o&&(t+=r);let c=e[t],h=e[t+1];const d=this.tmpCoordinate_;let g=!0,A,p,y;for(A=t+r;A<n;A+=r)d[0]=e[A],d[1]=e[A+1],y=Vy(u,d),y!==p?(g&&(a[l++]=c,a[l++]=h,g=!1),a[l++]=d[0],a[l++]=d[1]):y===Ci.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],g=!1):g=!0,c=d[0],h=d[1],p=y;return(s&&g||A===t+r)&&(a[l++]=c,a[l++]=h),l}drawCustomCoordinates_(e,t,n,r,s){for(let o=0,a=n.length;o<a;++o){const l=n[o],u=this.appendFlatLineCoordinates(e,t,l,r,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,n,r){this.beginGeometry(e,t);const s=e.getType(),o=e.getStride(),a=this.coordinates.length;let l,u,c,h,d;switch(s){case"MultiPolygon":l=e.getOrientedFlatCoordinates(),h=[];const g=e.getEndss();d=0;for(let A=0,p=g.length;A<p;++A){const y=[];d=this.drawCustomCoordinates_(l,d,g[A],o,y),h.push(y)}this.instructions.push([ze.CUSTOM,a,h,e,n,uv]),this.hitDetectionInstructions.push([ze.CUSTOM,a,h,e,r||n,uv]);break;case"Polygon":case"MultiLineString":c=[],l=s=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,e.getEnds(),o,c),this.instructions.push([ze.CUSTOM,a,c,e,n,Oh]),this.hitDetectionInstructions.push([ze.CUSTOM,a,c,e,r||n,Oh]);break;case"LineString":case"Circle":l=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([ze.CUSTOM,a,u,e,n,ko]),this.hitDetectionInstructions.push([ze.CUSTOM,a,u,e,r||n,ko]);break;case"MultiPoint":l=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(l,o),u>a&&(this.instructions.push([ze.CUSTOM,a,u,e,n,ko]),this.hitDetectionInstructions.push([ze.CUSTOM,a,u,e,r||n,ko]));break;case"Point":l=e.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),u=this.coordinates.length,this.instructions.push([ze.CUSTOM,a,u,e,n]),this.hitDetectionInstructions.push([ze.CUSTOM,a,u,e,r||n]);break}this.endGeometry(t)}beginGeometry(e,t){this.beginGeometryInstruction1_=[ze.BEGIN_GEOMETRY,t,0,e],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ze.BEGIN_GEOMETRY,t,0,e],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const n=e.length;let r,s,o=-1;for(t=0;t<n;++t)r=e[t],s=r[0],s==ze.END_GEOMETRY?o=t:s==ze.BEGIN_GEOMETRY&&(r[2]=t,h5(this.hitDetectionInstructions,o,t),o=-1)}setFillStrokeStyle(e,t){const n=this.state;if(e){const r=e.getColor();n.fillStyle=Jr(r||xn)}else n.fillStyle=void 0;if(t){const r=t.getColor();n.strokeStyle=Jr(r||Hh);const s=t.getLineCap();n.lineCap=s!==void 0?s:cu;const o=t.getLineDash();n.lineDash=o?o.slice():Ps;const a=t.getLineDashOffset();n.lineDashOffset=a||Ms;const l=t.getLineJoin();n.lineJoin=l!==void 0?l:hu;const u=t.getWidth();n.lineWidth=u!==void 0?u:Vh;const c=t.getMiterLimit();n.miterLimit=c!==void 0?c:Gh,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(e){const t=e.fillStyle,n=[ze.SET_FILL_STYLE,t];return typeof t!="string"&&n.push(!0),n}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[ze.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const n=e.fillStyle;(typeof n!="string"||e.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(t.call(this,e)),e.currentFillStyle=n)}updateStrokeStyle(e,t){const n=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=n||e.currentLineCap!=r||s!=e.currentLineDash&&!Qa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(n!==void 0&&t.call(this,e),e.currentStrokeStyle=n,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[ze.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Gb(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Ua(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class OG extends td{constructor(e,t,n,r){super(e,t,n,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t){if(!this.image_)return;this.beginGeometry(e,t);const n=e.getFlatCoordinates(),r=e.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([ze.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ze.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t){if(!this.image_)return;this.beginGeometry(e,t);const n=e.getFlatCoordinates(),r=e.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([ze.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ze.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const n=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class NG extends td{constructor(e,t,n,r){super(e,t,n,r)}drawFlatCoordinates_(e,t,n,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,n,r,!1,!1),a=[ze.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}drawLineString(e,t){const n=this.state,r=n.strokeStyle,s=n.lineWidth;if(r===void 0||s===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(e,t),this.hitDetectionInstructions.push([ze.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ps,Ms],Xa);const o=e.getFlatCoordinates(),a=e.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(Oo),this.endGeometry(t)}drawMultiLineString(e,t){const n=this.state,r=n.strokeStyle,s=n.lineWidth;if(r===void 0||s===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(e,t),this.hitDetectionInstructions.push([ze.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ps,Ms],Xa);const o=e.getEnds(),a=e.getFlatCoordinates(),l=e.getStride();let u=0;for(let c=0,h=o.length;c<h;++c)u=this.drawFlatCoordinates_(a,u,o[c],l);this.hitDetectionInstructions.push(Oo),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Oo),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Oo),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Xa)}}class uT extends td{constructor(e,t,n,r){super(e,t,n,r)}drawFlatCoordinatess_(e,t,n,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=n.length;this.instructions.push(Xa),this.hitDetectionInstructions.push(Xa);for(let u=0;u<l;++u){const c=n[u],h=this.coordinates.length,d=this.appendFlatLineCoordinates(e,t,c,r,!0,!a),g=[ze.MOVE_TO_LINE_TO,h,d];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(aT),this.hitDetectionInstructions.push(aT)),t=c}return o&&(this.instructions.push(hA),this.hitDetectionInstructions.push(hA)),a&&(this.instructions.push(Oo),this.hitDetectionInstructions.push(Oo)),t}drawCircle(e,t){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([ze.SET_FILL_STYLE,xn]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ze.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ps,Ms]);const o=e.getFlatCoordinates(),a=e.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const u=[ze.CIRCLE,l];this.instructions.push(Xa,u),this.hitDetectionInstructions.push(Xa,u),n.fillStyle!==void 0&&(this.instructions.push(hA),this.hitDetectionInstructions.push(hA)),n.strokeStyle!==void 0&&(this.instructions.push(Oo),this.hitDetectionInstructions.push(Oo)),this.endGeometry(t)}drawPolygon(e,t){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([ze.SET_FILL_STYLE,xn]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ze.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ps,Ms]);const o=e.getEnds(),a=e.getOrientedFlatCoordinates(),l=e.getStride();this.drawFlatCoordinatess_(a,0,o,l),this.endGeometry(t)}drawMultiPolygon(e,t){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(r===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([ze.SET_FILL_STYLE,xn]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ze.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ps,Ms]);const o=e.getEndss(),a=e.getOrientedFlatCoordinates(),l=e.getStride();let u=0;for(let c=0,h=o.length;c<h;++c)u=this.drawFlatCoordinatess_(a,u,o[c],l);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let n=0,r=t.length;n<r;++n)t[n]=qa(t[n],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;e.fillStyle!==void 0&&this.updateFillStyle(e,this.createFill),e.strokeStyle!==void 0&&this.updateStrokeStyle(e,this.applyStroke)}}function QG(i,e,t,n,r){const s=[];let o=t,a=0,l=e.slice(t,2);for(;a<i&&o+r<n;){const[u,c]=l.slice(-2),h=e[o+r],d=e[o+r+1],g=Math.sqrt((h-u)*(h-u)+(d-c)*(d-c));if(a+=g,a>=i){const A=(i-a+g)/g,p=Hn(u,h,A),y=Hn(c,d,A);l.push(p,y),s.push(l),l=[p,y],a==i&&(o+=r),a=0}else if(a<i)l.push(e[o+r],e[o+r+1]),o+=r;else{const A=g-a,p=Hn(u,h,A/g),y=Hn(c,d,A/g);l.push(p,y),s.push(l),l=[p,y],a=0,o+=r}}return a>0&&s.push(l),s}function UG(i,e,t,n,r){let s=t,o=t,a=0,l=0,u=t,c,h,d,g,A,p,y,v,E,I;for(h=t;h<n;h+=r){const C=e[h],w=e[h+1];A!==void 0&&(E=C-A,I=w-p,g=Math.sqrt(E*E+I*I),y!==void 0&&(l+=d,c=Math.acos((y*E+v*I)/(d*g)),c>i&&(l>a&&(a=l,s=u,o=h),l=0,u=h-r)),d=g,y=E,v=I),A=C,p=w}return l+=g,l>a?[u,h]:[s,o]}const dA={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class GG extends td{constructor(e,t,n,r){super(e,t,n,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[xn]={fillStyle:xn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t){const n=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(this.text_===""||!s||!n&&!r)return;const o=this.coordinates;let a=o.length;const l=e.getType();let u=null,c=e.getStride();if(s.placement==="line"&&(l=="LineString"||l=="MultiLineString"||l=="Polygon"||l=="MultiPolygon")){if(!vi(this.getBufferedMaxExtent(),e.getExtent()))return;let h;if(u=e.getFlatCoordinates(),l=="LineString")h=[u.length];else if(l=="MultiLineString")h=e.getEnds();else if(l=="Polygon")h=e.getEnds().slice(0,1);else if(l=="MultiPolygon"){const p=e.getEndss();h=[];for(let y=0,v=p.length;y<v;++y)h.push(p[y][0])}this.beginGeometry(e,t);const d=s.repeat,g=d?void 0:s.textAlign;let A=0;for(let p=0,y=h.length;p<y;++p){let v;d?v=QG(d*this.resolution,u,A,h[p],c):v=[u.slice(A,h[p])];for(let E=0,I=v.length;E<I;++E){const C=v[E];let w=0,S=C.length;if(g==null){const T=UG(s.maxAngle,C,0,C.length,2);w=T[0],S=T[1]}for(let T=w;T<S;T+=c)o.push(C[T],C[T+1]);const x=o.length;A=h[p],this.drawChars_(a,x),a=x}}this.endGeometry(t)}else{let h=s.overflow?null:[];switch(l){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),c=2;break;case"Polygon":u=e.getFlatInteriorPoint(),s.overflow||h.push(u[2]/this.resolution),c=3;break;case"MultiPolygon":const v=e.getFlatInteriorPoints();u=[];for(let E=0,I=v.length;E<I;E+=3)s.overflow||h.push(v[E+2]/this.resolution),u.push(v[E],v[E+1]);if(u.length===0)return;c=2;break}const d=this.appendFlatPointCoordinates(u,c);if(d===a)return;if(h&&(d-a)/2!==u.length/c){let v=a/2;h=h.filter((E,I)=>{const C=o[(v+I)*2]===u[I*c]&&o[(v+I)*2+1]===u[I*c+1];return C||--v,C})}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&this.updateFillStyle(this.state,this.createFill),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(e,t);let g=s.padding;if(g!=Ya&&(s.scale[0]<0||s.scale[1]<0)){let v=s.padding[0],E=s.padding[1],I=s.padding[2],C=s.padding[3];s.scale[0]<0&&(E=-E,C=-C),s.scale[1]<0&&(v=-v,I=-I),g=[v,E,I,C]}const A=this.pixelRatio;this.instructions.push([ze.DRAW_IMAGE,a,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,g==Ya?Ya:g.map(function(v){return v*A}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);const p=1/A,y=this.state.fillStyle;s.backgroundFill&&(this.state.fillStyle=xn,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([ze.DRAW_IMAGE,a,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,void 0,this.declutterImageWithText_,g,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?xn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),s.backgroundFill&&(this.state.fillStyle=y,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,n=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||zh,justify:t.justify,textBaseline:t.textBaseline||Xg,scale:t.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(e,t){const n=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=dA[r.textBaseline],c=this.textOffsetY_*l,h=this.text_,d=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([ze.DRAW_CHARS,e,t,u,r.overflow,a,r.maxAngle,l,c,s,d*l,h,o,1]),this.hitDetectionInstructions.push([ze.DRAW_CHARS,e,t,u,r.overflow,a&&xn,r.maxAngle,l,c,s,d*l,h,o,1/l])}setTextStyle(e,t){let n,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Jr(o.getColor()||xn)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const A=a.getLineDash(),p=a.getLineDashOffset(),y=a.getWidth(),v=a.getMiterLimit();s.lineCap=a.getLineCap()||cu,s.lineDash=A?A.slice():Ps,s.lineDashOffset=p===void 0?Ms:p,s.lineJoin=a.getLineJoin()||hu,s.lineWidth=y===void 0?Vh:y,s.miterLimit=v===void 0?Gh:v,s.strokeStyle=Jr(a.getColor()||Hh)}n=this.textState_;const l=e.getFont()||PS;SU(l);const u=e.getScaleArray();n.overflow=e.getOverflow(),n.font=l,n.maxAngle=e.getMaxAngle(),n.placement=e.getPlacement(),n.textAlign=e.getTextAlign(),n.repeat=e.getRepeat(),n.justify=e.getJustify(),n.textBaseline=e.getTextBaseline()||Xg,n.backgroundFill=e.getBackgroundFill(),n.backgroundStroke=e.getBackgroundStroke(),n.padding=e.getPadding()||Ya,n.scale=u===void 0?[1,1]:u;const c=e.getOffsetX(),h=e.getOffsetY(),d=e.getRotateWithView(),g=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=d===void 0?!1:d,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:nt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r?typeof r.fillStyle=="string"?r.fillStyle:"|"+nt(r.fillStyle):""}this.declutterImageWithText_=t}}const HG={Circle:uT,Default:td,Image:OG,LineString:NG,Polygon:uT,Text:GG};class cT{constructor(e,t,n,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const n=this.buildersByZIndex_[t];for(const r in n){const s=n[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const n=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[n];r===void 0&&(r={},this.buildersByZIndex_[n]=r);let s=r[t];if(s===void 0){const o=HG[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}class hT extends Rh{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.declutterExecutorGroup=null}getFeatures(e){return je()}getData(e){return null}prepareFrame(e){return je()}renderFrame(e,t){return je()}loadedTileCallback(e,t,n){e[t]||(e[t]={}),e[t][n.tileCoord.toString()]=n}createLoadedTileFinder(e,t,n){return(r,s)=>{const o=this.loadedTileCallback.bind(this,n,r);return e.forEachLoadedTile(t,r,s,o)}}forEachFeatureAtCoordinate(e,t,n,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===Nt.LOADED||t.getState()===Nt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=Nt.LOADED&&t!=Nt.ERROR&&e.addEventListener($e.CHANGE,this.boundHandleImageChange_),t==Nt.IDLE&&(e.load(),t=e.getState()),t==Nt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}class id extends hi{constructor(e,t,n,r){super(e),this.inversePixelTransform=t,this.frameState=n,this.context=r}}let Eu=null;function zG(){Eu=xi(1,1,void 0,{willReadFrequently:!0})}class VG extends hT{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Yi(),this.pixelTransform=Yi(),this.inversePixelTransform=Yi(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(e,t,n){Eu||zG(),Eu.clearRect(0,0,1,1);let r;try{Eu.drawImage(e,t,n,1,1,0,0,1,1),r=Eu.getImageData(0,0,1,1).data}catch{return Eu=null,null}return r}getBackground(e){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(e.viewState.resolution)),n||void 0}useContainer(e,t,n){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!n||e&&e.style.backgroundColor&&Qa(Qh(e.style.backgroundColor),Qh(n)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=xi();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(e,t,n){const r=Ro(n),s=Og(n),o=Fg(n),a=Mg(n);yi(t.coordinateToPixelTransform,r),yi(t.coordinateToPixelTransform,s),yi(t.coordinateToPixelTransform,o),yi(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;yi(l,r),yi(l,s),yi(l,o),yi(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}dispatchRenderEvent_(e,t,n){const r=this.getLayer();if(r.hasListener(e)){const s=new id(e,this.inversePixelTransform,n,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,this.dispatchRenderEvent_(wn.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(wn.POSTRENDER,e,t)}getRenderTransform(e,t,n,r,s,o,a){const l=s/2,u=o/2,c=r/t,h=-c,d=-e[0]+a,g=-e[1];return _r(this.tempTransform,l,u,c,h,-n,d,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function qG(i,e,t,n,r,s,o,a,l,u,c,h){let d=i[e],g=i[e+1],A=0,p=0,y=0,v=0;function E(){A=d,p=g,e+=n,d=i[e],g=i[e+1],v+=y,y=Math.sqrt((d-A)*(d-A)+(g-p)*(g-p))}do E();while(e<t-n&&v+y<s);let I=y===0?0:(s-v)/y;const C=Hn(A,d,I),w=Hn(p,g,I),S=e-n,x=v,T=s+a*l(u,r,c);for(;e<t-n&&v+y<T;)E();I=y===0?0:(T-v)/y;const Q=Hn(A,d,I),M=Hn(p,g,I);let R;if(h){const G=[C,w,Q,M];oS(G,0,4,2,h,G,G),R=G[0]>G[2]}else R=C>Q;const z=Math.PI,q=[],X=S+n===e;e=S,y=0,v=x,d=i[e],g=i[e+1];let N;if(X){E(),N=Math.atan2(g-p,d-A),R&&(N+=N>0?-z:z);const G=(Q+C)/2,j=(M+w)/2;return q[0]=[G,j,(T-s)/2,N,r],q}r=r.replace(/\n/g," ");for(let G=0,j=r.length;G<j;){E();let V=Math.atan2(g-p,d-A);if(R&&(V+=V>0?-z:z),N!==void 0){let ie=V-N;if(ie+=ie>z?-2*z:ie<-z?2*z:0,Math.abs(ie)>o)return null}N=V;const Z=G;let Y=0;for(;G<j;++G){const ie=R?j-G-1:G,ne=a*l(u,r[ie],c);if(e+n<t&&v+y<s+Y+ne/2)break;Y+=ne}if(G===Z)continue;const te=R?r.substring(j-Z,j-G):r.substring(Z,G);I=y===0?0:(s+Y/2-v)/y;const J=Hn(A,d,I),ce=Hn(p,g,I);q.push([J,ce,Y/2,V,te]),s+=Y}return q}const Iu=Zr(),No=[],Ns=[],Qs=[],Qo=[];function dT(i){return i[3].declutterBox}const fT=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Lv(i,e){return e==="start"?e=fT.test(i)?"right":"left":e==="end"&&(e=fT.test(i)?"left":"right"),dA[e]}function $G(i,e,t){return t>0&&i.push(`
`,""),i.push(e,""),i}class jG{constructor(e,t,n,r){this.overlaps=n,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Yi(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}createLabel(e,t,n,r){const s=e+t+n+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=n?this.fillStates[n]:null,l=this.textStates[t],u=this.pixelRatio,c=[l.scale[0]*u,l.scale[1]*u],h=Array.isArray(e),d=l.justify?dA[l.justify]:Lv(Array.isArray(e)?e[0]:e,l.textAlign||zh),g=r&&o.lineWidth?o.lineWidth:0,A=h?e:e.split(`
`).reduce($G,[]),{width:p,height:y,widths:v,heights:E,lineWidths:I}=BU(l,A),C=p+g,w=[],S=(C+2)*c[0],x=(y+g)*c[1],T={width:S<0?Math.floor(S):Math.ceil(S),height:x<0?Math.floor(x):Math.ceil(x),contextInstructions:w};(c[0]!=1||c[1]!=1)&&w.push("scale",c),r&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",g),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset)),n&&w.push("fillStyle",a.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const Q=.5-d;let M=d*C+Q*g;const R=[],z=[];let q=0,X=0,N=0,G=0,j;for(let V=0,Z=A.length;V<Z;V+=2){const Y=A[V];if(Y===`
`){X+=q,q=0,M=d*C+Q*g,++G;continue}const te=A[V+1]||l.font;te!==j&&(r&&R.push("font",te),n&&z.push("font",te),j=te),q=Math.max(q,E[N]);const J=[Y,M+Q*v[N]+d*(v[N]-I[G]),.5*(g+q)+X];M+=v[N],r&&R.push("strokeText",J),n&&z.push("fillText",J),++N}return Array.prototype.push.apply(w,R),Array.prototype.push.apply(w,z),this.labels_[s]=T,T}replayTextBackground_(e,t,n,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignFill_=o[2],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,n,r,s,o,a,l,u,c,h,d,g,A,p,y){a*=d[0],l*=d[1];let v=n-a,E=r-l;const I=s+u>e?e-u:s,C=o+c>t?t-c:o,w=A[3]+I*d[0]+A[1],S=A[0]+C*d[1]+A[2],x=v-A[3],T=E-A[0];(p||h!==0)&&(No[0]=x,Qo[0]=x,No[1]=T,Ns[1]=T,Ns[0]=x+w,Qs[0]=Ns[0],Qs[1]=T+S,Qo[1]=Qs[1]);let Q;return h!==0?(Q=_r(Yi(),n,r,1,1,h,-n,-r),yi(Q,No),yi(Q,Ns),yi(Q,Qs),yi(Q,Qo),To(Math.min(No[0],Ns[0],Qs[0],Qo[0]),Math.min(No[1],Ns[1],Qs[1],Qo[1]),Math.max(No[0],Ns[0],Qs[0],Qo[0]),Math.max(No[1],Ns[1],Qs[1],Qo[1]),Iu)):To(Math.min(x,x+w),Math.min(T,T+S),Math.max(x,x+w),Math.max(T,T+S),Iu),g&&(v=Math.round(v),E=Math.round(E)),{drawImageX:v,drawImageY:E,drawImageW:I,drawImageH:C,originX:u,originY:c,declutterBox:{minX:Iu[0],minY:Iu[1],maxX:Iu[2],maxY:Iu[3],value:y},canvasTransform:Q,scale:d}}replayImageOrLabel_(e,t,n,r,s,o,a){const l=!!(o||a),u=r.declutterBox,c=e.canvas,h=a?a[2]*r.scale[0]/2:0;return u.minX-h<=c.width/t&&u.maxX+h>=0&&u.minY-h<=c.height/t&&u.maxY+h>=0&&(l&&this.replayTextBackground_(e,No,Ns,Qs,Qo,o,a),RU(e,r.canvasTransform,s,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){if(this.alignFill_){const t=yi(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;e.save(),e.translate(t[0]%n,t[1]%n),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,n,r){const s=this.textStates[t],o=this.createLabel(e,t,r,n),a=this.strokeStates[n],l=this.pixelRatio,u=Lv(Array.isArray(e)?e[0]:e,s.textAlign||zh),c=dA[s.textBaseline||Xg],h=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],g=u*d+2*(.5-u)*h,A=c*o.height/l+2*(.5-c)*h;return{label:o,anchorX:g,anchorY:A}}execute_(e,t,n,r,s,o,a,l){let u;this.pixelCoordinates_&&Qa(n,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=Do(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),I5(this.renderedTransform_,n));let c=0;const h=r.length;let d=0,g,A,p,y,v,E,I,C,w,S,x,T,Q=0,M=0,R=null,z=null;const q=this.coordinateCache_,X=this.viewRotation_,N=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,G={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:X},j=this.instructions!=r||this.overlaps?0:200;let V,Z,Y,te;for(;c<h;){const J=r[c];switch(J[0]){case ze.BEGIN_GEOMETRY:V=J[1],te=J[3],V.getGeometry()?a!==void 0&&!vi(a,te.getExtent())?c=J[2]+1:++c:c=J[2];break;case ze.BEGIN_PATH:Q>j&&(this.fill_(e),Q=0),M>j&&(e.stroke(),M=0),!Q&&!M&&(e.beginPath(),y=NaN,v=NaN),++c;break;case ze.CIRCLE:d=J[1];const ie=u[d],ne=u[d+1],ue=u[d+2],fe=u[d+3],me=ue-ie,Pe=fe-ne,Re=Math.sqrt(me*me+Pe*Pe);e.moveTo(ie+Re,ne),e.arc(ie,ne,Re,0,2*Math.PI,!0),++c;break;case ze.CLOSE_PATH:e.closePath(),++c;break;case ze.CUSTOM:d=J[1],g=J[2];const Qe=J[3],Oe=J[4],wt=J.length==6?J[5]:void 0;G.geometry=Qe,G.feature=V,c in q||(q[c]=[]);const ft=q[c];wt?wt(u,d,g,2,ft):(ft[0]=u[d],ft[1]=u[d+1],ft.length=2),Oe(ft,G),++c;break;case ze.DRAW_IMAGE:d=J[1],g=J[2],C=J[3],A=J[4],p=J[5];let pt=J[6];const at=J[7],D=J[8],W=J[9],oe=J[10];let ve=J[11];const Ae=J[12];let Se=J[13];const xe=J[14],Xe=J[15];if(!C&&J.length>=20){w=J[19],S=J[20],x=J[21],T=J[22];const In=this.drawLabelWithPointPlacement_(w,S,x,T);C=In.label,J[3]=C;const Fa=J[23];A=(In.anchorX-Fa)*this.pixelRatio,J[4]=A;const Qn=J[24];p=(In.anchorY-Qn)*this.pixelRatio,J[5]=p,pt=C.height,J[6]=pt,Se=C.width,J[13]=Se}let ot;J.length>25&&(ot=J[25]);let gt,He,Ct;J.length>17?(gt=J[16],He=J[17],Ct=J[18]):(gt=Ya,He=!1,Ct=!1),oe&&N?ve+=X:!oe&&!N&&(ve-=X);let O=0;for(;d<g;d+=2){if(ot&&ot[O++]<Se/this.pixelRatio)continue;const In=this.calculateImageOrLabelDimensions_(C.width,C.height,u[d],u[d+1],Se,pt,A,p,D,W,ve,Ae,s,gt,He||Ct,V),Fa=[e,t,C,In,at,He?R:null,Ct?z:null];if(l){if(xe==="none")continue;if(xe==="obstacle"){l.insert(In.declutterBox);continue}else{let Qn,$r;if(Xe){const Wi=g-d;if(!Xe[Wi]){Xe[Wi]=Fa;continue}if(Qn=Xe[Wi],delete Xe[Wi],$r=dT(Qn),l.collides($r))continue}if(l.collides(In.declutterBox))continue;Qn&&(l.insert($r),this.replayImageOrLabel_.apply(this,Qn)),l.insert(In.declutterBox)}}this.replayImageOrLabel_.apply(this,Fa)}++c;break;case ze.DRAW_CHARS:const F=J[1],$=J[2],K=J[3],ge=J[4];T=J[5];const Ie=J[6],Ue=J[7],yt=J[8];x=J[9];const Ne=J[10];w=J[11],S=J[12];const Fi=[J[13],J[13]],Zt=this.textStates[S],En=Zt.font,Vr=[Zt.scale[0]*Ue,Zt.scale[1]*Ue];let qr;En in this.widths_?qr=this.widths_[En]:(qr={},this.widths_[En]=qr);const Wl=IS(u,F,$,2),vy=Math.abs(Vr[0])*FS(En,w,qr);if(ge||vy<=Wl){const In=this.textStates[S].textAlign,Fa=(Wl-vy)*Lv(w,In),Qn=qG(u,F,$,2,w,Fa,Ie,Math.abs(Vr[0]),FS,En,qr,N?0:this.viewRotation_);e:if(Qn){const $r=[];let Wi,yh,vh,un,Un;if(x)for(Wi=0,yh=Qn.length;Wi<yh;++Wi){Un=Qn[Wi],vh=Un[4],un=this.createLabel(vh,S,"",x),A=Un[2]+(Vr[0]<0?-Ne:Ne),p=K*un.height+(.5-K)*2*Ne*Vr[1]/Vr[0]-yt;const Ai=this.calculateImageOrLabelDimensions_(un.width,un.height,Un[0],Un[1],un.width,un.height,A,p,0,0,Un[3],Fi,!1,Ya,!1,V);if(l&&l.collides(Ai.declutterBox))break e;$r.push([e,t,un,Ai,1,null,null])}if(T)for(Wi=0,yh=Qn.length;Wi<yh;++Wi){Un=Qn[Wi],vh=Un[4],un=this.createLabel(vh,S,T,""),A=Un[2],p=K*un.height-yt;const Ai=this.calculateImageOrLabelDimensions_(un.width,un.height,Un[0],Un[1],un.width,un.height,A,p,0,0,Un[3],Fi,!1,Ya,!1,V);if(l&&l.collides(Ai.declutterBox))break e;$r.push([e,t,un,Ai,1,null,null])}l&&l.load($r.map(dT));for(let Ai=0,Ge=$r.length;Ai<Ge;++Ai)this.replayImageOrLabel_.apply(this,$r[Ai])}}++c;break;case ze.END_GEOMETRY:if(o!==void 0){V=J[1];const In=o(V,te);if(In)return In}++c;break;case ze.FILL:j?Q++:this.fill_(e),++c;break;case ze.MOVE_TO_LINE_TO:for(d=J[1],g=J[2],Z=u[d],Y=u[d+1],E=Z+.5|0,I=Y+.5|0,(E!==y||I!==v)&&(e.moveTo(Z,Y),y=E,v=I),d+=2;d<g;d+=2)Z=u[d],Y=u[d+1],E=Z+.5|0,I=Y+.5|0,(d==g-2||E!==y||I!==v)&&(e.lineTo(Z,Y),y=E,v=I);++c;break;case ze.SET_FILL_STYLE:R=J,this.alignFill_=J[2],Q&&(this.fill_(e),Q=0,M&&(e.stroke(),M=0)),e.fillStyle=J[1],++c;break;case ze.SET_STROKE_STYLE:z=J,M&&(e.stroke(),M=0),this.setStrokeStyle_(e,J),++c;break;case ze.STROKE:j?M++:e.stroke(),++c;break;default:++c;break}}Q&&this.fill_(e),M&&e.stroke()}execute(e,t,n,r,s,o){this.viewRotation_=r,this.execute_(e,t,n,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,n,r,s){return this.viewRotation_=n,this.execute_(e,1,t,this.hitDetectionInstructions,!0,r,s)}}const Dv=["Polygon","Circle","LineString","Image","Text","Default"];class gT{constructor(e,t,n,r,s,o){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Yi(),this.createExecutors_(s)}clip(e,t){const n=this.getClipCoords(t);e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(n[2],n[3]),e.lineTo(n[4],n[5]),e.lineTo(n[6],n[7]),e.clip()}createExecutors_(e){for(const t in e){let n=this.executorsByZIndex_[t];n===void 0&&(n={},this.executorsByZIndex_[t]=n);const r=e[t];for(const s in r){const o=r[s];n[s]=new jG(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const n=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in n)return!0}return!1}forEachFeatureAtCoordinate(e,t,n,r,s,o){r=Math.round(r);const a=r*2+1,l=_r(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-n,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=xi(a,a,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):u||c.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=Zr(),Dh(h,e),Ua(h,t*(this.renderBuffer_+r),h));const d=WG(r);let g;function A(w,S){const x=c.getImageData(0,0,a,a).data;for(let T=0,Q=d.length;T<Q;T++)if(x[d[T]]>0){if(!o||g!=="Image"&&g!=="Text"||o.includes(w)){const M=(d[T]-3)/4,R=r-M%a,z=r-(M/a|0),q=s(w,S,R*R+z*z);if(q)return q}c.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(bo);let y,v,E,I,C;for(y=p.length-1;y>=0;--y){const w=p[y].toString();for(E=this.executorsByZIndex_[w],v=Dv.length-1;v>=0;--v)if(g=Dv[v],I=E[g],I!==void 0&&(C=I.executeHitDetection(c,l,n,A,h),C))return C}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const n=t[0],r=t[1],s=t[2],o=t[3],a=[n,r,n,o,s,o,s,r];return Do(a,0,8,2,e,a),a}isEmpty(){return Tg(this.executorsByZIndex_)}execute(e,t,n,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(bo),this.maxExtent_&&(e.save(),this.clip(e,n)),o=o||Dv;let u,c,h,d,g,A;for(a&&l.reverse(),u=0,c=l.length;u<c;++u){const p=l[u].toString();for(g=this.executorsByZIndex_[p],h=0,d=o.length;h<d;++h){const y=o[h];A=g[y],A!==void 0&&A.execute(e,t,n,r,s,a)}}this.maxExtent_&&e.restore()}}const kv={};function WG(i){if(kv[i]!==void 0)return kv[i];const e=i*2+1,t=i*i,n=new Array(t+1);for(let s=0;s<=i;++s)for(let o=0;o<=i;++o){const a=s*s+o*o;if(a>t)break;let l=n[a];l||(l=[],n[a]=l),l.push(((i+s)*e+(i+o))*4+3),s>0&&l.push(((i-s)*e+(i+o))*4+3),o>0&&(l.push(((i+s)*e+(i-o))*4+3),s>0&&l.push(((i-s)*e+(i-o))*4+3))}const r=[];for(let s=0,o=n.length;s<o;++s)n[s]&&r.push(...n[s]);return kv[i]=r,r}class KG extends lT{constructor(e,t,n,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=n,this.transform_=r,this.transformRotation_=r?Yy(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Yi()}drawImages_(e,t,n,r){if(!this.image_)return;const s=Do(e,t,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let c=0,h=s.length;c<h;c+=2){const d=s[c]-this.imageAnchorX_,g=s[c+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const A=d+this.imageAnchorX_,p=g+this.imageAnchorY_;_r(a,A,p,1,1,u,-A,-p),o.save(),o.transform.apply(o,a),o.translate(A,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,n,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Do(e,t,n,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<n;t+=r){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,u-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u))}}moveToLineTo_(e,t,n,r,s){const o=this.context_,a=Do(e,t,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let u=2;u<l;u+=2)o.lineTo(a[u],a[u+1]);return s&&o.closePath(),n}drawRings_(e,t,n,r){for(let s=0,o=n.length;s<o;++s)t=this.moveToLineTo_(e,t,n[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vi(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=rU(e,this.transform_,this.pixelCoordinates_),n=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const n=t.getGeometryFunction()(e);n&&(this.setStyle(t),this.drawGeometry(n))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let n=0,r=t.length;n<r;++n)this.drawGeometry(t[n])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),n=e.getStride();this.image_&&this.drawImages_(t,0,t.length,n),this.text_!==""&&this.drawText_(t,0,t.length,n)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),n=e.getStride();this.image_&&this.drawImages_(t,0,t.length,n),this.text_!==""&&this.drawText_(t,0,t.length,n)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vi(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,n=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(n,0,n.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(vi(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();n.beginPath();for(let l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,n=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=s.length;a<l;++a){const u=s[a];r=this.drawRings_(n,r,u,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,n=this.contextFillState_;n?n.fillStyle!=e.fillStyle&&(n.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=e.lineCap&&(n.lineCap=e.lineCap,t.lineCap=e.lineCap),Qa(n.lineDash,e.lineDash)||t.setLineDash(n.lineDash=e.lineDash),n.lineDashOffset!=e.lineDashOffset&&(n.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),n.lineJoin!=e.lineJoin&&(n.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),n.lineWidth!=e.lineWidth&&(n.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),n.miterLimit!=e.miterLimit&&(n.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),n.strokeStyle!=e.strokeStyle&&(n.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,n=this.contextTextState_,r=e.textAlign?e.textAlign:zh;n?(n.font!=e.font&&(n.font=e.font,t.font=e.font),n.textAlign!=r&&(n.textAlign=r,t.textAlign=r),n.textBaseline!=e.textBaseline&&(n.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const n=e.getColor();this.fillState_={fillStyle:Jr(n||xn)}}if(!t)this.strokeState_=null;else{const n=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),c=s||Ps;this.strokeState_={lineCap:r!==void 0?r:cu,lineDash:this.pixelRatio_===1?c:c.map(h=>h*this.pixelRatio_),lineDashOffset:(o||Ms)*this.pixelRatio_,lineJoin:a!==void 0?a:hu,lineWidth:(l!==void 0?l:Vh)*this.pixelRatio_,miterLimit:u!==void 0?u:Gh,strokeStyle:Jr(n||Hh)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const n=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=t[1]*n,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=t[0]*n}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const g=t.getColor();this.textFillState_={fillStyle:Jr(g||xn)}}const n=e.getStroke();if(!n)this.textStrokeState_=null;else{const g=n.getColor(),A=n.getLineCap(),p=n.getLineDash(),y=n.getLineDashOffset(),v=n.getLineJoin(),E=n.getWidth(),I=n.getMiterLimit();this.textStrokeState_={lineCap:A!==void 0?A:cu,lineDash:p||Ps,lineDashOffset:y||Ms,lineJoin:v!==void 0?v:hu,lineWidth:E!==void 0?E:Vh,miterLimit:I!==void 0?I:Gh,strokeStyle:Jr(g||Hh)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),c=e.getText(),h=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:r!==void 0?r:PS,textAlign:h!==void 0?h:zh,textBaseline:d!==void 0?d:Xg},this.text_=c!==void 0?Array.isArray(c)?c.reduce((g,A,p)=>g+=p%2?" ":A,""):c:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const Uo=.5;function YG(i,e,t,n,r,s,o){const a=i[0]*Uo,l=i[1]*Uo,u=xi(a,l);u.imageSmoothingEnabled=!1;const c=u.canvas,h=new KG(u,Uo,r,null,o),d=t.length,g=Math.floor((256*256*256-1)/d),A={};for(let y=1;y<=d;++y){const v=t[y-1],E=v.getStyleFunction()||n;if(!E)continue;let I=E(v,s);if(!I)continue;Array.isArray(I)||(I=[I]);const w=(y*g).toString(16).padStart(7,"#00000");for(let S=0,x=I.length;S<x;++S){const T=I[S],Q=T.getGeometryFunction()(v);if(!Q||!vi(r,Q.getExtent()))continue;const M=T.clone(),R=M.getFill();R&&R.setColor(w);const z=M.getStroke();z&&(z.setColor(w),z.setLineDash(null)),M.setText(void 0);const q=T.getImage();if(q){const j=q.getImageSize();if(!j)continue;const V=xi(j[0],j[1],void 0,{alpha:!1}),Z=V.canvas;V.fillStyle=w,V.fillRect(0,0,Z.width,Z.height),M.setImage(new oA({img:Z,anchor:q.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:q.getOrigin(),opacity:1,size:q.getSize(),scale:q.getScale(),rotation:q.getRotation(),rotateWithView:q.getRotateWithView()}))}const X=M.getZIndex()||0;let N=A[X];N||(N={},A[X]=N,N.Polygon=[],N.Circle=[],N.LineString=[],N.Point=[]);const G=Q.getType();if(G==="GeometryCollection"){const j=Q.getGeometriesArrayRecursive();for(let V=0,Z=j.length;V<Z;++V){const Y=j[V];N[Y.getType().replace("Multi","")].push(Y,M)}}else N[G.replace("Multi","")].push(Q,M)}}const p=Object.keys(A).map(Number).sort(bo);for(let y=0,v=p.length;y<v;++y){const E=A[p[y]];for(const I in E){const C=E[I];for(let w=0,S=C.length;w<S;w+=2){h.setStyle(C[w+1]);for(let x=0,T=e.length;x<T;++x)h.setTransform(e[x]),h.drawGeometry(C[w])}}}return u.getImageData(0,0,c.width,c.height)}function ZG(i,e,t){const n=[];if(t){const r=Math.floor(Math.round(i[0])*Uo),s=Math.floor(Math.round(i[1])*Uo),o=(Xt(r,0,t.width-1)+Xt(s,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],c=t.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/e.length);c&&c%h===0&&n.push(e[c/h-1])}return n}const XG=.5,AT={Point:a9,LineString:r9,Polygon:u9,MultiPoint:l9,MultiLineString:s9,MultiPolygon:o9,GeometryCollection:n9,Circle:t9};function JG(i,e){const t=e9(i,e);return t*t}function e9(i,e){return XG*i/e}function t9(i,e,t,n,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=i.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,n)}const a=t.getText();if(a&&a.getText()){const l=(r||i).getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,n)}}function pT(i,e,t,n,r,s,o){let a=!1;const l=t.getImage();if(l){const u=l.getImageState();u==Nt.LOADED||u==Nt.ERROR?l.unlistenImageChange(r):(u==Nt.IDLE&&l.load(),l.listenImageChange(r),a=!0)}return i9(i,e,t,n,s,o),a}function i9(i,e,t,n,r,s){const o=t.getGeometryFunction()(e);if(!o)return;const a=o.simplifyTransformed(n,r);if(t.getRenderer())mT(i,a,t,e);else{const u=AT[a.getType()];u(i,a,t,e,s)}}function mT(i,e,t,n){if(e.getType()=="GeometryCollection"){const s=e.getGeometries();for(let o=0,a=s.length;o<a;++o)mT(i,s[o],t,n);return}i.getBuilder(t.getZIndex(),"Default").drawCustom(e,n,t.getRenderer(),t.getHitDetectionRenderer())}function n9(i,e,t,n,r){const s=e.getGeometriesArray();let o,a;for(o=0,a=s.length;o<a;++o){const l=AT[s[o].getType()];l(i,s[o],t,n,r)}}function r9(i,e,t,n,r){const s=t.getStroke();if(s){const a=i.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,n)}const o=t.getText();if(o&&o.getText()){const a=(r||i).getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,n)}}function s9(i,e,t,n,r){const s=t.getStroke();if(s){const a=i.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,n)}const o=t.getText();if(o&&o.getText()){const a=(r||i).getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,n)}}function o9(i,e,t,n,r){const s=t.getFill(),o=t.getStroke();if(o||s){const l=i.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,n)}const a=t.getText();if(a&&a.getText()){const l=(r||i).getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,n)}}function a9(i,e,t,n,r){const s=t.getImage(),o=t.getText();let a;if(s){if(s.getImageState()!=Nt.LOADED)return;let l=i;if(r){const c=s.getDeclutterMode();if(c!=="none")if(l=r,c==="obstacle"){const h=i.getBuilder(t.getZIndex(),"Image");h.setImageStyle(s,a),h.drawPoint(e,n)}else o&&o.getText()&&(a={})}const u=l.getBuilder(t.getZIndex(),"Image");u.setImageStyle(s,a),u.drawPoint(e,n)}if(o&&o.getText()){let l=i;r&&(l=r);const u=l.getBuilder(t.getZIndex(),"Text");u.setTextStyle(o,a),u.drawText(e,n)}}function l9(i,e,t,n,r){const s=t.getImage(),o=t.getText();let a;if(s){if(s.getImageState()!=Nt.LOADED)return;let l=i;if(r){const c=s.getDeclutterMode();if(c!=="none")if(l=r,c==="obstacle"){const h=i.getBuilder(t.getZIndex(),"Image");h.setImageStyle(s,a),h.drawMultiPoint(e,n)}else o&&o.getText()&&(a={})}const u=l.getBuilder(t.getZIndex(),"Image");u.setImageStyle(s,a),u.drawMultiPoint(e,n)}if(o&&o.getText()){let l=i;r&&(l=r);const u=l.getBuilder(t.getZIndex(),"Text");u.setTextStyle(o,a),u.drawText(e,n)}}function u9(i,e,t,n,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=i.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,n)}const a=t.getText();if(a&&a.getText()){const l=(r||i).getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,n)}}class c9 extends Yr{constructor(e){super(),this.projection=Vt(e.projection),this.attributions_=yT(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible!==void 0?e.attributionsCollapsible:!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(n,r){t.viewResolver=n,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=yT(e),this.changed()}setState(e){this.state_=e,this.changed()}}function yT(i){return i?Array.isArray(i)?function(e){return i}:typeof i=="function"?i:function(e){return[i]}:null}let h9=!1;function d9(i,e,t,n,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof i=="function"?i(t,n,r):i,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=h9,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const u=e.getType();let c;u=="json"||u=="text"?c=a.responseText:u=="xml"?(c=a.responseXML,c||(c=new DOMParser().parseFromString(a.responseText,"application/xml"))):u=="arraybuffer"&&(c=a.response),c?s(e.readFeatures(c,{extent:t,featureProjection:r}),e.readProjection(c)):o()}else o()},a.onerror=o,a.send()}const pe={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class nd extends Bh{constructor(e,t,n){super(),n=n||{},this.tileCoord=e,this.state=t,this.interimTile=null,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent($e.CHANGE)}release(){this.state===pe.ERROR&&this.setState(pe.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let e=this.interimTile;do{if(e.getState()==pe.LOADED)return this.transition_=0,e;e=e.interimTile}while(e);return this}refreshInterimChain(){if(!this.interimTile)return;let e=this.interimTile,t=this;do{if(e.getState()==pe.LOADED){e.interimTile=null;break}else e.getState()==pe.LOADING?t=e:e.getState()==pe.IDLE?t.interimTile=e.interimTile:t=e;e=t.interimTile}while(e)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==pe.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){je()}getAlpha(e,t){if(!this.transition_)return 1;let n=this.transitionStarts_[e];if(!n)n=t,this.transitionStarts_[e]=n;else if(n===-1)return 1;const r=t-n+1e3/60;return r>=this.transition_?1:zS(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}}class fA extends nd{constructor(e,t,n,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=pe.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=pe.ERROR,this.unlistenImage_(),this.image_=f9(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=pe.LOADED:this.state=pe.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==pe.ERROR&&(this.state=pe.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==pe.IDLE&&(this.state=pe.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=iG(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function f9(){const i=xi(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class g9{constructor(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let n=t-3;for(;n>0&&this.points_[n+2]>e;)n-=3;const r=this.points_[t+2]-this.points_[n+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[n],o=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class A9 extends wg{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){je()}calculateMatrices2D(e){const t=e.viewState,n=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;_r(n,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Qb(r,n)}forEachFeatureAtCoordinate(e,t,n,r,s,o,a,l){let u;const c=t.viewState;function h(C,w,S,x){return s.call(o,w,C?S:null,x)}const d=c.projection,g=Zb(e.slice(),d),A=[[0,0]];if(d.canWrapX()&&r){const C=d.getExtent(),w=wi(C);A.push([-w,0],[w,0])}const p=t.layerStatesArray,y=p.length,v=[],E=[];for(let C=0;C<A.length;C++)for(let w=y-1;w>=0;--w){const S=p[w],x=S.layer;if(x.hasRenderer()&&xv(S,c)&&a.call(l,x)){const T=x.getRenderer(),Q=x.getSource();if(T&&Q){const M=Q.getWrapX()?g:e,R=h.bind(null,S.managed);E[0]=M[0]+A[C][0],E[1]=M[1]+A[C][1],u=T.forEachFeatureAtCoordinate(E,t,n,R,v)}if(u)return u}}if(v.length===0)return;const I=1/v.length;return v.forEach((C,w)=>C.distanceSq+=w*I),v.sort((C,w)=>C.distanceSq-w.distanceSq),v.some(C=>u=C.callback(C.feature,C.layer,C.geometry)),u}hasFeatureAtCoordinate(e,t,n,r,s,o){return this.forEachFeatureAtCoordinate(e,t,n,r,xg,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){je()}flushDeclutterItems(e){}scheduleExpireIconCache(e){sA.canExpireCache()&&e.postRenderFunctions.push(p9)}}function p9(i,e){sA.expire()}class m9 extends A9{constructor(e){super(e),this.fontChangeListenerKey_=Et(Fs,Kr.PROPERTYCHANGE,e.redrawText.bind(e)),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Uh+" ol-layers";const n=e.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(e,t){const n=this.getMap();if(n.hasListener(e)){const r=new id(e,void 0,t);n.dispatchEvent(r)}}disposeInternal(){Ot(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(wn.PRECOMPOSE,e);const t=e.layerStatesArray.sort(function(o,a){return o.zIndex-a.zIndex}),n=e.viewState;this.children_.length=0;const r=this.declutterLayers_;r.length=0;let s=null;for(let o=0,a=t.length;o<a;++o){const l=t[o];e.layerIndex=o;const u=l.layer,c=u.getSourceState();if(!xv(l,n)||c!="ready"&&c!="undefined"){u.unrender();continue}const h=u.render(e,s);h&&(h!==s&&(this.children_.push(h),s=h),"getDeclutter"in u&&r.push(u))}this.flushDeclutterItems(e),xU(this.element_,this.children_),this.dispatchRenderEvent(wn.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}flushDeclutterItems(e){const t=this.declutterLayers_;for(let n=t.length-1;n>=0;--n)t[n].renderDeclutter(e);t.length=0}}class Go extends hi{constructor(e,t){super(e),this.layer=t}}const Pv={LAYERS:"layers"};class _u extends NS{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let n=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Pv.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new Ls(n.slice(),{unique:!0}):It(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new Ls(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ot),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Et(e,nr.ADD,this.handleLayersAdd_,this),Et(e,nr.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ot);eu(this.listenerKeys_);const t=e.getArray();for(let n=0,r=t.length;n<r;n++){const s=t[n];this.registerLayerListeners_(s),this.dispatchEvent(new Go("addlayer",s))}this.changed()}registerLayerListeners_(e){const t=[Et(e,Kr.PROPERTYCHANGE,this.handleLayerChange_,this),Et(e,$e.CHANGE,this.handleLayerChange_,this)];e instanceof _u&&t.push(Et(e,"addlayer",this.handleLayerGroupAdd_,this),Et(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[nt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Go("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Go("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Go("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,n=nt(t);this.listenerKeys_[n].forEach(Ot),delete this.listenerKeys_[n],this.dispatchEvent(new Go("removelayer",t)),this.changed()}getLayers(){return this.get(Pv.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const n=t.getArray();for(let r=0,s=n.length;r<s;++r)this.dispatchEvent(new Go("removelayer",n[r]))}this.set(Pv.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],n=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=n,a=t.length;o<a;o++){const l=t[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=Cn(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}}class Cu extends hi{constructor(e,t,n){super(e),this.map=t,this.frameState=n!==void 0?n:null}}class Ho extends Cu{constructor(e,t,n,r,s,o){super(e,t,s),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const si={SINGLECLICK:"singleclick",CLICK:$e.CLICK,DBLCLICK:$e.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Mv={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class y9 extends Bh{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=Et(n,Mv.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Et(n,Mv.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener($e.TOUCHMOVE,this.boundHandleTouchMove_,Ob?{passive:!1}:!1)}emulateClick_(e){let t=new Ho(si.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Ho(si.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new Ho(si.SINGLECLICK,this.map_,e);this.dispatchEvent(n)},250)}updateActivePointers_(e){const t=e,n=t.pointerId;if(t.type==si.POINTERUP||t.type==si.POINTERCANCEL){delete this.trackedTouches_[n];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==si.POINTERDOWN||t.type==si.POINTERMOVE)&&(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Ho(si.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ot),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Ho(si.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Et(n,si.POINTERMOVE,this.handlePointerMove_,this),Et(n,si.POINTERUP,this.handlePointerUp_,this),Et(this.element_,si.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(Et(this.element_.getRootNode(),si.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Ho(si.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Ho(si.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ot(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener($e.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ot(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ot),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const zo={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Si={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},gA=1/0;class v9{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,eu(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(e){It(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=gA?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,n=this.priorities_,r=t.length,s=t[e],o=n[e],a=e;for(;e<r>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),c=u<r&&n[u]<n[l]?u:l;t[e]=t[c],n[e]=n[c],e=c}t[e]=s,n[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const n=this.elements_,r=this.priorities_,s=n[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)n[t]=n[a],r[t]=r[a],t=a;else break}n[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,n=this.priorities_;let r=0;const s=t.length;let o,a,l;for(a=0;a<s;++a)o=t[a],l=e(o),l==gA?delete this.queuedElements_[this.keyFunction_(o)]:(n[r]=l,t[r++]=o);t.length=r,n.length=r,this.heapify_()}}class E9 extends v9{constructor(e,t){super(function(n){return e.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener($e.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,n=t.getState();if(n===pe.LOADED||n===pe.ERROR||n===pe.EMPTY){n!==pe.ERROR&&t.removeEventListener($e.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let n=0,r,s,o;for(;this.tilesLoading_<e&&n<t&&this.getCount()>0;)s=this.dequeue()[0],o=s.getKey(),r=s.getState(),r===pe.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++n,s.load())}}function I9(i,e,t,n,r){if(!i||!(t in i.wantedTiles)||!i.wantedTiles[t][e.getKey()])return gA;const s=i.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class AA extends Yr{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){Av(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&Av(this.element);for(let t=0,n=this.listenerKeys.length;t<n;++t)Ot(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=e,e&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Sg&&this.listenerKeys.push(Et(e,zo.POSTRENDER,this.render,this)),e.render())}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class _9 extends AA{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const t=e.className!==void 0?e.className:"ol-attribution",n=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"›",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener($e.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+Uh+" "+Zg+(this.collapsed_&&this.collapsible_?" "+LS:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=u,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=Array.from(new Set(this.getMap().getAllLayers().flatMap(r=>r.getAttributions(e)))),n=!this.getMap().getAllLayers().some(r=>r.getSource()&&r.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(n),t}updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=this.collectSourceAttributions_(e),n=t.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!Qa(t,this.renderedAttributions_)){wU(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(LS),this.collapsed_?Kg(this.collapseLabel_,this.label_):Kg(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class C9 extends AA{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",n=e.label!==void 0?e.label:"⇧",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener($e.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+Uh+" "+Zg,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Yg)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const n=t.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:gu}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const n=t.viewState.rotation;if(n!=this.rotation_){const r="rotate("+n+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Yg);!s&&n===0?this.element.classList.add(Yg):s&&n!==0&&this.element.classList.remove(Yg)}this.label_.style.transform=r}this.rotation_=n}}class w9 extends AA{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",n=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"–",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener($e.CLICK,this.handleClick_.bind(this,n),!1);const h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=u,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener($e.CLICK,this.handleClick_.bind(this,-n),!1);const d=t+" "+Uh+" "+Zg,g=this.element;g.className=d,g.appendChild(c),g.appendChild(h),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const n=this.getMap().getView();if(!n)return;const r=n.getZoom();if(r!==void 0){const s=n.getConstrainedZoom(r+e);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:s,duration:this.duration_,easing:gu})):n.setZoom(s)}}}function vT(i){i=i||{};const e=new Ls;return(i.zoom!==void 0?i.zoom:!0)&&e.push(new w9(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&e.push(new C9(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&e.push(new _9(i.attributionOptions)),e}const ET={ACTIVE:"active"};class rd extends Yr{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(ET.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(ET.ACTIVE,e)}setMap(e){this.map_=e}}function x9(i,e,t){const n=i.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];i.animateInternal({duration:t!==void 0?t:250,easing:HU,center:i.getConstrainedCenter(r)})}}function Fv(i,e,t,n){const r=i.getZoom();if(r===void 0)return;const s=i.getConstrainedZoom(r+e),o=i.getResolutionForZoom(s);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:o,anchor:t,duration:n!==void 0?n:250,easing:gu})}class b9 extends rd{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==si.DBLCLICK){const n=e.originalEvent,r=e.map,s=e.coordinate,o=n.shiftKey?-this.delta_:this.delta_,a=r.getView();Fv(a,o,s,this.duration_),n.preventDefault(),t=!0}return!t}}class sd extends rd{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==si.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==si.POINTERUP){const n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==si.POINTERDOWN){const n=this.handleDownEvent(e);this.handlingDownUpSequence=n,t=this.stopDown(n)}else e.type==si.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Ov(i){const e=i.length;let t=0,n=0;for(let r=0;r<e;r++)t+=i[r].clientX,n+=i[r].clientY;return{clientX:t/e,clientY:n/e}}function Nv(i){const e=arguments;return function(t){let n=!0;for(let r=0,s=e.length;r<s&&(n=n&&e[r](t),!!n);++r);return n}}const S9=function(i){const e=i.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},T9=function(i){const e=i.map.getTargetElement(),t=i.map.getOwnerDocument().activeElement;return e.contains(t)},IT=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?T9(i):!0},B9=xg,_T=function(i){const e=i.originalEvent;return e.button==0&&!(E5&&Pb&&e.ctrlKey)},CT=function(i){const e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},R9=function(i){const e=i.originalEvent;return Pb?e.metaKey:e.ctrlKey},L9=function(i){const e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},wT=function(i){const e=i.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Qv=function(i){const e=i.originalEvent;return It(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.pointerType=="mouse"},D9=function(i){const e=i.originalEvent;return It(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&e.button===0};class k9 extends sd{constructor(e){super({stopDown:bg}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Nv(CT,D9);this.condition_=e.onFocusOnly?Nv(IT,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const n=this.targetPointers,r=t.getEventPixel(Ov(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();V5(s,a.getResolution()),Zy(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,n=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:gu})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const n=e.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class P9 extends sd{constructor(e){e=e||{},super({stopDown:bg}),this.condition_=e.condition?e.condition:S9,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Qv(e))return;const t=e.map,n=t.getView();if(n.getConstraints().rotation===_v)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return Qv(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Qv(e)&&_T(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class M9 extends wg{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+n,r.top=Math.min(e[1],t[1])+n,r.width=Math.abs(t[0]-e[0])+n,r.height=Math.abs(t[1]-e[1])+n}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new ks([r])}getGeometry(){return this.geometry_}}const pA={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Uv extends hi{constructor(e,t,n){super(e),this.coordinate=t,this.mapBrowserEvent=n}}class F9 extends sd{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.box_=new M9(e.className||"ol-dragbox"),this.minArea_=e.minArea!==void 0?e.minArea:64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition?e.condition:_T,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,n){const r=n[0]-t[0],s=n[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Uv(pA.BOXDRAG,e.coordinate,e))}handleUpEvent(e){this.box_.setMap(null);const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Uv(t?pA.BOXEND:pA.BOXCANCEL,e.coordinate,e)),!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Uv(pA.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}}class O9 extends F9{constructor(e){e=e||{};const t=e.condition?e.condition:L9;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const n=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=n.rotatedExtentForGeometry(r),o=n.getResolutionForExtentInternal(s),a=n.getResolution()/o;r=r.clone(),r.scale(a*a)}n.fitInternal(r,{duration:this.duration_,easing:gu})}}const Ja={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class N9 extends rd{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return CT(t)&&wT(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==$e.KEYDOWN){const n=e.originalEvent,r=n.key;if(this.condition_(e)&&(r==Ja.DOWN||r==Ja.LEFT||r==Ja.RIGHT||r==Ja.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,u=0;r==Ja.DOWN?u=-a:r==Ja.LEFT?l=-a:r==Ja.RIGHT?l=a:u=a;const c=[l,u];Zy(c,o.getRotation()),x9(o,c,this.duration_),n.preventDefault(),t=!0}}return!t}}class Q9 extends rd{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!R9(t)&&wT(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==$e.KEYDOWN||e.type==$e.KEYPRESS){const n=e.originalEvent,r=n.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Fv(a,o,void 0,this.duration_),n.preventDefault(),t=!0}}return!t}}class U9 extends rd{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:B9;this.condition_=e.onFocusOnly?Nv(IT,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(e){if(!this.condition_(e)||e.type!==$e.WHEEL)return!0;const n=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.coordinate);let s;if(e.type==$e.WHEEL&&(s=r.deltaY,y5&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=Mb),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=n.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let n=-Xt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Fv(t,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class G9 extends sd{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=bg),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const n=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==_v&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Ov(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class H9 extends sd{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=bg),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const n=this.targetPointers[0],r=this.targetPointers[1],s=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Ov(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const n=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function z9(i){i=i||{};const e=new Ls,t=new g9(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&e.push(new P9),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&e.push(new b9({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&e.push(new k9({onFocusOnly:i.onFocusOnly,kinetic:t})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&e.push(new G9),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&e.push(new H9({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(e.push(new N9),e.push(new Q9({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&e.push(new U9({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&e.push(new O9({duration:i.zoomDuration})),e}function xT(i){if(i instanceof iA){i.setMapInternal(null);return}i instanceof _u&&i.getLayers().forEach(xT)}function bT(i,e){if(i instanceof iA){i.setMapInternal(e);return}if(i instanceof _u){const t=i.getLayers().getArray();for(let n=0,r=t.length;n<r;++n)bT(t[n],e)}}let V9=class extends Yr{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=q9(e);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Mb,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Yi(),this.pixelToCoordinateTransform_=Yi(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||vT(),this.interactions=t.interactions||z9({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new E9(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Si.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Si.VIEW,this.handleViewChanged_),this.addChangeListener(Si.SIZE,this.handleSizeChanged_),this.addChangeListener(Si.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const n=this;e.view&&!(e.view instanceof Os)&&e.view.then(function(r){n.setView(new Os(r))}),this.controls.addEventListener(nr.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(nr.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(nr.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(nr.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(nr.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(nr.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){bT(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,n){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:xg,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const n=[];return this.forEachFeatureAtPixel(e,function(r){n.push(r)},t),n}getAllLayers(){const e=[];function t(n){n.forEach(function(r){r instanceof _u?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:xg,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const n=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=n.width/r[0],o=n.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-n.left)/s,(a.clientY-n.top)/o]}getTarget(){return this.get(Si.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Vg(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?yi(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Si.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Ls){t.setLayers(e);return}const n=t.getLayers();n.clear(),n.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,n=e.length;t<n;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Ds(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?yi(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Si.SIZE)}getView(){return this.get(Si.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,n,r){return I9(this.frameState_,e,t,n,r)}handleBrowserEvent(e,t){t=t||e.type;const n=new Ho(t,this,e);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,n=t.type;if(n===Mv.POINTERDOWN||n===$e.WHEEL||n===$e.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===r?r.documentElement:s).contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[bi.ANIMATING]||o[bi.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_===!0?(this.hasListener(wn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(wn.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Cu(zo.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Cu(zo.LOADSTART,this,e))));const n=this.postRenderFunctions_;for(let r=0,s=n.length;r<s;++r)n[r](this,e);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,r=this.targetChangeHandlerKeys_.length;n<r;++n)Ot(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener($e.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener($e.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Av(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new m9(this)),this.mapBrowserEventHandler_=new y9(this,this.moveTolerance_);for(const s in si)this.mapBrowserEventHandler_.addEventListener(si[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener($e.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener($e.WHEEL,this.boundHandleBrowserEvent_,Ob?{passive:!1}:!1);const n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.targetChangeHandlerKeys_=[Et(n,$e.KEYDOWN,this.handleBrowserEvent,this),Et(n,$e.KEYPRESS,this.handleBrowserEvent,this)];const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ot(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ot(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Et(e,Kr.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Et(e,$e.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ot),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Go("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Et(e,Kr.PROPERTYCHANGE,this.render,this),Et(e,$e.CHANGE,this.render,this),Et(e,"addlayer",this.handleLayerAdd_,this),Et(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,n=e.length;t<n;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const e=this.frameState_;e&&this.renderer_.flushDeclutterItems(e)}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){xT(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),n=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&_S(t)&&n&&n.isDef()){const o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:$y(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:nt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=$y(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!nu(this.previousExtent_)&&!Pg(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Cu(zo.MOVESTART,this,r)),this.previousExtent_=iu(this.previousExtent_)),this.previousExtent_&&!s.viewHints[bi.ANIMATING]&&!s.viewHints[bi.INTERACTING]&&!Pg(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Cu(zo.MOVEEND,this,s)),Gb(s.extent,this.previousExtent_))),this.dispatchEvent(new Cu(zo.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(zo.LOADSTART)||this.hasListener(zo.LOADEND)||this.hasListener(wn.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Go("removelayer",t)),this.set(Si.LAYERGROUP,e)}setSize(e){this.set(Si.SIZE,e)}setTarget(e){this.set(Si.TARGET,e)}setView(e){if(!e||e instanceof Os){this.set(Si.VIEW,e);return}this.set(Si.VIEW,new Os);const t=this;e.then(function(n){t.setView(new Os(n))})}updateSize(){const e=this.getTargetElement();let t;if(e){const r=getComputedStyle(e),s=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[s,o],!_S(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Jb("No map visible because the map container's width or height are 0."))}const n=this.getSize();t&&(!n||!Qa(t,n))&&(this.setSize(t),this.updateViewportSize_())}updateViewportSize_(){const e=this.getView();if(e){let t;const n=getComputedStyle(this.viewport_);n.width&&n.height&&(t=[parseInt(n.width,10),parseInt(n.height,10)]),e.setViewportSize(t)}}};function q9(i){let e=null;i.keyboardEventTarget!==void 0&&(e=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const t={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new _u({layers:i.layers});t[Si.LAYERGROUP]=n,t[Si.TARGET]=i.target,t[Si.VIEW]=i.view instanceof Os?i.view:new Os;let r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new Ls(i.controls.slice()):(It(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=i.controls));let s;i.interactions!==void 0&&(Array.isArray(i.interactions)?s=new Ls(i.interactions.slice()):(It(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=i.interactions));let o;return i.overlays!==void 0?Array.isArray(i.overlays)?o=new Ls(i.overlays.slice()):(It(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=i.overlays):o=new Ls,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}class ST{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const n=this.entries_[e];return It(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(e){const t=this.entries_[e];return It(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e}getValues(){const e=new Array(this.count_);let t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){if(this.containsKey(e))return this.entries_[e].value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){It(!(e in this.entries_),"Tried to set a value for a key that is used already");const n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_}setSize(e){this.highWaterMark=e}}function mA(i,e,t,n){return n!==void 0?(n[0]=i,n[1]=e,n[2]=t,n):[i,e,t]}function Vo(i,e,t){return i+"/"+e+"/"+t}function el(i){return Vo(i[0],i[1],i[2])}function $9(i){const[e,t,n]=i.substring(i.lastIndexOf("/")+1,i.length).split(",").map(Number);return Vo(e,t,n)}function TT(i){return i.split("/").map(Number)}function j9(i){return(i[1]<<i[0])+i[2]}function W9(i,e){const t=i[0],n=i[1],r=i[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(n,r):!0}class yA extends ST{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(e){for(;this.canExpireCache()&&!(this.peekLast().getKey()in e);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const e=this.peekFirstKey(),n=TT(e)[0];this.forEach(r=>{r.tileCoord[0]!==n&&(this.remove(el(r.tileCoord)),r.release())})}}class vA{constructor(e,t,n,r){this.minX=e,this.maxX=t,this.minY=n,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function wu(i,e,t,n,r){return r!==void 0?(r.minX=i,r.maxX=e,r.minY=t,r.maxY=n,r):new vA(i,e,t,n)}const BT=[];class K9 extends nd{constructor(e,t,n,r){super(e,t,{transition:0}),this.context_={},this.executorGroups={},this.declutterExecutorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=r.bind(void 0,this),this.wrappedTileCoord=n}getContext(e){const t=nt(e);return t in this.context_||(this.context_[t]=xi(1,1,BT)),this.context_[t]}hasContext(e){return nt(e)in this.context_}getImage(e){return this.hasContext(e)?this.getContext(e).canvas:null}getReplayState(e){const t=nt(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){for(const e in this.context_){const t=this.context_[e];uu(t),BT.push(t.canvas),delete this.context_[e]}super.release()}}let Y9=class extends nd{constructor(e,t,n,r,s,o){super(e,t,o),this.extent=null,this.format_=r,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=s,this.url_=n,this.key=n}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==pe.IDLE&&(this.setState(pe.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(pe.ERROR)}setFeatures(e){this.features_=e,this.setState(pe.LOADED)}setLoader(e){this.loader_=e}};const qo={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class RT extends iA{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getPreload(){return this.get(qo.PRELOAD)}setPreload(e){this.set(qo.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(qo.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(qo.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}const LT=.5,Z9=10,DT=.25;class kT{constructor(e,t,n,r,s,o){this.sourceProj_=e,this.targetProj_=t;let a={};const l=Fh(this.targetProj_,this.sourceProj_);this.transformInv_=function(E){const I=E[0]+"/"+E[1];return a[I]||(a[I]=l(E)),a[I]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&wi(r)>=wi(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?wi(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?wi(this.targetProj_.getExtent()):null;const u=Ro(n),c=Og(n),h=Fg(n),d=Mg(n),g=this.transformInv_(u),A=this.transformInv_(c),p=this.transformInv_(h),y=this.transformInv_(d),v=Z9+(o?Math.max(0,Math.ceil(Math.log2(kh(n)/(o*o*256*256)))):0);if(this.addQuad_(u,c,h,d,g,A,p,y,v),this.wrapsXInSource_){let E=1/0;this.triangles_.forEach(function(I,C,w){E=Math.min(E,I.source[0][0],I.source[1][0],I.source[2][0])}),this.triangles_.forEach(I=>{if(Math.max(I.source[0][0],I.source[1][0],I.source[2][0])-E>this.sourceWorldWidth_/2){const C=[[I.source[0][0],I.source[0][1]],[I.source[1][0],I.source[1][1]],[I.source[2][0],I.source[2][1]]];C[0][0]-E>this.sourceWorldWidth_/2&&(C[0][0]-=this.sourceWorldWidth_),C[1][0]-E>this.sourceWorldWidth_/2&&(C[1][0]-=this.sourceWorldWidth_),C[2][0]-E>this.sourceWorldWidth_/2&&(C[2][0]-=this.sourceWorldWidth_);const w=Math.min(C[0][0],C[1][0],C[2][0]);Math.max(C[0][0],C[1][0],C[2][0])-w<this.sourceWorldWidth_/2&&(I.source=C)}})}a={}}addTriangle_(e,t,n,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,n]})}addQuad_(e,t,n,r,s,o,a,l,u){const c=kg([s,o,a,l]),h=this.sourceWorldWidth_?wi(c)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&h>.5&&h<1;let A=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const y=kg([e,t,n,r]);A=wi(y)/this.targetWorldWidth_>DT||A}!g&&this.sourceProj_.isGlobal()&&h&&(A=h>DT||A)}if(!A&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!vi(c,this.maxSourceExtent_))return;let p=0;if(!A&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)A=!0;else if(p=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(u>0){if(!A){const y=[(e[0]+n[0])/2,(e[1]+n[1])/2],v=this.transformInv_(y);let E;g?E=(au(s[0],d)+au(a[0],d))/2-au(v[0],d):E=(s[0]+a[0])/2-v[0];const I=(s[1]+a[1])/2-v[1];A=E*E+I*I>this.errorThresholdSquared_}if(A){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){const y=[(t[0]+n[0])/2,(t[1]+n[1])/2],v=this.transformInv_(y),E=[(r[0]+e[0])/2,(r[1]+e[1])/2],I=this.transformInv_(E);this.addQuad_(e,t,y,E,s,o,v,I,u-1),this.addQuad_(E,y,n,r,I,v,a,l,u-1)}else{const y=[(e[0]+t[0])/2,(e[1]+t[1])/2],v=this.transformInv_(y),E=[(n[0]+r[0])/2,(n[1]+r[1])/2],I=this.transformInv_(E);this.addQuad_(e,y,E,r,s,v,I,l,u-1),this.addQuad_(y,t,n,E,v,o,a,I,u-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}p&11||this.addTriangle_(e,n,r,s,a,l),p&14||this.addTriangle_(e,n,t,s,a,o),p&&(p&13||this.addTriangle_(t,r,e,o,l,s),p&7||this.addTriangle_(t,r,n,o,l,a))}calculateSourceExtent(){const e=Zr();return this.triangles_.forEach(function(t,n,r){const s=t.source;Dh(e,s[0]),Dh(e,s[1]),Dh(e,s[2])}),e}getTriangles(){return this.triangles_}}let Gv;const Us=[];function PT(i,e,t,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(e,t),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(e,n)+1,Math.max(t,r)),i.restore()}function Hv(i,e){return Math.abs(i[e*4]-210)>2||Math.abs(i[e*4+3]-.75*255)>2}function X9(){if(Gv===void 0){const i=xi(6,6,Us);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",PT(i,4,5,4,0),PT(i,4,5,0,5);const e=i.getImageData(0,0,3,3).data;Gv=Hv(e,0)||Hv(e,4)||Hv(e,8),uu(i),Us.push(i.canvas)}return Gv}function MT(i,e,t,n){const r=iv(t,e,i);let s=iS(e,n,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=i.getMetersPerUnit();a!==void 0&&(s/=a);const l=i.getExtent();if(!l||tu(l,r)){const u=iS(i,s,r)/s;isFinite(u)&&u>0&&(s/=u)}return s}function FT(i,e,t,n){const r=Bo(t);let s=MT(i,e,r,n);return(!isFinite(s)||s<=0)&&$b(t,function(o){return s=MT(i,e,o,n),isFinite(s)&&s>0}),s}function OT(i,e,t,n,r,s,o,a,l,u,c,h){const d=xi(Math.round(t*i),Math.round(t*e),Us);if(h||(d.imageSmoothingEnabled=!1),l.length===0)return d.canvas;d.scale(t,t);function g(C){return Math.round(C*t)/t}d.globalCompositeOperation="lighter";const A=Zr();l.forEach(function(C,w,S){Vb(A,C.extent)});const p=wi(A),y=rr(A),v=xi(Math.round(t*p/n),Math.round(t*y/n),Us);h||(v.imageSmoothingEnabled=!1);const E=t/n;l.forEach(function(C,w,S){const x=C.extent[0]-A[0],T=-(C.extent[3]-A[3]),Q=wi(C.extent),M=rr(C.extent);C.image.width>0&&C.image.height>0&&v.drawImage(C.image,u,u,C.image.width-2*u,C.image.height-2*u,x*E,T*E,Q*E,M*E)});const I=Ro(o);return a.getTriangles().forEach(function(C,w,S){const x=C.source,T=C.target;let Q=x[0][0],M=x[0][1],R=x[1][0],z=x[1][1],q=x[2][0],X=x[2][1];const N=g((T[0][0]-I[0])/s),G=g(-(T[0][1]-I[1])/s),j=g((T[1][0]-I[0])/s),V=g(-(T[1][1]-I[1])/s),Z=g((T[2][0]-I[0])/s),Y=g(-(T[2][1]-I[1])/s),te=Q,J=M;Q=0,M=0,R-=te,z-=J,q-=te,X-=J;const ce=[[R,z,0,0,j-N],[q,X,0,0,Z-N],[0,0,R,z,V-G],[0,0,q,X,Y-G]],ie=H5(ce);if(ie){if(d.save(),d.beginPath(),X9()||!h){d.moveTo(j,V);const ne=4,ue=N-j,fe=G-V;for(let me=0;me<ne;me++)d.lineTo(j+g((me+1)*ue/ne),V+g(me*fe/(ne-1))),me!=ne-1&&d.lineTo(j+g((me+1)*ue/ne),V+g((me+1)*fe/(ne-1)));d.lineTo(Z,Y)}else d.moveTo(j,V),d.lineTo(N,G),d.lineTo(Z,Y);d.clip(),d.transform(ie[0],ie[2],ie[1],ie[3],N,G),d.translate(A[0]-te,A[3]-J),d.scale(n/t,-n/t),d.drawImage(v.canvas,0,0),d.restore()}}),uu(v),Us.push(v.canvas),c&&(d.save(),d.globalCompositeOperation="source-over",d.strokeStyle="black",d.lineWidth=1,a.getTriangles().forEach(function(C,w,S){const x=C.target,T=(x[0][0]-I[0])/s,Q=-(x[0][1]-I[1])/s,M=(x[1][0]-I[0])/s,R=-(x[1][1]-I[1])/s,z=(x[2][0]-I[0])/s,q=-(x[2][1]-I[1])/s;d.beginPath(),d.moveTo(M,R),d.lineTo(T,Q),d.lineTo(z,q),d.closePath(),d.stroke()}),d.restore()),d.canvas}class xu extends nd{constructor(e,t,n,r,s,o,a,l,u,c,h,d){super(s,pe.IDLE,{interpolate:!!d}),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const g=r.getTileCoordExtent(this.wrappedTileCoord_),A=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const y=A?Cn(g,A):g;if(kh(y)===0){this.state=pe.EMPTY;return}const v=e.getExtent();v&&(p?p=Cn(p,v):p=v);const E=r.getResolution(this.wrappedTileCoord_[0]),I=FT(e,n,y,E);if(!isFinite(I)||I<=0){this.state=pe.EMPTY;return}const C=c!==void 0?c:LT;if(this.triangulation_=new kT(e,n,y,p,I*C,E),this.triangulation_.getTriangles().length===0){this.state=pe.EMPTY;return}this.sourceZ_=t.getZForResolution(I);let w=this.triangulation_.calculateSourceExtent();if(p&&(e.canWrapX()?(w[1]=Xt(w[1],p[1],p[3]),w[3]=Xt(w[3],p[1],p[3])):w=Cn(w,p)),!kh(w))this.state=pe.EMPTY;else{const S=t.getTileRangeForExtentAndZ(w,this.sourceZ_);for(let x=S.minX;x<=S.maxX;x++)for(let T=S.minY;T<=S.maxY;T++){const Q=u(this.sourceZ_,x,T,a);Q&&this.sourceTiles_.push(Q)}this.sourceTiles_.length===0&&(this.state=pe.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{t&&t.getState()==pe.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}),this.sourceTiles_.length=0,e.length===0)this.state=pe.ERROR;else{const t=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(t),r=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=OT(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=pe.LOADED}this.changed()}load(){if(this.state==pe.IDLE){this.state=pe.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const n=t.getState();if(n==pe.IDLE||n==pe.LOADING){e++;const r=Et(t,$e.CHANGE,function(s){const o=t.getState();(o==pe.LOADED||o==pe.ERROR||o==pe.EMPTY)&&(Ot(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,n,r){t.getState()==pe.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ot),this.sourcesListenerKeys_=null}release(){this.canvas_&&(uu(this.canvas_.getContext("2d")),Us.push(this.canvas_),this.canvas_=null),super.release()}}class NT extends VG{constructor(e){super(e),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=Zr(),this.tmpTileRange_=new vA(0,0,0,0)}isDrawableTile(e){const t=this.getLayer(),n=e.getState(),r=t.getUseInterimTilesOnError();return n==pe.LOADED||n==pe.EMPTY||n==pe.ERROR&&!r}getTile(e,t,n,r){const s=r.pixelRatio,o=r.viewState.projection,a=this.getLayer();let u=a.getSource().getTile(e,t,n,s,o);return u.getState()==pe.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(u)||(u=u.getInterimTile()),u}getData(e){const t=this.frameState;if(!t)return null;const n=this.getLayer(),r=yi(t.pixelToCoordinateTransform,e.slice()),s=n.getExtent();if(s&&!tu(s,r))return null;const o=t.pixelRatio,a=t.viewState.projection,l=t.viewState,u=n.getRenderSource(),c=u.getTileGridForProjection(l.projection),h=u.getTilePixelRatio(t.pixelRatio);for(let d=c.getZForResolution(l.resolution);d>=c.getMinZoom();--d){const g=c.getTileCoordForCoordAndZ(r,d),A=u.getTile(d,g[1],g[2],o,a);if(!(A instanceof fA||A instanceof xu)||A instanceof xu&&A.getState()===pe.EMPTY)return null;if(A.getState()!==pe.LOADED)continue;const p=c.getOrigin(d),y=ai(c.getTileSize(d)),v=c.getResolution(d),E=Math.floor(h*((r[0]-p[0])/v-g[1]*y[0])),I=Math.floor(h*((p[1]-r[1])/v-g[2]*y[1])),C=Math.round(h*u.getGutterForProjection(l.projection));return this.getImageData(A.getImage(),E+C,I+C)}return null}loadedTileCallback(e,t,n){return this.isDrawableTile(n)?super.loadedTileCallback(e,t,n):!1}prepareFrame(e){return!!this.getLayer().getSource()}renderFrame(e,t){const n=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,l=r.rotation,u=e.pixelRatio,c=this.getLayer(),h=c.getSource(),d=h.getRevision(),g=h.getTileGridForProjection(s),A=g.getZForResolution(o,h.zDirection),p=g.getResolution(A);let y=e.extent;const v=e.viewState.resolution,E=h.getTilePixelRatio(u),I=Math.round(wi(y)/v*u),C=Math.round(rr(y)/v*u),w=n.extent&&Lo(n.extent,s);w&&(y=Cn(y,Lo(n.extent,s)));const S=p*I/2/E,x=p*C/2/E,T=[a[0]-S,a[1]-x,a[0]+S,a[1]+x],Q=g.getTileRangeForExtentAndZ(y,A),M={};M[A]={};const R=this.createLoadedTileFinder(h,s,M),z=this.tmpExtent,q=this.tmpTileRange_;this.newTiles_=!1;const X=l?jy(r.center,v,l,e.size):void 0;for(let ce=Q.minX;ce<=Q.maxX;++ce)for(let ie=Q.minY;ie<=Q.maxY;++ie){if(l&&!g.tileCoordIntersectsViewport([A,ce,ie],X))continue;const ne=this.getTile(A,ce,ie,e);if(this.isDrawableTile(ne)){const me=nt(this);if(ne.getState()==pe.LOADED){M[A][ne.tileCoord.toString()]=ne;let Pe=ne.inTransition(me);Pe&&n.opacity!==1&&(ne.endTransition(me),Pe=!1),!this.newTiles_&&(Pe||!this.renderedTiles.includes(ne))&&(this.newTiles_=!0)}if(ne.getAlpha(me,e.time)===1)continue}const ue=g.getTileCoordChildTileRange(ne.tileCoord,q,z);let fe=!1;ue&&(fe=R(A+1,ue)),fe||g.forEachTileCoordParentTileRange(ne.tileCoord,R,q,z)}const N=p/o*u/E;_r(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/u,1/u,l,-I/2,-C/2);const G=w5(this.pixelTransform);this.useContainer(t,G,this.getBackground(e));const j=this.context,V=j.canvas;Qb(this.inversePixelTransform,this.pixelTransform),_r(this.tempTransform,I/2,C/2,N,N,0,-I/2,-C/2),V.width!=I||V.height!=C?(V.width=I,V.height=C):this.containerReused||j.clearRect(0,0,I,C),w&&this.clipUnrotated(j,e,w),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e),this.renderedTiles.length=0;let Z=Object.keys(M).map(Number);Z.sort(bo);let Y,te,J;n.opacity===1&&(!this.containerReused||h.getOpaque(e.viewState.projection))?Z=Z.reverse():(Y=[],te=[]);for(let ce=Z.length-1;ce>=0;--ce){const ie=Z[ce],ne=h.getTilePixelSize(ie,u,s),fe=g.getResolution(ie)/p,me=ne[0]*fe*N,Pe=ne[1]*fe*N,Re=g.getTileCoordForCoordAndZ(Ro(T),ie),Qe=g.getTileCoordExtent(Re),Oe=yi(this.tempTransform,[E*(Qe[0]-T[0])/p,E*(T[3]-Qe[3])/p]),wt=E*h.getGutterForProjection(s),ft=M[ie];for(const pt in ft){const at=ft[pt],D=at.tileCoord,W=Re[1]-D[1],oe=Math.round(Oe[0]-(W-1)*me),ve=Re[2]-D[2],Ae=Math.round(Oe[1]-(ve-1)*Pe),Se=Math.round(Oe[0]-W*me),xe=Math.round(Oe[1]-ve*Pe),Xe=oe-Se,ot=Ae-xe,gt=A===ie,He=gt&&at.getAlpha(nt(this),e.time)!==1;let Ct=!1;if(!He)if(Y){J=[Se,xe,Se+Xe,xe,Se+Xe,xe+ot,Se,xe+ot];for(let O=0,F=Y.length;O<F;++O)if(A!==ie&&ie<te[O]){const $=Y[O];vi([Se,xe,Se+Xe,xe+ot],[$[0],$[3],$[4],$[7]])&&(Ct||(j.save(),Ct=!0),j.beginPath(),j.moveTo(J[0],J[1]),j.lineTo(J[2],J[3]),j.lineTo(J[4],J[5]),j.lineTo(J[6],J[7]),j.moveTo($[6],$[7]),j.lineTo($[4],$[5]),j.lineTo($[2],$[3]),j.lineTo($[0],$[1]),j.clip())}Y.push(J),te.push(ie)}else j.clearRect(Se,xe,Xe,ot);this.drawTileImage(at,e,Se,xe,Xe,ot,wt,gt),Y&&!He?(Ct&&j.restore(),this.renderedTiles.unshift(at)):this.renderedTiles.push(at),this.updateUsedTiles(e.usedTiles,h,at)}}return this.renderedRevision=d,this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!Pg(this.renderedExtent_,T),this.renderedExtent_=T,this.renderedPixelRatio=u,this.renderedProjection=s,this.manageTilePyramid(e,h,g,u,s,y,A,c.getPreload()),this.scheduleExpireCache(e,h),this.postRender(j,e),n.extent&&j.restore(),j.imageSmoothingEnabled=!0,G!==V.style.transform&&(V.style.transform=G),this.container}drawTileImage(e,t,n,r,s,o,a,l){const u=this.getTileImage(e);if(!u)return;const c=nt(this),h=t.layerStatesArray[t.layerIndex],d=h.opacity*(l?e.getAlpha(c,t.time):1),g=d!==this.context.globalAlpha;g&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,r,s,o),g&&this.context.restore(),d!==h.opacity?t.animate=!0:l&&e.endTransition(c)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}scheduleExpireCache(e,t){if(t.canExpireCache()){const n=(function(r,s,o){const a=nt(r);a in o.usedTiles&&r.expireCache(o.viewState.projection,o.usedTiles[a])}).bind(null,t);e.postRenderFunctions.push(n)}}updateUsedTiles(e,t,n){const r=nt(t);r in e||(e[r]={}),e[r][n.getKey()]=!0}manageTilePyramid(e,t,n,r,s,o,a,l,u){const c=nt(t);c in e.wantedTiles||(e.wantedTiles[c]={});const h=e.wantedTiles[c],d=e.tileQueue,g=n.getMinZoom(),A=e.viewState.rotation,p=A?jy(e.viewState.center,e.viewState.resolution,A,e.size):void 0;let y=0,v,E,I,C,w,S;for(S=g;S<=a;++S)for(E=n.getTileRangeForExtentAndZ(o,S,E),I=n.getResolution(S),C=E.minX;C<=E.maxX;++C)for(w=E.minY;w<=E.maxY;++w)A&&!n.tileCoordIntersectsViewport([S,C,w],p)||(a-S<=l?(++y,v=t.getTile(S,C,w,r,s),v.getState()==pe.IDLE&&(h[v.getKey()]=!0,d.isKeyQueued(v.getKey())||d.enqueue([v,c,n.getTileCoordCenter(v.tileCoord),I])),u!==void 0&&u(v)):t.useTile(S,C,w,s));t.updateCacheSize(y,s)}}class J9 extends RT{constructor(e){super(e)}createRenderer(){return new NT(this)}}const bu={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},Su=[0,0,0],$o=5;class EA{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,It(d5(this.resolutions_,function(r,s){return s-r}),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,It(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=e.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ro(n)),It(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,It(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:vv,It(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(r,s){const o=new vA(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(n){const a=this.getTileRangeForExtentAndZ(n,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o},this):n&&this.calculateTileRanges_(n)}forEachTileCoord(e,t,n){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)n([t,s,a])}forEachTileCoordParentTileRange(e,t,n,r){let s,o,a,l=null,u=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,r);u>=this.minZoom;){if(this.zoomFactor_===2?(o=Math.floor(o/2),a=Math.floor(a/2),s=wu(o,o,a,a,n)):s=this.getTileRangeForExtentAndZ(l,u,n),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return wu(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return wu(s,o,s,o,n);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-r),u=Math.floor(s*l),c=Math.floor(o*l);if(t<r)return wu(u,u,c,c,n);const h=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return wu(u,h,c,d,n)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,n)}getTileRangeForExtentAndZ(e,t,n){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Su);const r=Su[1],s=Su[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Su);const o=Su[1],a=Su[2];return wu(r,o,s,a,n)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),n=this.getResolution(e[0]),r=ai(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*n,t[1]-(e[2]+.5)*r[1]*n]}getTileCoordExtent(e,t){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=ai(this.getTileSize(e[0]),this.tmpSize_),o=n[0]+e[1]*s[0]*r,a=n[1]-(e[2]+1)*s[1]*r,l=o+s[0]*r,u=a+s[1]*r;return To(o,a,l,u,t)}getTileCoordForCoordAndResolution(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)}getTileCoordForXYAndResolution_(e,t,n,r,s){const o=this.getZForResolution(n),a=n/this.getResolution(o),l=this.getOrigin(o),u=ai(this.getTileSize(o),this.tmpSize_);let c=a*(e-l[0])/n/u[0],h=a*(l[1]-t)/n/u[1];return r?(c=Hg(c,$o)-1,h=Hg(h,$o)-1):(c=Gg(c,$o),h=Gg(h,$o)),mA(o,c,h,s)}getTileCoordForXYAndZ_(e,t,n,r,s){const o=this.getOrigin(n),a=this.getResolution(n),l=ai(this.getTileSize(n),this.tmpSize_);let u=(e-o[0])/a/l[0],c=(o[1]-t)/a/l[1];return r?(u=Hg(u,$o)-1,c=Hg(c,$o)-1):(u=Gg(u,$o),c=Gg(c,$o)),mA(n,u,c,s)}getTileCoordForCoordAndZ(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const n=Ny(this.resolutions_,e,t||0);return Xt(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return pS(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,n=new Array(t);for(let r=this.minZoom;r<t;++r)n[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=n}}function zv(i){let e=i.getDefaultTileGrid();return e||(e=iH(i),i.setDefaultTileGrid(e)),e}function eH(i,e,t){const n=e[0],r=i.getTileCoordCenter(e),s=od(t);if(!tu(s,r)){const o=wi(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,i.getTileCoordForCoordAndZ(r,n)}return e}function tH(i,e,t,n){n=n!==void 0?n:"top-left";const r=QT(i,e,t);return new EA({extent:i,origin:S5(i,n),resolutions:r,tileSize:t})}function Vv(i){const e=i||{},t=e.extent||Vt("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:QT(t,e.maxZoom,e.tileSize,e.maxResolution)};return new EA(n)}function QT(i,e,t,n){e=e!==void 0?e:QS,t=ai(t!==void 0?t:vv);const r=rr(i),s=wi(i);n=n>0?n:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=n/Math.pow(2,l);return a}function iH(i,e,t,n){const r=od(i);return tH(r,e,t,n)}function od(i){i=Vt(i);let e=i.getExtent();if(!e){const t=180*Wy.degrees/i.getMetersPerUnit();e=To(-t,-t,t,t)}return e}class UT extends c9{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.opaque_=e.opaque!==void 0?e.opaque:!1,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&ai(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tileCache=new yA(e.cacheSize||0),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(e,t){const n=this.getTileCacheForProjection(e);n&&n.expireCache(t)}forEachLoadedTile(e,t,n,r){const s=this.getTileCacheForProjection(e);if(!s)return!1;let o=!0,a,l,u;for(let c=n.minX;c<=n.maxX;++c)for(let h=n.minY;h<=n.maxY;++h)l=Vo(t,c,h),u=!1,s.containsKey(l)&&(a=s.get(l),u=a.getState()===pe.LOADED,u&&(u=r(a)!==!1)),u||(o=!1);return o}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getOpaque(e){return this.opaque_}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,n,r,s){return je()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:zv(e)}getTileCacheForProjection(e){const t=this.getProjection();return It(t===null||Cr(t,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,n){const r=this.getTileGridForProjection(n),s=this.getTilePixelRatio(t),o=ai(r.getTileSize(e),this.tmpSize);return s==1?o:IU(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const n=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=eH(n,e,t)),W9(e,n)?e:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(e,t){const n=this.getTileCacheForProjection(t);e>n.highWaterMark&&(n.highWaterMark=e)}useTile(e,t,n,r){}}class GT extends hi{constructor(e,t){super(e),this.tile=t}}function nH(i,e){const t=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return i.replace(t,o[0].toString()).replace(n,o[1].toString()).replace(r,o[2].toString()).replace(s,function(){const u=o[0],c=e.getFullTileRange(u);return It(c,"The {-y} placeholder requires a tile grid with extent"),(c.getHeight()-o[2]-1).toString()})}}function rH(i,e){const t=i.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=nH(i[r],e);return sH(n)}function sH(i){return i.length===1?i[0]:function(e,t,n){if(!e)return;const r=j9(e),s=au(r,i.length);return i[s](e,t,n)}}function oH(i){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(i);if(t){const n=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=n;s<=r;++s)e.push(i.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(i),t){const n=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=n;r++)e.push(i.replace(t[0],r.toString()));return e}return e.push(i),e}class IA extends UT{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===IA.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,n=nt(t),r=t.getState();let s;r==pe.LOADING?(this.tileLoadingKeys_[n]=!0,s=bu.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=r==pe.ERROR?bu.TILELOADERROR:r==pe.LOADED?bu.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new GT(s,t))}setTileLoadFunction(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=oH(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(rH(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,n){}useTile(e,t,n){const r=Vo(e,t,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}class aH extends IA{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:lH,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:fA,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}expireCache(e,t){const n=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==n?t:{});for(const r in this.tileCacheForProjection){const s=this.tileCacheForProjection[r];s.expireCache(s==n?t:{})}}getGutterForProjection(e){return this.getProjection()&&e&&!Cr(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getOpaque(e){return this.getProjection()&&e&&!Cr(this.getProjection(),e)?!1:super.getOpaque(e)}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Cr(t,e)))return this.tileGrid;const n=nt(e);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=zv(e)),this.tileGridForProjection[n]}getTileCacheForProjection(e){const t=this.getProjection();if(!t||Cr(t,e))return this.tileCache;const n=nt(e);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new yA(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(e,t,n,r,s,o){const a=[e,t,n],l=this.getTileCoordForTileUrlFunction(a,s),u=l?this.tileUrlFunction(l,r,s):void 0,c=new this.tileClass(a,u!==void 0?pe.IDLE:pe.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener($e.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,t,n,r,s){const o=this.getProjection();if(!o||!s||Cr(o,s))return this.getTileInternal(e,t,n,r,o||s);const a=this.getTileCacheForProjection(s),l=[e,t,n];let u;const c=el(l);a.containsKey(c)&&(u=a.get(c));const h=this.getKey();if(u&&u.key==h)return u;const d=this.getTileGridForProjection(o),g=this.getTileGridForProjection(s),A=this.getTileCoordForTileUrlFunction(l,s),p=new xu(o,d,s,g,l,A,this.getTilePixelRatio(r),this.getGutter(),(y,v,E,I)=>this.getTileInternal(y,v,E,I,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return p.key=h,u?(p.interimTile=u,p.refreshInterimChain(),a.replace(c,p)):a.set(c,p),p}getTileInternal(e,t,n,r,s){let o=null;const a=Vo(e,t,n),l=this.getKey();if(!this.tileCache.containsKey(a))o=this.createTile_(e,t,n,r,s,l),this.tileCache.set(a,o);else if(o=this.tileCache.get(a),o.key!=l){const u=o;o=this.createTile_(e,t,n,r,s,l),u.getState()==pe.IDLE?o.interimTile=u.interimTile:o.interimTile=u,o.refreshInterimChain(),this.tileCache.replace(a,o)}return o}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(e,t){const n=Vt(e);if(n){const r=nt(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}clear(){super.clear();for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}function lH(i,e){i.getImage().src=e}class uH extends aH{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",n=e.tileGrid!==void 0?e.tileGrid:Vv({extent:od(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}class _A extends lS{constructor(e){super(),this.geometries_=e||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ot),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(Et(this.geometries_[e],$e.CHANGE,this.changed,this))}clone(){const e=new _A(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e}closestPointXY(e,t,n,r){if(r<Ga(this.getExtent(),e,t))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(e,t,n,r);return r}containsXY(e,t){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)if(n[r].containsXY(e,t))return!0;return!1}computeExtent(e){iu(e);const t=this.geometries_;for(let n=0,r=t.length;n<r;++n)Vb(e,t[n].getExtent());return e}getGeometries(){return HT(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let n=0,r=t.length;n<r;++n)t[n].getType()===this.getType()?e=e.concat(t[n].getGeometriesArrayRecursive()):e.push(t[n]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],n=this.geometries_;let r=!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=a.getSimplifiedGeometry(e);t.push(l),l!==a&&(r=!0)}if(r){const s=new _A(null);return s.setGeometriesArray(t),s}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let n=0,r=t.length;n<r;++n)if(t[n].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].rotate(e,t);this.changed()}scale(e,t,n){n||(n=Bo(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(e,t,n);this.changed()}setGeometries(e){this.setGeometriesArray(HT(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let n=0,r=t.length;n<r;++n)t[n].applyTransform(e);this.changed()}translate(e,t){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function HT(i){const e=[];for(let t=0,n=i.length;t<n;++t)e.push(i[t].clone());return e}class zT{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let n=t.dataProjection?Vt(t.dataProjection):this.readProjection(e);t.extent&&n&&n.getUnits()==="tile-pixels"&&(n=Vt(n),n.setWorldExtent(t.extent)),t={dataProjection:n,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)}getType(){return je()}readFeature(e,t){return je()}readFeatures(e,t){return je()}readGeometry(e,t){return je()}readProjection(e){return je()}writeFeature(e,t){return je()}writeFeatures(e,t){return je()}writeGeometry(e,t){return je()}}function qv(i,e,t){const n=t?Vt(t.featureProjection):null,r=t?Vt(t.dataProjection):null;let s;if(n&&r&&!Cr(n,r)?s=(e?i.clone():i).transform(e?n:r,e?r:n):s=i,e&&t&&t.decimals!==void 0){const o=Math.pow(10,t.decimals),a=function(l){for(let u=0,c=l.length;u<c;++u)l[u]=Math.round(l[u]*o)/o;return l};s===i&&(s=i.clone()),s.applyTransform(a)}return s}class cH extends zT{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(CA(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(CA(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return je()}readFeaturesFromObject(e,t){return je()}readGeometry(e,t){return this.readGeometryFromObject(CA(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return je()}readProjection(e){return this.readProjectionFromObject(CA(e))}readProjectionFromObject(e){return je()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return je()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return je()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return je()}}function CA(i){if(typeof i=="string"){const e=JSON.parse(i);return e||null}return i!==null?i:null}class ad extends Va{constructor(e,t,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&n)this.setFlatCoordinates(t,e),this.ends_=n;else{let r=this.getLayout();const s=e,o=[],a=[];for(let l=0,u=s.length;l<u;++l){const c=s[l];l===0&&(r=c.getLayout()),Rs(o,c.getFlatCoordinates()),a.push(o.length)}this.setFlatCoordinates(r,o),this.ends_=a}}appendLineString(e){this.flatCoordinates?Rs(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ad(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,n,r){return r<Ga(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rv(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ov(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,n,r))}getCoordinateAtM(e,t,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,n=n!==void 0?n:!1,EU(this.flatCoordinates,0,this.ends_,this.stride,e,t,n))}getCoordinates(){return Oh(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new Ka(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,n=this.layout,r=[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o],u=new Ka(e.slice(s,l),n);r.push(u),s=l}return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let n=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],u=jg(t,n,l,s,.5);Rs(e,u),n=l}return e}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=uU(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,n),new ad(t,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(e){return AU(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=av(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}class ld extends Va{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){this.flatCoordinates?Rs(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.changed()}clone(){const e=new ld(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,r){if(r<Ga(this.getExtent(),e,t))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const u=za(e,t,s[a],s[a+1]);if(u<r){r=u;for(let c=0;c<o;++c)n[c]=s[a+c];n.length=o}}return r}getCoordinates(){return ko(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return e<0||t<=e?null:new $a(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,n=this.stride,r=[];for(let s=0,o=e.length;s<o;s+=n){const a=new $a(e.slice(s,s+n),t);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,n=this.stride;for(let r=0,s=t.length;r<s;r+=n){const o=t[r],a=t[r+1];if(zy(e,o,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qg(this.flatCoordinates,0,e,this.stride),this.changed()}}function VT(i,e,t,n){const r=[];let s=Zr();for(let o=0,a=t.length;o<a;++o){const l=t[o];s=qy(i,e,l[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return r}class ud extends Va{constructor(e,t,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){let r=this.getLayout();const s=e,o=[],a=[];for(let l=0,u=s.length;l<u;++l){const c=s[l];l===0&&(r=c.getLayout());const h=o.length,d=c.getEnds();for(let g=0,A=d.length;g<A;++g)d[g]+=h;Rs(o,c.getFlatCoordinates()),a.push(d)}t=r,e=o,n=a}t!==void 0&&n?(this.setFlatCoordinates(t,e),this.endss_=n):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;Rs(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let r=0,s=t.length;r<s;++r)t[r]+=n}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let r=0;r<e;++r)t[r]=this.endss_[r].slice();const n=new ud(this.flatCoordinates.slice(),this.layout,t);return n.applyProperties(this),n}closestPointXY(e,t,n,r){return r<Ga(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sU(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),oU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,n,r))}containsXY(e,t){return gU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return dU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),vS(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,uv(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=VT(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=gS(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ld(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;yU(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=vS(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=hU(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,n),new ud(t,"XY",n)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const n=this.endss_[e].slice(),r=n[n.length-1];if(t!==0)for(let s=0,o=n.length;s<o;++s)n[s]-=t;return new ks(this.flatCoordinates.slice(t,r),this.layout,n)}getPolygons(){const e=this.layout,t=this.flatCoordinates,n=this.endss_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o].slice(),u=l[l.length-1];if(s!==0)for(let h=0,d=l.length;h<d;++h)l[h]-=s;const c=new ks(t.slice(s,u),e,l);r.push(c),s=u}return r}getType(){return"MultiPolygon"}intersectsExtent(e){return pU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=lU(this.flatCoordinates,0,e,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const r=n[n.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}class hH extends cH{constructor(e){e=e||{},super(),this.dataProjection=Vt(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Vt(e.featureProjection)),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let n=null;e.type==="Feature"?n=e:n={type:"Feature",geometry:e,properties:null};const r=$v(n.geometry,t),s=new Qy;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in n!==void 0&&s.setGeometryName(n.geometry_name),s.setGeometry(r),"id"in n&&s.setId(n.id),n.properties&&s.setProperties(n.properties,!0),s}readFeaturesFromObject(e,t){const n=e;let r=null;if(n.type==="FeatureCollection"){const s=e;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a)r.push(this.readFeatureFromObject(o[a],t))}else r=[this.readFeatureFromObject(e,t)];return r}readGeometryFromObject(e,t){return $v(e,t)}readProjectionFromObject(e){const t=e.crs;let n;if(t)if(t.type=="name")n=Vt(t.properties.name);else if(t.type==="EPSG")n=Vt("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else n=this.dataProjection;return n}writeFeatureObject(e,t){t=this.adaptOptions(t);const n={type:"Feature",geometry:null,properties:null},r=e.getId();if(r!==void 0&&(n.id=r),!e.hasProperties())return n;const s=e.getProperties(),o=e.getGeometry();return o&&(n.geometry=jv(o,t),delete s[e.getGeometryName()]),Tg(s)||(n.properties=s),n}writeFeaturesObject(e,t){t=this.adaptOptions(t);const n=[];for(let r=0,s=e.length;r<s;++r)n.push(this.writeFeatureObject(e[r],t));return{type:"FeatureCollection",features:n}}writeGeometryObject(e,t){return jv(e,this.adaptOptions(t))}}function $v(i,e){if(!i)return null;let t;switch(i.type){case"Point":{t=fH(i);break}case"LineString":{t=gH(i);break}case"Polygon":{t=yH(i);break}case"MultiPoint":{t=pH(i);break}case"MultiLineString":{t=AH(i);break}case"MultiPolygon":{t=mH(i);break}case"GeometryCollection":{t=dH(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return qv(t,!1,e)}function dH(i,e){const t=i.geometries.map(function(n){return $v(n,e)});return new _A(t)}function fH(i){return new $a(i.coordinates)}function gH(i){return new Ka(i.coordinates)}function AH(i){return new ad(i.coordinates)}function pH(i){return new ld(i.coordinates)}function mH(i){return new ud(i.coordinates)}function yH(i){return new ks(i.coordinates)}function jv(i,e){i=qv(i,!0,e);const t=i.getType();let n;switch(t){case"Point":{n=wH(i);break}case"LineString":{n=EH(i);break}case"Polygon":{n=xH(i,e);break}case"MultiPoint":{n=_H(i);break}case"MultiLineString":{n=IH(i);break}case"MultiPolygon":{n=CH(i,e);break}case"GeometryCollection":{n=vH(i,e);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return n}function vH(i,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(n){return jv(n,e)})}}function EH(i,e){return{type:"LineString",coordinates:i.getCoordinates()}}function IH(i,e){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function _H(i,e){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function CH(i,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(t)}}function wH(i,e){return{type:"Point",coordinates:i.getCoordinates()}}function xH(i,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(t)}}const qT=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],$T={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class bH extends AA{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.on,this.once,this.un,this.keys_=e.keys!==void 0?e.keys:!1,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=e.className!==void 0?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=e.activeClassName!==void 0?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=e.inactiveClassName!==void 0?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const t=e.label!==void 0?e.label:"⤢";this.labelNode_=typeof t=="string"?document.createTextNode(t):t;const n=e.labelActive!==void 0?e.labelActive:"×";this.labelActiveNode_=typeof n=="string"?document.createTextNode(n):n;const r=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=r,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener($e.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${Uh} ${Zg}`,this.element.appendChild(this.button_)}handleClick_(e){e.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const e=this.getMap();if(!e)return;const t=e.getOwnerDocument();if(jT(t))if(WT(t))TH(t);else{let n;this.source_?n=typeof this.source_=="string"?t.getElementById(this.source_):this.source_:n=e.getTargetElement(),this.keys_?SH(n):KT(n)}}handleFullScreenChange_(){const e=this.getMap();if(!e)return;const t=this.isInFullscreen_;this.isInFullscreen_=WT(e.getOwnerDocument()),t!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(Kg(this.labelActiveNode_,this.labelNode_),this.dispatchEvent($T.ENTERFULLSCREEN)):(Kg(this.labelNode_,this.labelActiveNode_),this.dispatchEvent($T.LEAVEFULLSCREEN)),e.updateSize())}setClassName_(e,t){t?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_))}setMap(e){const t=this.getMap();t&&t.removeChangeListener(Si.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(Si.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const e=this.documentListeners_;for(let n=0,r=e.length;n<r;++n)Ot(e[n]);e.length=0;const t=this.getMap();if(t){const n=t.getOwnerDocument();jT(n)?this.element.classList.remove(RS):this.element.classList.add(RS);for(let r=0,s=qT.length;r<s;++r)e.push(Et(n,qT[r],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}function jT(i){const e=i.body;return!!(e.webkitRequestFullscreen||e.requestFullscreen&&i.fullscreenEnabled)}function WT(i){return!!(i.webkitIsFullScreen||i.fullscreenElement)}function KT(i){i.requestFullscreen?i.requestFullscreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}function SH(i){i.webkitRequestFullscreen?i.webkitRequestFullscreen():KT(i)}function TH(i){i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()}const BH={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},RH={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class LH extends NT{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.tmpTransform_=Yi()}prepareTile(e,t,n){let r;const s=e.getState();return(s===pe.LOADED||s===pe.ERROR)&&(this.updateExecutorGroup_(e,t,n),this.tileImageNeedsRender_(e)&&(r=!0)),r}getTile(e,t,n,r){const s=r.pixelRatio,o=r.viewState,a=o.resolution,l=o.projection,u=this.getLayer(),c=u.getSource().getTile(e,t,n,s,l),h=r.viewHints,d=!(h[bi.ANIMATING]||h[bi.INTERACTING]);return(d||!c.wantedResolution)&&(c.wantedResolution=a),this.prepareTile(c,s,l)&&(d||Date.now()-r.time<8)&&u.getRenderMode()!=="vector"&&this.renderTileImage_(c,r),super.getTile(e,t,n,r)}isDrawableTile(e){const t=this.getLayer();return super.isDrawableTile(e)&&(t.getRenderMode()==="vector"?nt(t)in e.executorGroups:e.hasContext(t))}getTileImage(e){return e.getImage(this.getLayer())}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,n){const r=this.getLayer(),s=r.getRevision(),o=r.getRenderOrder()||null,a=e.wantedResolution,l=e.getReplayState(r);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedRenderOrder==o)return;const u=r.getSource(),c=r.getDeclutter(),h=u.getTileGrid(),g=u.getTileGridForProjection(n).getTileCoordExtent(e.wrappedTileCoord),A=u.getSourceTiles(t,n,e),p=nt(r);delete e.hitDetectionImageData[p],e.executorGroups[p]=[],c&&(e.declutterExecutorGroups[p]=[]),l.dirty=!1;for(let y=0,v=A.length;y<v;++y){const E=A[y];if(E.getState()!=pe.LOADED)continue;const I=E.tileCoord,C=h.getTileCoordExtent(I),w=Cn(g,C),S=Ua(w,r.getRenderBuffer()*a,this.tmpExtent),x=Pg(C,w)?null:S,T=new cT(0,S,a,t),Q=c?new cT(0,w,a,t):void 0,M=JG(a,t),R=function(G){let j;const V=G.getStyleFunction()||r.getStyleFunction();if(V&&(j=V(G,a)),j){const Z=this.renderFeature(G,M,j,T,Q);l.dirty=l.dirty||Z}},z=E.getFeatures();o&&o!==l.renderedRenderOrder&&z.sort(o);for(let G=0,j=z.length;G<j;++G){const V=z[G];(!x||vi(x,V.getGeometry().getExtent()))&&R.call(this,V)}const q=T.finish(),X=r.getRenderMode()!=="vector"&&c&&A.length===1?null:w,N=new gT(X,a,t,u.getOverlaps(),q,r.getRenderBuffer());if(e.executorGroups[p].push(N),Q){const G=new gT(null,a,t,u.getOverlaps(),Q.finish(),r.getRenderBuffer());e.declutterExecutorGroups[p].push(G)}}l.renderedRevision=s,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(e,t,n,r,s){const o=t.viewState.resolution,a=t.viewState.rotation;n=n??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(t.viewState.projection),h=kg([e]);Ua(h,o*n,h);const d={},g=function(y,v,E){let I=y.getId();I===void 0&&(I=nt(y));const C=d[I];if(C){if(C!==!0&&E<C.distanceSq){if(E===0)return d[I]=!0,s.splice(s.lastIndexOf(C),1),r(y,l,v);C.geometry=v,C.distanceSq=E}}else{if(E===0)return d[I]=!0,r(y,l,v);s.push(d[I]={feature:y,layer:l,geometry:v,distanceSq:E,callback:r})}},A=this.renderedTiles;let p;for(let y=0,v=A.length;!p&&y<v;++y){const E=A[y],I=c.getTileCoordExtent(E.wrappedTileCoord);if(!vi(I,h))continue;const C=nt(l),w=[E.executorGroups[C]],S=E.declutterExecutorGroups[C];S&&w.push(S),w.some(x=>{const T=x===S?t.declutterTree.all().map(Q=>Q.value):null;for(let Q=0,M=x.length;Q<M;++Q)if(p=x[Q].forEachFeatureAtCoordinate(e,o,a,n,g,T),p)return!0})}return p}getFeatures(e){return new Promise((t,n)=>{const r=this.getLayer(),s=nt(r),o=r.getSource(),a=this.renderedProjection,l=a.getExtent(),u=this.renderedResolution,c=o.getTileGridForProjection(a),h=yi(this.renderedPixelToCoordinateTransform_,e.slice()),d=c.getTileCoordForCoordAndResolution(h,u);let g;for(let I=0,C=this.renderedTiles.length;I<C;++I)if(d.toString()===this.renderedTiles[I].tileCoord.toString()){if(g=this.renderedTiles[I],g.getState()===pe.LOADED){const w=c.getTileCoordExtent(g.tileCoord);o.getWrapX()&&a.canWrapX()&&!Hb(l,w)&&Zb(h,a);break}g=void 0}if(!g||g.loadingSourceTiles>0){t([]);return}const A=c.getTileCoordExtent(g.wrappedTileCoord),p=Ro(A),y=[(h[0]-p[0])/u,(p[1]-h[1])/u],v=g.getSourceTiles().reduce(function(I,C){return I.concat(C.getFeatures())},[]);let E=g.hitDetectionImageData[s];if(!E){const I=ai(c.getTileSize(c.getZForResolution(u,o.zDirection))),C=this.renderedRotation_,w=[this.getRenderTransform(c.getTileCoordCenter(g.wrappedTileCoord),u,0,Uo,I[0]*Uo,I[1]*Uo,0)];E=YG(I,w,v,r.getStyleFunction(),c.getTileCoordExtent(g.wrappedTileCoord),g.getReplayState(r).renderedResolution,C),g.hitDetectionImageData[s]=E}t(ZG(y,v,E))})}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e){const t=this.context,n=t.globalAlpha;t.globalAlpha=this.getLayer().getOpacity();const r=e.viewHints,s=!(r[bi.ANIMATING]||r[bi.INTERACTING]),o=this.renderedTiles;for(let a=0,l=o.length;a<l;++a){const u=o[a],c=u.declutterExecutorGroups[nt(this.getLayer())];if(c)for(let h=c.length-1;h>=0;--h)c[h].execute(this.context,1,this.getTileRenderTransform(u,e),e.viewState.rotation,s,void 0,e.declutterTree)}t.globalAlpha=n}getTileRenderTransform(e,t){const n=t.pixelRatio,r=t.viewState,s=r.center,o=r.resolution,a=r.rotation,l=t.size,u=Math.round(l[0]*n),c=Math.round(l[1]*n),d=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),g=e.tileCoord,A=d.getTileCoordExtent(e.wrappedTileCoord),p=d.getTileCoordExtent(g,this.tmpExtent)[0]-A[0];return Lg(Lh(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(s,o,a,n,u,c,p))}postRender(e,t){const n=t.viewHints,r=!(n[bi.ANIMATING]||n[bi.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;const s=this.getLayer(),o=s.getRenderMode(),a=e.globalAlpha;e.globalAlpha=s.getOpacity();const l=RH[o],u=t.viewState,c=u.rotation,h=s.getSource(),g=h.getTileGridForProjection(u.projection).getZForResolution(u.resolution,h.zDirection),A=this.renderedTiles,p=[],y=[];let v=!0;for(let E=A.length-1;E>=0;--E){const I=A[E];v=v&&!I.getReplayState(s).dirty;const C=I.executorGroups[nt(s)].filter(Q=>Q.hasExecutors(l));if(C.length===0)continue;const w=this.getTileRenderTransform(I,t),S=I.tileCoord[0];let x=!1;const T=C[0].getClipCoords(w);if(T){for(let Q=0,M=p.length;Q<M;++Q)if(g!==S&&S<y[Q]){const R=p[Q];vi([T[0],T[3],T[4],T[7]],[R[0],R[3],R[4],R[7]])&&(x||(e.save(),x=!0),e.beginPath(),e.moveTo(T[0],T[1]),e.lineTo(T[2],T[3]),e.lineTo(T[4],T[5]),e.lineTo(T[6],T[7]),e.moveTo(R[6],R[7]),e.lineTo(R[4],R[5]),e.lineTo(R[2],R[3]),e.lineTo(R[0],R[1]),e.clip())}p.push(T),y.push(S)}for(let Q=0,M=C.length;Q<M;++Q)C[Q].execute(e,1,w,c,r,l);x&&e.restore()}e.globalAlpha=a,this.ready=v,super.postRender(e,t)}renderFeature(e,t,n,r,s){if(!n)return!1;let o=!1;if(Array.isArray(n))for(let a=0,l=n.length;a<l;++a)o=pT(r,e,n[a],t,this.boundHandleStyleImageChange_,void 0,s)||o;else o=pT(r,e,n,t,this.boundHandleStyleImageChange_,void 0,s);return o}tileImageNeedsRender_(e){const t=this.getLayer();if(t.getRenderMode()==="vector")return!1;const n=e.getReplayState(t),r=t.getRevision(),s=e.wantedResolution;return n.renderedTileResolution!==s||n.renderedTileRevision!==r}renderTileImage_(e,t){const n=this.getLayer(),r=e.getReplayState(n),s=n.getRevision(),o=e.executorGroups[nt(n)];r.renderedTileRevision=s;const a=e.wrappedTileCoord,l=a[0],u=n.getSource();let c=t.pixelRatio;const d=t.viewState.projection,g=u.getTileGridForProjection(d),A=g.getResolution(e.tileCoord[0]),p=t.pixelRatio/e.wantedResolution*A,y=g.getResolution(l),v=e.getContext(n);c=Math.round(Math.max(c,p/c));const E=u.getTilePixelSize(l,c,d);v.canvas.width=E[0],v.canvas.height=E[1];const I=c/p;if(I!==1){const x=Hy(this.tmpTransform_);Lh(x,I,I),v.setTransform.apply(v,x)}const C=g.getTileCoordExtent(a,this.tmpExtent),w=p/y,S=Hy(this.tmpTransform_);Lh(S,w,-w),Nb(S,-C[0],-C[3]);for(let x=0,T=o.length;x<T;++x)o[x].execute(v,I,S,0,!0,BH[n.getRenderMode()]);r.renderedTileResolution=e.wantedResolution}}class DH extends MG{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un;const n=e.renderMode||"hybrid";It(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new LH(this)}getFeatures(e){return super.getFeatures(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(qo.PRELOAD)}getUseInterimTilesOnError(){return this.get(qo.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(qo.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(qo.USE_INTERIM_TILES_ON_ERROR,e)}}function wA(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}function Wv(i){return i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Float32Array||i instanceof DataView?i:null}let Tu=null;function kH(i){Tu||(Tu=xi(i.width,i.height,void 0,{willReadFrequently:!0}));const e=Tu.canvas,t=i.width;e.width!==t&&(e.width=t);const n=i.height;return e.height!==n&&(e.height=n),Tu.clearRect(0,0,t,n),Tu.drawImage(i,0,0),Tu.getImageData(0,0,t,n).data}const PH=[256,256];class Kv extends nd{constructor(e){const t=pe.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null}getSize(){if(this.size_)return this.size_;const e=wA(this.data_);return e?[e.width,e.height]:PH}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==pe.IDLE&&this.state!==pe.ERROR)return;this.state=pe.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=pe.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=pe.ERROR,e.changed()})}}class Yv extends Kv{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8Array(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const t=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),n=this.targetTileGrid_.getExtent();let r=this.sourceTileGrid_.getExtent();const s=n?Cn(t,n):t;if(kh(s)===0){this.state=pe.EMPTY;return}const o=e.sourceProj,a=o.getExtent();a&&(r?r=Cn(r,a):r=a);const l=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),u=e.targetProj,c=FT(o,u,s,l);if(!isFinite(c)||c<=0){this.state=pe.EMPTY;return}const h=e.errorThreshold!==void 0?e.errorThreshold:LT;if(this.triangulation_=new kT(o,u,s,r,c*h,l),this.triangulation_.getTriangles().length===0){this.state=pe.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(c);let d=this.triangulation_.calculateSourceExtent();if(r&&(o.canWrapX()?(d[1]=Xt(d[1],r[1],r[3]),d[3]=Xt(d[3],r[1],r[3])):d=Cn(d,r)),!kh(d))this.state=pe.EMPTY;else{const g=this.sourceTileGrid_.getTileRangeForExtentAndZ(d,this.sourceZ_),A=e.getTileFunction;for(let p=g.minX;p<=g.maxX;p++)for(let y=g.minY;y<=g.maxY;y++){const v=A(this.sourceZ_,p,y,this.pixelRatio_);v&&this.sourceTiles_.push(v)}this.sourceTiles_.length===0&&(this.state=pe.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{if(!t||t.getState()!==pe.LOADED)return;const n=t.getSize(),r=this.gutter_;let s;const o=Wv(t.getData());o?s=o:s=kH(wA(t.getData()));const a=[n[0]+2*r,n[1]+2*r],l=s instanceof Float32Array,u=a[0]*a[1],c=l?Float32Array:Uint8Array,h=new c(s.buffer),d=c.BYTES_PER_ELEMENT,g=d*h.length/u,A=h.byteLength/a[1],p=Math.floor(A/d/a[0]),y=u*p;let v=h;if(h.length!==y){v=new c(y);let E=0,I=0;const C=a[0]*p;for(let w=0;w<a[1];++w){for(let S=0;S<C;++S)v[E++]=h[I+S];I+=A/d}}e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),data:new Uint8Array(v.buffer),dataType:c,bytesPerPixel:g,pixelSize:a})}),this.sourceTiles_.length=0,e.length===0)this.state=pe.ERROR;else{const t=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(t),r=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let u,c;const h=e[0].bytesPerPixel,d=Math.ceil(h/3);for(let g=d-1;g>=0;--g){const A=[];for(let C=0,w=e.length;C<w;++C){const S=e[C],x=S.data,T=S.pixelSize,Q=T[0],M=T[1],R=xi(Q,M,Us),z=R.createImageData(Q,M),q=z.data;let X=g*3;for(let N=0,G=q.length;N<G;N+=4)q[N]=x[X],q[N+1]=x[X+1],q[N+2]=x[X+2],q[N+3]=255,X+=h;R.putImageData(z,0,0),A.push({extent:S.extent,image:R.canvas})}const p=OT(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,A,this.gutter_,!1,!1);for(let C=0,w=A.length;C<w;++C){const x=A[C].image.getContext("2d");uu(x),Us.push(x.canvas)}const y=p.getContext("2d"),v=y.getImageData(0,0,p.width,p.height);uu(y),Us.push(p),u||(c=new Uint8Array(h*v.width*v.height),u=new e[0].dataType(c.buffer));const E=v.data;let I=g*3;for(let C=0,w=E.length;C<w;C+=4)E[C+3]===255?(c[I]=E[C],c[I+1]=E[C+1],c[I+2]=E[C+2]):(c[I]=0,c[I+1]=0,c[I+2]=0),I+=h}this.reprojData_=u,this.reprojSize_=[Math.round(r*this.pixelRatio_),Math.round(s*this.pixelRatio_)],this.state=pe.LOADED}this.changed()}load(){if(this.state!==pe.IDLE&&this.state!==pe.ERROR)return;this.state=pe.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const n=t.getState();if(n!==pe.IDLE&&n!==pe.LOADING)return;e++;const r=Et(t,$e.CHANGE,function(){const s=t.getState();(s==pe.LOADED||s==pe.ERROR||s==pe.EMPTY)&&(Ot(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t){t.getState()==pe.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ot),this.sourcesListenerKeys_=null}}class MH extends UT{constructor(e){const t=e.projection===void 0?"EPSG:3857":e.projection;let n=e.tileGrid;n===void 0&&t&&(n=Vv({extent:od(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:n,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?ai(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.tileCacheForProjection_={}}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const t=this.getTileGrid();return t?ai(t.getTileSize(e)):[256,256]}getGutterForProjection(e){const t=this.getProjection();return!t||Cr(t,e)?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,t,n,r,s){const o=this.getTileCacheForProjection(r),a=Vo(e,t,n);if(o.containsKey(a)){const y=o.get(a);if(y&&y.key==this.getKey())return y}const l=this.getTileGrid(),u=Math.max.apply(null,l.getResolutions().map((y,v)=>{const E=ai(l.getTileSize(v)),I=this.getTileSize(v);return Math.max(I[0]/E[0],I[1]/E[1])})),c=this.getTileGridForProjection(s),h=this.getTileGridForProjection(r),d=[e,t,n],g=this.getTileCoordForTileUrlFunction(d,r),A=Object.assign({sourceProj:s,sourceTileGrid:c,targetProj:r,targetTileGrid:h,tileCoord:d,wrappedTileCoord:g,pixelRatio:u,gutter:this.getGutterForProjection(s),getTileFunction:(y,v,E,I)=>this.getTile(y,v,E,I,s)},this.tileOptions),p=new Yv(A);return p.key=this.getKey(),p}getTile(e,t,n,r,s){const o=this.getProjection();if(o&&s&&!Cr(o,s))return this.getReprojTile_(e,t,n,s,o);const a=this.getTileSize(e),l=Vo(e,t,n);if(this.tileCache.containsKey(l))return this.tileCache.get(l);const u=this.loader_;function c(){return g5(function(){return u(e,t,n)})}const h=Object.assign({tileCoord:[e,t,n],loader:c,size:a},this.tileOptions),d=new Kv(h);return d.key=this.getKey(),d.addEventListener($e.CHANGE,this.handleTileChange_),this.tileCache.set(l,d),d}handleTileChange_(e){const t=e.target,n=nt(t),r=t.getState();let s;r==pe.LOADING?(this.tileLoadingKeys_[n]=!0,s=bu.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=r==pe.ERROR?bu.TILELOADERROR:r==pe.LOADED?bu.TILELOADEND:void 0),s&&this.dispatchEvent(new GT(s,t))}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Cr(t,e)))return this.tileGrid;const n=nt(e);return n in this.tileGridForProjection_||(this.tileGridForProjection_[n]=zv(e)),this.tileGridForProjection_[n]}setTileGridForProjection(e,t){const n=Vt(e);if(n){const r=nt(n);r in this.tileGridForProjection_||(this.tileGridForProjection_[r]=t)}}getTileCacheForProjection(e){const t=this.getProjection();if(!t||Cr(t,e))return this.tileCache;const n=nt(e);return n in this.tileCacheForProjection_||(this.tileCacheForProjection_[n]=new yA(.1)),this.tileCacheForProjection_[n]}expireCache(e,t){const n=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==n?t:{});for(const r in this.tileCacheForProjection_){const s=this.tileCacheForProjection_[r];s.expireCache(s==n?t:{})}}clear(){super.clear();for(const e in this.tileCacheForProjection_)this.tileCacheForProjection_[e].clear()}}class FH extends IA{constructor(e){const t=e.projection||"EPSG:3857",n=e.extent||od(t),r=e.tileGrid||Vv({extent:n,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,opaque:!1,projection:t,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:OH,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.sourceTileCache=new yA(this.tileCache.highWaterMark),this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:Y9,this.tileGrids_={}}getFeaturesInExtent(e){const t=[],n=this.tileCache;if(n.getCount()===0)return t;const r=TT(n.peekFirstKey())[0],s=this.tileGrid;return n.forEach(function(o){if(o.tileCoord[0]!==r||o.getState()!==pe.LOADED)return;const a=o.getSourceTiles();for(let l=0,u=a.length;l<u;++l){const c=a[l],h=c.tileCoord;if(vi(e,s.getTileCoordExtent(h))){const d=c.getFeatures();if(d)for(let g=0,A=d.length;g<A;++g){const p=d[g],y=p.getGeometry();vi(e,y.getExtent())&&t.push(p)}}}}),t}getOverlaps(){return this.overlaps_}clear(){this.tileCache.clear(),this.sourceTileCache.clear()}expireCache(e,t){const n=this.getTileCacheForProjection(e),r=Object.keys(t).reduce((s,o)=>{const a=$9(o),l=n.peek(a);if(l){const u=l.sourceTiles;for(let c=0,h=u.length;c<h;++c)s[u[c].getKey()]=!0}return s},{});super.expireCache(e,t),this.sourceTileCache.expireCache(r)}getSourceTiles(e,t,n){if(n.getState()===pe.IDLE){n.setState(pe.LOADING);const r=n.wrappedTileCoord,s=this.getTileGridForProjection(t),o=s.getTileCoordExtent(r),a=r[0],l=s.getResolution(a);Ua(o,-l,o);const u=this.tileGrid,c=u.getExtent();c&&Cn(o,c,o);const h=u.getZForResolution(l,this.zDirection);u.forEachTileCoord(o,h,d=>{const g=this.tileUrlFunction(d,e,t),A=this.sourceTileCache.containsKey(g)?this.sourceTileCache.get(g):new this.tileClass(d,g?pe.IDLE:pe.EMPTY,g,this.format_,this.tileLoadFunction);n.sourceTiles.push(A);const p=A.getState();if(p<pe.LOADED){const y=v=>{this.handleTileChange(v);const E=A.getState();if(E===pe.LOADED||E===pe.ERROR){const I=A.getKey();I in n.errorTileKeys?A.getState()===pe.LOADED&&delete n.errorTileKeys[I]:n.loadingSourceTiles--,E===pe.ERROR?n.errorTileKeys[I]=!0:A.removeEventListener($e.CHANGE,y),n.loadingSourceTiles===0&&n.setState(Tg(n.errorTileKeys)?pe.LOADED:pe.ERROR)}};A.addEventListener($e.CHANGE,y),n.loadingSourceTiles++}p===pe.IDLE&&(A.extent=u.getTileCoordExtent(d),A.projection=t,A.resolution=u.getResolution(d[0]),this.sourceTileCache.set(g,A),A.load())}),n.loadingSourceTiles||n.setState(n.sourceTiles.some(d=>d.getState()===pe.ERROR)?pe.ERROR:pe.LOADED)}return n.sourceTiles}getTile(e,t,n,r,s){const o=Vo(e,t,n),a=this.getKey();let l;if(this.tileCache.containsKey(o)&&(l=this.tileCache.get(o),l.key===a))return l;const u=[e,t,n];let c=this.getTileCoordForTileUrlFunction(u,s);const h=this.getTileGrid().getExtent(),d=this.getTileGridForProjection(s);if(c&&h){const p=d.getTileCoordExtent(c);Ua(p,-d.getResolution(e),p),vi(h,p)||(c=null)}let g=!0;if(c!==null){const p=this.tileGrid,y=d.getResolution(e),v=p.getZForResolution(y,1),E=d.getTileCoordExtent(c);Ua(E,-y,E),p.forEachTileCoord(E,v,I=>{g=g&&!this.tileUrlFunction(I,r,s)})}const A=new K9(u,g?pe.EMPTY:pe.IDLE,c,this.getSourceTiles.bind(this,r,s));return A.key=a,l?(A.interimTile=l,A.refreshInterimChain(),this.tileCache.replace(o,A)):this.tileCache.set(o,A),A}getTileGridForProjection(e){const t=e.getCode();let n=this.tileGrids_[t];if(!n){const r=this.tileGrid,s=r.getResolutions().slice(),o=s.map(function(u,c){return r.getOrigin(c)}),a=s.map(function(u,c){return r.getTileSize(c)}),l=QS+1;for(let u=s.length;u<l;++u)s.push(s[u-1]/2),o.push(o[u-1]),a.push(a[u-1]);n=new EA({extent:r.getExtent(),origins:o,resolutions:s,tileSizes:a}),this.tileGrids_[t]=n}return n}getTilePixelRatio(e){return e}getTilePixelSize(e,t,n){const r=this.getTileGridForProjection(n),s=ai(r.getTileSize(e),this.tmpSize);return[Math.round(s[0]*t),Math.round(s[1]*t)]}updateCacheSize(e,t){super.updateCacheSize(e*2,t),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(t).highWaterMark}}function OH(i,e){i.setLoader(function(t,n,r){d9(e,i.getFormat(),t,n,r,i.onLoad.bind(i),i.onError.bind(i))})}var We=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jo(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function NH(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var r=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return i[n]}})}),t}var Zv={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Zv.read=function(i,e,t,n,r){var s,o,a=r*8-n-1,l=(1<<a)-1,u=l>>1,c=-7,h=t?r-1:0,d=t?-1:1,g=i[e+h];for(h+=d,s=g&(1<<-c)-1,g>>=-c,c+=a;c>0;s=s*256+i[e+h],h+=d,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=n;c>0;o=o*256+i[e+h],h+=d,c-=8);if(s===0)s=1-u;else{if(s===l)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(g?-1:1)*o*Math.pow(2,s-n)},Zv.write=function(i,e,t,n,r,s){var o,a,l,u=s*8-r-1,c=(1<<u)-1,h=c>>1,d=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:s-1,A=n?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=d/l:e+=d*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=c?(a=0,o=c):o+h>=1?(a=(e*l-1)*Math.pow(2,r),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;i[t+g]=a&255,g+=A,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;i[t+g]=o&255,g+=A,o/=256,u-=8);i[t+g-A]|=p*128};var QH=St,xA=Zv;function St(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}St.Varint=0,St.Fixed64=1,St.Bytes=2,St.Fixed32=5;var Xv=65536*65536,YT=1/Xv,UH=12,ZT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");St.prototype={destroy:function(){this.buf=null},readFields:function(i,e,t){for(t=t||this.length;this.pos<t;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=n&7,i(r,e,this),this.pos===s&&this.skip(n)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=bA(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=JT(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=bA(this.buf,this.pos)+bA(this.buf,this.pos+4)*Xv;return this.pos+=8,i},readSFixed64:function(){var i=bA(this.buf,this.pos)+JT(this.buf,this.pos+4)*Xv;return this.pos+=8,i},readFloat:function(){var i=xA.read(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=xA.read(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e=this.buf,t,n;return n=e[this.pos++],t=n&127,n<128||(n=e[this.pos++],t|=(n&127)<<7,n<128)||(n=e[this.pos++],t|=(n&127)<<14,n<128)||(n=e[this.pos++],t|=(n&127)<<21,n<128)?t:(n=e[this.pos],t|=(n&15)<<28,GH(t,i,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2===1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=UH&&ZT?t7(this.buf,e,i):e7(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==St.Bytes)return i.push(this.readVarint(e));var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==St.Bytes)return i.push(this.readSVarint());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==St.Bytes)return i.push(this.readBoolean());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==St.Bytes)return i.push(this.readFloat());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==St.Bytes)return i.push(this.readDouble());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==St.Bytes)return i.push(this.readFixed32());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==St.Bytes)return i.push(this.readSFixed32());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==St.Bytes)return i.push(this.readFixed64());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==St.Bytes)return i.push(this.readSFixed64());var e=Gs(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=i&7;if(e===St.Varint)for(;this.buf[this.pos++]>127;);else if(e===St.Bytes)this.pos=this.readVarint()+this.pos;else if(e===St.Fixed32)this.pos+=4;else if(e===St.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var t=new Uint8Array(e);t.set(this.buf),this.buf=t,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Ru(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Ru(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Ru(this.buf,i&-1,this.pos),Ru(this.buf,Math.floor(i*YT),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Ru(this.buf,i&-1,this.pos),Ru(this.buf,Math.floor(i*YT),this.pos+4),this.pos+=8},writeVarint:function(i){if(i=+i||0,i>268435455||i<0){HH(i,this);return}this.realloc(4),this.buf[this.pos++]=i&127|(i>127?128:0),!(i<=127)&&(this.buf[this.pos++]=(i>>>=7)&127|(i>127?128:0),!(i<=127)&&(this.buf[this.pos++]=(i>>>=7)&127|(i>127?128:0),!(i<=127)&&(this.buf[this.pos++]=i>>>7&127)))},writeSVarint:function(i){this.writeVarint(i<0?-i*2-1:i*2)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(i.length*4),this.pos++;var e=this.pos;this.pos=i7(this.buf,i,this.pos);var t=this.pos-e;t>=128&&XT(e,t,this),this.pos=e-1,this.writeVarint(t),this.pos+=t},writeFloat:function(i){this.realloc(4),xA.write(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),xA.write(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var t=0;t<e;t++)this.buf[this.pos++]=i[t]},writeRawMessage:function(i,e){this.pos++;var t=this.pos;i(e,this);var n=this.pos-t;n>=128&&XT(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeMessage:function(i,e,t){this.writeTag(i,St.Bytes),this.writeRawMessage(e,t)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,qH,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,$H,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,KH,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,jH,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,WH,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,YH,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,ZH,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,XH,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,JH,e)},writeBytesField:function(i,e){this.writeTag(i,St.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,St.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,St.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,St.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,St.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,St.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,St.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,St.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,St.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,St.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};function GH(i,e,t){var n=t.buf,r,s;if(s=n[t.pos++],r=(s&112)>>4,s<128||(s=n[t.pos++],r|=(s&127)<<3,s<128)||(s=n[t.pos++],r|=(s&127)<<10,s<128)||(s=n[t.pos++],r|=(s&127)<<17,s<128)||(s=n[t.pos++],r|=(s&127)<<24,s<128)||(s=n[t.pos++],r|=(s&1)<<31,s<128))return Bu(i,r,e);throw new Error("Expected varint not more than 10 bytes")}function Gs(i){return i.type===St.Bytes?i.readVarint()+i.pos:i.pos+1}function Bu(i,e,t){return t?e*4294967296+(i>>>0):(e>>>0)*4294967296+(i>>>0)}function HH(i,e){var t,n;if(i>=0?(t=i%4294967296|0,n=i/4294967296|0):(t=~(-i%4294967296),n=~(-i/4294967296),t^4294967295?t=t+1|0:(t=0,n=n+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),zH(t,n,e),VH(n,e)}function zH(i,e,t){t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos++]=i&127|128,i>>>=7,t.buf[t.pos]=i&127}function VH(i,e){var t=(i&7)<<4;e.buf[e.pos++]|=t|((i>>>=3)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127|((i>>>=7)?128:0),i&&(e.buf[e.pos++]=i&127)))))}function XT(i,e,t){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(n);for(var r=t.pos-1;r>=i;r--)t.buf[r+n]=t.buf[r]}function qH(i,e){for(var t=0;t<i.length;t++)e.writeVarint(i[t])}function $H(i,e){for(var t=0;t<i.length;t++)e.writeSVarint(i[t])}function jH(i,e){for(var t=0;t<i.length;t++)e.writeFloat(i[t])}function WH(i,e){for(var t=0;t<i.length;t++)e.writeDouble(i[t])}function KH(i,e){for(var t=0;t<i.length;t++)e.writeBoolean(i[t])}function YH(i,e){for(var t=0;t<i.length;t++)e.writeFixed32(i[t])}function ZH(i,e){for(var t=0;t<i.length;t++)e.writeSFixed32(i[t])}function XH(i,e){for(var t=0;t<i.length;t++)e.writeFixed64(i[t])}function JH(i,e){for(var t=0;t<i.length;t++)e.writeSFixed64(i[t])}function bA(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+i[e+3]*16777216}function Ru(i,e,t){i[t]=e,i[t+1]=e>>>8,i[t+2]=e>>>16,i[t+3]=e>>>24}function JT(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}function e7(i,e,t){for(var n="",r=e;r<t;){var s=i[r],o=null,a=s>239?4:s>223?3:s>191?2:1;if(r+a>t)break;var l,u,c;a===1?s<128&&(o=s):a===2?(l=i[r+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=i[r+1],u=i[r+2],(l&192)===128&&(u&192)===128&&(o=(s&15)<<12|(l&63)<<6|u&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=i[r+1],u=i[r+2],c=i[r+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(o=(s&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),r+=a}return n}function t7(i,e,t){return ZT.decode(i.subarray(e,t))}function i7(i,e,t){for(var n=0,r,s;n<e.length;n++){if(r=e.charCodeAt(n),r>55295&&r<57344)if(s)if(r<56320){i[t++]=239,i[t++]=191,i[t++]=189,s=r;continue}else r=s-55296<<10|r-56320|65536,s=null;else{r>56319||n+1===e.length?(i[t++]=239,i[t++]=191,i[t++]=189):s=r;continue}else s&&(i[t++]=239,i[t++]=191,i[t++]=189,s=null);r<128?i[t++]=r:(r<2048?i[t++]=r>>6|192:(r<65536?i[t++]=r>>12|224:(i[t++]=r>>18|240,i[t++]=r>>12&63|128),i[t++]=r>>6&63|128),i[t++]=r&63|128)}return t}const n7=jo(QH),eB=Yi();class Lu{constructor(e,t,n,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n,this.properties_=r}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?zb(this.flatCoordinates_):qy(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Bo(this.getExtent());this.flatInteriorPoints_=hv(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=VT(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=gS(this.flatCoordinates_,0,this.ends_,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=jg(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const n=this.ends_;for(let r=0,s=n.length;r<s;++r){const o=n[r],a=jg(e,t,o,2,.5);Rs(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return 2}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Vt(e);const t=e.getExtent(),n=e.getWorldExtent();if(t&&n){const r=rr(n)/rr(t);_r(eB,n[0],n[3],r,-r,0,0,0),Do(this.flatCoordinates_,0,this.flatCoordinates_.length,2,eB,this.flatCoordinates_)}}getEnds(){return this.ends_}}Lu.prototype.getEndss=Lu.prototype.getEnds,Lu.prototype.getFlatCoordinates=Lu.prototype.getOrientedFlatCoordinates;class r7 extends zT{constructor(e){super(),e=e||{},this.dataProjection=new Ph({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:Lu,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,n,r){e.pos=t.geometry;const s=e.readVarint()+e.pos;let o=1,a=0,l=0,u=0,c=0,h=0;for(;e.pos<s;){if(!a){const d=e.readVarint();o=d&7,a=d>>3}if(a--,o===1||o===2)l+=e.readSVarint(),u+=e.readSVarint(),o===1&&c>h&&(r.push(c),h=c),n.push(l,u),c+=2;else if(o===7)c>h&&(n.push(n[h],n[h+1]),c+=2);else throw new Error("Invalid command found in the PBF")}c>h&&(r.push(c),h=c)}createFeature_(e,t,n){const r=t.type;if(r===0)return null;let s;const o=t.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=t.id,o[this.layerName_]=t.layer.name;const l=[],u=[];this.readRawGeometry_(e,t,l,u);const c=u7(r,u.length);if(this.featureClass_===Lu)s=new this.featureClass_(c,l,u,o,a),s.transform(n.dataProjection);else{let h;if(c=="Polygon"){const A=vU(l,u);h=A.length>1?new ud(l,"XY",A):new ks(l,"XY",u)}else h=c==="Point"?new $a(l,"XY"):c==="LineString"?new Ka(l,"XY"):c==="MultiPoint"?new ld(l,"XY"):c==="MultiLineString"?new ad(l,"XY",u):null;const d=this.featureClass_;s=new d,this.geometryName_&&s.setGeometryName(this.geometryName_);const g=qv(h,!1,n);s.setGeometry(g),a!==void 0&&s.setId(a),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(e,t){const n=this.layers_;t=this.adaptOptions(t);const r=Vt(t.dataProjection);r.setWorldExtent(t.extent),t.dataProjection=r;const s=new n7(e),o=s.readFields(s7,{}),a=[];for(const l in o){if(n&&!n.includes(l))continue;const u=o[l],c=u?[0,0,u.extent,u.extent]:null;r.setExtent(c);for(let h=0,d=u.length;h<d;++h){const g=l7(s,u,h),A=this.createFeature_(s,g,t);A!==null&&a.push(A)}}return a}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function s7(i,e,t){if(i===3){const n={keys:[],values:[],features:[]},r=t.readVarint()+t.pos;t.readFields(o7,n,r),n.length=n.features.length,n.length&&(e[n.name]=n)}}function o7(i,e,t){if(i===15)e.version=t.readVarint();else if(i===1)e.name=t.readString();else if(i===5)e.extent=t.readVarint();else if(i===2)e.features.push(t.pos);else if(i===3)e.keys.push(t.readString());else if(i===4){let n=null;const r=t.readVarint()+t.pos;for(;t.pos<r;)i=t.readVarint()>>3,n=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null;e.values.push(n)}}function a7(i,e,t){if(i==1)e.id=t.readVarint();else if(i==2){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e.layer.keys[t.readVarint()],s=e.layer.values[t.readVarint()];e.properties[r]=s}}else i==3?e.type=t.readVarint():i==4&&(e.geometry=t.pos)}function l7(i,e,t){i.pos=e.features[t];const n=i.readVarint()+i.pos,r={layer:e,type:0,properties:{}};return i.readFields(a7,r,n),r}function u7(i,e){let t;return i===1?t=e===1?"Point":"MultiPoint":i===2?t=e===1?"LineString":"MultiLineString":i===3&&(t="Polygon"),t}var cn=(i,e,t)=>new Promise((n,r)=>{var s=l=>{try{a(t.next(l))}catch(u){r(u)}},o=l=>{try{a(t.throw(l))}catch(u){r(u)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,o);a((t=t.apply(i,e)).next())}),zn=Uint8Array,cd=Uint16Array,c7=Int32Array,tB=new zn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),iB=new zn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h7=new zn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nB=function(i,e){for(var t=new cd(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new c7(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return{b:t,r}},rB=nB(tB,2),sB=rB.b,d7=rB.r;sB[28]=258,d7[258]=28;var f7=nB(iB,0),g7=f7.b,oB=new cd(32768);for(Tt=0;Tt<32768;++Tt)Hs=(Tt&43690)>>1|(Tt&21845)<<1,Hs=(Hs&52428)>>2|(Hs&13107)<<2,Hs=(Hs&61680)>>4|(Hs&3855)<<4,oB[Tt]=((Hs&65280)>>8|(Hs&255)<<8)>>1;var Hs,Tt,hd=function(i,e,t){for(var n=i.length,r=0,s=new cd(e);r<n;++r)i[r]&&++s[i[r]-1];var o=new cd(e);for(r=1;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;{a=new cd(1<<e);var l=15-e;for(r=0;r<n;++r)if(i[r])for(var u=r<<4|i[r],c=e-i[r],h=o[i[r]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)a[oB[h]>>l]=u}return a},dd=new zn(288);for(Tt=0;Tt<144;++Tt)dd[Tt]=8;var Tt;for(Tt=144;Tt<256;++Tt)dd[Tt]=9;var Tt;for(Tt=256;Tt<280;++Tt)dd[Tt]=7;var Tt;for(Tt=280;Tt<288;++Tt)dd[Tt]=8;var Tt,aB=new zn(32);for(Tt=0;Tt<32;++Tt)aB[Tt]=5;var Tt,A7=hd(dd,9),p7=hd(aB,5),Jv=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},br=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},eE=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},m7=function(i){return(i+7)/8|0},y7=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new zn(t-e);return n.set(i.subarray(e,t)),n},v7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Vn=function(i,e,t){var n=new Error(e||v7[i]);if(n.code=i,Error.captureStackTrace&&Error.captureStackTrace(n,Vn),!t)throw n;return n},tE=function(i,e,t,n){var r=i.length,s=0;if(!r||e.f&&!e.l)return t||new zn(0);var o=!t||e.i!=2,a=e.i;t||(t=new zn(r*3));var l=function(Re){var Qe=t.length;if(Re>Qe){var Oe=new zn(Math.max(Qe*2,Re));Oe.set(t),t=Oe}},u=e.f||0,c=e.p||0,h=e.b||0,d=e.l,g=e.d,A=e.m,p=e.n,y=r*8;do{if(!d){u=br(i,c,1);var v=br(i,c+1,3);if(c+=3,v)if(v==1)d=A7,g=p7,A=9,p=5;else if(v==2){var w=br(i,c,31)+257,S=br(i,c+10,15)+4,x=w+br(i,c+5,31)+1;c+=14;for(var T=new zn(x),Q=new zn(19),M=0;M<S;++M)Q[h7[M]]=br(i,c+M*3,7);c+=S*3;for(var R=Jv(Q),z=(1<<R)-1,q=hd(Q,R),M=0;M<x;){var X=q[br(i,c,z)];c+=X&15;var E=X>>4;if(E<16)T[M++]=E;else{var N=0,G=0;for(E==16?(G=3+br(i,c,3),c+=2,N=T[M-1]):E==17?(G=3+br(i,c,7),c+=3):E==18&&(G=11+br(i,c,127),c+=7);G--;)T[M++]=N}}var j=T.subarray(0,w),V=T.subarray(w);A=Jv(j),p=Jv(V),d=hd(j,A),g=hd(V,p)}else Vn(1);else{var E=m7(c)+4,I=i[E-4]|i[E-3]<<8,C=E+I;if(C>r){a&&Vn(0);break}o&&l(h+I),t.set(i.subarray(E,C),h),e.b=h+=I,e.p=c=C*8,e.f=u;continue}if(c>y){a&&Vn(0);break}}o&&l(h+131072);for(var Z=(1<<A)-1,Y=(1<<p)-1,te=c;;te=c){var N=d[eE(i,c)&Z],J=N>>4;if(c+=N&15,c>y){a&&Vn(0);break}if(N||Vn(2),J<256)t[h++]=J;else if(J==256){te=c,d=null;break}else{var ce=J-254;if(J>264){var M=J-257,ie=tB[M];ce=br(i,c,(1<<ie)-1)+sB[M],c+=ie}var ne=g[eE(i,c)&Y],ue=ne>>4;ne||Vn(3),c+=ne&15;var V=g7[ue];if(ue>3){var ie=iB[ue];V+=eE(i,c)&(1<<ie)-1,c+=ie}if(c>y){a&&Vn(0);break}o&&l(h+131072);var fe=h+ce;if(h<V){var me=s-V,Pe=Math.min(V,fe);for(me+h<0&&Vn(3);h<Pe;++h)t[h]=n[me+h]}for(;h<fe;h+=4)t[h]=t[h-V],t[h+1]=t[h+1-V],t[h+2]=t[h+2-V],t[h+3]=t[h+3-V];h=fe}}e.l=d,e.p=te,e.b=h,e.f=u,d&&(u=1,e.m=A,e.d=g,e.n=p)}while(!u);return h==t.length?t:y7(t,0,h)},E7=new zn(0),I7=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&Vn(6,"invalid gzip data");var e=i[3],t=10;e&4&&(t+=(i[10]|i[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!i[t++]);return t+(e&2)},_7=function(i){var e=i.length;return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0},C7=function(i,e){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&Vn(6,"invalid zlib data"),(i[1]>>5&1)==+!e&&Vn(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function w7(i,e){return tE(i,{i:2},e,e)}function x7(i,e){var t=I7(i);return t+8>i.length&&Vn(6,"invalid gzip data"),tE(i.subarray(t,-8),{i:2},new zn(_7(i)),e)}function b7(i,e){return tE(i.subarray(C7(i,e),-4),{i:2},e,e)}function iE(i,e){return i[0]==31&&i[1]==139&&i[2]==8?x7(i,e):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?w7(i,e):b7(i,e)}var S7=typeof TextDecoder<"u"&&new TextDecoder,T7=0;try{S7.decode(E7,{stream:!0}),T7=1}catch{}var lB=(i,e)=>i*Math.pow(2,e),fd=(i,e)=>Math.floor(i/Math.pow(2,e)),SA=(i,e)=>lB(i.getUint16(e+1,!0),8)+i.getUint8(e),uB=(i,e)=>lB(i.getUint32(e+2,!0),16)+i.getUint16(e,!0),B7=(i,e,t,n,r)=>{if(i!=n.getUint8(r))return i-n.getUint8(r);const s=SA(n,r+1);if(e!=s)return e-s;const o=SA(n,r+4);return t!=o?t-o:0},R7=(i,e,t,n)=>{const r=hB(i,e|128,t,n);return r?{z:e,x:t,y:n,offset:r[0],length:r[1],is_dir:!0}:null},cB=(i,e,t,n)=>{const r=hB(i,e,t,n);return r?{z:e,x:t,y:n,offset:r[0],length:r[1],is_dir:!1}:null},hB=(i,e,t,n)=>{let r=0,s=i.byteLength/17-1;for(;r<=s;){const o=s+r>>1,a=B7(e,t,n,i,o*17);if(a>0)r=o+1;else if(a<0)s=o-1;else return[uB(i,o*17+7),i.getUint32(o*17+13,!0)]}return null},L7=(i,e)=>i.is_dir&&!e.is_dir?1:!i.is_dir&&e.is_dir?-1:i.z!==e.z?i.z-e.z:i.x!==e.x?i.x-e.x:i.y-e.y,dB=(i,e)=>{const t=i.getUint8(e*17);return{z:t&127,x:SA(i,e*17+1),y:SA(i,e*17+4),offset:uB(i,e*17+7),length:i.getUint32(e*17+13,!0),is_dir:t>>7===1}},fB=i=>{const e=[],t=new DataView(i);for(let n=0;n<t.byteLength/17;n++)e.push(dB(t,n));return D7(e)},D7=i=>{i.sort(L7);const e=new ArrayBuffer(17*i.length),t=new Uint8Array(e);for(let n=0;n<i.length;n++){const r=i[n];let s=r.z;r.is_dir&&(s=s|128),t[n*17]=s,t[n*17+1]=r.x&255,t[n*17+2]=r.x>>8&255,t[n*17+3]=r.x>>16&255,t[n*17+4]=r.y&255,t[n*17+5]=r.y>>8&255,t[n*17+6]=r.y>>16&255,t[n*17+7]=r.offset&255,t[n*17+8]=fd(r.offset,8)&255,t[n*17+9]=fd(r.offset,16)&255,t[n*17+10]=fd(r.offset,24)&255,t[n*17+11]=fd(r.offset,32)&255,t[n*17+12]=fd(r.offset,48)&255,t[n*17+13]=r.length&255,t[n*17+14]=r.length>>8&255,t[n*17+15]=r.length>>16&255,t[n*17+16]=r.length>>24&255}return e},k7=(i,e)=>{if(i.byteLength<17)return null;const t=i.byteLength/17,n=dB(i,t-1);if(n.is_dir){const r=n.z,s=e.z-r,o=Math.trunc(e.x/(1<<s)),a=Math.trunc(e.y/(1<<s));return{z:r,x:o,y:a}}return null};function P7(i){return cn(this,null,function*(){const e=yield i.getBytes(0,512e3),t=new DataView(e.data),n=t.getUint32(4,!0),r=t.getUint16(8,!0),s=new TextDecoder("utf-8"),o=JSON.parse(s.decode(new DataView(e.data,10,n)));let a=0;o.compression==="gzip"&&(a=2);let l=0;"minzoom"in o&&(l=+o.minzoom);let u=0;"maxzoom"in o&&(u=+o.maxzoom);let c=0,h=0,d=0,g=-180,A=-85,p=180,y=85;if(o.bounds){const E=o.bounds.split(",");g=+E[0],A=+E[1],p=+E[2],y=+E[3]}if(o.center){const E=o.center.split(",");c=+E[0],h=+E[1],d=+E[2]}return{specVersion:t.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:l,maxZoom:u,minLon:g,minLat:A,maxLon:p,maxLat:y,centerZoom:d,centerLon:c,centerLat:h,etag:e.etag}})}function M7(i,e,t,n,r,s,o){return cn(this,null,function*(){let a=yield t.getArrayBuffer(e,i.rootDirectoryOffset,i.rootDirectoryLength,i);i.specVersion===1&&(a=fB(a));const l=cB(new DataView(a),n,r,s);if(l){let h=(yield e.getBytes(l.offset,l.length,o)).data;const d=new DataView(h);return d.getUint8(0)==31&&d.getUint8(1)==139&&(h=iE(new Uint8Array(h))),{data:h}}const u=k7(new DataView(a),{z:n,x:r,y:s});if(u){const c=R7(new DataView(a),u.z,u.x,u.y);if(c){let h=yield t.getArrayBuffer(e,c.offset,c.length,i);i.specVersion===1&&(h=fB(h));const d=cB(new DataView(h),n,r,s);if(d){let A=(yield e.getBytes(d.offset,d.length,o)).data;const p=new DataView(A);return p.getUint8(0)==31&&p.getUint8(1)==139&&(A=iE(new Uint8Array(A))),{data:A}}}}})}var gB={getHeader:P7,getZxy:M7};function Du(i,e){return(e>>>0)*4294967296+(i>>>0)}function F7(i,e){const t=e.buf;let n,r;if(r=t[e.pos++],n=(r&112)>>4,r<128||(r=t[e.pos++],n|=(r&127)<<3,r<128)||(r=t[e.pos++],n|=(r&127)<<10,r<128)||(r=t[e.pos++],n|=(r&127)<<17,r<128)||(r=t[e.pos++],n|=(r&127)<<24,r<128)||(r=t[e.pos++],n|=(r&1)<<31,r<128))return Du(i,n);throw new Error("Expected varint not more than 10 bytes")}function gd(i){const e=i.buf;let t,n;return n=e[i.pos++],t=n&127,n<128||(n=e[i.pos++],t|=(n&127)<<7,n<128)||(n=e[i.pos++],t|=(n&127)<<14,n<128)||(n=e[i.pos++],t|=(n&127)<<21,n<128)?t:(n=e[i.pos],t|=(n&15)<<28,F7(t,i))}function O7(i,e,t,n){if(n==0){t==1&&(e[0]=i-1-e[0],e[1]=i-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var N7=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Q7(i,e,t){if(i>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,i)-1||t>Math.pow(2,i)-1)throw Error("tile x/y outside zoom level bounds");const n=N7[i],r=Math.pow(2,i);let s=0,o=0,a=0;const l=[e,t];let u=r/2;for(;u>0;)s=(l[0]&u)>0?1:0,o=(l[1]&u)>0?1:0,a+=u*u*(3*s^o),O7(u,l,s,o),u=u/2;return n+a}function AB(i,e){return cn(this,null,function*(){if(e===1||e===0)return i;if(e===2){if(typeof globalThis.DecompressionStream>"u")return iE(new Uint8Array(i));{let n=new Response(i).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var U7=127;function G7(i,e){let t=0,n=i.length-1;for(;t<=n;){const r=n+t>>1,s=e-i[r].tileId;if(s>0)t=r+1;else if(s<0)n=r-1;else return i[r]}return n>=0&&(i[n].runLength===0||e-i[n].tileId<i[n].runLength)?i[n]:null}var pB=class{constructor(i,e=new Headers){this.url=i,this.customHeaders=e}getKey(){return this.url}setHeaders(i){this.customHeaders=i}getBytes(i,e,t){return cn(this,null,function*(){let n;t||(n=new AbortController,t=n.signal);const r=new Headers(this.customHeaders);r.set("Range","bytes="+i+"-"+(i+e-1));let s=yield fetch(this.url,{signal:t,headers:r});if(s.status===416&&i===0){const l=s.headers.get("Content-Range");if(!l||!l.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const u=+l.substr(8);s=yield fetch(this.url,{signal:t,headers:{Range:"bytes=0-"+(u-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const o=s.headers.get("Content-Length");if(s.status===200&&(!o||+o>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function Sr(i,e){const t=i.getUint32(e+4,!0),n=i.getUint32(e+0,!0);return t*Math.pow(2,32)+n}function H7(i,e){const t=new DataView(i),n=t.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:Sr(t,8),rootDirectoryLength:Sr(t,16),jsonMetadataOffset:Sr(t,24),jsonMetadataLength:Sr(t,32),leafDirectoryOffset:Sr(t,40),leafDirectoryLength:Sr(t,48),tileDataOffset:Sr(t,56),tileDataLength:Sr(t,64),numAddressedTiles:Sr(t,72),numTileEntries:Sr(t,80),numTileContents:Sr(t,88),clustered:t.getUint8(96)===1,internalCompression:t.getUint8(97),tileCompression:t.getUint8(98),tileType:t.getUint8(99),minZoom:t.getUint8(100),maxZoom:t.getUint8(101),minLon:t.getInt32(102,!0)/1e7,minLat:t.getInt32(106,!0)/1e7,maxLon:t.getInt32(110,!0)/1e7,maxLat:t.getInt32(114,!0)/1e7,centerZoom:t.getUint8(118),centerLon:t.getInt32(119,!0)/1e7,centerLat:t.getInt32(123,!0)/1e7,etag:e}}function mB(i){const e={buf:new Uint8Array(i),pos:0},t=gd(e),n=[];let r=0;for(let s=0;s<t;s++){const o=gd(e);n.push({tileId:r+o,offset:0,length:0,runLength:1}),r+=o}for(let s=0;s<t;s++)n[s].runLength=gd(e);for(let s=0;s<t;s++)n[s].length=gd(e);for(let s=0;s<t;s++){const o=gd(e);o===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=o-1}return n}function z7(i){const e=new DataView(i);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ku=class extends Error{};function V7(i,e,t,n){return cn(this,null,function*(){const r=yield i.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(z7(r.data)<3)return[yield gB.getHeader(i)];const o=r.data.slice(0,U7);let a=r.etag;n&&r.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+i.getKey()),a=void 0);const l=H7(o,a);if(t){const u=r.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),c=i.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,h=mB(yield e(u,l.internalCompression));return[l,[c,h.length,h]]}return[l,void 0]})}function q7(i,e,t,n,r){return cn(this,null,function*(){const s=yield i.getBytes(t,n);if(r.etag&&r.etag!==s.etag)throw new ku(s.etag);const o=yield e(s.data,r.internalCompression),a=mB(o);if(a.length===0)throw new Error("Empty directory is invalid");return a})}var $7=class{constructor(i=100,e=!0,t=AB){this.cache=new Map,this.maxCacheEntries=i,this.counter=1,this.prefetch=e,this.decompress=t}getHeader(i,e){return cn(this,null,function*(){const t=i.getKey();if(this.cache.has(t))return this.cache.get(t).lastUsed=this.counter++,yield this.cache.get(t).data;const n=new Promise((r,s)=>{V7(i,this.decompress,this.prefetch,e).then(o=>{o[1]&&this.cache.set(o[1][0],{lastUsed:this.counter++,data:Promise.resolve(o[1][2])}),r(o[0]),this.prune()}).catch(o=>{s(o)})});return this.cache.set(t,{lastUsed:this.counter++,data:n}),n})}getDirectory(i,e,t,n){return cn(this,null,function*(){const r=i.getKey()+"|"+(n.etag||"")+"|"+e+"|"+t;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const s=new Promise((o,a)=>{q7(i,this.decompress,e,t,n).then(l=>{o(l),this.prune()}).catch(l=>{a(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(i,e,t,n){return cn(this,null,function*(){const r=i.getKey()+"|"+(n.etag||"")+"|"+e+"|"+t;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const s=new Promise((o,a)=>{i.getBytes(e,t).then(l=>{if(n.etag&&n.etag!==l.etag)throw new ku(l.etag);o(l.data),this.cache.has(r),this.prune()}).catch(l=>{a(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let i=1/0,e;this.cache.forEach((t,n)=>{t.lastUsed<i&&(i=t.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(i,e){return cn(this,null,function*(){this.cache.delete(i.getKey()),yield this.getHeader(i,e)})}},j7=class{constructor(i,e,t){typeof i=="string"?this.source=new pB(i):this.source=i,t?this.decompress=t:this.decompress=AB,e?this.cache=e:this.cache=new $7}getHeader(){return cn(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(i,e,t,n){return cn(this,null,function*(){const r=Q7(i,e,t),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return gB.getZxy(s,this.source,this.cache,i,e,t,n);if(i<s.minZoom||i>s.maxZoom)return;let o=s.rootDirectoryOffset,a=s.rootDirectoryLength;for(let l=0;l<=3;l++){const u=yield this.cache.getDirectory(this.source,o,a,s),c=G7(u,r);if(c)if(c.runLength>0){const h=yield this.source.getBytes(s.tileDataOffset+c.offset,c.length,n);if(s.etag&&s.etag!==h.etag)throw new ku(h.etag);return{data:yield this.decompress(h.data,s.tileCompression),cacheControl:h.cacheControl,expires:h.expires}}else o=s.leafDirectoryOffset+c.offset,a=c.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(i,e,t,n){return cn(this,null,function*(){try{return yield this.getZxyAttempt(i,e,t,n)}catch(r){if(r instanceof ku)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(i,e,t,n);throw r}})}getMetadataAttempt(){return cn(this,null,function*(){const i=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(i.jsonMetadataOffset,i.jsonMetadataLength);if(i.etag&&i.etag!==e.etag)throw new ku(e.etag);const t=yield this.decompress(e.data,i.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(t))})}getMetadata(){return cn(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(i){if(i instanceof ku)return this.cache.invalidate(this.source,i.message),yield this.getMetadataAttempt();throw i}})}};class W7 extends FH{constructor(t){super({...t,state:"loading",url:"pmtiles://"+t.url+"/{z}/{x}/{y}",format:new r7});Ni(this,"tileLoadFunction",(t,n)=>{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),s=n.match(r),o=+s[2],a=+s[3],l=+s[4];t.setLoader((u,c,h)=>{t.setState(pe.LOADING),this.pmtiles_.getZxy(o,a,l).then(d=>{if(d){const g=t.getFormat();t.setFeatures(g.readFeatures(d.data,{extent:u,featureProjection:h})),t.setState(pe.LOADED)}else t.setFeatures([]),t.setState(pe.EMPTY)}).catch(d=>{t.setFeatures([]),t.setState(pe.ERROR)})})});const n=new pB(t.url,new Headers(t.headers));this.pmtiles_=new j7(n),this.pmtiles_.getHeader().then(r=>{this.tileGrid.minZoom=r.minZoom,this.tileGrid.maxZoom=r.maxZoom,this.setTileLoadFunction(this.tileLoadFunction),this.setState("ready")})}}function Qi(i){return(e,...t)=>K7(i,e,t)}function Pu(i,e){return Qi(yB(i,e).get)}const{apply:K7,construct:Zme,defineProperty:Xme,get:Jme,getOwnPropertyDescriptor:yB,getPrototypeOf:nE,has:eye,ownKeys:Y7,set:tye,setPrototypeOf:iye}=Reflect,{iterator:Ad,species:nye,toStringTag:Z7,for:rye}=Symbol,X7=Object,{create:rE,defineProperty:J7,freeze:sye,is:oye}=X7,vB=Array.prototype[Ad],ez=Qi(vB),EB=ArrayBuffer,tz=EB.prototype;Pu(tz,"byteLength");const IB=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;IB&&Pu(IB.prototype,"byteLength");const _B=nE(Uint8Array);_B.from;const hn=_B.prototype;hn[Ad],Qi(hn.keys),Qi(hn.values),Qi(hn.entries),Qi(hn.set),Qi(hn.reverse),Qi(hn.fill),Qi(hn.copyWithin),Qi(hn.sort),Qi(hn.slice),Qi(hn.subarray),Pu(hn,"buffer"),Pu(hn,"byteOffset"),Pu(hn,"length"),Pu(hn,Z7);const iz=Uint8Array,CB=Uint16Array,sE=Uint32Array,nz=Float32Array,pd=nE([][Ad]()),wB=Qi(pd.next),rz=Qi(function*(){}().next),sz=nE(pd),oz=DataView.prototype,az=Qi(oz.getUint16),oE=WeakMap,xB=oE.prototype,bB=Qi(xB.get),lz=Qi(xB.set),SB=new oE,uz=rE(null,{next:{value:function(){const e=bB(SB,this);return wB(e)}},[Ad]:{value:function(){return this}}});function cz(i){if(i[Ad]===vB&&pd.next===wB)return i;const e=rE(uz);return lz(SB,e,ez(i)),e}const hz=new oE,dz=rE(sz,{next:{value:function(){const e=bB(hz,this);return rz(e)},writable:!0,configurable:!0}});for(const i of Y7(pd))i!=="next"&&J7(dz,i,yB(pd,i));const TB=new EB(4),fz=new nz(TB),gz=new sE(TB),es=new CB(512),ts=new iz(512);for(let i=0;i<256;++i){const e=i-127;e<-24?(es[i]=0,es[i|256]=32768,ts[i]=24,ts[i|256]=24):e<-14?(es[i]=1024>>-e-14,es[i|256]=1024>>-e-14|32768,ts[i]=-e-1,ts[i|256]=-e-1):e<=15?(es[i]=e+15<<10,es[i|256]=e+15<<10|32768,ts[i]=13,ts[i|256]=13):e<128?(es[i]=31744,es[i|256]=64512,ts[i]=24,ts[i|256]=24):(es[i]=31744,es[i|256]=64512,ts[i]=13,ts[i|256]=13)}const aE=new sE(2048);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;!(e&8388608);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,aE[i]=e|t}for(let i=1024;i<2048;++i)aE[i]=939524096+(i-1024<<13);const Mu=new sE(64);for(let i=1;i<31;++i)Mu[i]=i<<23;Mu[31]=1199570944,Mu[32]=2147483648;for(let i=33;i<63;++i)Mu[i]=2147483648+(i-32<<23);Mu[63]=3347054592;const BB=new CB(64);for(let i=1;i<64;++i)i!==32&&(BB[i]=1024);function Az(i){const e=i>>10;return gz[0]=aE[BB[e]+(i&1023)]+Mu[e],fz[0]}function RB(i,e,...t){return Az(az(i,e,...cz(t)))}var lE={exports:{}};function LB(i,e,t){const n=t&&t.debug||!1;n&&console.log("[xml-utils] getting "+e+" in "+i);const r=typeof i=="object"?i.outer:i,s=r.slice(0,r.indexOf(">")+1),o=['"',"'"];for(let a=0;a<o.length;a++){const l=o[a],u=e+"\\="+l+"([^"+l+"]*)"+l;n&&console.log("[xml-utils] pattern:",u);const h=new RegExp(u).exec(s);if(n&&console.log("[xml-utils] match:",h),h)return h[1]}}lE.exports=LB,lE.exports.default=LB;var pz=lE.exports;const uE=jo(pz);var cE={exports:{}},hE={exports:{}},dE={exports:{}};function DB(i,e,t){const r=new RegExp(e).exec(i.slice(t));return r?t+r.index:-1}dE.exports=DB,dE.exports.default=DB;var mz=dE.exports,fE={exports:{}};function kB(i,e,t){const r=new RegExp(e).exec(i.slice(t));return r?t+r.index+r[0].length-1:-1}fE.exports=kB,fE.exports.default=kB;var yz=fE.exports,gE={exports:{}};function PB(i,e){const t=new RegExp(e,"g"),n=i.match(t);return n?n.length:0}gE.exports=PB,gE.exports.default=PB;var vz=gE.exports;const Ez=mz,AE=yz,MB=vz;function FB(i,e,t){const n=t&&t.debug||!1,r=!(t&&typeof t.nested===!1),s=t&&t.startIndex||0;n&&console.log("[xml-utils] starting findTagByName with",e," and ",t);const o=Ez(i,`<${e}[ 
>/]`,s);if(n&&console.log("[xml-utils] start:",o),o===-1)return;const a=i.slice(o+e.length);let l=AE(a,"^[^<]*[ /]>",0);const u=l!==-1&&a[l-1]==="/";if(n&&console.log("[xml-utils] selfClosing:",u),u===!1)if(r){let g=0,A=1,p=0;for(;(l=AE(a,"[ /]"+e+">",g))!==-1;){const y=a.substring(g,l+1);if(A+=MB(y,"<"+e+`[ 
	>]`),p+=MB(y,"</"+e+">"),p>=A)break;g=l}}else l=AE(a,"[ /]"+e+">",0);const c=o+e.length+l+1;if(n&&console.log("[xml-utils] end:",c),c===-1)return;const h=i.slice(o,c);let d;return u?d=null:d=h.slice(h.indexOf(">")+1,h.lastIndexOf("<")),{inner:d,outer:h,start:o,end:c}}hE.exports=FB,hE.exports.default=FB;var Iz=hE.exports;const _z=Iz;function OB(i,e,t){const n=[],r=t&&t.debug||!1,s=t&&typeof t.nested=="boolean"?t.nested:!0;let o=t&&t.startIndex||0,a;for(;a=_z(i,e,{debug:r,startIndex:o});)s?o=a.start+1+e.length:o=a.end,n.push(a);return r&&console.log("findTagsByName found",n.length,"tags"),n}cE.exports=OB,cE.exports.default=OB;var Cz=cE.exports;const wz=jo(Cz),md={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},is={};for(const i in md)md.hasOwnProperty(i)&&(is[md[i]]=parseInt(i,10));const xz=[is.BitsPerSample,is.ExtraSamples,is.SampleFormat,is.StripByteCounts,is.StripOffsets,is.StripRowCounts,is.TileByteCounts,is.TileOffsets,is.SubIFDs],pE={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},rt={};for(const i in pE)pE.hasOwnProperty(i)&&(rt[pE[i]]=parseInt(i,10));const Sn={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},bz={Unspecified:0,Assocalpha:1,Unassalpha:2},Sz={Version:0,AddCompression:1},mE={None:0,Deflate:1,Zstandard:2},Tz={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function Bz(i,e){const{width:t,height:n}=i,r=new Uint8Array(t*n*3);let s;for(let o=0,a=0;o<i.length;++o,a+=3)s=256-i[o]/e*256,r[a]=s,r[a+1]=s,r[a+2]=s;return r}function Rz(i,e){const{width:t,height:n}=i,r=new Uint8Array(t*n*3);let s;for(let o=0,a=0;o<i.length;++o,a+=3)s=i[o]/e*256,r[a]=s,r[a+1]=s,r[a+2]=s;return r}function Lz(i,e){const{width:t,height:n}=i,r=new Uint8Array(t*n*3),s=e.length/3,o=e.length/3*2;for(let a=0,l=0;a<i.length;++a,l+=3){const u=i[a];r[l]=e[u]/65536*256,r[l+1]=e[u+s]/65536*256,r[l+2]=e[u+o]/65536*256}return r}function Dz(i){const{width:e,height:t}=i,n=new Uint8Array(e*t*3);for(let r=0,s=0;r<i.length;r+=4,s+=3){const o=i[r],a=i[r+1],l=i[r+2],u=i[r+3];n[s]=255*((255-o)/256)*((255-u)/256),n[s+1]=255*((255-a)/256)*((255-u)/256),n[s+2]=255*((255-l)/256)*((255-u)/256)}return n}function kz(i){const{width:e,height:t}=i,n=new Uint8ClampedArray(e*t*3);for(let r=0,s=0;r<i.length;r+=3,s+=3){const o=i[r],a=i[r+1],l=i[r+2];n[s]=o+1.402*(l-128),n[s+1]=o-.34414*(a-128)-.71414*(l-128),n[s+2]=o+1.772*(a-128)}return n}const Pz=.95047,Mz=1,Fz=1.08883;function Oz(i){const{width:e,height:t}=i,n=new Uint8Array(e*t*3);for(let r=0,s=0;r<i.length;r+=3,s+=3){const o=i[r+0],a=i[r+1]<<24>>24,l=i[r+2]<<24>>24;let u=(o+16)/116,c=a/500+u,h=u-l/200,d,g,A;c=Pz*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),u=Mz*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),h=Fz*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),d=c*3.2406+u*-1.5372+h*-.4986,g=c*-.9689+u*1.8758+h*.0415,A=c*.0557+u*-.204+h*1.057,d=d>.0031308?1.055*d**(1/2.4)-.055:12.92*d,g=g>.0031308?1.055*g**(1/2.4)-.055:12.92*g,A=A>.0031308?1.055*A**(1/2.4)-.055:12.92*A,n[s]=Math.max(0,Math.min(1,d))*255,n[s+1]=Math.max(0,Math.min(1,g))*255,n[s+2]=Math.max(0,Math.min(1,A))*255}return n}const NB=new Map;function Wo(i,e){Array.isArray(i)||(i=[i]),i.forEach(t=>NB.set(t,e))}async function QB(i){const e=NB.get(i.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${i.Compression}`);const t=await e();return new t(i)}Wo([void 0,1],()=>Promise.resolve().then(()=>Xge).then(i=>i.default)),Wo(5,()=>Promise.resolve().then(()=>nAe).then(i=>i.default)),Wo(6,()=>{throw new Error("old style JPEG compression is not supported.")}),Wo(7,()=>Promise.resolve().then(()=>lAe).then(i=>i.default)),Wo([8,32946],()=>Promise.resolve().then(()=>Rpe).then(i=>i.default)),Wo(32773,()=>Promise.resolve().then(()=>Dpe).then(i=>i.default)),Wo(34887,()=>Promise.resolve().then(()=>Ope).then(async i=>(await i.zstd.init(),i)).then(i=>i.default)),Wo(50001,()=>Promise.resolve().then(()=>Qpe).then(i=>i.default));function TA(i,e,t,n=1){return new(Object.getPrototypeOf(i)).constructor(e*t*n)}function Nz(i,e,t,n,r){const s=e/n,o=t/r;return i.map(a=>{const l=TA(a,n,r);for(let u=0;u<r;++u){const c=Math.min(Math.round(o*u),t-1);for(let h=0;h<n;++h){const d=Math.min(Math.round(s*h),e-1),g=a[c*e+d];l[u*n+h]=g}}return l})}function Fu(i,e,t){return(1-t)*i+t*e}function Qz(i,e,t,n,r){const s=e/n,o=t/r;return i.map(a=>{const l=TA(a,n,r);for(let u=0;u<r;++u){const c=o*u,h=Math.floor(c),d=Math.min(Math.ceil(c),t-1);for(let g=0;g<n;++g){const A=s*g,p=A%1,y=Math.floor(A),v=Math.min(Math.ceil(A),e-1),E=a[h*e+y],I=a[h*e+v],C=a[d*e+y],w=a[d*e+v],S=Fu(Fu(E,I,p),Fu(C,w,p),c%1);l[u*n+g]=S}}return l})}function Uz(i,e,t,n,r,s="nearest"){switch(s.toLowerCase()){case"nearest":return Nz(i,e,t,n,r);case"bilinear":case"linear":return Qz(i,e,t,n,r);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function Gz(i,e,t,n,r,s){const o=e/n,a=t/r,l=TA(i,n,r,s);for(let u=0;u<r;++u){const c=Math.min(Math.round(a*u),t-1);for(let h=0;h<n;++h){const d=Math.min(Math.round(o*h),e-1);for(let g=0;g<s;++g){const A=i[c*e*s+d*s+g];l[u*n*s+h*s+g]=A}}}return l}function Hz(i,e,t,n,r,s){const o=e/n,a=t/r,l=TA(i,n,r,s);for(let u=0;u<r;++u){const c=a*u,h=Math.floor(c),d=Math.min(Math.ceil(c),t-1);for(let g=0;g<n;++g){const A=o*g,p=A%1,y=Math.floor(A),v=Math.min(Math.ceil(A),e-1);for(let E=0;E<s;++E){const I=i[h*e*s+y*s+E],C=i[h*e*s+v*s+E],w=i[d*e*s+y*s+E],S=i[d*e*s+v*s+E],x=Fu(Fu(I,C,p),Fu(w,S,p),c%1);l[u*n*s+g*s+E]=x}}}return l}function zz(i,e,t,n,r,s,o="nearest"){switch(o.toLowerCase()){case"nearest":return Gz(i,e,t,n,r,s);case"bilinear":case"linear":return Hz(i,e,t,n,r,s);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function Vz(i,e,t){let n=0;for(let r=e;r<t;++r)n+=i[r];return n}function yE(i,e,t){switch(i){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function qz(i,e){return(i===1||i===2)&&e<=32&&e%8===0?!1:!(i===3&&(e===16||e===32||e===64))}function $z(i,e,t,n,r,s,o){const a=new DataView(i),l=t===2?o*s:o*s*n,u=t===2?1:n,c=yE(e,r,l),h=parseInt("1".repeat(r),2);if(e===1){let d;t===1?d=n*r:d=r;let g=s*d;g&7&&(g=g+7&-8);for(let A=0;A<o;++A){const p=A*g;for(let y=0;y<s;++y){const v=p+y*u*r;for(let E=0;E<u;++E){const I=v+E*r,C=(A*s+y)*u+E,w=Math.floor(I/8),S=I%8;if(S+r<=8)c[C]=a.getUint8(w)>>8-r-S&h;else if(S+r<=16)c[C]=a.getUint16(w)>>16-r-S&h;else if(S+r<=24){const x=a.getUint16(w)<<8|a.getUint8(w+2);c[C]=x>>24-r-S&h}else c[C]=a.getUint32(w)>>32-r-S&h}}}}return c.buffer}class UB{constructor(e,t,n,r,s,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=n,this.littleEndian=r,this.tiles=s?{}:null,this.isTiled=!e.StripOffsets;const a=e.PlanarConfiguration;if(this.planarConfiguration=typeof a>"u"?1:a,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,n=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(r,s){return RB(this,r,s)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const n=this.getSampleFormat(e),r=this.getBitsPerSample(e);return yE(n,r,t)}async getTileOrStrip(e,t,n,r,s){const o=Math.ceil(this.getWidth()/this.getTileWidth()),a=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:u}=this;this.planarConfiguration===1?l=t*o+e:this.planarConfiguration===2&&(l=n*o*a+t*o+e);let c,h;this.isTiled?(c=this.fileDirectory.TileOffsets[l],h=this.fileDirectory.TileByteCounts[l]):(c=this.fileDirectory.StripOffsets[l],h=this.fileDirectory.StripByteCounts[l]);const d=(await this.source.fetch([{offset:c,length:h}],s))[0];let g;return u===null||!u[l]?(g=(async()=>{let A=await r.decode(this.fileDirectory,d);const p=this.getSampleFormat(),y=this.getBitsPerSample();return qz(p,y)&&(A=$z(A,p,this.planarConfiguration,this.getSamplesPerPixel(),y,this.getTileWidth(),this.getBlockHeight(t))),A})(),u!==null&&(u[l]=g)):g=u[l],{x:e,y:t,sample:n,data:await g}}async _readRaster(e,t,n,r,s,o,a,l,u){const c=this.getTileWidth(),h=this.getTileHeight(),d=this.getWidth(),g=this.getHeight(),A=Math.max(Math.floor(e[0]/c),0),p=Math.min(Math.ceil(e[2]/c),Math.ceil(d/c)),y=Math.max(Math.floor(e[1]/h),0),v=Math.min(Math.ceil(e[3]/h),Math.ceil(g/h)),E=e[2]-e[0];let I=this.getBytesPerPixel();const C=[],w=[];for(let T=0;T<t.length;++T)this.planarConfiguration===1?C.push(Vz(this.fileDirectory.BitsPerSample,0,t[T])/8):C.push(0),w.push(this.getReaderForSample(t[T]));const S=[],{littleEndian:x}=this;for(let T=y;T<v;++T)for(let Q=A;Q<p;++Q){let M;this.planarConfiguration===1&&(M=this.getTileOrStrip(Q,T,0,s,u));for(let R=0;R<t.length;++R){const z=R,q=t[R];this.planarConfiguration===2&&(I=this.getSampleByteSize(q),M=this.getTileOrStrip(Q,T,q,s,u));const X=M.then(N=>{const G=N.data,j=new DataView(G),V=this.getBlockHeight(N.y),Z=N.y*h,Y=N.x*c,te=Z+V,J=(N.x+1)*c,ce=w[z],ie=Math.min(V,V-(te-e[3]),g-Z),ne=Math.min(c,c-(J-e[2]),d-Y);for(let ue=Math.max(0,e[1]-Z);ue<ie;++ue)for(let fe=Math.max(0,e[0]-Y);fe<ne;++fe){const me=(ue*c+fe)*I,Pe=ce.call(j,me+C[z],x);let Re;r?(Re=(ue+Z-e[1])*E*t.length+(fe+Y-e[0])*t.length+z,n[Re]=Pe):(Re=(ue+Z-e[1])*E+fe+Y-e[0],n[z][Re]=Pe)}});S.push(X)}}if(await Promise.all(S),o&&e[2]-e[0]!==o||a&&e[3]-e[1]!==a){let T;return r?T=zz(n,e[2]-e[0],e[3]-e[1],o,a,t.length,l):T=Uz(n,e[2]-e[0],e[3]-e[1],o,a,l),T.width=o,T.height=a,T}return n.width=o||e[2]-e[0],n.height=a||e[3]-e[1],n}async readRasters({window:e,samples:t=[],interleave:n,pool:r=null,width:s,height:o,resampleMethod:a,fillValue:l,signal:u}={}){const c=e||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const h=c[2]-c[0],d=c[3]-c[1],g=h*d,A=this.getSamplesPerPixel();if(!t||!t.length)for(let E=0;E<A;++E)t.push(E);else for(let E=0;E<t.length;++E)if(t[E]>=A)return Promise.reject(new RangeError(`Invalid sample index '${t[E]}'.`));let p;if(n){const E=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,I=Math.max.apply(null,this.fileDirectory.BitsPerSample);p=yE(E,I,g*t.length),l&&p.fill(l)}else{p=[];for(let E=0;E<t.length;++E){const I=this.getArrayForSample(t[E],g);Array.isArray(l)&&E<l.length?I.fill(l[E]):l&&!Array.isArray(l)&&I.fill(l),p.push(I)}}const y=r||await QB(this.fileDirectory);return await this._readRaster(c,t,p,n,y,s,o,a,u)}async readRGB({window:e,interleave:t=!0,pool:n=null,width:r,height:s,resampleMethod:o,enableAlpha:a=!1,signal:l}={}){const u=e||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===Sn.RGB){let v=[0,1,2];if(this.fileDirectory.ExtraSamples!==bz.Unspecified&&a){v=[];for(let E=0;E<this.fileDirectory.BitsPerSample.length;E+=1)v.push(E)}return this.readRasters({window:e,interleave:t,samples:v,pool:n,width:r,height:s,resampleMethod:o,signal:l})}let h;switch(c){case Sn.WhiteIsZero:case Sn.BlackIsZero:case Sn.Palette:h=[0];break;case Sn.CMYK:h=[0,1,2,3];break;case Sn.YCbCr:case Sn.CIELab:h=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const d={window:u,interleave:!0,samples:h,pool:n,width:r,height:s,resampleMethod:o,signal:l},{fileDirectory:g}=this,A=await this.readRasters(d),p=2**this.fileDirectory.BitsPerSample[0];let y;switch(c){case Sn.WhiteIsZero:y=Bz(A,p);break;case Sn.BlackIsZero:y=Rz(A,p);break;case Sn.Palette:y=Lz(A,g.ColorMap);break;case Sn.CMYK:y=Dz(A);break;case Sn.YCbCr:y=kz(A);break;case Sn.CIELab:y=Oz(A);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const v=new Uint8Array(y.length/3),E=new Uint8Array(y.length/3),I=new Uint8Array(y.length/3);for(let C=0,w=0;C<y.length;C+=3,++w)v[w]=y[C],E[w]=y[C+1],I[w]=y[C+2];y=[v,E,I]}return y.width=A.width,y.height=A.height,y}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let r=wz(n,"Item");e===null?r=r.filter(s=>uE(s,"sample")===void 0):r=r.filter(s=>Number(uE(s,"sample"))===e);for(let s=0;s<r.length;++s){const o=r[s];t[uE(o,"name")]=o.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(n)return n[1]===0&&n[4]===0?[n[0],-n[5],n[10]]:[Math.sqrt(n[0]*n[0]+n[4]*n[4]),-Math.sqrt(n[1]*n[1]+n[5]*n[5]),n[10]];if(e){const[r,s,o]=e.getResolution();return[r*e.getWidth()/this.getWidth(),s*e.getHeight()/this.getHeight(),o*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(e=!1){const t=this.getHeight(),n=this.getWidth();if(this.fileDirectory.ModelTransformation&&!e){const[r,s,o,a,l,u,c,h]=this.fileDirectory.ModelTransformation,g=[[0,0],[0,t],[n,0],[n,t]].map(([y,v])=>[a+r*y+s*v,h+l*y+u*v]),A=g.map(y=>y[0]),p=g.map(y=>y[1]);return[Math.min(...A),Math.min(...p),Math.max(...A),Math.max(...p)]}else{const r=this.getOrigin(),s=this.getResolution(),o=r[0],a=r[1],l=o+s[0]*n,u=a+s[1]*t;return[Math.min(o,l),Math.min(a,u),Math.max(o,l),Math.max(a,u)]}}}class jz{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const n=this.getUint32(e,t),r=this.getUint32(e+4,t);let s;if(t){if(s=n+2**32*r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*n+r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}getInt64(e,t){let n=0;const r=(this._dataView.getUint8(e+(t?7:0))&128)>0;let s=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(t?o:7-o));r&&(s?a!==0&&(a=~(a-1)&255,s=!1):a=~a&255),n+=a*256**o}return r&&(n=-n),n}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return RB(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class Wz{constructor(e,t,n,r){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=n,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),n=this.readUint32(e+4);let r;if(this._littleEndian){if(r=t+2**32*n,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*t+n,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(e){let t=0;const n=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let r=!0;for(let s=0;s<8;s++){let o=this._dataView.getUint8(e+(this._littleEndian?s:7-s));n&&(r?o!==0&&(o=~(o-1)&255,r=!1):o=~o&255),t+=o*256**s}return n&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const Kz=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class Yz{constructor(e=Kz,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(n=>{Promise.resolve().then(()=>Hpe).then(r=>{n(r.create)})}),this._awaitingDecoder.then(n=>{this._awaitingDecoder=null,this.workers=[];for(let r=0;r<e;r++)this.workers.push({worker:n(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?QB(e).then(n=>n.decode(e,t)):new Promise(n=>{const r=this.workers.find(a=>a.idle)||this.workers[Math.floor(Math.random()*this.size)];r.idle=!1;const s=this.messageId++,o=a=>{a.data.id===s&&(r.idle=!0,n(a.data.decoded),r.worker.removeEventListener("message",o))};r.worker.addEventListener("message",o),r.worker.postMessage({fileDirectory:e,buffer:t,id:s},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const GB=`\r
\r
`;function HB(i){if(typeof Object.fromEntries<"u")return Object.fromEntries(i);const e={};for(const[t,n]of i)e[t.toLowerCase()]=n;return e}function Zz(i){const e=i.split(`\r
`).map(t=>{const n=t.split(":").map(r=>r.trim());return n[0]=n[0].toLowerCase(),n});return HB(e)}function Xz(i){const[e,...t]=i.split(";").map(r=>r.trim()),n=t.map(r=>r.split("="));return{type:e,params:HB(n)}}function vE(i){let e,t,n;return i&&([,e,t,n]=i.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10)),{start:e,end:t,total:n}}function Jz(i,e){let t=null;const n=new TextDecoder("ascii"),r=[],s=`--${e}`,o=`${s}--`;for(let a=0;a<10;++a)n.decode(new Uint8Array(i,a,s.length))===s&&(t=a);if(t===null)throw new Error("Could not find initial boundary");for(;t<i.byteLength;){const a=n.decode(new Uint8Array(i,t,Math.min(s.length+1024,i.byteLength-t)));if(a.length===0||a.startsWith(o))break;if(!a.startsWith(s))throw new Error("Part does not start with boundary");const l=a.substr(s.length+2);if(l.length===0)break;const u=l.indexOf(GB),c=Zz(l.substr(0,u)),{start:h,end:d,total:g}=vE(c["content-range"]),A=t+s.length+u+GB.length,p=parseInt(d,10)+1-parseInt(h,10);r.push({headers:c,data:i.slice(A,A+p),offset:h,length:p,fileSize:g}),t=A+p+4}return r}class EE{async fetch(e,t=void 0){return Promise.all(e.map(n=>this.fetchSlice(n,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class eV extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield e)}for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const r=typeof n=="number"&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;return this.cache.has(e)?this.cache.set(e,{value:t,expiry:r}):this._set(e,{value:t,expiry:r}),this}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[r,s]=n;this._deleteIfExpired(r,s)===!1&&(yield[r,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[r,s]=n;this.cache.has(r)||this._deleteIfExpired(r,s)===!1&&(yield[r,s.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,r]of this.entriesAscending())e.call(t,r,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function tV(i){return new Promise(e=>setTimeout(e,i))}function iV(i,e){const t=Array.isArray(i)?i:Array.from(i),n=Array.isArray(e)?e:Array.from(e);return t.map((r,s)=>[r,n[s]])}class Ou extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,Ou),this.name="AbortError"}}class nV extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const rV=nV;class sV{constructor(e,t,n=null){this.offset=e,this.length=t,this.data=n}get top(){return this.offset+this.length}}class zB{constructor(e,t,n){this.offset=e,this.length=t,this.blockIds=n}}class oV extends EE{constructor(e,{blockSize:t=65536,cacheSize:n=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new eV({maxSize:n,onEviction:(r,s)=>{this.evictedBlocks.set(r,s)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const n=[],r=[],s=[];this.evictedBlocks.clear();for(const{offset:d,length:g}of e){let A=d+g;const{fileSize:p}=this;p!==null&&(A=Math.min(A,p));const y=Math.floor(d/this.blockSize)*this.blockSize;for(let v=y;v<A;v+=this.blockSize){const E=Math.floor(v/this.blockSize);!this.blockCache.has(E)&&!this.blockRequests.has(E)&&(this.blockIdsToFetch.add(E),r.push(E)),this.blockRequests.has(E)&&n.push(this.blockRequests.get(E)),s.push(E)}}await tV(),this.fetchBlocks(t);const o=[];for(const d of r)this.blockRequests.has(d)&&o.push(this.blockRequests.get(d));await Promise.allSettled(n),await Promise.allSettled(o);const a=[],l=s.filter(d=>this.abortedBlockIds.has(d)||!this.blockCache.has(d));if(l.forEach(d=>this.blockIdsToFetch.add(d)),l.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const d of l){const g=this.blockRequests.get(d);if(!g)throw new Error(`Block ${d} is not in the block requests`);a.push(g)}await Promise.allSettled(a)}if(t&&t.aborted)throw new Ou("Request was aborted");const u=s.map(d=>this.blockCache.get(d)||this.evictedBlocks.get(d)),c=u.filter(d=>!d);if(c.length)throw new rV(c,"Request failed");const h=new Map(iV(s,u));return this.readSliceData(e,h)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(t,e);for(let r=0;r<t.length;++r){const s=t[r];for(const o of s.blockIds)this.blockRequests.set(o,(async()=>{try{const a=(await n)[r],l=o*this.blockSize,u=l-a.offset,c=Math.min(u+this.blockSize,a.data.byteLength),h=a.data.slice(u,c),d=new sV(l,h.byteLength,h,o);this.blockCache.set(o,d),this.abortedBlockIds.delete(o)}catch(a){if(a.name==="AbortError")a.signal=e,this.blockCache.delete(o),this.abortedBlockIds.add(o);else throw a}finally{this.blockRequests.delete(o)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((o,a)=>o-a);if(t.length===0)return[];let n=[],r=null;const s=[];for(const o of t)r===null||r+1===o?(n.push(o),r=o):(s.push(new zB(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[o],r=o);return s.push(new zB(n[0]*this.blockSize,n.length*this.blockSize,n)),s}readSliceData(e,t){return e.map(n=>{let r=n.offset+n.length;this.fileSize!==null&&(r=Math.min(this.fileSize,r));const s=Math.floor(n.offset/this.blockSize),o=Math.floor(r/this.blockSize),a=new ArrayBuffer(n.length),l=new Uint8Array(a);for(let u=s;u<=o;++u){const c=t.get(u),h=c.offset-n.offset,d=c.top-r;let g=0,A=0,p;h<0?g=-h:h>0&&(A=h),d<0?p=c.length-g:p=r-c.offset-g;const y=new Uint8Array(c.data,g,p);l.set(y,A)}return a})}}class IE{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class _E{constructor(e){this.url=e}async request({headers:e,signal:t}={}){throw new Error("request is not implemented")}}class aV extends IE{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class lV extends _E{constructor(e,t){super(e),this.credentials=t}async request({headers:e,signal:t}={}){const n=await fetch(this.url,{headers:e,credentials:this.credentials,signal:t});return new aV(n)}}class uV extends IE{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class cV extends _E{constructRequest(e,t){return new Promise((n,r)=>{const s=new XMLHttpRequest;s.open("GET",this.url),s.responseType="arraybuffer";for(const[o,a]of Object.entries(e))s.setRequestHeader(o,a);s.onload=()=>{const o=s.response;n(new uV(s,o))},s.onerror=r,s.onabort=()=>r(new Ou("Request aborted")),s.send(),t&&(t.aborted&&s.abort(),t.addEventListener("abort",()=>s.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}const BA={},hV=Object.freeze(Object.defineProperty({__proto__:null,default:BA},Symbol.toStringTag,{value:"Module"}));class dV extends IE{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class fV extends _E{constructor(e){super(e),this.parsedUrl=BA.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",BA)}constructRequest(e,t){return new Promise((n,r)=>{const s=this.httpApi.get({...this.parsedUrl,headers:e},o=>{const a=new Promise(l=>{const u=[];o.on("data",c=>{u.push(c)}),o.on("end",()=>{const c=Buffer.concat(u).buffer;l(c)}),o.on("error",r)});n(new dV(o,a))});s.on("error",r),t&&(t.aborted&&s.destroy(new Ou("Request aborted")),t.addEventListener("abort",()=>s.destroy(new Ou("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class CE extends EE{constructor(e,t,n,r){super(),this.client=e,this.headers=t,this.maxRanges=n,this.allowFullFile=r,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(n=>this.fetchSlice(n,t))))}async fetchSlices(e,t){const n=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:r,length:s})=>`${r}-${r+s}`).join(",")}`},signal:t});if(n.ok)if(n.status===206){const{type:r,params:s}=Xz(n.getHeader("content-type"));if(r==="multipart/byteranges"){const h=Jz(await n.getData(),s.boundary);return this._fileSize=h[0].fileSize||null,h}const o=await n.getData(),{start:a,end:l,total:u}=vE(n.getHeader("content-range"));this._fileSize=u||null;const c=[{data:o,offset:a,length:l-a}];if(e.length>1){const h=await Promise.all(e.slice(1).map(d=>this.fetchSlice(d,t)));return c.concat(h)}return c}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const r=await n.getData();return this._fileSize=r.byteLength,[{data:r,offset:0,length:r.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:n,length:r}=e,s=await this.client.request({headers:{...this.headers,Range:`bytes=${n}-${n+r}`},signal:t});if(s.ok)if(s.status===206){const o=await s.getData(),{total:a}=vE(s.getHeader("content-range"));return this._fileSize=a||null,{data:o,offset:n,length:r}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await s.getData();return this._fileSize=o.byteLength,{data:o,offset:0,length:o.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function wE(i,{blockSize:e,cacheSize:t}){return e===null?i:new oV(i,{blockSize:e,cacheSize:t})}function gV(i,{headers:e={},credentials:t,maxRanges:n=0,allowFullFile:r=!1,...s}={}){const o=new lV(i,t),a=new CE(o,e,n,r);return wE(a,s)}function AV(i,{headers:e={},maxRanges:t=0,allowFullFile:n=!1,...r}={}){const s=new cV(i),o=new CE(s,e,t,n);return wE(o,r)}function pV(i,{headers:e={},maxRanges:t=0,allowFullFile:n=!1,...r}={}){const s=new fV(i),o=new CE(s,e,t,n);return wE(o,r)}function xE(i,{forceXHR:e=!1,...t}={}){return typeof fetch=="function"&&!e?gV(i,t):typeof XMLHttpRequest<"u"?AV(i,t):pV(i,t)}class mV extends EE{constructor(e){super(),this.file=e}async fetchSlice(e,t){return new Promise((n,r)=>{const s=this.file.slice(e.offset,e.offset+e.length),o=new FileReader;o.onload=a=>n(a.target.result),o.onerror=r,o.onabort=r,o.readAsArrayBuffer(s),t&&t.addEventListener("abort",()=>o.abort())})}}function yV(i){return new mV(i)}function vV(i,e){let t=i.length-e,n=0;do{for(let r=e;r>0;r--)i[n+e]+=i[n],n++;t-=e}while(t>0)}function EV(i,e,t){let n=0,r=i.length;const s=r/t;for(;r>e;){for(let a=e;a>0;--a)i[n+e]+=i[n],++n;r-=e}const o=i.slice();for(let a=0;a<s;++a)for(let l=0;l<t;++l)i[t*a+l]=o[(t-l-1)*s+a]}function IV(i,e,t,n,r,s){if(!e||e===1)return i;for(let l=0;l<r.length;++l){if(r[l]%8!==0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(r[l]!==r[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const o=r[0]/8,a=s===2?1:r.length;for(let l=0;l<n&&!(l*a*t*o>=i.byteLength);++l){let u;if(e===2){switch(r[0]){case 8:u=new Uint8Array(i,l*a*t*o,a*t*o);break;case 16:u=new Uint16Array(i,l*a*t*o,a*t*o/2);break;case 32:u=new Uint32Array(i,l*a*t*o,a*t*o/4);break;default:throw new Error(`Predictor 2 not allowed with ${r[0]} bits per sample.`)}vV(u,a)}else e===3&&(u=new Uint8Array(i,l*a*t*o,a*t*o),EV(u,a,o))}return i}class tl{async decode(e,t){const n=await this.decodeBlock(t),r=e.Predictor||1;if(r!==1){const s=!e.StripOffsets,o=s?e.TileWidth:e.ImageWidth,a=s?e.TileLength:e.RowsPerStrip||e.ImageLength;return IV(n,r,o,a,e.BitsPerSample,e.PlanarConfiguration)}return n}}function bE(i){switch(i){case rt.BYTE:case rt.ASCII:case rt.SBYTE:case rt.UNDEFINED:return 1;case rt.SHORT:case rt.SSHORT:return 2;case rt.LONG:case rt.SLONG:case rt.FLOAT:case rt.IFD:return 4;case rt.RATIONAL:case rt.SRATIONAL:case rt.DOUBLE:case rt.LONG8:case rt.SLONG8:case rt.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${i}`)}}function _V(i){const e=i.GeoKeyDirectory;if(!e)return null;const t={};for(let n=4;n<=e[3]*4;n+=4){const r=Tz[e[n]],s=e[n+1]?md[e[n+1]]:null,o=e[n+2],a=e[n+3];let l=null;if(!s)l=a;else{if(l=i[s],typeof l>"u"||l===null)throw new Error(`Could not get value of geoKey '${r}'.`);typeof l=="string"?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),o===1&&(l=l[0]))}t[r]=l}return t}function Nu(i,e,t,n){let r=null,s=null;const o=bE(e);switch(e){case rt.BYTE:case rt.ASCII:case rt.UNDEFINED:r=new Uint8Array(t),s=i.readUint8;break;case rt.SBYTE:r=new Int8Array(t),s=i.readInt8;break;case rt.SHORT:r=new Uint16Array(t),s=i.readUint16;break;case rt.SSHORT:r=new Int16Array(t),s=i.readInt16;break;case rt.LONG:case rt.IFD:r=new Uint32Array(t),s=i.readUint32;break;case rt.SLONG:r=new Int32Array(t),s=i.readInt32;break;case rt.LONG8:case rt.IFD8:r=new Array(t),s=i.readUint64;break;case rt.SLONG8:r=new Array(t),s=i.readInt64;break;case rt.RATIONAL:r=new Uint32Array(t*2),s=i.readUint32;break;case rt.SRATIONAL:r=new Int32Array(t*2),s=i.readInt32;break;case rt.FLOAT:r=new Float32Array(t),s=i.readFloat32;break;case rt.DOUBLE:r=new Float64Array(t),s=i.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===rt.RATIONAL||e===rt.SRATIONAL)for(let a=0;a<t;a+=2)r[a]=s.call(i,n+a*o),r[a+1]=s.call(i,n+(a*o+4));else for(let a=0;a<t;++a)r[a]=s.call(i,n+a*o);return e===rt.ASCII?new TextDecoder("utf-8").decode(r):r}class CV{constructor(e,t,n){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=n}}class RA extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class VB{async readRasters(e={}){const{window:t,width:n,height:r}=e;let{resX:s,resY:o,bbox:a}=e;const l=await this.getImage();let u=l;const c=await this.getImageCount(),h=l.getBoundingBox();if(t&&a)throw new Error('Both "bbox" and "window" passed.');if(n||r){if(t){const[A,p]=l.getOrigin(),[y,v]=l.getResolution();a=[A+t[0]*y,p+t[1]*v,A+t[2]*y,p+t[3]*v]}const g=a||h;if(n){if(s)throw new Error("Both width and resX passed");s=(g[2]-g[0])/n}if(r){if(o)throw new Error("Both width and resY passed");o=(g[3]-g[1])/r}}if(s||o){const g=[];for(let A=0;A<c;++A){const p=await this.getImage(A),{SubfileType:y,NewSubfileType:v}=p.fileDirectory;(A===0||y===2||v&1)&&g.push(p)}g.sort((A,p)=>A.getWidth()-p.getWidth());for(let A=0;A<g.length;++A){const p=g[A],y=(h[2]-h[0])/p.getWidth(),v=(h[3]-h[1])/p.getHeight();if(u=p,s&&s>y||o&&o>v)break}}let d=t;if(a){const[g,A]=l.getOrigin(),[p,y]=u.getResolution(l);d=[Math.round((a[0]-g)/p),Math.round((a[1]-A)/y),Math.round((a[2]-g)/p),Math.round((a[3]-A)/y)],d=[Math.min(d[0],d[2]),Math.min(d[1],d[3]),Math.max(d[0],d[2]),Math.max(d[1],d[3])]}return u.readRasters({...e,window:d})}}class Qu extends VB{constructor(e,t,n,r,s={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=n,this.firstIFDOffset=r,this.cache=s.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const n=this.bigTiff?4048:1024;return new Wz((await this.source.fetch([{offset:e,length:typeof t<"u"?t:n}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,n=this.bigTiff?8:2;let r=await this.getSlice(e);const s=this.bigTiff?r.readUint64(e):r.readUint16(e),o=s*t+(this.bigTiff?16:6);r.covers(e,o)||(r=await this.getSlice(e,o));const a={};let l=e+(this.bigTiff?8:2);for(let h=0;h<s;l+=t,++h){const d=r.readUint16(l),g=r.readUint16(l+2),A=this.bigTiff?r.readUint64(l+4):r.readUint32(l+4);let p,y;const v=bE(g),E=l+(this.bigTiff?12:8);if(v*A<=(this.bigTiff?8:4))p=Nu(r,g,A,E);else{const I=r.readOffset(E),C=bE(g)*A;if(r.covers(I,C))p=Nu(r,g,A,I);else{const w=await this.getSlice(I,C);p=Nu(w,g,A,I)}}A===1&&xz.indexOf(d)===-1&&!(g===rt.RATIONAL||g===rt.SRATIONAL)?y=p[0]:y=p,a[md[d]]=y}const u=_V(a),c=r.readOffset(e+n+t*s);return new CV(a,u,c)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof RA?new RA(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new RA(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new UB(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(n){if(n instanceof RA)t=!1;else throw n}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",n=t.length+100;let r=await this.getSlice(e,n);if(t===Nu(r,rt.ASCII,t.length,e)){const o=Nu(r,rt.ASCII,n,e).split(`
`)[0],a=Number(o.split("=")[1].split(" ")[0])+o.length;a>n&&(r=await this.getSlice(e,a));const l=Nu(r,rt.ASCII,a,e);this.ghostValues={},l.split(`
`).filter(u=>u.length>0).map(u=>u.split("=")).forEach(([u,c])=>{this.ghostValues[u]=c})}return this.ghostValues}static async fromSource(e,t,n){const r=(await e.fetch([{offset:0,length:1024}],n))[0],s=new jz(r),o=s.getUint16(0,0);let a;if(o===18761)a=!0;else if(o===19789)a=!1;else throw new TypeError("Invalid byte order value.");const l=s.getUint16(2,a);let u;if(l===42)u=!1;else if(l===43){if(u=!0,s.getUint16(4,a)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const c=u?s.getUint64(8,a):s.getUint32(4,a);return new Qu(e,a,u,c,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class wV extends VB{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,n=0;for(let r=0;r<this.imageFiles.length;r++){const s=this.imageFiles[r];for(let o=0;o<this.imageCounts[r];o++){if(e===t){const a=await s.requestIFD(n);return new UB(a.fileDirectory,a.geoKeyDirectory,s.dataView,s.littleEndian,s.cache,s.source)}t++,n++}n=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,n)=>t+n,0),this.imageCount}}async function xV(i,e={},t){return Qu.fromSource(xE(i,e),t)}async function bV(i,e){return Qu.fromSource(yV(i),e)}async function SV(i,e=[],t={},n){const r=await Qu.fromSource(xE(i,t),n),s=await Promise.all(e.map(o=>Qu.fromSource(xE(o,t))));return new wV(r,s)}function TV(i){return((i.fileDirectory.NewSubfileType||0)&4)===4}function BV(i,e){if(!i)return!1;if(i===!0)return!0;if(e.getSamplesPerPixel()!==3)return!1;const t=e.fileDirectory.PhotometricInterpretation,n=Sn;return t===n.CMYK||t===n.YCbCr||t===n.CIELab||t===n.ICCLab}const qB="STATISTICS_MAXIMUM",$B="STATISTICS_MINIMUM",SE=256;let TE;function RV(){return TE||(TE=new Yz),TE}function LV(i){try{return i.getBoundingBox()}catch{return[0,0,i.getWidth(),i.getHeight()]}}function DV(i){try{return i.getOrigin().slice(0,2)}catch{return[0,i.getHeight()]}}function kV(i,e){try{return i.getResolution(e)}catch{return[e.getWidth()/i.getWidth(),e.getHeight()/i.getHeight()]}}function PV(i){const e=i.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey&&e.ProjectedCSTypeGeoKey!==32767){const t="EPSG:"+e.ProjectedCSTypeGeoKey;let n=Vt(t);if(!n){const r=jb(e.ProjLinearUnitsGeoKey);r&&(n=new Ph({code:t,units:r}))}return n}if(e.GeographicTypeGeoKey&&e.GeographicTypeGeoKey!==32767){const t="EPSG:"+e.GeographicTypeGeoKey;let n=Vt(t);if(!n){const r=jb(e.GeogAngularUnitsGeoKey);r&&(n=new Ph({code:t,units:r}))}return n}return null}function MV(i){return i.getImageCount().then(function(e){const t=new Array(e);for(let n=0;n<e;++n)t[n]=i.getImage(n);return Promise.all(t)})}function FV(i,e){let t;return i.blob?t=bV(i.blob):i.overviews?t=SV(i.url,i.overviews,e):t=xV(i.url,e),t.then(MV)}function yd(i,e,t,n,r){if(Array.isArray(i)){const s=i.length;if(!Array.isArray(e)||s!=e.length){const o=new Error(n);throw r(o),o}for(let o=0;o<s;++o)yd(i[o],e[o],t,n,r);return}if(e=e,Math.abs(i-e)>t*i)throw new Error(n)}function OV(i){return i instanceof Int8Array?-128:i instanceof Int16Array?-32768:i instanceof Int32Array?-2147483648:i instanceof Float32Array?12e-39:0}function NV(i){return i instanceof Int8Array?127:i instanceof Uint8Array||i instanceof Uint8ClampedArray?255:i instanceof Int16Array?32767:i instanceof Uint16Array?65535:i instanceof Int32Array?2147483647:i instanceof Uint32Array?4294967295:i instanceof Float32Array?34e37:255}class QV extends MH{constructor(e){super({state:"loading",tileGrid:null,projection:e.projection||null,opaque:e.opaque,transition:e.transition,interpolate:e.interpolate!==!1,wrapX:e.wrapX}),this.sourceInfo_=e.sources;const t=this.sourceInfo_.length;this.sourceOptions_=e.sourceOptions,this.sourceImagery_=new Array(t),this.sourceMasks_=new Array(t),this.resolutionFactors_=new Array(t),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=e.normalize!==!1,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=e.convertToRGB||!1,this.setKey(this.sourceInfo_.map(s=>s.url).join(","));const n=this,r=new Array(t);for(let s=0;s<t;++s)r[s]=FV(this.sourceInfo_[s],this.sourceOptions_);Promise.all(r).then(function(s){n.configure_(s)}).catch(function(s){eS(s),n.error_=s,n.setState("error")})}getError(){return this.error_}determineProjection(e){const t=e[0];for(let n=t.length-1;n>=0;--n){const r=t[n],s=PV(r);if(s){this.projection=s;break}}}configure_(e){let t,n,r,s,o;const a=new Array(e.length),l=new Array(e.length),u=new Array(e.length);let c=0;const h=e.length;for(let p=0;p<h;++p){const y=[],v=[];e[p].forEach(T=>{TV(T)?v.push(T):y.push(T)});const E=y.length;if(v.length>0&&v.length!==E)throw new Error(`Expected one mask per image found ${v.length} masks and ${E} images`);let I,C;const w=new Array(E),S=new Array(E),x=new Array(E);l[p]=new Array(E),u[p]=new Array(E);for(let T=0;T<E;++T){const Q=y[T],M=Q.getGDALNoData();u[p][T]=Q.getGDALMetadata(0),l[p][T]=M;const R=this.sourceInfo_[p].bands;a[p]=R?R.length:Q.getSamplesPerPixel();const z=E-(T+1);I||(I=LV(Q)),C||(C=DV(Q));const q=kV(Q,y[0]);x[z]=q[0];const X=[Q.getTileWidth(),Q.getTileHeight()];X[0]!==X[1]&&X[1]<SE&&(X[0]=SE,X[1]=SE),w[z]=X;const N=q[0]/Math.abs(q[1]);S[z]=[X[0],X[1]/N]}if(t?Cn(t,I,t):t=I,!n)n=C;else{const T=`Origin mismatch for source ${p}, got [${C}] but expected [${n}]`;yd(n,C,0,T,this.viewRejector)}if(!o)o=x,this.resolutionFactors_[p]=1;else{o.length-c>x.length&&(c=o.length-x.length);const T=o[o.length-1]/x[x.length-1];this.resolutionFactors_[p]=T;const Q=x.map(R=>R*=T),M=`Resolution mismatch for source ${p}, got [${Q}] but expected [${o}]`;yd(o.slice(c,o.length),Q,.02,M,this.viewRejector)}r?yd(r.slice(c,r.length),S,.01,`Tile size mismatch for source ${p}`,this.viewRejector):r=S,s?yd(s.slice(c,s.length),w,0,`Tile size mismatch for source ${p}`,this.viewRejector):s=w,this.sourceImagery_[p]=y.reverse(),this.sourceMasks_[p]=v.reverse()}for(let p=0,y=this.sourceImagery_.length;p<y;++p){const v=this.sourceImagery_[p];for(;v.length<o.length;)v.unshift(void 0)}this.getProjection()||this.determineProjection(e),this.samplesPerPixel_=a,this.nodataValues_=l,this.metadata_=u;e:for(let p=0;p<h;++p){if(this.sourceInfo_[p].nodata!==void 0){this.addAlpha_=!0;break}if(this.sourceMasks_[p].length){this.addAlpha_=!0;break}const y=l[p],v=this.sourceInfo_[p].bands;if(v){for(let E=0;E<v.length;++E)if(y[v[E]-1]!==null){this.addAlpha_=!0;break e}continue}for(let E=0;E<y.length;++E)if(y[E]!==null){this.addAlpha_=!0;break e}}let d=this.addAlpha_?1:0;for(let p=0;p<h;++p)d+=a[p];this.bandCount=d;const g=new EA({extent:t,minZoom:c,origin:n,resolutions:o,tileSizes:r});this.tileGrid=g,this.setTileSizes(s),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");const A=1;o.length===2?o=[o[0],o[1],o[1]/2]:o.length===1&&(o=[o[0]*2,o[0],o[0]/2]),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:o,center:Vg(Bo(t),this.projection),extent:sS(t,this.projection),zoom:A})}loadTile_(e,t,n){const r=this.getTileSize(e),s=this.sourceImagery_.length,o=new Array(s*2),a=this.nodataValues_,l=this.sourceInfo_,u=RV();for(let c=0;c<s;++c){const h=l[c],d=this.resolutionFactors_[c],g=[Math.round(t*(r[0]*d)),Math.round(n*(r[1]*d)),Math.round((t+1)*(r[0]*d)),Math.round((n+1)*(r[1]*d))],A=this.sourceImagery_[c][e];let p;h.bands&&(p=h.bands.map(function(C){return C-1}));let y;"nodata"in h&&h.nodata!==null?y=h.nodata:p?y=p.map(function(C){return a[c][C]}):y=a[c];const v={window:g,width:r[0],height:r[1],samples:p,fillValue:y,pool:u,interleave:!1};BV(this.convertToRGB_,A)?o[c]=A.readRGB(v):o[c]=A.readRasters(v);const E=s+c,I=this.sourceMasks_[c][e];if(!I){o[E]=Promise.resolve(null);continue}o[E]=I.readRasters({window:g,width:r[0],height:r[1],samples:[0],pool:u,interleave:!1})}return Promise.all(o).then(this.composeTile_.bind(this,r)).catch(function(c){throw eS(c),c})}composeTile_(e,t){const n=this.metadata_,r=this.sourceInfo_,s=this.sourceImagery_.length,o=this.bandCount,a=this.samplesPerPixel_,l=this.nodataValues_,u=this.normalize_,c=this.addAlpha_,h=e[0]*e[1],d=h*o;let g;u?g=new Uint8Array(d):g=new Float32Array(d);let A=0;for(let p=0;p<h;++p){let y=c;for(let v=0;v<s;++v){const E=r[v];let I=E.min,C=E.max,w,S;if(u){const x=n[v][0];I===void 0&&(x&&$B in x?I=parseFloat(x[$B]):I=OV(t[v][0])),C===void 0&&(x&&qB in x?C=parseFloat(x[qB]):C=NV(t[v][0])),w=255/(C-I),S=-I*w}for(let x=0;x<a[v];++x){const T=t[v][x][p];let Q;if(u?Q=Xt(w*T+S,0,255):Q=T,!c)g[A]=Q;else{let M=E.nodata;if(M===void 0){let z;E.bands?z=E.bands[x]-1:z=x,M=l[v][z]}const R=isNaN(M);(!R&&T!==M||R&&!isNaN(T))&&(y=!1,g[A]=Q)}A++}if(!y){const x=s+v,T=t[x];T&&!T[0][p]&&(y=!0)}}c&&(y||(g[A]=255),A++)}return g}}class UV extends Bh{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter_=e.gutter||0,this.helper_=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener($e.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===pe.LOADED,this.loaded)this.uploadTile();else{if(e instanceof fA){const t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener($e.CHANGE,this.handleTileChange_)}}uploadTile(){je()}setReady(){this.ready=!0,this.dispatchEvent($e.CHANGE)}handleTileChange_(){this.tile.getState()===pe.LOADED&&(this.loaded=!0,this.uploadTile())}disposeInternal(){this.tile.removeEventListener($e.CHANGE,this.handleTileChange_)}}const BE=34962,RE=34963,GV=35040,LE=35044,HV=35048,zV=5121,VV=5123,qV=5125,jB=5126,WB=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function $V(i,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!v5},e);const t=WB.length;for(let n=0;n<t;++n)try{const r=i.getContext(WB[n],e);if(r)return r}catch{}return null}const jV={STATIC_DRAW:LE,STREAM_DRAW:GV,DYNAMIC_DRAW:HV};class KB{constructor(e,t){this.array=null,this.type=e,It(e===BE||e===RE,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage=t!==void 0?t:jV.STATIC_DRAW}ofSize(e){return this.array=new(DE(this.type))(e),this}fromArray(e){return this.array=DE(this.type).from(e),this}fromArrayBuffer(e){return this.array=new(DE(this.type))(e),this}getType(){return this.type}getArray(){return this.array}getUsage(){return this.usage}getSize(){return this.array?this.array.length:0}}function DE(i){switch(i){case BE:return Float32Array;case RE:return Uint32Array;default:return Float32Array}}function YB(i,e,t){const n=t?i.LINEAR:i.NEAREST;i.bindTexture(i.TEXTURE_2D,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n)}function WV(i,e,t,n){YB(i,e,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)}function ZB(i,e,t,n,r,s){const o=i.getGL();let a,l;t instanceof Float32Array?(a=o.FLOAT,i.getExtension("OES_texture_float"),l=i.getExtension("OES_texture_float_linear")!==null):(a=o.UNSIGNED_BYTE,l=!0),YB(o,e,s&&l);const u=t.byteLength/n[1];let c=1;u%8===0?c=8:u%4===0?c=4:u%2===0&&(c=2);let h;switch(r){case 1:{h=o.LUMINANCE;break}case 2:{h=o.LUMINANCE_ALPHA;break}case 3:{h=o.RGB;break}case 4:{h=o.RGBA;break}default:throw new Error(`Unsupported number of bands: ${r}`)}const d=o.getParameter(o.UNPACK_ALIGNMENT);o.pixelStorei(o.UNPACK_ALIGNMENT,c),o.texImage2D(o.TEXTURE_2D,0,h,n[0],n[1],0,h,a,t),o.pixelStorei(o.UNPACK_ALIGNMENT,d)}let Uu=null;function KV(){Uu=xi(1,1,void 0,{willReadFrequently:!0})}class YV extends UV{constructor(e){super(e),this.textures=[],this.renderSize_=ai(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;const t=new KB(BE,LE);t.fromArray([0,1,1,1,1,0,0,0]),this.helper_.flushBufferData(t),this.coords=t,this.setTile(e.tile)}uploadTile(){const e=this.helper_,t=e.getGL(),n=this.tile;this.textures.length=0;let r;n instanceof fA||n instanceof xu?r=n.getImage():r=n.getData();const s=wA(r);if(s){const E=t.createTexture();this.textures.push(E),this.bandCount=4,WV(t,E,s,n.interpolate),this.setReady();return}r=Wv(r);const o=n.getSize(),a=[o[0]+2*this.gutter_,o[1]+2*this.gutter_],l=r instanceof Float32Array,u=a[0]*a[1],c=l?Float32Array:Uint8Array,h=c.BYTES_PER_ELEMENT,d=r.byteLength/a[1];this.bandCount=Math.floor(d/h/a[0]);const g=Math.ceil(this.bandCount/4);if(g===1){const E=t.createTexture();this.textures.push(E),ZB(e,E,r,a,this.bandCount,n.interpolate),this.setReady();return}const A=new Array(g);for(let E=0;E<g;++E){const I=t.createTexture();this.textures.push(I);const C=E<g-1?4:(this.bandCount-1)%4+1;A[E]=new c(u*C)}let p=0,y=0;const v=a[0]*this.bandCount;for(let E=0;E<a[1];++E){for(let I=0;I<v;++I){const C=r[y+I],w=Math.floor(p/this.bandCount),S=I%this.bandCount,x=Math.floor(S/4),T=A[x],Q=T.length/u,M=S%4;T[w*Q+M]=C,++p}y+=d/h}for(let E=0;E<g;++E){const I=this.textures[E],C=A[E],w=C.length/u;ZB(e,I,C,a,w,n.interpolate)}this.setReady()}disposeInternal(){const e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(let t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t]);this.tile.removeEventListener($e.CHANGE,this.handleTileChange_)}getImagePixelData_(e,t,n){const r=this.gutter_,s=this.renderSize_[0],o=this.renderSize_[1];Uu||KV(),Uu.clearRect(0,0,1,1);const a=e.width,l=e.height,u=a-2*r,c=l-2*r,h=r+Math.floor(u*(t/s)),d=r+Math.floor(c*(n/o));let g;try{Uu.drawImage(e,h,d,1,1,0,0,1,1),g=Uu.getImageData(0,0,1,1).data}catch{return Uu=null,null}return g}getArrayPixelData_(e,t,n,r){const s=this.gutter_,o=this.renderSize_[0],a=this.renderSize_[1],l=t[0],u=t[1],c=l+2*s,h=u+2*s,d=s+Math.floor(l*(n/o)),g=s+Math.floor(u*(r/a));if(e instanceof DataView){const p=e.byteLength/(c*h),y=p*(g*c+d),v=e.buffer.slice(y,y+p);return new DataView(v)}const A=this.bandCount*(g*c+d);return e.slice(A,A+this.bandCount)}getPixelData(e,t){if(!this.loaded)return null;if(this.tile instanceof Kv){const n=this.tile.getData(),r=Wv(n);if(r){const s=this.tile.getSize();return this.getArrayPixelData_(r,s,e,t)}return this.getImagePixelData_(wA(n),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}const LA={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},ZV=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,XV=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class XB{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e.vertexShader||ZV),t.compileShader(n);const r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,e.fragmentShader||XV),t.compileShader(r),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,n),t.attachShader(this.renderTargetProgram_,r),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:t.getUniformLocation(this.renderTargetProgram_,o)})})}getGL(){return this.gl_}init(e){const t=this.getGL(),n=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;const r=0,s=t.RGBA,o=0,a=t.RGBA,l=t.UNSIGNED_BYTE,u=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,r,s,n[0],n[1],o,a,l,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n[0],n[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,n,r){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=nt(s.canvas);if(!e.renderTargets[l]){const u=s.getContextAttributes();u&&u.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),n&&n(s,e),s.drawArrays(s.TRIANGLES,0,6),r&&r(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let n,r=1;this.uniforms_.forEach(function(s){if(n=typeof s.value=="function"?s.value(e):s.value,n instanceof HTMLCanvasElement||n instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${r}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,n.width,n.height,0,t.UNSIGNED_BYTE,new Uint8Array(n.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.uniform1i(s.location,r++);else if(Array.isArray(n))switch(n.length){case 2:t.uniform2f(s.location,n[0],n[1]);return;case 3:t.uniform3f(s.location,n[0],n[1],n[2]);return;case 4:t.uniform4f(s.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&t.uniform1f(s.location,n)})}}function JB(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function e2(i,e){return i[0]=e[0],i[1]=e[1],i[4]=e[2],i[5]=e[3],i[12]=e[4],i[13]=e[5],i}const Ko={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},vd={UNSIGNED_BYTE:zV,UNSIGNED_SHORT:VV,UNSIGNED_INT:qV,FLOAT:jB},DA={};function t2(i){return"shared/"+i}let i2=0;function JV(){const i="unique/"+i2;return i2+=1,i}function eq(i){let e=DA[i];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:$V(t)},DA[i]=e}return e.users+=1,e.context}function tq(i){const e=DA[i];if(!e||(e.users-=1,e.users>0))return;const t=e.context,n=t.getExtension("WEBGL_lose_context");n&&n.loseContext();const r=t.canvas;r.width=1,r.height=1,delete DA[i]}class iq extends wg{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?t2(e.canvasCacheKey):JV(),this.gl_=eq(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(LA.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(LA.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Yi(),this.offsetScaleMatrix_=Yi(),this.tmpMat4_=JB(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(n=>new XB({webGlContext:this.gl_,scaleRatio:n.scaleRatio,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms})):[new XB({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===t2(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){const t=this.gl_,n=nt(e);let r=this.bufferCache_[n];if(!r){const s=t.createBuffer();r={buffer:e,webGlBuffer:s},this.bufferCache_[n]=r}t.bindBuffer(e.getType(),r.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=this.gl_,n=nt(e),r=this.bufferCache_[n];r&&!t.isContextLost()&&t.deleteBuffer(r.webGlBuffer),delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(LA.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(LA.RESTORED,this.boundHandleWebGLContextRestored_),tq(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,n){const r=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.depthRange(0,1),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,t?r.ZERO:r.ONE_MINUS_SRC_ALPHA),n?(r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL)):r.disable(r.DEPTH_TEST)}bindTexture(e,t,n){const r=this.gl_;r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,e),r.uniform1i(this.getUniformLocation(n),t)}prepareDrawToRenderTarget(e,t,n,r){const s=this.gl_,o=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,n?s.ZERO:s.ONE_MINUS_SRC_ALPHA),r?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const n=this.gl_;this.getExtension("OES_element_index_uint");const r=n.UNSIGNED_INT,s=4,o=t-e,a=e*s;n.drawElements(n.TRIANGLES,o,r,a)}finalizeDraw(e,t,n){for(let r=0,s=this.postProcessPasses_.length;r<s;r++)r===s-1?this.postProcessPasses_[r].apply(e,null,t,n):this.postProcessPasses_[r].apply(e,this.postProcessPasses_[r+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,n=e.viewState.rotation,r=e.pixelRatio;this.setUniformFloatValue(Ko.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Ko.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Ko.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Ko.PIXEL_RATIO,r),this.setUniformFloatVec2(Ko.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Ko.ROTATION,n)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Ko.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Ko.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let n,r=0;this.uniforms_.forEach(s=>{if(n=typeof s.value=="function"?s.value(e):s.value,n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof ImageData)s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,r,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(!(n instanceof HTMLImageElement)||n.complete)&&s.prevValue!==n&&(s.prevValue=n,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),r++;else if(Array.isArray(n)&&n.length===6)this.setUniformMatrixValue(s.name,e2(this.tmpMat4_,n));else if(Array.isArray(n)&&n.length<=4)switch(n.length){case 2:t.uniform2f(this.getUniformLocation(s.name),n[0],n[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),n[0],n[1],n[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&t.uniform1f(this.getUniformLocation(s.name),n)})}useProgram(e,t){this.gl_.useProgram(e),this.currentProgram_=e,this.applyFrameState(t),this.applyUniforms(t)}compileShader(e,t){const n=this.gl_,r=n.createShader(t);return n.shaderSource(r,e),n.compileShader(r),r}getProgram(e,t){const n=this.gl_,r=this.compileShader(e,n.FRAGMENT_SHADER),s=this.compileShader(t,n.VERTEX_SHADER),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,s),n.linkProgram(o),!n.getShaderParameter(r,n.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${n.getShaderInfoLog(r)}`;throw new Error(a)}if(n.deleteShader(r),!n.getShaderParameter(s,n.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${n.getShaderInfoLog(s)}`;throw new Error(a)}if(n.deleteShader(s),!n.getProgramParameter(o,n.LINK_STATUS)){const a=`GL program linking failed: ${n.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const t=nt(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=nt(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const n=e.size,r=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return _r(t,0,0,2/(s*n[0]),2/(s*n[1]),-r,-o[0],-o[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}enableAttributeArray_(e,t,n,r,s){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,n,!1,r,s))}enableAttributes(e){const t=nq(e);let n=0;for(let r=0;r<e.length;r++){const s=e[r];this.enableAttributeArray_(s.name,s.size,s.type||jB,t,n),n+=s.size*n2(s.type)}}handleWebGLContextLost(e){eu(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,n){const r=this.gl_;n=n||r.createTexture();const s=0,o=r.RGBA,a=0,l=r.RGBA,u=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,n),t?r.texImage2D(r.TEXTURE_2D,s,o,l,u,t):r.texImage2D(r.TEXTURE_2D,s,o,e[0],e[1],a,l,u,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),n}}function nq(i){let e=0;for(let t=0;t<i.length;t++){const n=i[t];e+=n.size*n2(n.type)}return e}function n2(i){switch(i){case vd.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case vd.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case vd.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case vd.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class kE extends hT{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=Yi(),this.pixelContext_=null,this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,e.addChangeListener(bt.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const n=this.getLayer();if(n.hasListener(wn.PRECOMPOSE)){const r=new id(wn.PRECOMPOSE,void 0,t,e);n.dispatchEvent(r)}}dispatchPostComposeEvent(e,t){const n=this.getLayer();if(n.hasListener(wn.POSTCOMPOSE)){const r=new id(wn.POSTCOMPOSE,void 0,t,e);n.dispatchEvent(r)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,n=-1,r;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,u=l.getRenderer();if(!(u instanceof kE)){t=!0;continue}const c=l.getClassName();if((t||c!==r)&&(n+=1,t=!1),r=c,u===this)break}const s="map/"+e.mapId+"/group/"+n;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new iq({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),r&&(this.helper.getCanvas().className=r),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(e,t,n){const r=this.getLayer();if(r.hasListener(e)){_r(this.inversePixelTransform_,0,0,n.pixelRatio,-n.pixelRatio,0,0,-n.size[1]);const s=new id(e,this.inversePixelTransform_,n,t);r.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(wn.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(wn.POSTRENDER,e,t)}}const rq={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"},sq={};function oq(i){return 1/(i+2)}function aq(){return{tileIds:new Set,representationsByZ:{}}}function r2(i,e){return i.tileIds.has(nt(e))}function s2(i,e,t){const n=i.representationsByZ;t in n||(n[t]=new Set),n[t].add(e),i.tileIds.add(nt(e.tile))}function PE(i,e){const t=i.layerStatesArray[i.layerIndex];t.extent&&(e=Cn(e,Lo(t.extent,i.viewState.projection)));const n=t.layer.getRenderSource();if(!n.getWrapX()){const r=n.getTileGridForProjection(i.viewState.projection).getExtent();r&&(e=Cn(e,r))}return e}function ME(i,e){return`${i.getKey()},${el(e)}`}class lq extends kE{constructor(e,t){super(e,{uniforms:t.uniforms,postProcesses:t.postProcesses}),this.renderComplete=!1,this.tileTransform_=Yi(),this.tempMat4=JB(),this.tempTileRange_=new vA(0,0,0,0),this.tempTileCoord_=mA(0,0,0),this.tempSize_=[0,0];const n=t.cacheSize!==void 0?t.cacheSize:512;this.tileRepresentationCache=new ST(n),this.frameState=null,this.projection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}isDrawableTile_(e){const t=this.getLayer(),n=e.getState(),r=t.getUseInterimTilesOnError();return n==pe.LOADED||n==pe.EMPTY||n==pe.ERROR&&!r}prepareFrameInternal(e){this.projection_?e.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=e.viewState.projection):this.projection_=e.viewState.projection;const n=this.getLayer().getRenderSource();return!n||nu(PE(e,e.extent))?!1:n.getState()==="ready"}createTileRepresentation(e){return je()}enqueueTiles(e,t,n,r,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),u=l.getTileGridForProjection(o.projection),c=l.getGutterForProjection(o.projection),h=nt(l);h in e.wantedTiles||(e.wantedTiles[h]={});const d=e.wantedTiles[h],g=this.tileRepresentationCache,A=a.getMapInternal(),p=Math.max(n-s,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),A?A.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),l.zDirection));for(let y=n;y>=p;--y){const v=u.getTileRangeForExtentAndZ(t,y,this.tempTileRange_),E=u.getResolution(y);for(let I=v.minX;I<=v.maxX;++I)for(let C=v.minY;C<=v.maxY;++C){const w=mA(y,I,C,this.tempTileCoord_),S=ME(l,w);let x,T;if(g.containsKey(S)&&(x=g.get(S),T=x.tile),(!x||x.tile.key!==l.getKey())&&(T=l.getTile(y,I,C,e.pixelRatio,o.projection)),r2(r,T))continue;if(!x)x=this.createTileRepresentation({tile:T,grid:u,helper:this.helper,gutter:c}),g.set(S,x);else if(this.isDrawableTile_(T))x.setTile(T);else{const M=T.getInterimTile();x.setTile(M)}s2(r,x,y);const Q=T.getKey();d[Q]=!0,T.getState()===pe.IDLE&&(e.tileQueue.isKeyQueued(Q)||e.tileQueue.enqueue([T,h,u.getTileCoordCenter(w),E]))}}}beforeTilesRender(e,t){this.helper.prepareDraw(this.frameState,!t,!0)}renderTile(e,t,n,r,s,o,a,l,u,c,h){}drawTile_(e,t,n,r,s,o,a){if(!t.loaded)return;const u=t.tile.tileCoord,c=el(u),h=c in o?o[c]:1,d=a.getResolution(n),g=ai(a.getTileSize(n),this.tempSize_),A=a.getOrigin(n),p=a.getTileCoordExtent(u),y=h<1?-1:oq(n);h<1&&(e.animate=!0);const v=e.viewState,E=v.center[0],I=v.center[1],C=g[0]+2*r,w=g[1]+2*r,S=C/w,x=(E-A[0])/(g[0]*d),T=(A[1]-I)/(g[1]*d),Q=v.resolution/d,M=u[1],R=u[2];Hy(this.tileTransform_),Lh(this.tileTransform_,2/(e.size[0]*Q/C),-2/(e.size[1]*Q/C)),_5(this.tileTransform_,v.rotation),Lh(this.tileTransform_,1,1/S),Nb(this.tileTransform_,(g[0]*(M-x)-r)/C,(g[1]*(R-T)-r)/w),this.renderTile(t,this.tileTransform_,e,s,d,g,A,p,y,r,h)}renderFrame(e){this.frameState=e,this.renderComplete=!0;const t=this.helper.getGL();this.preRender(t,e);const n=e.viewState,r=this.getLayer(),s=r.getRenderSource(),o=s.getTileGridForProjection(n.projection),a=s.getGutterForProjection(n.projection),l=PE(e,e.extent),u=o.getZForResolution(n.resolution,s.zDirection),c=aq(),h=r.getPreload();if(e.nextExtent){const w=o.getZForResolution(n.nextResolution,s.zDirection),S=PE(e,e.nextExtent);this.enqueueTiles(e,S,w,c,h)}this.enqueueTiles(e,l,u,c,0),h>0&&setTimeout(()=>{this.enqueueTiles(e,l,u-1,c,h-1)},0);const d={},g=nt(this),A=e.time;let p=!1;for(const w of c.representationsByZ[u]){const S=w.tile;if((S instanceof xu||S instanceof Yv)&&S.getState()===pe.EMPTY)continue;const x=S.tileCoord;if(w.loaded){const M=S.getAlpha(g,A);if(M===1){S.endTransition(g);continue}p=!0;const R=el(x);d[R]=M}if(this.renderComplete=!1,this.findAltTiles_(o,x,u+1,c))continue;const Q=o.getMinZoom();for(let M=u-1;M>=Q&&!this.findAltTiles_(o,x,M,c);--M);}this.beforeTilesRender(e,p);const y=c.representationsByZ,v=Object.keys(y).map(Number).sort(c5);for(let w=0,S=v.length;w<S;++w){const x=v[w];for(const T of y[x]){const Q=T.tile.tileCoord;el(Q)in d||this.drawTile_(e,T,x,a,l,d,o)}}for(const w of y[u]){const S=w.tile.tileCoord;el(S)in d&&this.drawTile_(e,w,u,a,l,d,o)}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const E=this.helper.getCanvas(),I=this.tileRepresentationCache;for(;I.canExpireCache();)I.pop().dispose();const C=function(w,S){s.updateCacheSize(.1,S.viewState.projection),s.expireCache(S.viewState.projection,sq)};return e.postRenderFunctions.push(C),this.postRender(t,e),E}findAltTiles_(e,t,n,r){const s=e.getTileRangeForTileCoordAndZ(t,n,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileRepresentationCache,l=this.getLayer().getRenderSource();for(let u=s.minX;u<=s.maxX;++u)for(let c=s.minY;c<=s.maxY;++c){const h=ME(l,[n,u,c]);let d=!1;if(a.containsKey(h)){const g=a.get(h);g.loaded&&!r2(r,g.tile)&&(s2(r,g,n),d=!0)}d||(o=!1)}return o}clearCache(){const e=this.tileRepresentationCache;e.forEach(t=>t.dispose()),e.clear()}removeHelper(){this.helper&&this.clearCache(),super.removeHelper()}disposeInternal(){super.disposeInternal(),delete this.frameState}}const Je={...rq,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},kA={TEXTURE_COORD:"a_textureCoord"},uq=[{name:kA.TEXTURE_COORD,size:2,type:vd.FLOAT}];class cq extends lq{constructor(e,t){super(e,t),this.program_,this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.indices_=new KB(RE,LE),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=t.paletteTextures||[]}reset(e){super.reset(e),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}createTileRepresentation(e){return new YV(e)}beforeTilesRender(e,t){super.beforeTilesRender(e,t),this.helper.useProgram(this.program_,e)}renderTile(e,t,n,r,s,o,a,l,u,c,h){const d=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(uq);let g=0;for(;g<e.textures.length;){const S=`${Je.TILE_TEXTURE_ARRAY}[${g}]`;this.helper.bindTexture(e.textures[g],g,S),++g}for(let S=0;S<this.paletteTextures_.length;++S){const x=this.paletteTextures_[S],T=x.getTexture(d);this.helper.bindTexture(T,g,x.name),++g}const A=n.viewState,p=o[0]+2*c,y=o[1]+2*c,E=e.tile.tileCoord,I=E[1],C=E[2];this.helper.setUniformMatrixValue(Je.TILE_TRANSFORM,e2(this.tempMat4,t)),this.helper.setUniformFloatValue(Je.TRANSITION_ALPHA,h),this.helper.setUniformFloatValue(Je.DEPTH,u);let w=r;c>0&&(w=l,Cn(w,r,w)),this.helper.setUniformFloatVec4(Je.RENDER_EXTENT,w),this.helper.setUniformFloatValue(Je.RESOLUTION,A.resolution),this.helper.setUniformFloatValue(Je.ZOOM,A.zoom),this.helper.setUniformFloatValue(Je.TEXTURE_PIXEL_WIDTH,p),this.helper.setUniformFloatValue(Je.TEXTURE_PIXEL_HEIGHT,y),this.helper.setUniformFloatValue(Je.TEXTURE_RESOLUTION,s),this.helper.setUniformFloatValue(Je.TEXTURE_ORIGIN_X,a[0]+I*o[0]*s-c*s),this.helper.setUniformFloatValue(Je.TEXTURE_ORIGIN_Y,a[1]-C*o[1]*s+c*s),this.helper.drawElements(0,this.indices_.getSize())}getData(e){if(!this.helper.getGL())return null;const n=this.frameState;if(!n)return null;const r=this.getLayer(),s=yi(n.pixelToCoordinateTransform,e.slice()),o=n.viewState,a=r.getExtent();if(a&&!tu(Lo(a,o.projection),s))return null;const l=r.getSources(kg([s]),o.resolution);let u,c,h;for(u=l.length-1;u>=0;--u)if(c=l[u],c.getState()==="ready"){if(h=c.getTileGridForProjection(o.projection),c.getWrapX())break;const g=h.getExtent();if(!g||tu(g,s))break}if(u<0)return null;const d=this.tileRepresentationCache;for(let g=h.getZForResolution(o.resolution);g>=h.getMinZoom();--g){const A=h.getTileCoordForCoordAndZ(s,g),p=ME(c,A);if(!d.containsKey(p))continue;const y=d.get(p),v=y.tile;if((v instanceof xu||v instanceof Yv)&&v.getState()===pe.EMPTY)return null;if(!y.loaded)continue;const E=h.getOrigin(g),I=ai(h.getTileSize(g)),C=h.getResolution(g),w=(s[0]-E[0])/C-A[1]*I[0],S=(E[1]-s[1])/C-A[2]*I[1];return y.getPixelData(w,S)}return null}disposeInternal(){const e=this.helper;e&&(e.getGL().deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)),super.disposeInternal(),delete this.indices_}}class hq{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}}const _e={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0};function dq(i){switch(i){case"string":return _e.STRING;case"color":return _e.COLOR;case"number":return _e.NUMBER;case"boolean":return _e.BOOLEAN;case"number[]":return _e.NUMBER_ARRAY;default:throw new Error(`Unrecognized type hint: ${i}`)}}const Ze={};function Ui(i){if(typeof i=="number")return _e.NUMBER;if(typeof i=="boolean")return _e.BOOLEAN;if(typeof i=="string")return CU(i)?_e.COLOR|_e.STRING:_e.STRING;if(!Array.isArray(i))throw new Error(`Unhandled value type: ${JSON.stringify(i)}`);const e=i;if(e.every(function(r){return typeof r=="number"}))return e.length===3||e.length===4?_e.COLOR|_e.NUMBER_ARRAY:_e.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error(`Expected an expression operator but received: ${JSON.stringify(e)}`);const n=Ze[e[0]];if(n===void 0)throw new Error(`Unrecognized expression operator: ${JSON.stringify(e)}`);return n.getReturnType(e.slice(1))}function fq(i){return Math.log2(i)%1===0}function Yo(i){const e=[];return(i&_e.NUMBER)>0&&e.push("number"),(i&_e.COLOR)>0&&e.push("color"),(i&_e.BOOLEAN)>0&&e.push("boolean"),(i&_e.NUMBER_ARRAY)>0&&e.push("number[]"),(i&_e.STRING)>0&&e.push("string"),e.length>0?e.join(", "):"(no type)"}function gq(i,e){return`operator_${i}_${Object.keys(e.functions).length}`}function PA(i){const e=i.toString();return e.includes(".")?e:e+".0"}function o2(i){if(i.length<2||i.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${i.length}(${i.map(PA).join(", ")})`}function Aq(i){const e=Qh(i),t=e.length>3?e[3]:1;return o2([e[0]/255*t,e[1]/255*t,e[2]/255*t,t])}const FE={};let pq=0;function a2(i){return i in FE||(FE[i]=pq++),FE[i]}function mq(i){return PA(a2(i))}function Me(i,e,t){const n=t!==void 0?t:_e.NUMBER;if(Array.isArray(e)&&typeof e[0]=="string"){const s=Ze[e[0]];if(s===void 0)throw new Error(`Unrecognized expression operator: ${JSON.stringify(e)}`);return s.toGlsl(i,e.slice(1),n)}const r=Ui(e)&n;if(h2(e,r,""),(r&_e.NUMBER)>0)return PA(e);if((r&_e.BOOLEAN)>0)return e.toString();if((r&_e.STRING)>0)return mq(e.toString());if((r&_e.COLOR)>0)return Aq(e);if((r&_e.NUMBER_ARRAY)>0)return o2(e);throw new Error(`Unexpected expression ${e} (expected type ${Yo(n)})`)}function l2(i){if(!(Ui(i)&_e.NUMBER))throw new Error(`A numeric value was expected, got ${JSON.stringify(i)} instead`)}function li(i){for(let e=0;e<i.length;e++)l2(i[e])}function u2(i){if(!(Ui(i)&_e.STRING))throw new Error(`A string value was expected, got ${JSON.stringify(i)} instead`)}function OE(i){if(!(Ui(i)&_e.BOOLEAN))throw new Error(`A boolean value was expected, got ${JSON.stringify(i)} instead`)}function Qt(i,e){if(i.length!==e)throw new Error(`Exactly ${e} arguments were expected, got ${i.length} instead`)}function Tr(i,e){if(i.length<e)throw new Error(`At least ${e} arguments were expected, got ${i.length} instead`)}function Ed(i,e){if(i.length>e)throw new Error(`At most ${e} arguments were expected, got ${i.length} instead`)}function c2(i){if(i.length%2!==0)throw new Error(`An even amount of arguments was expected, got ${JSON.stringify(i)} instead`)}function yq(i){if(i.length%2===0)throw new Error(`An odd amount of arguments was expected, got ${JSON.stringify(i)} instead`)}function h2(i,e,t){if(e===_e.NONE)throw new Error(`No matching type was found for the following expression ${t}: ${JSON.stringify(i)}`)}function Id(i,e,t){if(h2(i,e,t),!fq(e))throw new Error(`Expected to have a unique type for the following expression ${t}: ${JSON.stringify(i)}
Got the following types instead: ${Yo(e)}`)}function NE(i,e,t,n){if((e&t)===_e.NONE)throw new Error(`Expected the ${n} type of the following expression: ${JSON.stringify(i)} to be of the following types: ${Yo(t)}
Got these types instead: ${Yo(e)}`)}Ze.get={getReturnType:function(i){if(i.length===2){const e=i[1];return dq(e)}return _e.ANY},toGlsl:function(i,e,t){Tr(e,1),Ed(e,2),u2(e[0]);const n=t&Ze.get.getReturnType(e);Id(["get",...e],n,"");const r=e[0].toString(),s=i.attributes.find(a=>a.name===r);if(!s)i.attributes.push({name:r,type:n});else if(n!==s.type)throw new Error(`The following attribute was used in different places with incompatible types: ${r}
Types were: ${Yo(s.type)} and ${Yo(n)}`);return(i.inFragmentShader?"v_":"a_")+r}};function d2(i){return"u_var_"+i}Ze.var={getReturnType:function(){return _e.ANY},toGlsl:function(i,e,t){Qt(e,1),u2(e[0]);const n=e[0].toString();if(!i.style.variables||i.style.variables[n]===void 0)throw new Error(`The following variable is missing from the style: ${n}`);const r=i.style.variables[n],s=t&Ui(r);Id(["var",...e],s,"");const o=i.variables.find(a=>a.name===n);if(!o)i.variables.push({name:n,type:s});else if(s!==o.type)throw new Error(`The following variable was used in different places with incompatible types: ${n}
Types were: ${Yo(o.type)} and ${Yo(s)}`);return d2(n)}};const f2="u_paletteTextures";Ze.palette={getReturnType:function(){return _e.COLOR},toGlsl:function(i,e){Qt(e,2),l2(e[0]);const t=Me(i,e[0]),n=e[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const r=n.length,s=new Uint8Array(r*4);for(let l=0;l<r;l++){const u=n[l];let c;if(typeof u=="string")c=SS(u);else{if(!Array.isArray(u))throw new Error("The second argument of palette must be an array of strings or colors");const d=u.length;if(d===4)c=u;else{if(d!==3)throw new Error(`Expected palette color to have 3 or 4 values, got ${d}`);c=[u[0],u[1],u[2],1]}}const h=l*4;s[h]=c[0],s[h+1]=c[1],s[h+2]=c[2],s[h+3]=c[3]*255}i.paletteTextures||(i.paletteTextures=[]);const o=`${f2}[${i.paletteTextures.length}]`,a=new hq(o,s);return i.paletteTextures.push(a),`texture2D(${o}, vec2((${t} + 0.5) / ${r}.0, 0.5))`}};const QE="getBandValue";Ze.band={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){Tr(e,1),Ed(e,3);const t=e[0];if(!(QE in i.functions)){let o="";const a=i.bandCount||1;for(let l=0;l<a;l++){const u=Math.floor(l/4);let c=l%4;l===a-1&&c===1&&(c=3);const h=`${Je.TILE_TEXTURE_ARRAY}[${u}]`;o+=`
          if (band == ${l+1}.0) {
            return texture2D(${h}, v_textureCoord + vec2(dx, dy))[${c}];
          }
        `}i.functions[QE]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / ${Je.TEXTURE_PIXEL_WIDTH};
          float dy = yOffset / ${Je.TEXTURE_PIXEL_HEIGHT};
          ${o}
        }
      `}const n=Me(i,t),r=Me(i,e[1]||0),s=Me(i,e[2]||0);return`${QE}(${n}, ${r}, ${s})`}},Ze.time={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,0),"u_time"}},Ze.zoom={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,0),"u_zoom"}},Ze.resolution={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,0),"u_resolution"}},Ze["geometry-type"]={getReturnType:function(){return _e.STRING},toGlsl:function(i,e){Qt(e,0);const t="geometryType",n=o=>{const a=o.getType();switch(a){case"Point":case"LineString":case"Polygon":return a;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return a.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return n(o.getGeometries()[0])}};return i.attributes.find(o=>o.name===t)||i.attributes.push({name:t,type:_e.STRING,callback:o=>n(o.getGeometry())}),(i.inFragmentShader?"v_":"a_")+t}},Ze["*"]={getReturnType:function(i){let e=_e.NUMBER|_e.COLOR;for(let t=0;t<i.length;t++)e=e&Ui(i[t]);return e},toGlsl:function(i,e,t){Tr(e,2);let n=t;for(let r=0;r<e.length;r++)n=n&Ui(e[r]);return NE(e,n,_e.NUMBER|_e.COLOR,"output"),`(${e.map(r=>Me(i,r,n)).join(" * ")})`}},Ze["/"]={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,2),li(e),`(${Me(i,e[0])} / ${Me(i,e[1])})`}},Ze["+"]={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Tr(e,2),li(e),`(${e.map(t=>Me(i,t)).join(" + ")})`}},Ze["-"]={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,2),li(e),`(${Me(i,e[0])} - ${Me(i,e[1])})`}},Ze.clamp={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){Qt(e,3),li(e);const t=Me(i,e[1]),n=Me(i,e[2]);return`clamp(${Me(i,e[0])}, ${t}, ${n})`}},Ze["%"]={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,2),li(e),`mod(${Me(i,e[0])}, ${Me(i,e[1])})`}},Ze["^"]={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,2),li(e),`pow(${Me(i,e[0])}, ${Me(i,e[1])})`}},Ze.abs={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`abs(${Me(i,e[0])})`}},Ze.floor={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`floor(${Me(i,e[0])})`}},Ze.round={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`floor(${Me(i,e[0])} + 0.5)`}},Ze.ceil={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`ceil(${Me(i,e[0])})`}},Ze.sin={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`sin(${Me(i,e[0])})`}},Ze.cos={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`cos(${Me(i,e[0])})`}},Ze.atan={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Tr(e,1),Ed(e,2),li(e),e.length===2?`atan(${Me(i,e[0])}, ${Me(i,e[1])})`:`atan(${Me(i,e[0])})`}},Ze.sqrt={getReturnType:function(){return _e.NUMBER},toGlsl:function(i,e){return Qt(e,1),li(e),`sqrt(${Me(i,e[0])})`}},Ze[">"]={getReturnType:function(){return _e.BOOLEAN},toGlsl:function(i,e){return Qt(e,2),li(e),`(${Me(i,e[0])} > ${Me(i,e[1])})`}},Ze[">="]={getReturnType:function(){return _e.BOOLEAN},toGlsl:function(i,e){return Qt(e,2),li(e),`(${Me(i,e[0])} >= ${Me(i,e[1])})`}},Ze["<"]={getReturnType:function(){return _e.BOOLEAN},toGlsl:function(i,e){return Qt(e,2),li(e),`(${Me(i,e[0])} < ${Me(i,e[1])})`}},Ze["<="]={getReturnType:function(){return _e.BOOLEAN},toGlsl:function(i,e){return Qt(e,2),li(e),`(${Me(i,e[0])} <= ${Me(i,e[1])})`}};function g2(i){return{getReturnType:function(){return _e.BOOLEAN},toGlsl:function(e,t){Qt(t,2);let n=_e.ANY;for(let r=0;r<t.length;r++)n&=Ui(t[r]);if(n===_e.NONE)throw new Error(`All arguments should be of compatible type, got ${JSON.stringify(t)} instead`);return n&=~_e.COLOR,`(${Me(e,t[0],n)} ${i} ${Me(e,t[1],n)})`}}}Ze["=="]=g2("=="),Ze["!="]=g2("!="),Ze["!"]={getReturnType:function(){return _e.BOOLEAN},toGlsl:function(i,e){return Qt(e,1),OE(e[0]),`(!${Me(i,e[0],_e.BOOLEAN)})`}};function A2(i){return{getReturnType:function(){return _e.BOOLEAN},toGlsl:function(e,t){Tr(t,2);for(let r=0;r<t.length;r++)OE(t[r]);let n=t.map(r=>Me(e,r,_e.BOOLEAN)).join(` ${i} `);return n=`(${n})`,n}}}Ze.all=A2("&&"),Ze.any=A2("||"),Ze.between={getReturnType:function(){return _e.BOOLEAN},toGlsl:function(i,e){Qt(e,3),li(e);const t=Me(i,e[1]),n=Me(i,e[2]),r=Me(i,e[0]);return`(${r} >= ${t} && ${r} <= ${n})`}},Ze.array={getReturnType:function(){return _e.NUMBER_ARRAY},toGlsl:function(i,e){Tr(e,2),Ed(e,4),li(e);const t=e.map(function(n){return Me(i,n)});return`vec${e.length}(${t.join(", ")})`}},Ze.color={getReturnType:function(){return _e.COLOR},toGlsl:function(i,e){Tr(e,3),Ed(e,4),li(e);const t=e.slice(0,3).map(r=>`${Me(i,r)} / 255.0`);return e.length===3?`vec4(${t.join(", ")}, 1.0)`:`(${Me(i,e[3])} * vec4(${t.join(", ")}, 1.0))`}},Ze.interpolate={getReturnType:function(i){let e=_e.COLOR|_e.NUMBER;for(let t=3;t<i.length;t+=2)e=e&Ui(i[t]);return e},toGlsl:function(i,e,t){c2(e),Tr(e,6);const n=e[0];let r;switch(n[0]){case"linear":r=1;break;case"exponential":r=n[1];break;default:r=null}if(!r)throw new Error(`Invalid interpolation type for "interpolate" operator, received: ${JSON.stringify(n)}`);const s=_e.NUMBER,o=Ze.interpolate.getReturnType(e)&t;Id(["interpolate",...e],o,"output");const a=Me(i,e[1],s),l=PA(r);let u="";for(let c=2;c<e.length-2;c+=2){const h=Me(i,e[c],s),d=u||Me(i,e[c+1],o),g=Me(i,e[c+2],s),A=Me(i,e[c+3],o);let p;r===1?p=`(${a} - ${h}) / (${g} - ${h})`:p=`(pow(${l}, (${a} - ${h})) - 1.0) / (pow(${l}, (${g} - ${h})) - 1.0)`,u=`mix(${d}, ${A}, clamp(${p}, 0.0, 1.0))`}return u}},Ze.match={getReturnType:function(i){let e=_e.ANY;for(let t=2;t<i.length;t+=2)e=e&Ui(i[t]);return e=e&Ui(i[i.length-1]),e},toGlsl:function(i,e,t){c2(e),Tr(e,4);let n=Ui(e[0]);for(let l=1;l<e.length-1;l+=2)n=n&Ui(e[l]);NE(["match",...e],n,_e.STRING|_e.NUMBER|_e.BOOLEAN,"input"),n=(_e.STRING|_e.NUMBER|_e.BOOLEAN)&n;const r=Ze.match.getReturnType(e)&t;Id(["match",...e],r,"output");const s=Me(i,e[0],n),o=Me(i,e[e.length-1],r);let a=null;for(let l=e.length-3;l>=1;l-=2){const u=Me(i,e[l],n),c=Me(i,e[l+1],r);a=`(${s} == ${u} ? ${c} : ${a||o})`}return a}},Ze.case={getReturnType:function(i){let e=_e.ANY;for(let t=1;t<i.length;t+=2)e=e&Ui(i[t]);return e=e&Ui(i[i.length-1]),e},toGlsl:function(i,e,t){yq(e),Tr(e,3);const n=Ze.case.getReturnType(e)&t;Id(["case",...e],n,"output");for(let o=0;o<e.length-1;o+=2)OE(e[o]);const r=Me(i,e[e.length-1],n);let s=null;for(let o=e.length-3;o>=0;o-=2){const a=Me(i,e[o],_e.BOOLEAN),l=Me(i,e[o+1],n);s=`(${a} ? ${l} : ${s||r})`}return s}},Ze.in={getReturnType:function(i){return _e.BOOLEAN},toGlsl:function(i,e){Qt(e,2);const t=e[0];let n=e[1];if(!Array.isArray(n))throw new Error('The "in" operator expects an array literal as its second argument.');if(typeof n[0]=="string"){if(n[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(n[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');n=n[1]}let r=Ui(t);for(let a=0;a<n.length-1;a+=1)r=r&Ui(n[a]);NE(["match",...e],r,_e.STRING|_e.NUMBER|_e.BOOLEAN,"input"),r=(_e.STRING|_e.NUMBER|_e.BOOLEAN)&r;const s=gq("in",i),o=[];for(let a=0;a<n.length;a+=1)o.push(`  if (inputValue == ${Me(i,n[a],r)}) { return true; }`);return i.functions[s]=`bool ${s}(float inputValue) {
${o.join(`
`)}
  return false;
}`,`${s}(${Me(i,t,r)})`}};function p2(i,e){const t=`
    attribute vec2 ${kA.TEXTURE_COORD};
    uniform mat4 ${Je.TILE_TRANSFORM};
    uniform float ${Je.TEXTURE_PIXEL_WIDTH};
    uniform float ${Je.TEXTURE_PIXEL_HEIGHT};
    uniform float ${Je.TEXTURE_RESOLUTION};
    uniform float ${Je.TEXTURE_ORIGIN_X};
    uniform float ${Je.TEXTURE_ORIGIN_Y};
    uniform float ${Je.DEPTH};

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = ${kA.TEXTURE_COORD};
      v_mapCoord = vec2(
        ${Je.TEXTURE_ORIGIN_X} + ${Je.TEXTURE_RESOLUTION} * ${Je.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],
        ${Je.TEXTURE_ORIGIN_Y} - ${Je.TEXTURE_RESOLUTION} * ${Je.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]
      );
      gl_Position = ${Je.TILE_TRANSFORM} * vec4(${kA.TEXTURE_COORD}, ${Je.DEPTH}, 1.0);
    }
  `,n={inFragmentShader:!0,variables:[],attributes:[],functions:{},bandCount:e,style:i},r=[];if(i.color!==void 0){const h=Me(n,i.color,_e.COLOR);r.push(`color = ${h};`)}if(i.contrast!==void 0){const h=Me(n,i.contrast,_e.NUMBER);r.push(`color.rgb = clamp((${h} + 1.0) * color.rgb - (${h} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(i.exposure!==void 0){const h=Me(n,i.exposure,_e.NUMBER);r.push(`color.rgb = clamp((${h} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(i.saturation!==void 0){const h=Me(n,i.saturation,_e.NUMBER);r.push(`
      float saturation = ${h} + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `)}if(i.gamma!==void 0){const h=Me(n,i.gamma,_e.NUMBER);r.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${h}));`)}if(i.brightness!==void 0){const h=Me(n,i.brightness,_e.NUMBER);r.push(`color.rgb = clamp(color.rgb + ${h}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const s={},o=n.variables.length;if(o>1&&!i.variables)throw new Error(`Missing variables in style (expected ${n.variables})`);for(let h=0;h<o;++h){const d=n.variables[h];if(!(d.name in i.variables))throw new Error(`Missing '${d.name}' in style variables`);const g=d2(d.name);s[g]=function(){let A=i.variables[d.name];return typeof A=="string"&&(A=a2(A)),A!==void 0?A:-9999999}}const a=Object.keys(s).map(function(h){return`uniform float ${h};`}),l=Math.ceil(e/4);a.push(`uniform sampler2D ${Je.TILE_TEXTURE_ARRAY}[${l}];`),n.paletteTextures&&a.push(`uniform sampler2D ${f2}[${n.paletteTextures.length}];`);const u=Object.keys(n.functions).map(function(h){return n.functions[h]}),c=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 ${Je.RENDER_EXTENT};
    uniform float ${Je.TRANSITION_ALPHA};
    uniform float ${Je.TEXTURE_PIXEL_WIDTH};
    uniform float ${Je.TEXTURE_PIXEL_HEIGHT};
    uniform float ${Je.RESOLUTION};
    uniform float ${Je.ZOOM};

    ${a.join(`
`)}

    ${u.join(`
`)}

    void main() {
      if (
        v_mapCoord[0] < ${Je.RENDER_EXTENT}[0] ||
        v_mapCoord[1] < ${Je.RENDER_EXTENT}[1] ||
        v_mapCoord[0] > ${Je.RENDER_EXTENT}[2] ||
        v_mapCoord[1] > ${Je.RENDER_EXTENT}[3]
      ) {
        discard;
      }

      vec4 color = texture2D(${Je.TILE_TEXTURE_ARRAY}[0],  v_textureCoord);

      ${r.join(`
`)}

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= ${Je.TRANSITION_ALPHA};
    }`;return{vertexShader:t,fragmentShader:c,uniforms:s,paletteTextures:n.paletteTextures}}class m2 extends RT{constructor(e){e=e?Object.assign({},e):{};const t=e.style||{};delete e.style;const n=e.cacheSize;delete e.cacheSize,super(e),this.sources_=e.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=t,this.cacheSize_=n,this.styleVariables_=this.style_.variables||{},this.addChangeListener(bt.SOURCE,this.handleSourceUpdate_)}getSources(e,t){const n=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(e,t):this.sources_:n?[n]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const e=this.getRenderSource();return e?e.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}getSourceBandCount_(){const e=Number.MAX_SAFE_INTEGER,t=this.getSources([-e,-e,e,e],e);return t&&t.length&&"bandCount"in t[0]?t[0].bandCount:4}createRenderer(){const e=p2(this.style_,this.getSourceBandCount_());return new cq(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})}renderSources(e,t){const n=this.getRenderer();let r;for(let s=0,o=t.length;s<o;++s)this.renderedSource_=t[s],n.prepareFrame(e)&&(r=n.renderFrame(e));return r}render(e,t){this.rendered=!0;const n=e.viewState,r=this.getSources(e.extent,n.resolution);let s=!0;for(let a=0,l=r.length;a<l;++a){const u=r[a],c=u.getState();if(c=="loading"){const h=()=>{u.getState()=="ready"&&(u.removeEventListener("change",h),this.changed())};u.addEventListener("change",h)}s=s&&c=="ready"}const o=this.renderSources(e,r);if(this.getRenderer().renderComplete&&s)return this.renderedResolution_=n.resolution,o;if(this.renderedResolution_>.5*n.resolution){const a=this.getSources(e.extent,this.renderedResolution_).filter(l=>!r.includes(l));if(a.length>0)return this.renderSources(e,a)}return o}setStyle(e){this.styleVariables_=e.variables||{},this.style_=e;const t=p2(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms}),this.changed()}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}m2.prototype.dispose;const vq=i=>(J5(),new DH({declutter:!0,source:new W7({url:i}),style:new fu({stroke:new lu({color:"#7070B3",width:1}),fill:new Wa({color:"#FFFFFF"}),image:new qh({radius:7,fill:new Wa({color:"#7070B3"}),stroke:new lu({color:"#FFFFFF",width:2})})})})),Eq=i=>new m2({source:new QV({sources:[{url:i}],convertToRGB:!0})}),y2={darkMatter:{url:"https://{a-d}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},positron:{url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},positronLite:{url:"https://{a-d}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},worldAntique:{url:"https://cartocdn_{a-d}.global.ssl.fastly.net/base-antique/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},worldEco:{url:"https://cartocdn_{a-d}.global.ssl.fastly.net/base-eco/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},flatBlue:{url:"https://cartocdn_{a-d}.global.ssl.fastly.net/base-flatblue/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},midnightCommander:{url:"https://cartocdn_{a-d}.global.ssl.fastly.net/base-midnight/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributionss">Carto</a>',maxZoom:18},openstreetmapHot:{url:"https://{a-c}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>',maxZoom:19},openstreetmapStandard:{url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attributions:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}};function v2(i){return i.replace(/(?:[_-])([a-z0-9])/g,(e,t)=>t.toUpperCase())}function Iq(i){return v2(i.replace(/--/g,"-").replace(/__/g,"_"))}function MA(i){return i.charAt(0).toUpperCase()+i.slice(1)}function _q(i){return i.replace(/([A-Z])/g,(e,t)=>`-${t.toLowerCase()}`)}function E2(i){return i!=null}function I2(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function UE(i,e){const t=_2(i);return Array.from(t.reduce((n,r)=>(wq(r,e).forEach(s=>n.add(s)),n),new Set))}function Cq(i,e){return _2(i).reduce((n,r)=>(n.push(...xq(r,e)),n),[])}function _2(i){const e=[];for(;i;)e.push(i),i=Object.getPrototypeOf(i);return e.reverse()}function wq(i,e){const t=i[e];return Array.isArray(t)?t:[]}function xq(i,e){const t=i[e];return t?Object.keys(t).map(n=>[n,t[n]]):[]}(()=>{function i(t){function n(){return Reflect.construct(t,arguments,new.target)}return n.prototype=Object.create(t.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,t),n}function e(){const n=i(function(){this.a.call(this)});return n.prototype.a=function(){},new n}try{return e(),i}catch{return n=>class extends n{}}})(),Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},C2("abcdefghijklmnopqrstuvwxyz".split("").map(i=>[i,i]))),C2("0123456789".split("").map(i=>[i,i])));function C2(i){return i.reduce((e,[t,n])=>Object.assign(Object.assign({},e),{[t]:n}),{})}function bq(i){return UE(i,"classes").reduce((t,n)=>Object.assign(t,Sq(n)),{})}function Sq(i){return{[`${i}Class`]:{get(){const{classes:e}=this;if(e.has(i))return e.get(i);{const t=e.getAttributeName(i);throw new Error(`Missing attribute "${t}"`)}}},[`${i}Classes`]:{get(){return this.classes.getAll(i)}},[`has${MA(i)}Class`]:{get(){return this.classes.has(i)}}}}function Tq(i){return UE(i,"outlets").reduce((t,n)=>Object.assign(t,Bq(n)),{})}function w2(i,e,t){return i.application.getControllerForElementAndIdentifier(e,t)}function x2(i,e,t){let n=w2(i,e,t);if(n||(i.application.router.proposeToConnectScopeForElementAndIdentifier(e,t),n=w2(i,e,t),n))return n}function Bq(i){const e=Iq(i);return{[`${e}Outlet`]:{get(){const t=this.outlets.find(i),n=this.outlets.getSelectorForOutletName(i);if(t){const r=x2(this,t,i);if(r)return r;throw new Error(`The provided outlet element is missing an outlet controller "${i}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${i}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${e}Outlets`]:{get(){const t=this.outlets.findAll(i);return t.length>0?t.map(n=>{const r=x2(this,n,i);if(r)return r;console.warn(`The provided outlet element is missing an outlet controller "${i}" instance for host controller "${this.identifier}"`,n)}).filter(n=>n):[]}},[`${e}OutletElement`]:{get(){const t=this.outlets.find(i),n=this.outlets.getSelectorForOutletName(i);if(t)return t;throw new Error(`Missing outlet element "${i}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(i)}},[`has${MA(e)}Outlet`]:{get(){return this.outlets.has(i)}}}}function Rq(i){return UE(i,"targets").reduce((t,n)=>Object.assign(t,Lq(n)),{})}function Lq(i){return{[`${i}Target`]:{get(){const e=this.targets.find(i);if(e)return e;throw new Error(`Missing target element "${i}" for "${this.identifier}" controller`)}},[`${i}Targets`]:{get(){return this.targets.findAll(i)}},[`has${MA(i)}Target`]:{get(){return this.targets.has(i)}}}}function Dq(i){const e=Cq(i,"values"),t={valueDescriptorMap:{get(){return e.reduce((n,r)=>{const s=b2(r,this.identifier),o=this.data.getAttributeNameForKey(s.key);return Object.assign(n,{[o]:s})},{})}}};return e.reduce((n,r)=>Object.assign(n,kq(r)),t)}function kq(i,e){const t=b2(i,e),{key:n,name:r,reader:s,writer:o}=t;return{[r]:{get(){const a=this.data.get(n);return a!==null?s(a):t.defaultValue},set(a){a===void 0?this.data.delete(n):this.data.set(n,o(a))}},[`has${MA(r)}`]:{get(){return this.data.has(n)||t.hasCustomDefaultValue}}}}function b2([i,e],t){return Oq({controller:t,token:i,typeDefinition:e})}function FA(i){switch(i){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function _d(i){switch(typeof i){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(i))return"array";if(Object.prototype.toString.call(i)==="[object Object]")return"object"}function Pq(i){const{controller:e,token:t,typeObject:n}=i,r=E2(n.type),s=E2(n.default),o=r&&s,a=r&&!s,l=!r&&s,u=FA(n.type),c=_d(i.typeObject.default);if(a)return u;if(l)return c;if(u!==c){const h=e?`${e}.${t}`:t;throw new Error(`The specified default value for the Stimulus Value "${h}" must match the defined type "${u}". The provided default value of "${n.default}" is of type "${c}".`)}if(o)return u}function Mq(i){const{controller:e,token:t,typeDefinition:n}=i,s=Pq({controller:e,token:t,typeObject:n}),o=_d(n),a=FA(n),l=s||o||a;if(l)return l;const u=e?`${e}.${n}`:t;throw new Error(`Unknown value type "${u}" for "${t}" value`)}function Fq(i){const e=FA(i);if(e)return S2[e];const t=I2(i,"default"),n=I2(i,"type"),r=i;if(t)return r.default;if(n){const{type:s}=r,o=FA(s);if(o)return S2[o]}return i}function Oq(i){const{token:e,typeDefinition:t}=i,n=`${_q(e)}-value`,r=Mq(i);return{type:r,key:n,name:v2(n),get defaultValue(){return Fq(t)},get hasCustomDefaultValue(){return _d(t)!==void 0},reader:Nq[r],writer:T2[r]||T2.default}}const S2={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Nq={array(i){const e=JSON.parse(i);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${i}" of type "${_d(e)}"`);return e},boolean(i){return!(i=="0"||String(i).toLowerCase()=="false")},number(i){return Number(i.replace(/_/g,""))},object(i){const e=JSON.parse(i);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${i}" of type "${_d(e)}"`);return e},string(i){return i}},T2={default:Qq,array:B2,object:B2};function B2(i){return JSON.stringify(i)}function Qq(i){return`${i}`}class Br{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:n={},prefix:r=this.identifier,bubbles:s=!0,cancelable:o=!0}={}){const a=r?`${r}:${e}`:e,l=new CustomEvent(a,{detail:n,bubbles:s,cancelable:o});return t.dispatchEvent(l),l}}Br.blessings=[bq,Rq,Dq,Tq],Br.targets=[],Br.outlets=[],Br.values={};class GE extends Br{async connect(){this.basemap=this.getBasemap(),this.overlay=this.getPreviewOverlay(this.protocolValue,this.urlValue),await this.getBounds(),this.loadMap()}loadMap(){this.map=new V9({target:this.element,controls:vT().extend([new bH]),layers:[this.basemap,this.overlay]}),this.map.getView().fit(this.extent,this.map.getSize())}async getBounds(){if(this.protocolValue=="Cog"){const e=await this.overlay.getSource().getView();this.extent=e.extent}else this.extent=new hH().readFeatures(this.mapGeomValue)[0].getGeometry().getExtent()}getBasemap(){const e=y2[this.basemapValue||"positron"];return new J9({source:new uH(e)})}getPreviewOverlay(e,t){if(e==="Pmtiles")return vq(t);if(e==="Cog")return Eq(t);console.error(`Unsupported protocol name: "${e}"`)}}Ni(GE,"values",{url:String,protocol:String,basemap:String,mapGeom:String});var R2={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cd=Symbol.for("react.element"),Uq=Symbol.for("react.portal"),Gq=Symbol.for("react.fragment"),Hq=Symbol.for("react.strict_mode"),zq=Symbol.for("react.profiler"),Vq=Symbol.for("react.provider"),qq=Symbol.for("react.context"),$q=Symbol.for("react.forward_ref"),jq=Symbol.for("react.suspense"),Wq=Symbol.for("react.memo"),Kq=Symbol.for("react.lazy"),L2=Symbol.iterator;function Yq(i){return i===null||typeof i!="object"?null:(i=L2&&i[L2]||i["@@iterator"],typeof i=="function"?i:null)}var D2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k2=Object.assign,P2={};function Gu(i,e,t){this.props=i,this.context=e,this.refs=P2,this.updater=t||D2}Gu.prototype.isReactComponent={},Gu.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")},Gu.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function M2(){}M2.prototype=Gu.prototype;function HE(i,e,t){this.props=i,this.context=e,this.refs=P2,this.updater=t||D2}var zE=HE.prototype=new M2;zE.constructor=HE,k2(zE,Gu.prototype),zE.isPureReactComponent=!0;var F2=Array.isArray,O2=Object.prototype.hasOwnProperty,VE={current:null},N2={key:!0,ref:!0,__self:!0,__source:!0};function Q2(i,e,t){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)O2.call(e,n)&&!N2.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(i&&i.defaultProps)for(n in a=i.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:Cd,type:i,key:s,ref:o,props:r,_owner:VE.current}}function Zq(i,e){return{$$typeof:Cd,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function qE(i){return typeof i=="object"&&i!==null&&i.$$typeof===Cd}function Xq(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var U2=/\/+/g;function $E(i,e){return typeof i=="object"&&i!==null&&i.key!=null?Xq(""+i.key):e.toString(36)}function OA(i,e,t,n,r){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var o=!1;if(i===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(i.$$typeof){case Cd:case Uq:o=!0}}if(o)return o=i,r=r(o),i=n===""?"."+$E(o,0):n,F2(r)?(t="",i!=null&&(t=i.replace(U2,"$&/")+"/"),OA(r,e,t,"",function(u){return u})):r!=null&&(qE(r)&&(r=Zq(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(U2,"$&/")+"/")+i)),e.push(r)),1;if(o=0,n=n===""?".":n+":",F2(i))for(var a=0;a<i.length;a++){s=i[a];var l=n+$E(s,a);o+=OA(s,e,t,l,r)}else if(l=Yq(i),typeof l=="function")for(i=l.call(i),a=0;!(s=i.next()).done;)s=s.value,l=n+$E(s,a++),o+=OA(s,e,t,l,r);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function NA(i,e,t){if(i==null)return i;var n=[],r=0;return OA(i,n,"","",function(s){return e.call(t,s,r++)}),n}function Jq(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var dn={current:null},QA={transition:null},e$={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:QA,ReactCurrentOwner:VE};function G2(){throw Error("act(...) is not supported in production builds of React.")}ct.Children={map:NA,forEach:function(i,e,t){NA(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return NA(i,function(){e++}),e},toArray:function(i){return NA(i,function(e){return e})||[]},only:function(i){if(!qE(i))throw Error("React.Children.only expected to receive a single React element child.");return i}},ct.Component=Gu,ct.Fragment=Gq,ct.Profiler=zq,ct.PureComponent=HE,ct.StrictMode=Hq,ct.Suspense=jq,ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e$,ct.act=G2,ct.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var n=k2({},i.props),r=i.key,s=i.ref,o=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=VE.current),e.key!==void 0&&(r=""+e.key),i.type&&i.type.defaultProps)var a=i.type.defaultProps;for(l in e)O2.call(e,l)&&!N2.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:Cd,type:i.type,key:r,ref:s,props:n,_owner:o}},ct.createContext=function(i){return i={$$typeof:qq,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Vq,_context:i},i.Consumer=i},ct.createElement=Q2,ct.createFactory=function(i){var e=Q2.bind(null,i);return e.type=i,e},ct.createRef=function(){return{current:null}},ct.forwardRef=function(i){return{$$typeof:$q,render:i}},ct.isValidElement=qE,ct.lazy=function(i){return{$$typeof:Kq,_payload:{_status:-1,_result:i},_init:Jq}},ct.memo=function(i,e){return{$$typeof:Wq,type:i,compare:e===void 0?null:e}},ct.startTransition=function(i){var e=QA.transition;QA.transition={};try{i()}finally{QA.transition=e}},ct.unstable_act=G2,ct.useCallback=function(i,e){return dn.current.useCallback(i,e)},ct.useContext=function(i){return dn.current.useContext(i)},ct.useDebugValue=function(){},ct.useDeferredValue=function(i){return dn.current.useDeferredValue(i)},ct.useEffect=function(i,e){return dn.current.useEffect(i,e)},ct.useId=function(){return dn.current.useId()},ct.useImperativeHandle=function(i,e,t){return dn.current.useImperativeHandle(i,e,t)},ct.useInsertionEffect=function(i,e){return dn.current.useInsertionEffect(i,e)},ct.useLayoutEffect=function(i,e){return dn.current.useLayoutEffect(i,e)},ct.useMemo=function(i,e){return dn.current.useMemo(i,e)},ct.useReducer=function(i,e,t){return dn.current.useReducer(i,e,t)},ct.useRef=function(i){return dn.current.useRef(i)},ct.useState=function(i){return dn.current.useState(i)},ct.useSyncExternalStore=function(i,e,t){return dn.current.useSyncExternalStore(i,e,t)},ct.useTransition=function(){return dn.current.useTransition()},ct.version="18.3.1",R2.exports=ct;var k=R2.exports;const P=jo(k),t$=Ir({__proto__:null,default:P},[k]);var H2={exports:{}},qn={},z2={exports:{}},V2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(V,Z){var Y=V.length;V.push(Z);e:for(;0<Y;){var te=Y-1>>>1,J=V[te];if(0<r(J,Z))V[te]=Z,V[Y]=J,Y=te;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var Z=V[0],Y=V.pop();if(Y!==Z){V[0]=Y;e:for(var te=0,J=V.length,ce=J>>>1;te<ce;){var ie=2*(te+1)-1,ne=V[ie],ue=ie+1,fe=V[ue];if(0>r(ne,Y))ue<J&&0>r(fe,ne)?(V[te]=fe,V[ue]=Y,te=ue):(V[te]=ne,V[ie]=Y,te=ie);else if(ue<J&&0>r(fe,Y))V[te]=fe,V[ue]=Y,te=ue;else break e}}return Z}function r(V,Z){var Y=V.sortIndex-Z.sortIndex;return Y!==0?Y:V.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();i.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,g=!1,A=!1,p=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(V){for(var Z=t(u);Z!==null;){if(Z.callback===null)n(u);else if(Z.startTime<=V)n(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=t(u)}}function C(V){if(p=!1,I(V),!A)if(t(l)!==null)A=!0,G(w);else{var Z=t(u);Z!==null&&j(C,Z.startTime-V)}}function w(V,Z){A=!1,p&&(p=!1,v(T),T=-1),g=!0;var Y=d;try{for(I(Z),h=t(l);h!==null&&(!(h.expirationTime>Z)||V&&!R());){var te=h.callback;if(typeof te=="function"){h.callback=null,d=h.priorityLevel;var J=te(h.expirationTime<=Z);Z=i.unstable_now(),typeof J=="function"?h.callback=J:h===t(l)&&n(l),I(Z)}else n(l);h=t(l)}if(h!==null)var ce=!0;else{var ie=t(u);ie!==null&&j(C,ie.startTime-Z),ce=!1}return ce}finally{h=null,d=Y,g=!1}}var S=!1,x=null,T=-1,Q=5,M=-1;function R(){return!(i.unstable_now()-M<Q)}function z(){if(x!==null){var V=i.unstable_now();M=V;var Z=!0;try{Z=x(!0,V)}finally{Z?q():(S=!1,x=null)}}else S=!1}var q;if(typeof E=="function")q=function(){E(z)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,N=X.port2;X.port1.onmessage=z,q=function(){N.postMessage(null)}}else q=function(){y(z,0)};function G(V){x=V,S||(S=!0,q())}function j(V,Z){T=y(function(){V(i.unstable_now())},Z)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(V){V.callback=null},i.unstable_continueExecution=function(){A||g||(A=!0,G(w))},i.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<V?Math.floor(1e3/V):5},i.unstable_getCurrentPriorityLevel=function(){return d},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(V){switch(d){case 1:case 2:case 3:var Z=3;break;default:Z=d}var Y=d;d=Z;try{return V()}finally{d=Y}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(V,Z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Y=d;d=V;try{return Z()}finally{d=Y}},i.unstable_scheduleCallback=function(V,Z,Y){var te=i.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?te+Y:te):Y=te,V){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Y+J,V={id:c++,callback:Z,priorityLevel:V,startTime:Y,expirationTime:J,sortIndex:-1},Y>te?(V.sortIndex=Y,e(u,V),t(l)===null&&V===t(u)&&(p?(v(T),T=-1):p=!0,j(C,Y-te))):(V.sortIndex=J,e(l,V),A||g||(A=!0,G(w))),V},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(V){var Z=d;return function(){var Y=d;d=Z;try{return V.apply(this,arguments)}finally{d=Y}}}})(V2),z2.exports=V2;var i$=z2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n$=k,$n=i$;function Ce(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q2=new Set,wd={};function il(i,e){Hu(i,e),Hu(i+"Capture",e)}function Hu(i,e){for(wd[i]=e,i=0;i<e.length;i++)q2.add(e[i])}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jE=Object.prototype.hasOwnProperty,r$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$2={},j2={};function s$(i){return jE.call(j2,i)?!0:jE.call($2,i)?!1:r$.test(i)?j2[i]=!0:($2[i]=!0,!1)}function o$(i,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function a$(i,e,t,n){if(e===null||typeof e>"u"||o$(i,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fn(i,e,t,n,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Gi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Gi[i]=new fn(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Gi[e]=new fn(e,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){Gi[i]=new fn(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Gi[i]=new fn(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Gi[i]=new fn(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){Gi[i]=new fn(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){Gi[i]=new fn(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){Gi[i]=new fn(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){Gi[i]=new fn(i,5,!1,i.toLowerCase(),null,!1,!1)});var WE=/[\-:]([a-z])/g;function KE(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(WE,KE);Gi[e]=new fn(e,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(WE,KE);Gi[e]=new fn(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(WE,KE);Gi[e]=new fn(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){Gi[i]=new fn(i,1,!1,i.toLowerCase(),null,!1,!1)}),Gi.xlinkHref=new fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){Gi[i]=new fn(i,1,!1,i.toLowerCase(),null,!0,!0)});function YE(i,e,t,n){var r=Gi.hasOwnProperty(e)?Gi[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(a$(e,t,r,n)&&(t=null),n||r===null?s$(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):r.mustUseProperty?i[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,n=r.attributeNamespace,t===null?i.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,n?i.setAttributeNS(n,e,t):i.setAttribute(e,t))))}var Vs=n$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,UA=Symbol.for("react.element"),zu=Symbol.for("react.portal"),Vu=Symbol.for("react.fragment"),ZE=Symbol.for("react.strict_mode"),XE=Symbol.for("react.profiler"),W2=Symbol.for("react.provider"),K2=Symbol.for("react.context"),JE=Symbol.for("react.forward_ref"),e1=Symbol.for("react.suspense"),t1=Symbol.for("react.suspense_list"),i1=Symbol.for("react.memo"),Zo=Symbol.for("react.lazy"),Y2=Symbol.for("react.offscreen"),Z2=Symbol.iterator;function xd(i){return i===null||typeof i!="object"?null:(i=Z2&&i[Z2]||i["@@iterator"],typeof i=="function"?i:null)}var Jt=Object.assign,n1;function bd(i){if(n1===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);n1=e&&e[1]||""}return`
`+n1+i}var r1=!1;function s1(i,e){if(!i||r1)return"";r1=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(i,[],e)}else{try{e.call()}catch(u){n=u}i.call(e.prototype)}else{try{throw Error()}catch(u){n=u}i()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=n.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=o&&0<=a);break}}}finally{r1=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?bd(i):""}function l$(i){switch(i.tag){case 5:return bd(i.type);case 16:return bd("Lazy");case 13:return bd("Suspense");case 19:return bd("SuspenseList");case 0:case 2:case 15:return i=s1(i.type,!1),i;case 11:return i=s1(i.type.render,!1),i;case 1:return i=s1(i.type,!0),i;default:return""}}function o1(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Vu:return"Fragment";case zu:return"Portal";case XE:return"Profiler";case ZE:return"StrictMode";case e1:return"Suspense";case t1:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case K2:return(i.displayName||"Context")+".Consumer";case W2:return(i._context.displayName||"Context")+".Provider";case JE:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case i1:return e=i.displayName||null,e!==null?e:o1(i.type)||"Memo";case Zo:e=i._payload,i=i._init;try{return o1(i(e))}catch{}}return null}function u$(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return o1(e);case 8:return e===ZE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xo(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function X2(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function c$(i){var e=X2(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),n=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function GA(i){i._valueTracker||(i._valueTracker=c$(i))}function J2(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return i&&(n=X2(i)?i.checked?"true":"false":i.value),i=n,i!==t?(e.setValue(i),!0):!1}function HA(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function a1(i,e){var t=e.checked;return Jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function eR(i,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=Xo(e.value!=null?e.value:t),i._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tR(i,e){e=e.checked,e!=null&&YE(i,"checked",e,!1)}function l1(i,e){tR(i,e);var t=Xo(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(n==="submit"||n==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?u1(i,e.type,t):e.hasOwnProperty("defaultValue")&&u1(i,e.type,Xo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function iR(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function u1(i,e,t){(e!=="number"||HA(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var Sd=Array.isArray;function qu(i,e,t,n){if(i=i.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<i.length;t++)r=e.hasOwnProperty("$"+i[t].value),i[t].selected!==r&&(i[t].selected=r),r&&n&&(i[t].defaultSelected=!0)}else{for(t=""+Xo(t),e=null,r=0;r<i.length;r++){if(i[r].value===t){i[r].selected=!0,n&&(i[r].defaultSelected=!0);return}e!==null||i[r].disabled||(e=i[r])}e!==null&&(e.selected=!0)}}function c1(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ce(91));return Jt({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function nR(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Ce(92));if(Sd(t)){if(1<t.length)throw Error(Ce(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Xo(t)}}function rR(i,e){var t=Xo(e.value),n=Xo(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),n!=null&&(i.defaultValue=""+n)}function sR(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function oR(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function h1(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?oR(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var zA,aR=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return i(e,t,n,r)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(zA=zA||document.createElement("div"),zA.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=zA.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function Td(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Bd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},h$=["Webkit","ms","Moz","O"];Object.keys(Bd).forEach(function(i){h$.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Bd[e]=Bd[i]})});function lR(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Bd.hasOwnProperty(i)&&Bd[i]?(""+e).trim():e+"px"}function uR(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,r=lR(t,e[t],n);t==="float"&&(t="cssFloat"),n?i.setProperty(t,r):i[t]=r}}var d$=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function d1(i,e){if(e){if(d$[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ce(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ce(62))}}function f1(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g1=null;function A1(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var p1=null,$u=null,ju=null;function cR(i){if(i=Zd(i)){if(typeof p1!="function")throw Error(Ce(280));var e=i.stateNode;e&&(e=d0(e),p1(i.stateNode,i.type,e))}}function hR(i){$u?ju?ju.push(i):ju=[i]:$u=i}function dR(){if($u){var i=$u,e=ju;if(ju=$u=null,cR(i),e)for(i=0;i<e.length;i++)cR(e[i])}}function fR(i,e){return i(e)}function gR(){}var m1=!1;function AR(i,e,t){if(m1)return i(e,t);m1=!0;try{return fR(i,e,t)}finally{m1=!1,($u!==null||ju!==null)&&(gR(),dR())}}function Rd(i,e){var t=i.stateNode;if(t===null)return null;var n=d0(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(i=i.type,n=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!n;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(Ce(231,e,typeof t));return t}var y1=!1;if(zs)try{var Ld={};Object.defineProperty(Ld,"passive",{get:function(){y1=!0}}),window.addEventListener("test",Ld,Ld),window.removeEventListener("test",Ld,Ld)}catch{y1=!1}function f$(i,e,t,n,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var Dd=!1,VA=null,qA=!1,v1=null,g$={onError:function(i){Dd=!0,VA=i}};function A$(i,e,t,n,r,s,o,a,l){Dd=!1,VA=null,f$.apply(g$,arguments)}function p$(i,e,t,n,r,s,o,a,l){if(A$.apply(this,arguments),Dd){if(Dd){var u=VA;Dd=!1,VA=null}else throw Error(Ce(198));qA||(qA=!0,v1=u)}}function nl(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function pR(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function mR(i){if(nl(i)!==i)throw Error(Ce(188))}function m$(i){var e=i.alternate;if(!e){if(e=nl(i),e===null)throw Error(Ce(188));return e!==i?null:i}for(var t=i,n=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){t=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return mR(r),i;if(s===n)return mR(r),e;s=s.sibling}throw Error(Ce(188))}if(t.return!==n.return)t=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,n=s;break}if(a===n){o=!0,n=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,n=r;break}if(a===n){o=!0,n=s,t=r;break}a=a.sibling}if(!o)throw Error(Ce(189))}}if(t.alternate!==n)throw Error(Ce(190))}if(t.tag!==3)throw Error(Ce(188));return t.stateNode.current===t?i:e}function yR(i){return i=m$(i),i!==null?vR(i):null}function vR(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=vR(i);if(e!==null)return e;i=i.sibling}return null}var ER=$n.unstable_scheduleCallback,IR=$n.unstable_cancelCallback,y$=$n.unstable_shouldYield,v$=$n.unstable_requestPaint,ui=$n.unstable_now,E$=$n.unstable_getCurrentPriorityLevel,E1=$n.unstable_ImmediatePriority,_R=$n.unstable_UserBlockingPriority,$A=$n.unstable_NormalPriority,I$=$n.unstable_LowPriority,CR=$n.unstable_IdlePriority,jA=null,ns=null;function _$(i){if(ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(jA,i,void 0,(i.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:x$,C$=Math.log,w$=Math.LN2;function x$(i){return i>>>=0,i===0?32:31-(C$(i)/w$|0)|0}var WA=64,KA=4194304;function kd(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function YA(i,e){var t=i.pendingLanes;if(t===0)return 0;var n=0,r=i.suspendedLanes,s=i.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?n=kd(a):(s&=o,s!==0&&(n=kd(s)))}else o=t&~r,o!==0?n=kd(o):s!==0&&(n=kd(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&r)&&(r=n&-n,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(n&4&&(n|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=n;0<e;)t=31-Rr(e),r=1<<t,n|=i[t],e&=~r;return n}function b$(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S$(i,e){for(var t=i.suspendedLanes,n=i.pingedLanes,r=i.expirationTimes,s=i.pendingLanes;0<s;){var o=31-Rr(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&n)&&(r[o]=b$(a,e)):l<=e&&(i.expiredLanes|=a),s&=~a}}function I1(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function wR(){var i=WA;return WA<<=1,!(WA&4194240)&&(WA=64),i}function _1(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function Pd(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Rr(e),i[e]=t}function T$(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var n=i.eventTimes;for(i=i.expirationTimes;0<t;){var r=31-Rr(t),s=1<<r;e[r]=0,n[r]=-1,i[r]=-1,t&=~s}}function C1(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var n=31-Rr(t),r=1<<n;r&e|i[n]&e&&(i[n]|=e),t&=~r}}var Lt=0;function xR(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var bR,w1,SR,TR,BR,x1=!1,ZA=[],Jo=null,ea=null,ta=null,Md=new Map,Fd=new Map,ia=[],B$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function RR(i,e){switch(i){case"focusin":case"focusout":Jo=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":Md.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fd.delete(e.pointerId)}}function Od(i,e,t,n,r,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Zd(e),e!==null&&w1(e)),i):(i.eventSystemFlags|=n,e=i.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),i)}function R$(i,e,t,n,r){switch(e){case"focusin":return Jo=Od(Jo,i,e,t,n,r),!0;case"dragenter":return ea=Od(ea,i,e,t,n,r),!0;case"mouseover":return ta=Od(ta,i,e,t,n,r),!0;case"pointerover":var s=r.pointerId;return Md.set(s,Od(Md.get(s)||null,i,e,t,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Fd.set(s,Od(Fd.get(s)||null,i,e,t,n,r)),!0}return!1}function LR(i){var e=rl(i.target);if(e!==null){var t=nl(e);if(t!==null){if(e=t.tag,e===13){if(e=pR(t),e!==null){i.blockedOn=e,BR(i.priority,function(){SR(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function XA(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=S1(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var n=new t.constructor(t.type,t);g1=n,t.target.dispatchEvent(n),g1=null}else return e=Zd(t),e!==null&&w1(e),i.blockedOn=t,!1;e.shift()}return!0}function DR(i,e,t){XA(i)&&t.delete(e)}function L$(){x1=!1,Jo!==null&&XA(Jo)&&(Jo=null),ea!==null&&XA(ea)&&(ea=null),ta!==null&&XA(ta)&&(ta=null),Md.forEach(DR),Fd.forEach(DR)}function Nd(i,e){i.blockedOn===e&&(i.blockedOn=null,x1||(x1=!0,$n.unstable_scheduleCallback($n.unstable_NormalPriority,L$)))}function Qd(i){function e(r){return Nd(r,i)}if(0<ZA.length){Nd(ZA[0],i);for(var t=1;t<ZA.length;t++){var n=ZA[t];n.blockedOn===i&&(n.blockedOn=null)}}for(Jo!==null&&Nd(Jo,i),ea!==null&&Nd(ea,i),ta!==null&&Nd(ta,i),Md.forEach(e),Fd.forEach(e),t=0;t<ia.length;t++)n=ia[t],n.blockedOn===i&&(n.blockedOn=null);for(;0<ia.length&&(t=ia[0],t.blockedOn===null);)LR(t),t.blockedOn===null&&ia.shift()}var Wu=Vs.ReactCurrentBatchConfig,JA=!0;function D$(i,e,t,n){var r=Lt,s=Wu.transition;Wu.transition=null;try{Lt=1,b1(i,e,t,n)}finally{Lt=r,Wu.transition=s}}function k$(i,e,t,n){var r=Lt,s=Wu.transition;Wu.transition=null;try{Lt=4,b1(i,e,t,n)}finally{Lt=r,Wu.transition=s}}function b1(i,e,t,n){if(JA){var r=S1(i,e,t,n);if(r===null)V1(i,e,n,e0,t),RR(i,n);else if(R$(r,i,e,t,n))n.stopPropagation();else if(RR(i,n),e&4&&-1<B$.indexOf(i)){for(;r!==null;){var s=Zd(r);if(s!==null&&bR(s),s=S1(i,e,t,n),s===null&&V1(i,e,n,e0,t),s===r)break;r=s}r!==null&&n.stopPropagation()}else V1(i,e,n,null,t)}}var e0=null;function S1(i,e,t,n){if(e0=null,i=A1(n),i=rl(i),i!==null)if(e=nl(i),e===null)i=null;else if(t=e.tag,t===13){if(i=pR(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return e0=i,null}function kR(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(E$()){case E1:return 1;case _R:return 4;case $A:case I$:return 16;case CR:return 536870912;default:return 16}default:return 16}}var na=null,T1=null,t0=null;function PR(){if(t0)return t0;var i,e=T1,t=e.length,n,r="value"in na?na.value:na.textContent,s=r.length;for(i=0;i<t&&e[i]===r[i];i++);var o=t-i;for(n=1;n<=o&&e[t-n]===r[s-n];n++);return t0=r.slice(i,1<n?1-n:void 0)}function i0(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function n0(){return!0}function MR(){return!1}function jn(i){function e(t,n,r,s,o){this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in i)i.hasOwnProperty(a)&&(t=i[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?n0:MR,this.isPropagationStopped=MR,this}return Jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=n0)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=n0)},persist:function(){},isPersistent:n0}),e}var Ku={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},B1=jn(Ku),Ud=Jt({},Ku,{view:0,detail:0}),P$=jn(Ud),R1,L1,Gd,r0=Jt({},Ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:k1,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Gd&&(Gd&&i.type==="mousemove"?(R1=i.screenX-Gd.screenX,L1=i.screenY-Gd.screenY):L1=R1=0,Gd=i),R1)},movementY:function(i){return"movementY"in i?i.movementY:L1}}),FR=jn(r0),M$=Jt({},r0,{dataTransfer:0}),F$=jn(M$),O$=Jt({},Ud,{relatedTarget:0}),D1=jn(O$),N$=Jt({},Ku,{animationName:0,elapsedTime:0,pseudoElement:0}),Q$=jn(N$),U$=Jt({},Ku,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),G$=jn(U$),H$=Jt({},Ku,{data:0}),OR=jn(H$),z$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},q$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $$(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=q$[i])?!!e[i]:!1}function k1(){return $$}var j$=Jt({},Ud,{key:function(i){if(i.key){var e=z$[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=i0(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?V$[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:k1,charCode:function(i){return i.type==="keypress"?i0(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?i0(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),W$=jn(j$),K$=Jt({},r0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),NR=jn(K$),Y$=Jt({},Ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:k1}),Z$=jn(Y$),X$=Jt({},Ku,{propertyName:0,elapsedTime:0,pseudoElement:0}),J$=jn(X$),ej=Jt({},r0,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),tj=jn(ej),ij=[9,13,27,32],P1=zs&&"CompositionEvent"in window,Hd=null;zs&&"documentMode"in document&&(Hd=document.documentMode);var nj=zs&&"TextEvent"in window&&!Hd,QR=zs&&(!P1||Hd&&8<Hd&&11>=Hd),UR=" ",GR=!1;function HR(i,e){switch(i){case"keyup":return ij.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zR(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Yu=!1;function rj(i,e){switch(i){case"compositionend":return zR(e);case"keypress":return e.which!==32?null:(GR=!0,UR);case"textInput":return i=e.data,i===UR&&GR?null:i;default:return null}}function sj(i,e){if(Yu)return i==="compositionend"||!P1&&HR(i,e)?(i=PR(),t0=T1=na=null,Yu=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return QR&&e.locale!=="ko"?null:e.data;default:return null}}var oj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VR(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!oj[i.type]:e==="textarea"}function qR(i,e,t,n){hR(n),e=u0(e,"onChange"),0<e.length&&(t=new B1("onChange","change",null,t,n),i.push({event:t,listeners:e}))}var zd=null,Vd=null;function aj(i){uL(i,0)}function s0(i){var e=tc(i);if(J2(e))return i}function lj(i,e){if(i==="change")return e}var $R=!1;if(zs){var M1;if(zs){var F1="oninput"in document;if(!F1){var jR=document.createElement("div");jR.setAttribute("oninput","return;"),F1=typeof jR.oninput=="function"}M1=F1}else M1=!1;$R=M1&&(!document.documentMode||9<document.documentMode)}function WR(){zd&&(zd.detachEvent("onpropertychange",KR),Vd=zd=null)}function KR(i){if(i.propertyName==="value"&&s0(Vd)){var e=[];qR(e,Vd,i,A1(i)),AR(aj,e)}}function uj(i,e,t){i==="focusin"?(WR(),zd=e,Vd=t,zd.attachEvent("onpropertychange",KR)):i==="focusout"&&WR()}function cj(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return s0(Vd)}function hj(i,e){if(i==="click")return s0(e)}function dj(i,e){if(i==="input"||i==="change")return s0(e)}function fj(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Lr=typeof Object.is=="function"?Object.is:fj;function qd(i,e){if(Lr(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var r=t[n];if(!jE.call(e,r)||!Lr(i[r],e[r]))return!1}return!0}function YR(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ZR(i,e){var t=YR(i);i=0;for(var n;t;){if(t.nodeType===3){if(n=i+t.textContent.length,i<=e&&n>=e)return{node:t,offset:e-i};i=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=YR(t)}}function XR(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?XR(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function JR(){for(var i=window,e=HA();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=HA(i.document)}return e}function O1(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function gj(i){var e=JR(),t=i.focusedElem,n=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&XR(t.ownerDocument.documentElement,t)){if(n!==null&&O1(t)){if(e=n.start,i=n.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var r=t.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!i.extend&&s>n&&(r=n,n=s,s=r),r=ZR(t,s);var o=ZR(t,n);r&&o&&(i.rangeCount!==1||i.anchorNode!==r.node||i.anchorOffset!==r.offset||i.focusNode!==o.node||i.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),i.removeAllRanges(),s>n?(i.addRange(e),i.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Aj=zs&&"documentMode"in document&&11>=document.documentMode,Zu=null,N1=null,$d=null,Q1=!1;function eL(i,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Q1||Zu==null||Zu!==HA(n)||(n=Zu,"selectionStart"in n&&O1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),$d&&qd($d,n)||($d=n,n=u0(N1,"onSelect"),0<n.length&&(e=new B1("onSelect","select",null,e,t),i.push({event:e,listeners:n}),e.target=Zu)))}function o0(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var Xu={animationend:o0("Animation","AnimationEnd"),animationiteration:o0("Animation","AnimationIteration"),animationstart:o0("Animation","AnimationStart"),transitionend:o0("Transition","TransitionEnd")},U1={},tL={};zs&&(tL=document.createElement("div").style,"AnimationEvent"in window||(delete Xu.animationend.animation,delete Xu.animationiteration.animation,delete Xu.animationstart.animation),"TransitionEvent"in window||delete Xu.transitionend.transition);function a0(i){if(U1[i])return U1[i];if(!Xu[i])return i;var e=Xu[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in tL)return U1[i]=e[t];return i}var iL=a0("animationend"),nL=a0("animationiteration"),rL=a0("animationstart"),sL=a0("transitionend"),oL=new Map,aL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ra(i,e){oL.set(i,e),il(e,[i])}for(var G1=0;G1<aL.length;G1++){var H1=aL[G1],pj=H1.toLowerCase(),mj=H1[0].toUpperCase()+H1.slice(1);ra(pj,"on"+mj)}ra(iL,"onAnimationEnd"),ra(nL,"onAnimationIteration"),ra(rL,"onAnimationStart"),ra("dblclick","onDoubleClick"),ra("focusin","onFocus"),ra("focusout","onBlur"),ra(sL,"onTransitionEnd"),Hu("onMouseEnter",["mouseout","mouseover"]),Hu("onMouseLeave",["mouseout","mouseover"]),Hu("onPointerEnter",["pointerout","pointerover"]),Hu("onPointerLeave",["pointerout","pointerover"]),il("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),il("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),il("onBeforeInput",["compositionend","keypress","textInput","paste"]),il("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),il("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),il("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yj=new Set("cancel close invalid load scroll toggle".split(" ").concat(jd));function lL(i,e,t){var n=i.type||"unknown-event";i.currentTarget=t,p$(n,e,void 0,i),i.currentTarget=null}function uL(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var n=i[t],r=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;lL(r,a,u),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;lL(r,a,u),s=l}}}if(qA)throw i=v1,qA=!1,v1=null,i}function qt(i,e){var t=e[Y1];t===void 0&&(t=e[Y1]=new Set);var n=i+"__bubble";t.has(n)||(cL(e,i,2,!1),t.add(n))}function z1(i,e,t){var n=0;e&&(n|=4),cL(t,i,n,e)}var l0="_reactListening"+Math.random().toString(36).slice(2);function Wd(i){if(!i[l0]){i[l0]=!0,q2.forEach(function(t){t!=="selectionchange"&&(yj.has(t)||z1(t,!1,i),z1(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[l0]||(e[l0]=!0,z1("selectionchange",!1,e))}}function cL(i,e,t,n){switch(kR(e)){case 1:var r=D$;break;case 4:r=k$;break;default:r=b1}t=r.bind(null,e,t,i),r=void 0,!y1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?i.addEventListener(e,t,{capture:!0,passive:r}):i.addEventListener(e,t,!0):r!==void 0?i.addEventListener(e,t,{passive:r}):i.addEventListener(e,t,!1)}function V1(i,e,t,n,r){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=rl(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}AR(function(){var u=s,c=A1(t),h=[];e:{var d=oL.get(i);if(d!==void 0){var g=B1,A=i;switch(i){case"keypress":if(i0(t)===0)break e;case"keydown":case"keyup":g=W$;break;case"focusin":A="focus",g=D1;break;case"focusout":A="blur",g=D1;break;case"beforeblur":case"afterblur":g=D1;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=FR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=F$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Z$;break;case iL:case nL:case rL:g=Q$;break;case sL:g=J$;break;case"scroll":g=P$;break;case"wheel":g=tj;break;case"copy":case"cut":case"paste":g=G$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=NR}var p=(e&4)!==0,y=!p&&i==="scroll",v=p?d!==null?d+"Capture":null:d;p=[];for(var E=u,I;E!==null;){I=E;var C=I.stateNode;if(I.tag===5&&C!==null&&(I=C,v!==null&&(C=Rd(E,v),C!=null&&p.push(Kd(E,C,I)))),y)break;E=E.return}0<p.length&&(d=new g(d,A,null,t,c),h.push({event:d,listeners:p}))}}if(!(e&7)){e:{if(d=i==="mouseover"||i==="pointerover",g=i==="mouseout"||i==="pointerout",d&&t!==g1&&(A=t.relatedTarget||t.fromElement)&&(rl(A)||A[qs]))break e;if((g||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,g?(A=t.relatedTarget||t.toElement,g=u,A=A?rl(A):null,A!==null&&(y=nl(A),A!==y||A.tag!==5&&A.tag!==6)&&(A=null)):(g=null,A=u),g!==A)){if(p=FR,C="onMouseLeave",v="onMouseEnter",E="mouse",(i==="pointerout"||i==="pointerover")&&(p=NR,C="onPointerLeave",v="onPointerEnter",E="pointer"),y=g==null?d:tc(g),I=A==null?d:tc(A),d=new p(C,E+"leave",g,t,c),d.target=y,d.relatedTarget=I,C=null,rl(c)===u&&(p=new p(v,E+"enter",A,t,c),p.target=I,p.relatedTarget=y,C=p),y=C,g&&A)t:{for(p=g,v=A,E=0,I=p;I;I=Ju(I))E++;for(I=0,C=v;C;C=Ju(C))I++;for(;0<E-I;)p=Ju(p),E--;for(;0<I-E;)v=Ju(v),I--;for(;E--;){if(p===v||v!==null&&p===v.alternate)break t;p=Ju(p),v=Ju(v)}p=null}else p=null;g!==null&&hL(h,d,g,p,!1),A!==null&&y!==null&&hL(h,y,A,p,!0)}}e:{if(d=u?tc(u):window,g=d.nodeName&&d.nodeName.toLowerCase(),g==="select"||g==="input"&&d.type==="file")var w=lj;else if(VR(d))if($R)w=dj;else{w=cj;var S=uj}else(g=d.nodeName)&&g.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=hj);if(w&&(w=w(i,u))){qR(h,w,t,c);break e}S&&S(i,d,u),i==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&u1(d,"number",d.value)}switch(S=u?tc(u):window,i){case"focusin":(VR(S)||S.contentEditable==="true")&&(Zu=S,N1=u,$d=null);break;case"focusout":$d=N1=Zu=null;break;case"mousedown":Q1=!0;break;case"contextmenu":case"mouseup":case"dragend":Q1=!1,eL(h,t,c);break;case"selectionchange":if(Aj)break;case"keydown":case"keyup":eL(h,t,c)}var x;if(P1)e:{switch(i){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Yu?HR(i,t)&&(T="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(QR&&t.locale!=="ko"&&(Yu||T!=="onCompositionStart"?T==="onCompositionEnd"&&Yu&&(x=PR()):(na=c,T1="value"in na?na.value:na.textContent,Yu=!0)),S=u0(u,T),0<S.length&&(T=new OR(T,i,null,t,c),h.push({event:T,listeners:S}),x?T.data=x:(x=zR(t),x!==null&&(T.data=x)))),(x=nj?rj(i,t):sj(i,t))&&(u=u0(u,"onBeforeInput"),0<u.length&&(c=new OR("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=x))}uL(h,e)})}function Kd(i,e,t){return{instance:i,listener:e,currentTarget:t}}function u0(i,e){for(var t=e+"Capture",n=[];i!==null;){var r=i,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Rd(i,t),s!=null&&n.unshift(Kd(i,s,r)),s=Rd(i,e),s!=null&&n.push(Kd(i,s,r))),i=i.return}return n}function Ju(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function hL(i,e,t,n,r){for(var s=e._reactName,o=[];t!==null&&t!==n;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&u!==null&&(a=u,r?(l=Rd(t,s),l!=null&&o.unshift(Kd(t,l,a))):r||(l=Rd(t,s),l!=null&&o.push(Kd(t,l,a)))),t=t.return}o.length!==0&&i.push({event:e,listeners:o})}var vj=/\r\n?/g,Ej=/\u0000|\uFFFD/g;function dL(i){return(typeof i=="string"?i:""+i).replace(vj,`
`).replace(Ej,"")}function c0(i,e,t){if(e=dL(e),dL(i)!==e&&t)throw Error(Ce(425))}function h0(){}var q1=null,$1=null;function j1(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var W1=typeof setTimeout=="function"?setTimeout:void 0,Ij=typeof clearTimeout=="function"?clearTimeout:void 0,fL=typeof Promise=="function"?Promise:void 0,_j=typeof queueMicrotask=="function"?queueMicrotask:typeof fL<"u"?function(i){return fL.resolve(null).then(i).catch(Cj)}:W1;function Cj(i){setTimeout(function(){throw i})}function K1(i,e){var t=e,n=0;do{var r=t.nextSibling;if(i.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(n===0){i.removeChild(r),Qd(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=r}while(t);Qd(e)}function sa(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function gL(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var ec=Math.random().toString(36).slice(2),rs="__reactFiber$"+ec,Yd="__reactProps$"+ec,qs="__reactContainer$"+ec,Y1="__reactEvents$"+ec,wj="__reactListeners$"+ec,xj="__reactHandles$"+ec;function rl(i){var e=i[rs];if(e)return e;for(var t=i.parentNode;t;){if(e=t[qs]||t[rs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=gL(i);i!==null;){if(t=i[rs])return t;i=gL(i)}return e}i=t,t=i.parentNode}return null}function Zd(i){return i=i[rs]||i[qs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function tc(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Ce(33))}function d0(i){return i[Yd]||null}var Z1=[],ic=-1;function oa(i){return{current:i}}function $t(i){0>ic||(i.current=Z1[ic],Z1[ic]=null,ic--)}function Ut(i,e){ic++,Z1[ic]=i.current,i.current=e}var aa={},Xi=oa(aa),Tn=oa(!1),sl=aa;function nc(i,e){var t=i.type.contextTypes;if(!t)return aa;var n=i.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=r),r}function Bn(i){return i=i.childContextTypes,i!=null}function f0(){$t(Tn),$t(Xi)}function AL(i,e,t){if(Xi.current!==aa)throw Error(Ce(168));Ut(Xi,e),Ut(Tn,t)}function pL(i,e,t){var n=i.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(Ce(108,u$(i)||"Unknown",r));return Jt({},t,n)}function g0(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||aa,sl=Xi.current,Ut(Xi,i),Ut(Tn,Tn.current),!0}function mL(i,e,t){var n=i.stateNode;if(!n)throw Error(Ce(169));t?(i=pL(i,e,sl),n.__reactInternalMemoizedMergedChildContext=i,$t(Tn),$t(Xi),Ut(Xi,i)):$t(Tn),Ut(Tn,t)}var $s=null,A0=!1,X1=!1;function yL(i){$s===null?$s=[i]:$s.push(i)}function bj(i){A0=!0,yL(i)}function la(){if(!X1&&$s!==null){X1=!0;var i=0,e=Lt;try{var t=$s;for(Lt=1;i<t.length;i++){var n=t[i];do n=n(!0);while(n!==null)}$s=null,A0=!1}catch(r){throw $s!==null&&($s=$s.slice(i+1)),ER(E1,la),r}finally{Lt=e,X1=!1}}return null}var rc=[],sc=0,p0=null,m0=0,sr=[],or=0,ol=null,js=1,Ws="";function al(i,e){rc[sc++]=m0,rc[sc++]=p0,p0=i,m0=e}function vL(i,e,t){sr[or++]=js,sr[or++]=Ws,sr[or++]=ol,ol=i;var n=js;i=Ws;var r=32-Rr(n)-1;n&=~(1<<r),t+=1;var s=32-Rr(e)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,js=1<<32-Rr(e)+r|t<<r|n,Ws=s+i}else js=1<<s|t<<r|n,Ws=i}function J1(i){i.return!==null&&(al(i,1),vL(i,1,0))}function eI(i){for(;i===p0;)p0=rc[--sc],rc[sc]=null,m0=rc[--sc],rc[sc]=null;for(;i===ol;)ol=sr[--or],sr[or]=null,Ws=sr[--or],sr[or]=null,js=sr[--or],sr[or]=null}var Wn=null,Kn=null,Wt=!1,Dr=null;function EL(i,e){var t=cr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function IL(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,Wn=i,Kn=sa(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,Wn=i,Kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ol!==null?{id:js,overflow:Ws}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=cr(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,Wn=i,Kn=null,!0):!1;default:return!1}}function tI(i){return(i.mode&1)!==0&&(i.flags&128)===0}function iI(i){if(Wt){var e=Kn;if(e){var t=e;if(!IL(i,e)){if(tI(i))throw Error(Ce(418));e=sa(t.nextSibling);var n=Wn;e&&IL(i,e)?EL(n,t):(i.flags=i.flags&-4097|2,Wt=!1,Wn=i)}}else{if(tI(i))throw Error(Ce(418));i.flags=i.flags&-4097|2,Wt=!1,Wn=i}}}function _L(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Wn=i}function y0(i){if(i!==Wn)return!1;if(!Wt)return _L(i),Wt=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!j1(i.type,i.memoizedProps)),e&&(e=Kn)){if(tI(i))throw CL(),Error(Ce(418));for(;e;)EL(i,e),e=sa(e.nextSibling)}if(_L(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ce(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){Kn=sa(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}Kn=null}}else Kn=Wn?sa(i.stateNode.nextSibling):null;return!0}function CL(){for(var i=Kn;i;)i=sa(i.nextSibling)}function oc(){Kn=Wn=null,Wt=!1}function nI(i){Dr===null?Dr=[i]:Dr.push(i)}var Sj=Vs.ReactCurrentBatchConfig;function Xd(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Ce(309));var n=t.stateNode}if(!n)throw Error(Ce(147,i));var r=n,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof i!="string")throw Error(Ce(284));if(!t._owner)throw Error(Ce(290,i))}return i}function v0(i,e){throw i=Object.prototype.toString.call(e),Error(Ce(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function wL(i){var e=i._init;return e(i._payload)}function xL(i){function e(v,E){if(i){var I=v.deletions;I===null?(v.deletions=[E],v.flags|=16):I.push(E)}}function t(v,E){if(!i)return null;for(;E!==null;)e(v,E),E=E.sibling;return null}function n(v,E){for(v=new Map;E!==null;)E.key!==null?v.set(E.key,E):v.set(E.index,E),E=E.sibling;return v}function r(v,E){return v=pa(v,E),v.index=0,v.sibling=null,v}function s(v,E,I){return v.index=I,i?(I=v.alternate,I!==null?(I=I.index,I<E?(v.flags|=2,E):I):(v.flags|=2,E)):(v.flags|=1048576,E)}function o(v){return i&&v.alternate===null&&(v.flags|=2),v}function a(v,E,I,C){return E===null||E.tag!==6?(E=WI(I,v.mode,C),E.return=v,E):(E=r(E,I),E.return=v,E)}function l(v,E,I,C){var w=I.type;return w===Vu?c(v,E,I.props.children,C,I.key):E!==null&&(E.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Zo&&wL(w)===E.type)?(C=r(E,I.props),C.ref=Xd(v,E,I),C.return=v,C):(C=z0(I.type,I.key,I.props,null,v.mode,C),C.ref=Xd(v,E,I),C.return=v,C)}function u(v,E,I,C){return E===null||E.tag!==4||E.stateNode.containerInfo!==I.containerInfo||E.stateNode.implementation!==I.implementation?(E=KI(I,v.mode,C),E.return=v,E):(E=r(E,I.children||[]),E.return=v,E)}function c(v,E,I,C,w){return E===null||E.tag!==7?(E=Al(I,v.mode,C,w),E.return=v,E):(E=r(E,I),E.return=v,E)}function h(v,E,I){if(typeof E=="string"&&E!==""||typeof E=="number")return E=WI(""+E,v.mode,I),E.return=v,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case UA:return I=z0(E.type,E.key,E.props,null,v.mode,I),I.ref=Xd(v,null,E),I.return=v,I;case zu:return E=KI(E,v.mode,I),E.return=v,E;case Zo:var C=E._init;return h(v,C(E._payload),I)}if(Sd(E)||xd(E))return E=Al(E,v.mode,I,null),E.return=v,E;v0(v,E)}return null}function d(v,E,I,C){var w=E!==null?E.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return w!==null?null:a(v,E,""+I,C);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case UA:return I.key===w?l(v,E,I,C):null;case zu:return I.key===w?u(v,E,I,C):null;case Zo:return w=I._init,d(v,E,w(I._payload),C)}if(Sd(I)||xd(I))return w!==null?null:c(v,E,I,C,null);v0(v,I)}return null}function g(v,E,I,C,w){if(typeof C=="string"&&C!==""||typeof C=="number")return v=v.get(I)||null,a(E,v,""+C,w);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case UA:return v=v.get(C.key===null?I:C.key)||null,l(E,v,C,w);case zu:return v=v.get(C.key===null?I:C.key)||null,u(E,v,C,w);case Zo:var S=C._init;return g(v,E,I,S(C._payload),w)}if(Sd(C)||xd(C))return v=v.get(I)||null,c(E,v,C,w,null);v0(E,C)}return null}function A(v,E,I,C){for(var w=null,S=null,x=E,T=E=0,Q=null;x!==null&&T<I.length;T++){x.index>T?(Q=x,x=null):Q=x.sibling;var M=d(v,x,I[T],C);if(M===null){x===null&&(x=Q);break}i&&x&&M.alternate===null&&e(v,x),E=s(M,E,T),S===null?w=M:S.sibling=M,S=M,x=Q}if(T===I.length)return t(v,x),Wt&&al(v,T),w;if(x===null){for(;T<I.length;T++)x=h(v,I[T],C),x!==null&&(E=s(x,E,T),S===null?w=x:S.sibling=x,S=x);return Wt&&al(v,T),w}for(x=n(v,x);T<I.length;T++)Q=g(x,v,T,I[T],C),Q!==null&&(i&&Q.alternate!==null&&x.delete(Q.key===null?T:Q.key),E=s(Q,E,T),S===null?w=Q:S.sibling=Q,S=Q);return i&&x.forEach(function(R){return e(v,R)}),Wt&&al(v,T),w}function p(v,E,I,C){var w=xd(I);if(typeof w!="function")throw Error(Ce(150));if(I=w.call(I),I==null)throw Error(Ce(151));for(var S=w=null,x=E,T=E=0,Q=null,M=I.next();x!==null&&!M.done;T++,M=I.next()){x.index>T?(Q=x,x=null):Q=x.sibling;var R=d(v,x,M.value,C);if(R===null){x===null&&(x=Q);break}i&&x&&R.alternate===null&&e(v,x),E=s(R,E,T),S===null?w=R:S.sibling=R,S=R,x=Q}if(M.done)return t(v,x),Wt&&al(v,T),w;if(x===null){for(;!M.done;T++,M=I.next())M=h(v,M.value,C),M!==null&&(E=s(M,E,T),S===null?w=M:S.sibling=M,S=M);return Wt&&al(v,T),w}for(x=n(v,x);!M.done;T++,M=I.next())M=g(x,v,T,M.value,C),M!==null&&(i&&M.alternate!==null&&x.delete(M.key===null?T:M.key),E=s(M,E,T),S===null?w=M:S.sibling=M,S=M);return i&&x.forEach(function(z){return e(v,z)}),Wt&&al(v,T),w}function y(v,E,I,C){if(typeof I=="object"&&I!==null&&I.type===Vu&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case UA:e:{for(var w=I.key,S=E;S!==null;){if(S.key===w){if(w=I.type,w===Vu){if(S.tag===7){t(v,S.sibling),E=r(S,I.props.children),E.return=v,v=E;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Zo&&wL(w)===S.type){t(v,S.sibling),E=r(S,I.props),E.ref=Xd(v,S,I),E.return=v,v=E;break e}t(v,S);break}else e(v,S);S=S.sibling}I.type===Vu?(E=Al(I.props.children,v.mode,C,I.key),E.return=v,v=E):(C=z0(I.type,I.key,I.props,null,v.mode,C),C.ref=Xd(v,E,I),C.return=v,v=C)}return o(v);case zu:e:{for(S=I.key;E!==null;){if(E.key===S)if(E.tag===4&&E.stateNode.containerInfo===I.containerInfo&&E.stateNode.implementation===I.implementation){t(v,E.sibling),E=r(E,I.children||[]),E.return=v,v=E;break e}else{t(v,E);break}else e(v,E);E=E.sibling}E=KI(I,v.mode,C),E.return=v,v=E}return o(v);case Zo:return S=I._init,y(v,E,S(I._payload),C)}if(Sd(I))return A(v,E,I,C);if(xd(I))return p(v,E,I,C);v0(v,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,E!==null&&E.tag===6?(t(v,E.sibling),E=r(E,I),E.return=v,v=E):(t(v,E),E=WI(I,v.mode,C),E.return=v,v=E),o(v)):t(v,E)}return y}var ac=xL(!0),bL=xL(!1),E0=oa(null),I0=null,lc=null,rI=null;function sI(){rI=lc=I0=null}function oI(i){var e=E0.current;$t(E0),i._currentValue=e}function aI(i,e,t){for(;i!==null;){var n=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),i===t)break;i=i.return}}function uc(i,e){I0=i,rI=lc=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Rn=!0),i.firstContext=null)}function ar(i){var e=i._currentValue;if(rI!==i)if(i={context:i,memoizedValue:e,next:null},lc===null){if(I0===null)throw Error(Ce(308));lc=i,I0.dependencies={lanes:0,firstContext:i}}else lc=lc.next=i;return e}var ll=null;function lI(i){ll===null?ll=[i]:ll.push(i)}function SL(i,e,t,n){var r=e.interleaved;return r===null?(t.next=t,lI(e)):(t.next=r.next,r.next=t),e.interleaved=t,Ks(i,n)}function Ks(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var ua=!1;function uI(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TL(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ys(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function ca(i,e,t){var n=i.updateQueue;if(n===null)return null;if(n=n.shared,_t&2){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,Ks(i,t)}return r=n.interleaved,r===null?(e.next=e,lI(n)):(e.next=r.next,r.next=e),n.interleaved=e,Ks(i,t)}function _0(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,C1(i,t)}}function BL(i,e){var t=i.updateQueue,n=i.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function C0(i,e,t,n){var r=i.updateQueue;ua=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=i.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,g=a.eventTime;if((n&d)===d){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=i,p=a;switch(d=e,g=t,p.tag){case 1:if(A=p.payload,typeof A=="function"){h=A.call(g,h,d);break e}h=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=p.payload,d=typeof A=="function"?A.call(g,h,d):A,d==null)break e;h=Jt({},h,d);break e;case 2:ua=!0}}a.callback!==null&&a.lane!==0&&(i.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else g={eventTime:g,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=h):c=c.next=g,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(c===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);hl|=o,i.lanes=o,i.memoizedState=h}}function RL(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var n=i[e],r=n.callback;if(r!==null){if(n.callback=null,n=t,typeof r!="function")throw Error(Ce(191,r));r.call(n)}}}var Jd={},ss=oa(Jd),ef=oa(Jd),tf=oa(Jd);function ul(i){if(i===Jd)throw Error(Ce(174));return i}function cI(i,e){switch(Ut(tf,e),Ut(ef,i),Ut(ss,Jd),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:h1(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=h1(e,i)}$t(ss),Ut(ss,e)}function cc(){$t(ss),$t(ef),$t(tf)}function LL(i){ul(tf.current);var e=ul(ss.current),t=h1(e,i.type);e!==t&&(Ut(ef,i),Ut(ss,t))}function hI(i){ef.current===i&&($t(ss),$t(ef))}var ei=oa(0);function w0(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dI=[];function fI(){for(var i=0;i<dI.length;i++)dI[i]._workInProgressVersionPrimary=null;dI.length=0}var x0=Vs.ReactCurrentDispatcher,gI=Vs.ReactCurrentBatchConfig,cl=0,ti=null,Ei=null,Ti=null,b0=!1,nf=!1,rf=0,Tj=0;function Ji(){throw Error(Ce(321))}function AI(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Lr(i[t],e[t]))return!1;return!0}function pI(i,e,t,n,r,s){if(cl=s,ti=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,x0.current=i===null||i.memoizedState===null?Dj:kj,i=t(n,r),nf){s=0;do{if(nf=!1,rf=0,25<=s)throw Error(Ce(301));s+=1,Ti=Ei=null,e.updateQueue=null,x0.current=Pj,i=t(n,r)}while(nf)}if(x0.current=B0,e=Ei!==null&&Ei.next!==null,cl=0,Ti=Ei=ti=null,b0=!1,e)throw Error(Ce(300));return i}function mI(){var i=rf!==0;return rf=0,i}function os(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ti===null?ti.memoizedState=Ti=i:Ti=Ti.next=i,Ti}function lr(){if(Ei===null){var i=ti.alternate;i=i!==null?i.memoizedState:null}else i=Ei.next;var e=Ti===null?ti.memoizedState:Ti.next;if(e!==null)Ti=e,Ei=i;else{if(i===null)throw Error(Ce(310));Ei=i,i={memoizedState:Ei.memoizedState,baseState:Ei.baseState,baseQueue:Ei.baseQueue,queue:Ei.queue,next:null},Ti===null?ti.memoizedState=Ti=i:Ti=Ti.next=i}return Ti}function sf(i,e){return typeof e=="function"?e(i):e}function yI(i){var e=lr(),t=e.queue;if(t===null)throw Error(Ce(311));t.lastRenderedReducer=i;var n=Ei,r=n.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,n=n.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((cl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:i(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,ti.lanes|=c,hl|=c}u=u.next}while(u!==null&&u!==s);l===null?o=n:l.next=a,Lr(n,e.memoizedState)||(Rn=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,t.lastRenderedState=n}if(i=t.interleaved,i!==null){r=i;do s=r.lane,ti.lanes|=s,hl|=s,r=r.next;while(r!==i)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function vI(i){var e=lr(),t=e.queue;if(t===null)throw Error(Ce(311));t.lastRenderedReducer=i;var n=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=i(s,o.action),o=o.next;while(o!==r);Lr(s,e.memoizedState)||(Rn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,n]}function DL(){}function kL(i,e){var t=ti,n=lr(),r=e(),s=!Lr(n.memoizedState,r);if(s&&(n.memoizedState=r,Rn=!0),n=n.queue,EI(FL.bind(null,t,n,i),[i]),n.getSnapshot!==e||s||Ti!==null&&Ti.memoizedState.tag&1){if(t.flags|=2048,of(9,ML.bind(null,t,n,r,e),void 0,null),Bi===null)throw Error(Ce(349));cl&30||PL(t,e,r)}return r}function PL(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=ti.updateQueue,e===null?(e={lastEffect:null,stores:null},ti.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function ML(i,e,t,n){e.value=t,e.getSnapshot=n,OL(e)&&NL(i)}function FL(i,e,t){return t(function(){OL(e)&&NL(i)})}function OL(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Lr(i,t)}catch{return!0}}function NL(i){var e=Ks(i,1);e!==null&&Fr(e,i,1,-1)}function QL(i){var e=os();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sf,lastRenderedState:i},e.queue=i,i=i.dispatch=Lj.bind(null,ti,i),[e.memoizedState,i]}function of(i,e,t,n){return i={tag:i,create:e,destroy:t,deps:n,next:null},e=ti.updateQueue,e===null?(e={lastEffect:null,stores:null},ti.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(n=t.next,t.next=i,i.next=n,e.lastEffect=i)),i}function UL(){return lr().memoizedState}function S0(i,e,t,n){var r=os();ti.flags|=i,r.memoizedState=of(1|e,t,void 0,n===void 0?null:n)}function T0(i,e,t,n){var r=lr();n=n===void 0?null:n;var s=void 0;if(Ei!==null){var o=Ei.memoizedState;if(s=o.destroy,n!==null&&AI(n,o.deps)){r.memoizedState=of(e,t,s,n);return}}ti.flags|=i,r.memoizedState=of(1|e,t,s,n)}function GL(i,e){return S0(8390656,8,i,e)}function EI(i,e){return T0(2048,8,i,e)}function HL(i,e){return T0(4,2,i,e)}function zL(i,e){return T0(4,4,i,e)}function VL(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function qL(i,e,t){return t=t!=null?t.concat([i]):null,T0(4,4,VL.bind(null,e,i),t)}function II(){}function $L(i,e){var t=lr();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&AI(e,n[1])?n[0]:(t.memoizedState=[i,e],i)}function jL(i,e){var t=lr();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&AI(e,n[1])?n[0]:(i=i(),t.memoizedState=[i,e],i)}function WL(i,e,t){return cl&21?(Lr(t,e)||(t=wR(),ti.lanes|=t,hl|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Rn=!0),i.memoizedState=t)}function Bj(i,e){var t=Lt;Lt=t!==0&&4>t?t:4,i(!0);var n=gI.transition;gI.transition={};try{i(!1),e()}finally{Lt=t,gI.transition=n}}function KL(){return lr().memoizedState}function Rj(i,e,t){var n=ga(i);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},YL(i))ZL(e,t);else if(t=SL(i,e,t,n),t!==null){var r=An();Fr(t,i,n,r),XL(t,e,n)}}function Lj(i,e,t){var n=ga(i),r={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(YL(i))ZL(e,r);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Lr(a,o)){var l=e.interleaved;l===null?(r.next=r,lI(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=SL(i,e,r,n),t!==null&&(r=An(),Fr(t,i,n,r),XL(t,e,n))}}function YL(i){var e=i.alternate;return i===ti||e!==null&&e===ti}function ZL(i,e){nf=b0=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function XL(i,e,t){if(t&4194240){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,C1(i,t)}}var B0={readContext:ar,useCallback:Ji,useContext:Ji,useEffect:Ji,useImperativeHandle:Ji,useInsertionEffect:Ji,useLayoutEffect:Ji,useMemo:Ji,useReducer:Ji,useRef:Ji,useState:Ji,useDebugValue:Ji,useDeferredValue:Ji,useTransition:Ji,useMutableSource:Ji,useSyncExternalStore:Ji,useId:Ji,unstable_isNewReconciler:!1},Dj={readContext:ar,useCallback:function(i,e){return os().memoizedState=[i,e===void 0?null:e],i},useContext:ar,useEffect:GL,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,S0(4194308,4,VL.bind(null,e,i),t)},useLayoutEffect:function(i,e){return S0(4194308,4,i,e)},useInsertionEffect:function(i,e){return S0(4,2,i,e)},useMemo:function(i,e){var t=os();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var n=os();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},n.queue=i,i=i.dispatch=Rj.bind(null,ti,i),[n.memoizedState,i]},useRef:function(i){var e=os();return i={current:i},e.memoizedState=i},useState:QL,useDebugValue:II,useDeferredValue:function(i){return os().memoizedState=i},useTransition:function(){var i=QL(!1),e=i[0];return i=Bj.bind(null,i[1]),os().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var n=ti,r=os();if(Wt){if(t===void 0)throw Error(Ce(407));t=t()}else{if(t=e(),Bi===null)throw Error(Ce(349));cl&30||PL(n,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,GL(FL.bind(null,n,s,i),[i]),n.flags|=2048,of(9,ML.bind(null,n,s,t,e),void 0,null),t},useId:function(){var i=os(),e=Bi.identifierPrefix;if(Wt){var t=Ws,n=js;t=(n&~(1<<32-Rr(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=rf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Tj++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},kj={readContext:ar,useCallback:$L,useContext:ar,useEffect:EI,useImperativeHandle:qL,useInsertionEffect:HL,useLayoutEffect:zL,useMemo:jL,useReducer:yI,useRef:UL,useState:function(){return yI(sf)},useDebugValue:II,useDeferredValue:function(i){var e=lr();return WL(e,Ei.memoizedState,i)},useTransition:function(){var i=yI(sf)[0],e=lr().memoizedState;return[i,e]},useMutableSource:DL,useSyncExternalStore:kL,useId:KL,unstable_isNewReconciler:!1},Pj={readContext:ar,useCallback:$L,useContext:ar,useEffect:EI,useImperativeHandle:qL,useInsertionEffect:HL,useLayoutEffect:zL,useMemo:jL,useReducer:vI,useRef:UL,useState:function(){return vI(sf)},useDebugValue:II,useDeferredValue:function(i){var e=lr();return Ei===null?e.memoizedState=i:WL(e,Ei.memoizedState,i)},useTransition:function(){var i=vI(sf)[0],e=lr().memoizedState;return[i,e]},useMutableSource:DL,useSyncExternalStore:kL,useId:KL,unstable_isNewReconciler:!1};function kr(i,e){if(i&&i.defaultProps){e=Jt({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}function _I(i,e,t,n){e=i.memoizedState,t=t(n,e),t=t==null?e:Jt({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var R0={isMounted:function(i){return(i=i._reactInternals)?nl(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var n=An(),r=ga(i),s=Ys(n,r);s.payload=e,t!=null&&(s.callback=t),e=ca(i,s,r),e!==null&&(Fr(e,i,r,n),_0(e,i,r))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var n=An(),r=ga(i),s=Ys(n,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=ca(i,s,r),e!==null&&(Fr(e,i,r,n),_0(e,i,r))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=An(),n=ga(i),r=Ys(t,n);r.tag=2,e!=null&&(r.callback=e),e=ca(i,r,n),e!==null&&(Fr(e,i,n,t),_0(e,i,n))}};function JL(i,e,t,n,r,s,o){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!qd(t,n)||!qd(r,s):!0}function eD(i,e,t){var n=!1,r=aa,s=e.contextType;return typeof s=="object"&&s!==null?s=ar(s):(r=Bn(e)?sl:Xi.current,n=e.contextTypes,s=(n=n!=null)?nc(i,r):aa),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=R0,i.stateNode=e,e._reactInternals=i,n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=r,i.__reactInternalMemoizedMaskedChildContext=s),e}function tD(i,e,t,n){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==i&&R0.enqueueReplaceState(e,e.state,null)}function CI(i,e,t,n){var r=i.stateNode;r.props=t,r.state=i.memoizedState,r.refs={},uI(i);var s=e.contextType;typeof s=="object"&&s!==null?r.context=ar(s):(s=Bn(e)?sl:Xi.current,r.context=nc(i,s)),r.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(_I(i,e,s,t),r.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&R0.enqueueReplaceState(r,r.state,null),C0(i,t,r,n),r.state=i.memoizedState),typeof r.componentDidMount=="function"&&(i.flags|=4194308)}function hc(i,e){try{var t="",n=e;do t+=l$(n),n=n.return;while(n);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:r,digest:null}}function wI(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function xI(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Mj=typeof WeakMap=="function"?WeakMap:Map;function iD(i,e,t){t=Ys(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){O0||(O0=!0,UI=n),xI(i,e)},t}function nD(i,e,t){t=Ys(-1,t),t.tag=3;var n=i.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;t.payload=function(){return n(r)},t.callback=function(){xI(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){xI(i,e),typeof n!="function"&&(da===null?da=new Set([this]):da.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function rD(i,e,t){var n=i.pingCache;if(n===null){n=i.pingCache=new Mj;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(t)||(r.add(t),i=Kj.bind(null,i,e,t),e.then(i,i))}function sD(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function oD(i,e,t,n,r){return i.mode&1?(i.flags|=65536,i.lanes=r,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ys(-1,1),e.tag=2,ca(t,e,1))),t.lanes|=1),i)}var Fj=Vs.ReactCurrentOwner,Rn=!1;function gn(i,e,t,n){e.child=i===null?bL(e,null,t,n):ac(e,i.child,t,n)}function aD(i,e,t,n,r){t=t.render;var s=e.ref;return uc(e,r),n=pI(i,e,t,n,s,r),t=mI(),i!==null&&!Rn?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,Zs(i,e,r)):(Wt&&t&&J1(e),e.flags|=1,gn(i,e,n,r),e.child)}function lD(i,e,t,n,r){if(i===null){var s=t.type;return typeof s=="function"&&!jI(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,uD(i,e,s,n,r)):(i=z0(t.type,null,n,e,e.mode,r),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,!(i.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:qd,t(o,n)&&i.ref===e.ref)return Zs(i,e,r)}return e.flags|=1,i=pa(s,n),i.ref=e.ref,i.return=e,e.child=i}function uD(i,e,t,n,r){if(i!==null){var s=i.memoizedProps;if(qd(s,n)&&i.ref===e.ref)if(Rn=!1,e.pendingProps=n=s,(i.lanes&r)!==0)i.flags&131072&&(Rn=!0);else return e.lanes=i.lanes,Zs(i,e,r)}return bI(i,e,t,n,r)}function cD(i,e,t){var n=e.pendingProps,r=n.children,s=i!==null?i.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ut(fc,Yn),Yn|=t;else{if(!(t&1073741824))return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,Ut(fc,Yn),Yn|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,Ut(fc,Yn),Yn|=n}else s!==null?(n=s.baseLanes|t,e.memoizedState=null):n=t,Ut(fc,Yn),Yn|=n;return gn(i,e,r,t),e.child}function hD(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function bI(i,e,t,n,r){var s=Bn(t)?sl:Xi.current;return s=nc(e,s),uc(e,r),t=pI(i,e,t,n,s,r),n=mI(),i!==null&&!Rn?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,Zs(i,e,r)):(Wt&&n&&J1(e),e.flags|=1,gn(i,e,t,r),e.child)}function dD(i,e,t,n,r){if(Bn(t)){var s=!0;g0(e)}else s=!1;if(uc(e,r),e.stateNode===null)D0(i,e),eD(e,t,n),CI(e,t,n,r),n=!0;else if(i===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=ar(u):(u=Bn(t)?sl:Xi.current,u=nc(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&tD(e,o,n,u),ua=!1;var d=e.memoizedState;o.state=d,C0(e,n,o,r),l=e.memoizedState,a!==n||d!==l||Tn.current||ua?(typeof c=="function"&&(_I(e,t,c,n),l=e.memoizedState),(a=ua||JL(e,t,a,n,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,TL(i,e),a=e.memoizedProps,u=e.type===e.elementType?a:kr(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=ar(l):(l=Bn(t)?sl:Xi.current,l=nc(e,l));var g=t.getDerivedStateFromProps;(c=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&tD(e,o,n,l),ua=!1,d=e.memoizedState,o.state=d,C0(e,n,o,r);var A=e.memoizedState;a!==h||d!==A||Tn.current||ua?(typeof g=="function"&&(_I(e,t,g,n),A=e.memoizedState),(u=ua||JL(e,t,u,n,d,A,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,A,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,A,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=A),o.props=n,o.state=A,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||a===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),n=!1)}return SI(i,e,t,n,s,r)}function SI(i,e,t,n,r,s){hD(i,e);var o=(e.flags&128)!==0;if(!n&&!o)return r&&mL(e,t,!1),Zs(i,e,s);n=e.stateNode,Fj.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,i!==null&&o?(e.child=ac(e,i.child,null,s),e.child=ac(e,null,a,s)):gn(i,e,a,s),e.memoizedState=n.state,r&&mL(e,t,!0),e.child}function fD(i){var e=i.stateNode;e.pendingContext?AL(i,e.pendingContext,e.pendingContext!==e.context):e.context&&AL(i,e.context,!1),cI(i,e.containerInfo)}function gD(i,e,t,n,r){return oc(),nI(r),e.flags|=256,gn(i,e,t,n),e.child}var TI={dehydrated:null,treeContext:null,retryLane:0};function BI(i){return{baseLanes:i,cachePool:null,transitions:null}}function AD(i,e,t){var n=e.pendingProps,r=ei.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=i!==null&&i.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(r|=1),Ut(ei,r&1),i===null)return iI(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,i=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=V0(o,n,0,null),i=Al(i,n,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=BI(t),e.memoizedState=TI,i):RI(e,o));if(r=i.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Oj(i,e,o,n,a,r,t);if(s){s=n.fallback,o=e.mode,r=i.child,a=r.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=pa(r,l),n.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=pa(a,s):(s=Al(s,o,t,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=i.child.memoizedState,o=o===null?BI(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=i.childLanes&~t,e.memoizedState=TI,n}return s=i.child,i=s.sibling,n=pa(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=t),n.return=e,n.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=n,e.memoizedState=null,n}function RI(i,e){return e=V0({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function L0(i,e,t,n){return n!==null&&nI(n),ac(e,i.child,null,t),i=RI(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function Oj(i,e,t,n,r,s,o){if(t)return e.flags&256?(e.flags&=-257,n=wI(Error(Ce(422))),L0(i,e,o,n)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=n.fallback,r=e.mode,n=V0({mode:"visible",children:n.children},r,0,null),s=Al(s,r,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&ac(e,i.child,null,o),e.child.memoizedState=BI(o),e.memoizedState=TI,s);if(!(e.mode&1))return L0(i,e,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Ce(419)),n=wI(s,n,void 0),L0(i,e,o,n)}if(a=(o&i.childLanes)!==0,Rn||a){if(n=Bi,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ks(i,r),Fr(n,i,r,-1))}return $I(),n=wI(Error(Ce(421))),L0(i,e,o,n)}return r.data==="$?"?(e.flags|=128,e.child=i.child,e=Yj.bind(null,i),r._reactRetry=e,null):(i=s.treeContext,Kn=sa(r.nextSibling),Wn=e,Wt=!0,Dr=null,i!==null&&(sr[or++]=js,sr[or++]=Ws,sr[or++]=ol,js=i.id,Ws=i.overflow,ol=e),e=RI(e,n.children),e.flags|=4096,e)}function pD(i,e,t){i.lanes|=e;var n=i.alternate;n!==null&&(n.lanes|=e),aI(i.return,e,t)}function LI(i,e,t,n,r){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=r)}function mD(i,e,t){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(gn(i,e,n.children,t),n=ei.current,n&2)n=n&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&pD(i,t,e);else if(i.tag===19)pD(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}n&=1}if(Ut(ei,n),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)i=t.alternate,i!==null&&w0(i)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),LI(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(i=r.alternate,i!==null&&w0(i)===null){e.child=r;break}i=r.sibling,r.sibling=t,t=r,r=i}LI(e,!0,t,null,s);break;case"together":LI(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function D0(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Zs(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),hl|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(Ce(153));if(e.child!==null){for(i=e.child,t=pa(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=pa(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function Nj(i,e,t){switch(e.tag){case 3:fD(e),oc();break;case 5:LL(e);break;case 1:Bn(e.type)&&g0(e);break;case 4:cI(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;Ut(E0,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ut(ei,ei.current&1),e.flags|=128,null):t&e.child.childLanes?AD(i,e,t):(Ut(ei,ei.current&1),i=Zs(i,e,t),i!==null?i.sibling:null);Ut(ei,ei.current&1);break;case 19:if(n=(t&e.childLanes)!==0,i.flags&128){if(n)return mD(i,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ut(ei,ei.current),n)break;return null;case 22:case 23:return e.lanes=0,cD(i,e,t)}return Zs(i,e,t)}var yD,DI,vD,ED;yD=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}},DI=function(){},vD=function(i,e,t,n){var r=i.memoizedProps;if(r!==n){i=e.stateNode,ul(ss.current);var s=null;switch(t){case"input":r=a1(i,r),n=a1(i,n),s=[];break;case"select":r=Jt({},r,{value:void 0}),n=Jt({},n,{value:void 0}),s=[];break;case"textarea":r=c1(i,r),n=c1(i,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(i.onclick=h0)}d1(t,n);var o;t=null;for(u in r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(a=r!=null?r[u]:void 0,n.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&qt("scroll",i),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}},ED=function(i,e,t,n){t!==n&&(e.flags|=4)};function af(i,e){if(!Wt)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:n.sibling=null}}function tn(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,n=0;if(e)for(var r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=i,r=r.sibling;else for(r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=i,r=r.sibling;return i.subtreeFlags|=n,i.childLanes=t,e}function Qj(i,e,t){var n=e.pendingProps;switch(eI(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return Bn(e.type)&&f0(),tn(e),null;case 3:return n=e.stateNode,cc(),$t(Tn),$t(Xi),fI(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(i===null||i.child===null)&&(y0(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Dr!==null&&(zI(Dr),Dr=null))),DI(i,e),tn(e),null;case 5:hI(e);var r=ul(tf.current);if(t=e.type,i!==null&&e.stateNode!=null)vD(i,e,t,n,r),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ce(166));return tn(e),null}if(i=ul(ss.current),y0(e)){n=e.stateNode,t=e.type;var s=e.memoizedProps;switch(n[rs]=e,n[Yd]=s,i=(e.mode&1)!==0,t){case"dialog":qt("cancel",n),qt("close",n);break;case"iframe":case"object":case"embed":qt("load",n);break;case"video":case"audio":for(r=0;r<jd.length;r++)qt(jd[r],n);break;case"source":qt("error",n);break;case"img":case"image":case"link":qt("error",n),qt("load",n);break;case"details":qt("toggle",n);break;case"input":eR(n,s),qt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},qt("invalid",n);break;case"textarea":nR(n,s),qt("invalid",n)}d1(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&c0(n.textContent,a,i),r=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&c0(n.textContent,a,i),r=["children",""+a]):wd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&qt("scroll",n)}switch(t){case"input":GA(n),iR(n,s,!0);break;case"textarea":GA(n),sR(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=h0)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=oR(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=o.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof n.is=="string"?i=o.createElement(t,{is:n.is}):(i=o.createElement(t),t==="select"&&(o=i,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):i=o.createElementNS(i,t),i[rs]=e,i[Yd]=n,yD(i,e,!1,!1),e.stateNode=i;e:{switch(o=f1(t,n),t){case"dialog":qt("cancel",i),qt("close",i),r=n;break;case"iframe":case"object":case"embed":qt("load",i),r=n;break;case"video":case"audio":for(r=0;r<jd.length;r++)qt(jd[r],i);r=n;break;case"source":qt("error",i),r=n;break;case"img":case"image":case"link":qt("error",i),qt("load",i),r=n;break;case"details":qt("toggle",i),r=n;break;case"input":eR(i,n),r=a1(i,n),qt("invalid",i);break;case"option":r=n;break;case"select":i._wrapperState={wasMultiple:!!n.multiple},r=Jt({},n,{value:void 0}),qt("invalid",i);break;case"textarea":nR(i,n),r=c1(i,n),qt("invalid",i);break;default:r=n}d1(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?uR(i,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&aR(i,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Td(i,l):typeof l=="number"&&Td(i,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&qt("scroll",i):l!=null&&YE(i,s,l,o))}switch(t){case"input":GA(i),iR(i,n,!1);break;case"textarea":GA(i),sR(i);break;case"option":n.value!=null&&i.setAttribute("value",""+Xo(n.value));break;case"select":i.multiple=!!n.multiple,s=n.value,s!=null?qu(i,!!n.multiple,s,!1):n.defaultValue!=null&&qu(i,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(i.onclick=h0)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(i&&e.stateNode!=null)ED(i,e,i.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ce(166));if(t=ul(tf.current),ul(ss.current),y0(e)){if(n=e.stateNode,t=e.memoizedProps,n[rs]=e,(s=n.nodeValue!==t)&&(i=Wn,i!==null))switch(i.tag){case 3:c0(n.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&c0(n.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[rs]=e,e.stateNode=n}return tn(e),null;case 13:if($t(ei),n=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Wt&&Kn!==null&&e.mode&1&&!(e.flags&128))CL(),oc(),e.flags|=98560,s=!1;else if(s=y0(e),n!==null&&n.dehydrated!==null){if(i===null){if(!s)throw Error(Ce(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ce(317));s[rs]=e}else oc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),s=!1}else Dr!==null&&(zI(Dr),Dr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(n=n!==null,n!==(i!==null&&i.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(i===null||ei.current&1?Ii===0&&(Ii=3):$I())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return cc(),DI(i,e),i===null&&Wd(e.stateNode.containerInfo),tn(e),null;case 10:return oI(e.type._context),tn(e),null;case 17:return Bn(e.type)&&f0(),tn(e),null;case 19:if($t(ei),s=e.memoizedState,s===null)return tn(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)af(s,!1);else{if(Ii!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(o=w0(i),o!==null){for(e.flags|=128,af(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)s=t,i=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,i=o.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return Ut(ei,ei.current&1|2),e.child}i=i.sibling}s.tail!==null&&ui()>gc&&(e.flags|=128,n=!0,af(s,!1),e.lanes=4194304)}else{if(!n)if(i=w0(o),i!==null){if(e.flags|=128,n=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),af(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Wt)return tn(e),null}else 2*ui()-s.renderingStartTime>gc&&t!==1073741824&&(e.flags|=128,n=!0,af(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ui(),e.sibling=null,t=ei.current,Ut(ei,n?t&1|2:t&1),e):(tn(e),null);case 22:case 23:return qI(),n=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Yn&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(Ce(156,e.tag))}function Uj(i,e){switch(eI(e),e.tag){case 1:return Bn(e.type)&&f0(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return cc(),$t(Tn),$t(Xi),fI(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return hI(e),null;case 13:if($t(ei),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(Ce(340));oc()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return $t(ei),null;case 4:return cc(),null;case 10:return oI(e.type._context),null;case 22:case 23:return qI(),null;case 24:return null;default:return null}}var k0=!1,nn=!1,Gj=typeof WeakSet=="function"?WeakSet:Set,Le=null;function dc(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){oi(i,e,n)}else t.current=null}function kI(i,e,t){try{t()}catch(n){oi(i,e,n)}}var ID=!1;function Hj(i,e){if(q1=JA,i=JR(),O1(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=i,d=null;t:for(;;){for(var g;h!==t||r!==0&&h.nodeType!==3||(a=o+r),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)d=h,h=g;for(;;){if(h===i)break t;if(d===t&&++u===r&&(a=o),d===s&&++c===n&&(l=o),(g=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=g}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for($1={focusedElem:i,selectionRange:t},JA=!1,Le=e;Le!==null;)if(e=Le,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,Le=i;else for(;Le!==null;){e=Le;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var p=A.memoizedProps,y=A.memoizedState,v=e.stateNode,E=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:kr(e.type,p),y);v.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ce(163))}}catch(C){oi(e,e.return,C)}if(i=e.sibling,i!==null){i.return=e.return,Le=i;break}Le=e.return}return A=ID,ID=!1,A}function lf(i,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&i)===i){var s=r.destroy;r.destroy=void 0,s!==void 0&&kI(e,t,s)}r=r.next}while(r!==n)}}function P0(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function PI(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function _D(i){var e=i.alternate;e!==null&&(i.alternate=null,_D(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[rs],delete e[Yd],delete e[Y1],delete e[wj],delete e[xj])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function CD(i){return i.tag===5||i.tag===3||i.tag===4}function wD(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||CD(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function MI(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=h0));else if(n!==4&&(i=i.child,i!==null))for(MI(i,e,t),i=i.sibling;i!==null;)MI(i,e,t),i=i.sibling}function FI(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(n!==4&&(i=i.child,i!==null))for(FI(i,e,t),i=i.sibling;i!==null;)FI(i,e,t),i=i.sibling}var Hi=null,Pr=!1;function ha(i,e,t){for(t=t.child;t!==null;)xD(i,e,t),t=t.sibling}function xD(i,e,t){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(jA,t)}catch{}switch(t.tag){case 5:nn||dc(t,e);case 6:var n=Hi,r=Pr;Hi=null,ha(i,e,t),Hi=n,Pr=r,Hi!==null&&(Pr?(i=Hi,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Hi.removeChild(t.stateNode));break;case 18:Hi!==null&&(Pr?(i=Hi,t=t.stateNode,i.nodeType===8?K1(i.parentNode,t):i.nodeType===1&&K1(i,t),Qd(i)):K1(Hi,t.stateNode));break;case 4:n=Hi,r=Pr,Hi=t.stateNode.containerInfo,Pr=!0,ha(i,e,t),Hi=n,Pr=r;break;case 0:case 11:case 14:case 15:if(!nn&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&kI(t,e,o),r=r.next}while(r!==n)}ha(i,e,t);break;case 1:if(!nn&&(dc(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(a){oi(t,e,a)}ha(i,e,t);break;case 21:ha(i,e,t);break;case 22:t.mode&1?(nn=(n=nn)||t.memoizedState!==null,ha(i,e,t),nn=n):ha(i,e,t);break;default:ha(i,e,t)}}function bD(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new Gj),e.forEach(function(n){var r=Zj.bind(null,i,n);t.has(n)||(t.add(n),n.then(r,r))})}}function Mr(i,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];try{var s=i,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Hi=a.stateNode,Pr=!1;break e;case 3:Hi=a.stateNode.containerInfo,Pr=!0;break e;case 4:Hi=a.stateNode.containerInfo,Pr=!0;break e}a=a.return}if(Hi===null)throw Error(Ce(160));xD(s,o,r),Hi=null,Pr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){oi(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)SD(e,i),e=e.sibling}function SD(i,e){var t=i.alternate,n=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Mr(e,i),as(i),n&4){try{lf(3,i,i.return),P0(3,i)}catch(p){oi(i,i.return,p)}try{lf(5,i,i.return)}catch(p){oi(i,i.return,p)}}break;case 1:Mr(e,i),as(i),n&512&&t!==null&&dc(t,t.return);break;case 5:if(Mr(e,i),as(i),n&512&&t!==null&&dc(t,t.return),i.flags&32){var r=i.stateNode;try{Td(r,"")}catch(p){oi(i,i.return,p)}}if(n&4&&(r=i.stateNode,r!=null)){var s=i.memoizedProps,o=t!==null?t.memoizedProps:s,a=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&tR(r,s),f1(a,o);var u=f1(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?uR(r,h):c==="dangerouslySetInnerHTML"?aR(r,h):c==="children"?Td(r,h):YE(r,c,h,u)}switch(a){case"input":l1(r,s);break;case"textarea":rR(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?qu(r,!!s.multiple,g,!1):d!==!!s.multiple&&(s.defaultValue!=null?qu(r,!!s.multiple,s.defaultValue,!0):qu(r,!!s.multiple,s.multiple?[]:"",!1))}r[Yd]=s}catch(p){oi(i,i.return,p)}}break;case 6:if(Mr(e,i),as(i),n&4){if(i.stateNode===null)throw Error(Ce(162));r=i.stateNode,s=i.memoizedProps;try{r.nodeValue=s}catch(p){oi(i,i.return,p)}}break;case 3:if(Mr(e,i),as(i),n&4&&t!==null&&t.memoizedState.isDehydrated)try{Qd(e.containerInfo)}catch(p){oi(i,i.return,p)}break;case 4:Mr(e,i),as(i);break;case 13:Mr(e,i),as(i),r=i.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(QI=ui())),n&4&&bD(i);break;case 22:if(c=t!==null&&t.memoizedState!==null,i.mode&1?(nn=(u=nn)||c,Mr(e,i),nn=u):Mr(e,i),as(i),n&8192){if(u=i.memoizedState!==null,(i.stateNode.isHidden=u)&&!c&&i.mode&1)for(Le=i,c=i.child;c!==null;){for(h=Le=c;Le!==null;){switch(d=Le,g=d.child,d.tag){case 0:case 11:case 14:case 15:lf(4,d,d.return);break;case 1:dc(d,d.return);var A=d.stateNode;if(typeof A.componentWillUnmount=="function"){n=d,t=d.return;try{e=n,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(p){oi(n,t,p)}}break;case 5:dc(d,d.return);break;case 22:if(d.memoizedState!==null){RD(h);continue}}g!==null?(g.return=d,Le=g):RD(h)}c=c.sibling}e:for(c=null,h=i;;){if(h.tag===5){if(c===null){c=h;try{r=h.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=lR("display",o))}catch(p){oi(i,i.return,p)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(p){oi(i,i.return,p)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===i)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break e;for(;h.sibling===null;){if(h.return===null||h.return===i)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Mr(e,i),as(i),n&4&&bD(i);break;case 21:break;default:Mr(e,i),as(i)}}function as(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(CD(t)){var n=t;break e}t=t.return}throw Error(Ce(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(Td(r,""),n.flags&=-33);var s=wD(i);FI(i,s,r);break;case 3:case 4:var o=n.stateNode.containerInfo,a=wD(i);MI(i,a,o);break;default:throw Error(Ce(161))}}catch(l){oi(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function zj(i,e,t){Le=i,TD(i)}function TD(i,e,t){for(var n=(i.mode&1)!==0;Le!==null;){var r=Le,s=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||k0;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||nn;a=k0;var u=nn;if(k0=o,(nn=l)&&!u)for(Le=r;Le!==null;)o=Le,l=o.child,o.tag===22&&o.memoizedState!==null?LD(r):l!==null?(l.return=o,Le=l):LD(r);for(;s!==null;)Le=s,TD(s),s=s.sibling;Le=r,k0=a,nn=u}BD(i)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Le=s):BD(i)}}function BD(i){for(;Le!==null;){var e=Le;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nn||P0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!nn)if(t===null)n.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:kr(e.type,t.memoizedProps);n.componentDidUpdate(r,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&RL(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}RL(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Qd(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ce(163))}nn||e.flags&512&&PI(e)}catch(d){oi(e,e.return,d)}}if(e===i){Le=null;break}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}}function RD(i){for(;Le!==null;){var e=Le;if(e===i){Le=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Le=t;break}Le=e.return}}function LD(i){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{P0(4,e)}catch(l){oi(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(l){oi(e,r,l)}}var s=e.return;try{PI(e)}catch(l){oi(e,s,l)}break;case 5:var o=e.return;try{PI(e)}catch(l){oi(e,o,l)}}}catch(l){oi(e,e.return,l)}if(e===i){Le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Le=a;break}Le=e.return}}var Vj=Math.ceil,M0=Vs.ReactCurrentDispatcher,OI=Vs.ReactCurrentOwner,ur=Vs.ReactCurrentBatchConfig,_t=0,Bi=null,di=null,zi=0,Yn=0,fc=oa(0),Ii=0,uf=null,hl=0,F0=0,NI=0,cf=null,Ln=null,QI=0,gc=1/0,Xs=null,O0=!1,UI=null,da=null,N0=!1,fa=null,Q0=0,hf=0,GI=null,U0=-1,G0=0;function An(){return _t&6?ui():U0!==-1?U0:U0=ui()}function ga(i){return i.mode&1?_t&2&&zi!==0?zi&-zi:Sj.transition!==null?(G0===0&&(G0=wR()),G0):(i=Lt,i!==0||(i=window.event,i=i===void 0?16:kR(i.type)),i):1}function Fr(i,e,t,n){if(50<hf)throw hf=0,GI=null,Error(Ce(185));Pd(i,t,n),(!(_t&2)||i!==Bi)&&(i===Bi&&(!(_t&2)&&(F0|=t),Ii===4&&Aa(i,zi)),Dn(i,n),t===1&&_t===0&&!(e.mode&1)&&(gc=ui()+500,A0&&la()))}function Dn(i,e){var t=i.callbackNode;S$(i,e);var n=YA(i,i===Bi?zi:0);if(n===0)t!==null&&IR(t),i.callbackNode=null,i.callbackPriority=0;else if(e=n&-n,i.callbackPriority!==e){if(t!=null&&IR(t),e===1)i.tag===0?bj(kD.bind(null,i)):yL(kD.bind(null,i)),_j(function(){!(_t&6)&&la()}),t=null;else{switch(xR(n)){case 1:t=E1;break;case 4:t=_R;break;case 16:t=$A;break;case 536870912:t=CR;break;default:t=$A}t=GD(t,DD.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function DD(i,e){if(U0=-1,G0=0,_t&6)throw Error(Ce(327));var t=i.callbackNode;if(Ac()&&i.callbackNode!==t)return null;var n=YA(i,i===Bi?zi:0);if(n===0)return null;if(n&30||n&i.expiredLanes||e)e=H0(i,n);else{e=n;var r=_t;_t|=2;var s=MD();(Bi!==i||zi!==e)&&(Xs=null,gc=ui()+500,fl(i,e));do try{jj();break}catch(a){PD(i,a)}while(!0);sI(),M0.current=s,_t=r,di!==null?e=0:(Bi=null,zi=0,e=Ii)}if(e!==0){if(e===2&&(r=I1(i),r!==0&&(n=r,e=HI(i,r))),e===1)throw t=uf,fl(i,0),Aa(i,n),Dn(i,ui()),t;if(e===6)Aa(i,n);else{if(r=i.current.alternate,!(n&30)&&!qj(r)&&(e=H0(i,n),e===2&&(s=I1(i),s!==0&&(n=s,e=HI(i,s))),e===1))throw t=uf,fl(i,0),Aa(i,n),Dn(i,ui()),t;switch(i.finishedWork=r,i.finishedLanes=n,e){case 0:case 1:throw Error(Ce(345));case 2:gl(i,Ln,Xs);break;case 3:if(Aa(i,n),(n&130023424)===n&&(e=QI+500-ui(),10<e)){if(YA(i,0)!==0)break;if(r=i.suspendedLanes,(r&n)!==n){An(),i.pingedLanes|=i.suspendedLanes&r;break}i.timeoutHandle=W1(gl.bind(null,i,Ln,Xs),e);break}gl(i,Ln,Xs);break;case 4:if(Aa(i,n),(n&4194240)===n)break;for(e=i.eventTimes,r=-1;0<n;){var o=31-Rr(n);s=1<<o,o=e[o],o>r&&(r=o),n&=~s}if(n=r,n=ui()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Vj(n/1960))-n,10<n){i.timeoutHandle=W1(gl.bind(null,i,Ln,Xs),n);break}gl(i,Ln,Xs);break;case 5:gl(i,Ln,Xs);break;default:throw Error(Ce(329))}}}return Dn(i,ui()),i.callbackNode===t?DD.bind(null,i):null}function HI(i,e){var t=cf;return i.current.memoizedState.isDehydrated&&(fl(i,e).flags|=256),i=H0(i,e),i!==2&&(e=Ln,Ln=t,e!==null&&zI(e)),i}function zI(i){Ln===null?Ln=i:Ln.push.apply(Ln,i)}function qj(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var r=t[n],s=r.getSnapshot;r=r.value;try{if(!Lr(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Aa(i,e){for(e&=~NI,e&=~F0,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Rr(e),n=1<<t;i[t]=-1,e&=~n}}function kD(i){if(_t&6)throw Error(Ce(327));Ac();var e=YA(i,0);if(!(e&1))return Dn(i,ui()),null;var t=H0(i,e);if(i.tag!==0&&t===2){var n=I1(i);n!==0&&(e=n,t=HI(i,n))}if(t===1)throw t=uf,fl(i,0),Aa(i,e),Dn(i,ui()),t;if(t===6)throw Error(Ce(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,gl(i,Ln,Xs),Dn(i,ui()),null}function VI(i,e){var t=_t;_t|=1;try{return i(e)}finally{_t=t,_t===0&&(gc=ui()+500,A0&&la())}}function dl(i){fa!==null&&fa.tag===0&&!(_t&6)&&Ac();var e=_t;_t|=1;var t=ur.transition,n=Lt;try{if(ur.transition=null,Lt=1,i)return i()}finally{Lt=n,ur.transition=t,_t=e,!(_t&6)&&la()}}function qI(){Yn=fc.current,$t(fc)}function fl(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,Ij(t)),di!==null)for(t=di.return;t!==null;){var n=t;switch(eI(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&f0();break;case 3:cc(),$t(Tn),$t(Xi),fI();break;case 5:hI(n);break;case 4:cc();break;case 13:$t(ei);break;case 19:$t(ei);break;case 10:oI(n.type._context);break;case 22:case 23:qI()}t=t.return}if(Bi=i,di=i=pa(i.current,null),zi=Yn=e,Ii=0,uf=null,NI=F0=hl=0,Ln=cf=null,ll!==null){for(e=0;e<ll.length;e++)if(t=ll[e],n=t.interleaved,n!==null){t.interleaved=null;var r=n.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,n.next=o}t.pending=n}ll=null}return i}function PD(i,e){do{var t=di;try{if(sI(),x0.current=B0,b0){for(var n=ti.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}b0=!1}if(cl=0,Ti=Ei=ti=null,nf=!1,rf=0,OI.current=null,t===null||t.return===null){Ii=1,uf=e,di=null;break}e:{var s=i,o=t.return,a=t,l=e;if(e=zi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=sD(o);if(g!==null){g.flags&=-257,oD(g,o,a,s,e),g.mode&1&&rD(s,u,e),e=g,l=u;var A=e.updateQueue;if(A===null){var p=new Set;p.add(l),e.updateQueue=p}else A.add(l);break e}else{if(!(e&1)){rD(s,u,e),$I();break e}l=Error(Ce(426))}}else if(Wt&&a.mode&1){var y=sD(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),oD(y,o,a,s,e),nI(hc(l,a));break e}}s=l=hc(l,a),Ii!==4&&(Ii=2),cf===null?cf=[s]:cf.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=iD(s,l,e);BL(s,v);break e;case 1:a=l;var E=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(da===null||!da.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var C=nD(s,a,e);BL(s,C);break e}}s=s.return}while(s!==null)}OD(t)}catch(w){e=w,di===t&&t!==null&&(di=t=t.return);continue}break}while(!0)}function MD(){var i=M0.current;return M0.current=B0,i===null?B0:i}function $I(){(Ii===0||Ii===3||Ii===2)&&(Ii=4),Bi===null||!(hl&268435455)&&!(F0&268435455)||Aa(Bi,zi)}function H0(i,e){var t=_t;_t|=2;var n=MD();(Bi!==i||zi!==e)&&(Xs=null,fl(i,e));do try{$j();break}catch(r){PD(i,r)}while(!0);if(sI(),_t=t,M0.current=n,di!==null)throw Error(Ce(261));return Bi=null,zi=0,Ii}function $j(){for(;di!==null;)FD(di)}function jj(){for(;di!==null&&!y$();)FD(di)}function FD(i){var e=UD(i.alternate,i,Yn);i.memoizedProps=i.pendingProps,e===null?OD(i):di=e,OI.current=null}function OD(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=Uj(t,e),t!==null){t.flags&=32767,di=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ii=6,di=null;return}}else if(t=Qj(t,e,Yn),t!==null){di=t;return}if(e=e.sibling,e!==null){di=e;return}di=e=i}while(e!==null);Ii===0&&(Ii=5)}function gl(i,e,t){var n=Lt,r=ur.transition;try{ur.transition=null,Lt=1,Wj(i,e,t,n)}finally{ur.transition=r,Lt=n}return null}function Wj(i,e,t,n){do Ac();while(fa!==null);if(_t&6)throw Error(Ce(327));t=i.finishedWork;var r=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(Ce(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(T$(i,s),i===Bi&&(di=Bi=null,zi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||N0||(N0=!0,GD($A,function(){return Ac(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ur.transition,ur.transition=null;var o=Lt;Lt=1;var a=_t;_t|=4,OI.current=null,Hj(i,t),SD(t,i),gj($1),JA=!!q1,$1=q1=null,i.current=t,zj(t),v$(),_t=a,Lt=o,ur.transition=s}else i.current=t;if(N0&&(N0=!1,fa=i,Q0=r),s=i.pendingLanes,s===0&&(da=null),_$(t.stateNode),Dn(i,ui()),e!==null)for(n=i.onRecoverableError,t=0;t<e.length;t++)r=e[t],n(r.value,{componentStack:r.stack,digest:r.digest});if(O0)throw O0=!1,i=UI,UI=null,i;return Q0&1&&i.tag!==0&&Ac(),s=i.pendingLanes,s&1?i===GI?hf++:(hf=0,GI=i):hf=0,la(),null}function Ac(){if(fa!==null){var i=xR(Q0),e=ur.transition,t=Lt;try{if(ur.transition=null,Lt=16>i?16:i,fa===null)var n=!1;else{if(i=fa,fa=null,Q0=0,_t&6)throw Error(Ce(331));var r=_t;for(_t|=4,Le=i.current;Le!==null;){var s=Le,o=s.child;if(Le.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Le=u;Le!==null;){var c=Le;switch(c.tag){case 0:case 11:case 15:lf(8,c,s)}var h=c.child;if(h!==null)h.return=c,Le=h;else for(;Le!==null;){c=Le;var d=c.sibling,g=c.return;if(_D(c),c===u){Le=null;break}if(d!==null){d.return=g,Le=d;break}Le=g}}}var A=s.alternate;if(A!==null){var p=A.child;if(p!==null){A.child=null;do{var y=p.sibling;p.sibling=null,p=y}while(p!==null)}}Le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Le=o;else e:for(;Le!==null;){if(s=Le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:lf(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Le=v;break e}Le=s.return}}var E=i.current;for(Le=E;Le!==null;){o=Le;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,Le=I;else e:for(o=E;Le!==null;){if(a=Le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:P0(9,a)}}catch(w){oi(a,a.return,w)}if(a===o){Le=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,Le=C;break e}Le=a.return}}if(_t=r,la(),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(jA,i)}catch{}n=!0}return n}finally{Lt=t,ur.transition=e}}return!1}function ND(i,e,t){e=hc(t,e),e=iD(i,e,1),i=ca(i,e,1),e=An(),i!==null&&(Pd(i,1,e),Dn(i,e))}function oi(i,e,t){if(i.tag===3)ND(i,i,t);else for(;e!==null;){if(e.tag===3){ND(e,i,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(da===null||!da.has(n))){i=hc(t,i),i=nD(e,i,1),e=ca(e,i,1),i=An(),e!==null&&(Pd(e,1,i),Dn(e,i));break}}e=e.return}}function Kj(i,e,t){var n=i.pingCache;n!==null&&n.delete(e),e=An(),i.pingedLanes|=i.suspendedLanes&t,Bi===i&&(zi&t)===t&&(Ii===4||Ii===3&&(zi&130023424)===zi&&500>ui()-QI?fl(i,0):NI|=t),Dn(i,e)}function QD(i,e){e===0&&(i.mode&1?(e=KA,KA<<=1,!(KA&130023424)&&(KA=4194304)):e=1);var t=An();i=Ks(i,e),i!==null&&(Pd(i,e,t),Dn(i,t))}function Yj(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),QD(i,t)}function Zj(i,e){var t=0;switch(i.tag){case 13:var n=i.stateNode,r=i.memoizedState;r!==null&&(t=r.retryLane);break;case 19:n=i.stateNode;break;default:throw Error(Ce(314))}n!==null&&n.delete(e),QD(i,t)}var UD;UD=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||Tn.current)Rn=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return Rn=!1,Nj(i,e,t);Rn=!!(i.flags&131072)}else Rn=!1,Wt&&e.flags&1048576&&vL(e,m0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;D0(i,e),i=e.pendingProps;var r=nc(e,Xi.current);uc(e,t),r=pI(null,e,n,i,r,t);var s=mI();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bn(n)?(s=!0,g0(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,uI(e),r.updater=R0,e.stateNode=r,r._reactInternals=e,CI(e,n,i,t),e=SI(null,e,n,!0,s,t)):(e.tag=0,Wt&&s&&J1(e),gn(null,e,r,t),e=e.child),e;case 16:n=e.elementType;e:{switch(D0(i,e),i=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=Jj(n),i=kr(n,i),r){case 0:e=bI(null,e,n,i,t);break e;case 1:e=dD(null,e,n,i,t);break e;case 11:e=aD(null,e,n,i,t);break e;case 14:e=lD(null,e,n,kr(n.type,i),t);break e}throw Error(Ce(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:kr(n,r),bI(i,e,n,r,t);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:kr(n,r),dD(i,e,n,r,t);case 3:e:{if(fD(e),i===null)throw Error(Ce(387));n=e.pendingProps,s=e.memoizedState,r=s.element,TL(i,e),C0(e,n,null,t);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=hc(Error(Ce(423)),e),e=gD(i,e,n,t,r);break e}else if(n!==r){r=hc(Error(Ce(424)),e),e=gD(i,e,n,t,r);break e}else for(Kn=sa(e.stateNode.containerInfo.firstChild),Wn=e,Wt=!0,Dr=null,t=bL(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(oc(),n===r){e=Zs(i,e,t);break e}gn(i,e,n,t)}e=e.child}return e;case 5:return LL(e),i===null&&iI(e),n=e.type,r=e.pendingProps,s=i!==null?i.memoizedProps:null,o=r.children,j1(n,r)?o=null:s!==null&&j1(n,s)&&(e.flags|=32),hD(i,e),gn(i,e,o,t),e.child;case 6:return i===null&&iI(e),null;case 13:return AD(i,e,t);case 4:return cI(e,e.stateNode.containerInfo),n=e.pendingProps,i===null?e.child=ac(e,null,n,t):gn(i,e,n,t),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:kr(n,r),aD(i,e,n,r,t);case 7:return gn(i,e,e.pendingProps,t),e.child;case 8:return gn(i,e,e.pendingProps.children,t),e.child;case 12:return gn(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Ut(E0,n._currentValue),n._currentValue=o,s!==null)if(Lr(s.value,o)){if(s.children===r.children&&!Tn.current){e=Zs(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ys(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),aI(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ce(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),aI(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}gn(i,e,r.children,t),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,uc(e,t),r=ar(r),n=n(r),e.flags|=1,gn(i,e,n,t),e.child;case 14:return n=e.type,r=kr(n,e.pendingProps),r=kr(n.type,r),lD(i,e,n,r,t);case 15:return uD(i,e,e.type,e.pendingProps,t);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:kr(n,r),D0(i,e),e.tag=1,Bn(n)?(i=!0,g0(e)):i=!1,uc(e,t),eD(e,n,r),CI(e,n,r,t),SI(null,e,n,!0,i,t);case 19:return mD(i,e,t);case 22:return cD(i,e,t)}throw Error(Ce(156,e.tag))};function GD(i,e){return ER(i,e)}function Xj(i,e,t,n){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(i,e,t,n){return new Xj(i,e,t,n)}function jI(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Jj(i){if(typeof i=="function")return jI(i)?1:0;if(i!=null){if(i=i.$$typeof,i===JE)return 11;if(i===i1)return 14}return 2}function pa(i,e){var t=i.alternate;return t===null?(t=cr(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function z0(i,e,t,n,r,s){var o=2;if(n=i,typeof i=="function")jI(i)&&(o=1);else if(typeof i=="string")o=5;else e:switch(i){case Vu:return Al(t.children,r,s,e);case ZE:o=8,r|=8;break;case XE:return i=cr(12,t,e,r|2),i.elementType=XE,i.lanes=s,i;case e1:return i=cr(13,t,e,r),i.elementType=e1,i.lanes=s,i;case t1:return i=cr(19,t,e,r),i.elementType=t1,i.lanes=s,i;case Y2:return V0(t,r,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case W2:o=10;break e;case K2:o=9;break e;case JE:o=11;break e;case i1:o=14;break e;case Zo:o=16,n=null;break e}throw Error(Ce(130,i==null?i:typeof i,""))}return e=cr(o,t,e,r),e.elementType=i,e.type=n,e.lanes=s,e}function Al(i,e,t,n){return i=cr(7,i,n,e),i.lanes=t,i}function V0(i,e,t,n){return i=cr(22,i,n,e),i.elementType=Y2,i.lanes=t,i.stateNode={isHidden:!1},i}function WI(i,e,t){return i=cr(6,i,null,e),i.lanes=t,i}function KI(i,e,t){return e=cr(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function eW(i,e,t,n,r){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_1(0),this.expirationTimes=_1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_1(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function YI(i,e,t,n,r,s,o,a,l){return i=new eW(i,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=cr(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},uI(s),i}function tW(i,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zu,key:n==null?null:""+n,children:i,containerInfo:e,implementation:t}}function HD(i){if(!i)return aa;i=i._reactInternals;e:{if(nl(i)!==i||i.tag!==1)throw Error(Ce(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ce(171))}if(i.tag===1){var t=i.type;if(Bn(t))return pL(i,t,e)}return e}function zD(i,e,t,n,r,s,o,a,l){return i=YI(t,n,!0,i,r,s,o,a,l),i.context=HD(null),t=i.current,n=An(),r=ga(t),s=Ys(n,r),s.callback=e??null,ca(t,s,r),i.current.lanes=r,Pd(i,r,n),Dn(i,n),i}function q0(i,e,t,n){var r=e.current,s=An(),o=ga(r);return t=HD(t),e.context===null?e.context=t:e.pendingContext=t,e=Ys(s,o),e.payload={element:i},n=n===void 0?null:n,n!==null&&(e.callback=n),i=ca(r,e,o),i!==null&&(Fr(i,r,o,s),_0(i,r,o)),o}function $0(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function VD(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function ZI(i,e){VD(i,e),(i=i.alternate)&&VD(i,e)}function iW(){return null}var qD=typeof reportError=="function"?reportError:function(i){console.error(i)};function XI(i){this._internalRoot=i}j0.prototype.render=XI.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(Ce(409));q0(i,e,null,null)},j0.prototype.unmount=XI.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;dl(function(){q0(null,i,null,null)}),e[qs]=null}};function j0(i){this._internalRoot=i}j0.prototype.unstable_scheduleHydration=function(i){if(i){var e=TR();i={blockedOn:null,target:i,priority:e};for(var t=0;t<ia.length&&e!==0&&e<ia[t].priority;t++);ia.splice(t,0,i),t===0&&LR(i)}};function JI(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function W0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function $D(){}function nW(i,e,t,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var u=$0(o);s.call(u)}}var o=zD(e,n,i,0,null,!1,!1,"",$D);return i._reactRootContainer=o,i[qs]=o.current,Wd(i.nodeType===8?i.parentNode:i),dl(),o}for(;r=i.lastChild;)i.removeChild(r);if(typeof n=="function"){var a=n;n=function(){var u=$0(l);a.call(u)}}var l=YI(i,0,!1,null,null,!1,!1,"",$D);return i._reactRootContainer=l,i[qs]=l.current,Wd(i.nodeType===8?i.parentNode:i),dl(function(){q0(e,l,t,n)}),l}function K0(i,e,t,n,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=$0(o);a.call(l)}}q0(e,o,i,r)}else o=nW(t,e,i,r,n);return $0(o)}bR=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=kd(e.pendingLanes);t!==0&&(C1(e,t|1),Dn(e,ui()),!(_t&6)&&(gc=ui()+500,la()))}break;case 13:dl(function(){var n=Ks(i,1);if(n!==null){var r=An();Fr(n,i,1,r)}}),ZI(i,1)}},w1=function(i){if(i.tag===13){var e=Ks(i,134217728);if(e!==null){var t=An();Fr(e,i,134217728,t)}ZI(i,134217728)}},SR=function(i){if(i.tag===13){var e=ga(i),t=Ks(i,e);if(t!==null){var n=An();Fr(t,i,e,n)}ZI(i,e)}},TR=function(){return Lt},BR=function(i,e){var t=Lt;try{return Lt=i,e()}finally{Lt=t}},p1=function(i,e,t){switch(e){case"input":if(l1(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==i&&n.form===i.form){var r=d0(n);if(!r)throw Error(Ce(90));J2(n),l1(n,r)}}}break;case"textarea":rR(i,t);break;case"select":e=t.value,e!=null&&qu(i,!!t.multiple,e,!1)}},fR=VI,gR=dl;var rW={usingClientEntryPoint:!1,Events:[Zd,tc,d0,hR,dR,VI]},df={findFiberByHostInstance:rl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sW={bundleType:df.bundleType,version:df.version,rendererPackageName:df.rendererPackageName,rendererConfig:df.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=yR(i),i===null?null:i.stateNode},findFiberByHostInstance:df.findFiberByHostInstance||iW,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Y0.isDisabled&&Y0.supportsFiber)try{jA=Y0.inject(sW),ns=Y0}catch{}}qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rW,qn.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!JI(e))throw Error(Ce(200));return tW(i,e,null,t)},qn.createRoot=function(i,e){if(!JI(i))throw Error(Ce(299));var t=!1,n="",r=qD;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=YI(i,1,!1,null,null,t,!1,n,r),i[qs]=e.current,Wd(i.nodeType===8?i.parentNode:i),new XI(e)},qn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(Ce(188)):(i=Object.keys(i).join(","),Error(Ce(268,i)));return i=yR(e),i=i===null?null:i.stateNode,i},qn.flushSync=function(i){return dl(i)},qn.hydrate=function(i,e,t){if(!W0(e))throw Error(Ce(200));return K0(null,i,e,!0,t)},qn.hydrateRoot=function(i,e,t){if(!JI(i))throw Error(Ce(405));var n=t!=null&&t.hydratedSources||null,r=!1,s="",o=qD;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=zD(e,null,i,1,t??null,r,!1,s,o),i[qs]=e.current,Wd(i),n)for(i=0;i<n.length;i++)t=n[i],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new j0(e)},qn.render=function(i,e,t){if(!W0(e))throw Error(Ce(200));return K0(null,i,e,!1,t)},qn.unmountComponentAtNode=function(i){if(!W0(i))throw Error(Ce(40));return i._reactRootContainer?(dl(function(){K0(null,null,i,!1,function(){i._reactRootContainer=null,i[qs]=null})}),!0):!1},qn.unstable_batchedUpdates=VI,qn.unstable_renderSubtreeIntoContainer=function(i,e,t,n){if(!W0(t))throw Error(Ce(200));if(i==null||i._reactInternals===void 0)throw Error(Ce(38));return K0(i,e,t,!1,n)},qn.version="18.3.1-next-f1338f8080-20240426";function jD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jD)}catch(i){console.error(i)}}jD(),H2.exports=qn;var pl=H2.exports;const oW=jo(pl);var WD,KD=pl;WD=KD.createRoot,KD.hydrateRoot;var aW=Object.defineProperty,lW=(i,e,t)=>e in i?aW(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Z0=(i,e,t)=>(lW(i,typeof e!="symbol"?e+"":e,t),t);const De=[];Object.freeze(De);const uW={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:De,motivation:null,label:null,thumbnail:De,summary:null,requiredStatement:null,metadata:De,rights:null,provider:De,items:De,seeAlso:De,homepage:De,logo:De,rendering:De,service:De},cW={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:De,motivation:null,thumbnail:De,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:De,rights:null,navDate:null,provider:De,items:De,annotations:De,seeAlso:De,homepage:De,logo:De,partOf:De,rendering:De,service:De,duration:0,height:0,width:0},hW={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:De,motivation:null,thumbnail:De,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:De,rights:null,navDate:null,provider:De,items:De,annotations:De,seeAlso:De,homepage:De,logo:De,partOf:De,rendering:De,service:De,services:De},dW={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:De,behavior:De,homepage:De,items:De,label:null,logo:De,metadata:De,motivation:null,navDate:null,provider:De,partOf:De,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:De,requiredStatement:null,rights:null,seeAlso:De,service:De,services:De,start:null,structures:De,summary:null,thumbnail:De,viewingDirection:"left-to-right"},fW={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:De,motivation:null,thumbnail:De,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:De,rights:null,navDate:null,provider:De,items:De,annotations:De,seeAlso:De,homepage:De,logo:De,partOf:De,rendering:De,service:De,start:null,supplementary:null,viewingDirection:"left-to-right"},gW={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:De,seeAlso:De,homepage:De};function e_(i){return Array.isArray(i)?i:[i]}const YD=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function AW(i){if(typeof i>"u"||i===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(i))throw new Error("Array is not a valid entity");if(typeof i!="object")throw new Error(`${typeof i} is not a valid entity`);if(typeof i.type=="string"){const e=YD.indexOf(i.type);if(e!==-1)return YD[e]}if(i.profile)return"Service";throw new Error("Resource type is not known")}class t_{constructor(e,t={}){Z0(this,"traversals"),Z0(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],...e},this.options={allowUndefinedReturn:!1,...t}}static all(e){return new t_({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=e.thumbnail.map(t=>this.traverseType(t,this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(t=>this.traverseAgent(t))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map(t=>this.traverseType(t,this.traversals.contentResource))),e.service&&(e.service=e_(e.service).map(t=>this.traverseType(t,this.traversals.service))),e.services&&(e.services=e.services.map(t=>this.traverseType(t,this.traversals.service))),e.logo&&(e.logo=e.logo.map(t=>this.traverseType(t,this.traversals.contentResource))),e.homepage&&(e.homepage=e.homepage.map(t=>this.traverseType(t,this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(t=>typeof t=="string"||!t.type?this.traverseType(t,this.traversals.contentResource):t.type==="Canvas"?this.traverseType(t,this.traversals.canvas):t.type==="AnnotationCollection"?this.traverseType(t,this.traversals.annotationCollection):t.type==="Collection"?this.traverseType(t,this.traversals.collection):this.traverseType(t,this.traversals.contentResource))),e.start&&(e.start=e.start?this.traverseType(e.start,this.traversals.canvas):null),e.rendering&&(e.rendering=e.rendering.map(t=>this.traverseType(t,this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(t=>this.traverseType(t,this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(t=>t.type==="Collection"?this.traverseCollection(t):this.traverseManifest(t)),e}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(e))))),this.traversals.collection)}traverseManifestItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseCanvas(t))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseManifest(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e)))))),this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(t=>this.traverseAnnotationPage(t)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(t=>this.traverseAnnotationPage(t))),e}traverseCanvas(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))))),this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseAnnotation(t))),e}traverseAnnotationPage(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(e))),this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(t=>this.traverseContentResource(t)):e.body&&(e.body=this.traverseContentResource(e.body)),e}traversePosterCanvas(e){return e.posterCanvas&&(e.posterCanvas=this.traverseCanvas(e.posterCanvas)),e.placeholderCanvas&&(e.placeholderCanvas=this.traverseCanvas(e.placeholderCanvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseCanvas(e.accompanyingCanvas)),e}traverseAnnotation(e){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(e)),this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=e_(e.service||[]).map(t=>this.traverseType(t,this.traversals.service))),e}traverseContentResource(e){return e.type==="Choice"&&(e.items=e.items.map(t=>this.traverseContentResource(t))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),this.traversals.contentResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(t=>typeof t=="string"?this.traverseCanvas({id:t,type:"Canvas"}):t.type==="Manifest"?this.traverseManifest(t):this.traverseRange(t))),e}traverseRange(e){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(e)))),this.traversals.range)}traverseAgent(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.agent)}traverseType(e,t){return t.reduce((n,r)=>{const s=r(n);return typeof s>"u"&&!this.options.allowUndefinedReturn?n:s},e)}traverseService(e){return this.traverseType(e,this.traversals.service)}traverseUnknown(e){const t=AW(e);switch(t){case"Collection":return this.traverseCollection(e);case"Manifest":return this.traverseManifest(e);case"Canvas":return this.traverseCanvas(e);case"AnnotationPage":return this.traverseAnnotationPage(e);case"Annotation":return this.traverseAnnotation(e);case"ContentResource":return this.traverseContentResource(e);case"Range":return this.traverseRange(e);case"Service":return this.traverseService(e);case"Agent":return this.traverseAgent(e);default:throw new Error(`Unknown or unsupported resource type of ${t}`)}}}const ZD=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function pW(i){if(typeof i>"u"||i===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(i))throw new Error("Array is not a valid entity");if(typeof i!="object")throw new Error(`${typeof i} is not a valid entity`);if(typeof i["@type"]=="string"){const e=ZD.indexOf(i["@type"]);if(e!==-1)return ZD[e]}if(i.profile)return"Service";if(i.format||i["@type"])return"ContentResource";throw new Error("Resource type is not known")}class i_{constructor(e,t={}){Z0(this,"traversals"),Z0(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...t}}static all(e){return new i_({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){const t=[...(e.manifests||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n),...(e.collections||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n),...e.members||[]];delete e.collections,delete e.manifests,e.members=t}return e.manifests&&(e.manifests=e.manifests.map(t=>this.traverseManifest(typeof t=="string"?{"@id":t,"@type":"sc:Manifest"}:t))),e.collections&&(e.collections=e.collections.map(t=>this.traverseCollection(typeof t=="string"?{"@id":t,"@type":"sc:Collection"}:t))),e.members&&(e.members=e.members.map(t=>typeof t=="string"?t:this.traverseUnknown(t))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(t=>this.traverseSequence(t))),e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(t=>this.traverseCanvas(t))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(t=>this.traverseAnnotation(t))),e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){const t=[...(e.ranges||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Range"}:n),...(e.canvases||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Canvas"}:n),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(n=>this.traverseUnknown(n)):void 0}return e}traverseAnnotationList(e){const t=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(t)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(t=>this.traverseAnnotation(t))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(t=>this.traverseContentResource(t)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(t=>this.traverseContentResource(t))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(pW(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){const t=Array.isArray(e),n=Array.isArray(e)?e:[e],r=[];for(const s of n)typeof s=="string"?r.push(this.traverseContentResource({"@id":s,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(s));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){const t=Array.isArray(e),n=Array.isArray(e)?e:[e],r=[];for(const s of n)r.push(this.traverseService(s));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,t);return e.map(n=>this.traverseType(n,t))}traverseType(e,t){return t.reduce((n,r)=>{const s=r(n);return typeof s>"u"&&!this.options.allowUndefinedReturn?n:s},e)}}const mW="http://library.stanford.edu/iiif/image-api/compliance.html#level0",XD="http://library.stanford.edu/iiif/image-api/compliance.html#level1",JD="http://library.stanford.edu/iiif/image-api/compliance.html#level2",yW="http://library.stanford.edu/iiif/image-api/conformance.html#level0",ek="http://library.stanford.edu/iiif/image-api/conformance.html#level1",tk="http://library.stanford.edu/iiif/image-api/conformance.html#level2",vW="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",ik="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",nk="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",EW="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",rk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",sk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",IW="http://iiif.io/api/image/1/level0.json",_W="http://iiif.io/api/image/1/profiles/level0.json",ok="http://iiif.io/api/image/1/level1.json",ak="http://iiif.io/api/image/1/profiles/level1.json",lk="http://iiif.io/api/image/1/level2.json",uk="http://iiif.io/api/image/1/profiles/level2.json",CW="http://iiif.io/api/image/2/level0.json",wW="http://iiif.io/api/image/2/profiles/level0.json",ck="http://iiif.io/api/image/2/level1.json",hk="http://iiif.io/api/image/2/profiles/level1.json",dk="http://iiif.io/api/image/2/level2.json",fk="http://iiif.io/api/image/2/profiles/level2.json",xW="level0",gk="level1",Ak="level2",bW="http://iiif.io/api/image/2/level0",pk="http://iiif.io/api/image/2/level1",mk="http://iiif.io/api/image/2/level2",SW=[pk,mk,XD,JD,ek,tk,ik,nk,rk,sk,ok,ak,lk,uk,ck,hk,dk,fk,gk,Ak],TW=[bW,pk,mk,mW,XD,JD,yW,ek,tk,vW,ik,nk,EW,rk,sk,IW,_W,ok,ak,lk,uk,CW,wW,ck,hk,dk,fk,xW,gk,Ak],n_={attributionLabel:"Attribution",lang:"none",providerId:"http://example.org/provider",providerName:"Unknown"};function ml(i,e="none"){if(!i)return{};const t=Array.isArray(i)?i:[i],n={};for(const r of t){if(typeof r=="string"){n[e]=n[e]?n[e]:[],n[e].push(r||"");continue}if(!r["@language"]){n[e]=n[e]?n[e]:[],n[e].push(r["@value"]||"");continue}const s=r["@language"];n[s]=n[s]?n[s]:[],n[s].push(r["@value"]||"")}return n}function yk(i){if(Array.isArray(i))return yk(i.find(e=>typeof e=="string"));if(TW.indexOf(i)!==-1)return"level2";if(SW.indexOf(i)!==-1)return"level1";if(typeof i=="string")return i}function BW(i){const e=Array.isArray(i)?i:[i];for(const t of e)switch(t){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function RW(i){switch(i){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function vk(i){for(const e of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${e}:`))return i.slice(e.length+1);return i}const LW=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function r_(i){const e=i["@id"]||i.id;let t=i["@type"]||i.type;const n=i.profile||void 0,r=i["@context"]||void 0;if(n){const s=RW(n);if(s)return s}if(r){const s=BW(r);if(s)return s}if(t){if(Array.isArray(t)){if(t.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(t.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";t=t[0]}for(const s of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${s}:`)){t=t.slice(s.length+1);break}switch(t){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(t&&LW.indexOf(t)!==-1)return t;if(i.format){if(i.format.startsWith("image/"))return"Image";if(i.format.startsWith("text/")||i.format==="application/pdf")return"Text";if(i.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":t||"unknown"}const DW=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function kW(i){const e=i.match(DW);return e?e[0]:i}function PW(i,e="Rights/License",t="none"){let n=null;const r=[],s=Array.isArray(i)?i:[i];for(const o of s){const a=o?kW(o):void 0;if(a&&(a.indexOf("creativecommons.org")!==-1||a.indexOf("rightsstatements.org")!==-1)){a.startsWith("https://")?n=`http://${a.slice(8)}`:n=a;continue}a&&r.push({label:{[t]:[e]},value:{[t]:[a]}})}return[n,r]}const MW=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function FW(i){if(i){const e=Array.isArray(i)?i:[i],t=[];for(const n of e)n==="http://iiif.io/api/presentation/2/context.json"&&t.push("http://iiif.io/api/presentation/3/context.json"),MW.indexOf(n)===-1&&t.push(n);if(e.length)return t.length===1?t[0]:t}}function OW(i){return i?i.map(e=>({label:ml(e.label),value:ml(e.value)})):[]}function Js(i){for(const e in i)(typeof i[e]>"u"||i[e]===null)&&delete i[e];return i}let Ek=0;function Ik(i,e){const t=encodeURI(i.id||i["@id"]||"").trim();return t&&e?`${t}/${e}`:t||(Ek++,`http://example.org/${i["@type"]}${e?`/${e}`:""}/${Ek}`)}function eo(i){const e=[...i.behavior||[]];i.viewingHint&&e.push(i.viewingHint);let t;return Array.isArray(i.motivation)?t=i.motivation.map(vk):i.motivation&&(t=vk(i.motivation)),{"@context":i["@context"]?FW(i["@context"]):void 0,id:(i["@id"]||Ik(i)).trim(),type:r_(i),behavior:e.length?e:void 0,height:i.height?i.height:void 0,width:i.width?i.width:void 0,motivation:t,viewingDirection:i.viewingDirection,profile:i.profile,format:i.format?i.format:void 0,duration:void 0,timeMode:void 0}}function to(i){const[e,t]=PW(i.license),n=[...i.metadata?OW(i.metadata):[],...t];return{rights:e,metadata:n.length?n:void 0,label:i.label?ml(i.label):void 0,requiredStatement:i.attribution?{label:ml(n_.attributionLabel),value:ml(i.attribution)}:void 0,navDate:i.navDate,summary:i.description?ml(i.description):void 0,thumbnail:i.thumbnail}}function NW(i){if(!i.within)return;const e=Array.isArray(i.within)?i.within:[i.within],t=[];for(const n of e)if(typeof n=="string"){if(n)switch(i["@type"]){case"sc:Manifest":t.push({id:n,type:"Collection"});break}}else n["@id"]&&t.push({id:n["@id"],type:r_(n)});return t.length?t:void 0}function ma(i){const e=i.related?Array.isArray(i.related)?i.related:[i.related]:[],t=i.contentLayer;return{provider:i.logo||e.length?[{id:n_.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:i.logo?Array.isArray(i.logo)?i.logo:[i.logo]:void 0,label:ml(n_.providerName)}]:void 0,partOf:NW(i),rendering:i.rendering,seeAlso:i.seeAlso,start:i.startCanvas,service:i.service?e_(i.service):void 0,supplementary:t?[t]:void 0}}function QW(i){return{chars:i.chars,format:i.format?i.format:void 0,language:i.language}}function UW(i){return Js({...eo(i),...to(i),...ma(i),items:i.members})}function GW(i){const e=[],t=[];for(const r of i.sequences||[])r.canvases.length&&e.push(...r.canvases),r.behavior&&t.push(...r.behavior);const n=eo(i);return t.length&&(n.behavior?n.behavior.push(...t):n.behavior=t),Js({...n,...to(i),...ma(i),items:e,structures:i.structures})}function HW(i){return Js({...eo(i),...to(i),...ma(i),annotations:i.otherContent&&i.otherContent.length?i.otherContent:void 0,items:i.images&&i.images.length?[{id:Ik(i,"annotation-page"),type:"AnnotationPage",items:i.images}]:void 0})}function zW(i){return Js({...eo(i),...to(i),...ma(i),items:i.resources&&i.resources.length?i.resources:void 0})}function VW(i){return!i.canvases||i.canvases.length===0?{canvases:[],behavior:[]}:{canvases:i.canvases,behavior:i.viewingHint?[i.viewingHint]:[]}}function qW(i){function e(t){if(Array.isArray(t)){if(t.length>1)return{type:"List",items:t.map(e)};t=t[0]}if(typeof t=="string")return encodeURI(t).trim();if("@type"in t){let n;if(typeof t.full=="string")n=t.full;else if(t.full["@type"]==="dctypes:Image")n={id:t.full["@id"],type:"Image"};else if(t.full["@type"]==="sc:Canvas")n={id:t.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${t.full["@type"]}`);return{type:"SpecificResource",source:n,selector:o_(t.selector)}}else return encodeURI(t["@id"]).trim()}return Js({...eo(i),...to(i),...ma(i),target:e(i.on),body:Array.isArray(i.resource)?i.resource.map(s_):s_(i.resource)})}function s_(i){const e=i;return Js({...eo(e),...to(e),...ma(e),...QW(e)})}function $W(i){const e=[];return i.default&&i.default!=="rdf:nil"&&e.push(i.default),i.item&&i.item!=="rdf:nil"&&e.push(...i.item),{...eo(i),...to(i),items:e}}function jW(i){return Js({...eo(i),...to(i),...ma(i),items:i.members})}function WW(i){const{"@id":e,"@type":t,"@context":n,profile:r,...s}=i,o={};return e&&(o["@id"]=e),o["@type"]=r_(i),o["@type"]==="unknown"&&(n&&n.length&&(o["@context"]=n),o["@type"]="Service"),r&&(o.profile=yk(r)),Js({...o,...s})}function KW(i){return Js({...eo(i),...to(i),...ma(i)})}const YW=new i_({collection:[UW],manifest:[GW],canvas:[HW],annotationList:[zW],sequence:[VW],annotation:[qW],contentResource:[s_],choice:[$W],range:[jW],service:[WW],layer:[KW]});function ZW(i){return i&&i["@context"]&&(i["@context"]==="http://iiif.io/api/presentation/2/context.json"||i["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||i["@context"]==="http://www.shared-canvas.org/ns/context.json")||i["@context"]==="http://iiif.io/api/image/2/context.json"?YW.traverseUnknown(i):i}function o_(i){if((Array.isArray(i["@type"])&&i["@type"].includes("oa:SvgSelector")||i["@type"]=="oa:SvgSelector")&&("chars"in i||"value"in i))return{type:"SvgSelector",value:"chars"in i?i.chars:i.value};if(i["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:i.value};if(i["@type"]==="oa:Choice")return[o_(i.default),...(Array.isArray(i.item)?i.item:[i.item]).map(o_)];if(i["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in i?i.region:void 0,rotation:"rotation"in i?i.rotation:void 0};throw new Error(`Unsupported selector type: ${i["@type"]}`)}function XW(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function _k(i,e){if(typeof i=="string")return{id:i,type:e};if(!i.id)throw new Error(`Invalid resource does not have an ID (${e})`);return i}function JW(i){return(e,t)=>{const n=i[e]?i[e]:{};return r=>{const s=_k(r,t||e);return s&&s.id&&e?(n[s.id]=n[s.id]?eK(n[s.id],s):Object.assign({},s),{id:s.id,type:e==="ContentResource"?e:s.type}):s}}}function a_(i,e){if(!e)return i;if(Array.isArray(i)){if(!Array.isArray(e))throw new Error("Cannot merge array with non-array");const t=[...i];for(const n of e)if(n!=null)if(Array.isArray(n))t.push(n);else if(typeof n=="object"&&n.id&&n.type){const r=t.findIndex(s=>s.id===n.id&&s.type===n.type);r>=0&&(t[r]=a_(t[r],n))}else i.indexOf(n)===-1&&t.push(n);return t}else if(typeof i=="object"){if(Array.isArray(e)||typeof e!="object")throw new Error("Cannot merge object with non-object");const t={...i};for(const[n,r]of Object.entries(e)){const s=t[n];s===De||!s?t[n]=r:t[n]=a_(s,r)}return t}else if(i)return i;return e}function eK(i,e){if(typeof i=="string")return i;if(e.id!==i.id||e.type!==i.type)throw new Error("Can only merge entities with identical identifiers and type!");return a_({...i},e)}function tK(i){return(e,t)=>n=>{const{id:r,type:s}=_k(n,t||e);if(typeof r>"u")throw new Error("Found invalid entity without an ID.");return e==="ContentResource"?i[r]=e:i[r]=s,n}}function iK(i){const e=JSON.stringify(i);let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);const s=(t>>>0).toString(16);return s.length%2?"0"+s:s}function l_(i){return e=>typeof e=="string"?{id:e,type:i}:e.id?e.type?e:{type:i,...e}:{id:`vault://${iK(e)}`,type:i,...e}}function pc(i){return e=>({...i,...e})}function mc(i){return Array.isArray(i)?i:[i]}function nK(i){return i.body&&(i.body=mc(i.body)),i.seeAlso&&(i.seeAlso=mc(i.seeAlso)),i.body&&(i.body=mc(i.body)),i.audience&&(i.audience=mc(i.audience)),i.accessibility&&(i.accessibility=mc(i.accessibility)),i.motivation&&(i.motivation=mc(i.motivation)),i}function rK(i){const e=ZW(i),t=XW(),n={},r=JW(t),s=tK(n),a=new t_({collection:[pc(hW),s("Collection"),r("Collection")],manifest:[pc(dW),s("Manifest"),r("Manifest")],canvas:[pc(cW),s("Canvas"),r("Canvas")],annotationPage:[l_("AnnotationPage"),pc(uW),s("AnnotationPage"),r("AnnotationPage")],annotation:[l_("Annotation"),nK,s("Annotation"),r("Annotation")],contentResource:[l_("ContentResource"),s("ContentResource"),r("ContentResource")],range:[pc(fW),s("Range","Canvas"),r("Range","Canvas")],agent:[pc(gW),s("Agent"),r("Agent")]}).traverseUnknown(e);return{entities:t,resource:a,mapping:n}}const yl="__$UNSET$__",Ck="__$UNWRAP$__";function sK(i,e){const t=i.requests[e],n=i.mapping[e];if(!(!n||t&&t.resourceUri&&!i.entities[n][t.resourceUri]))return i.entities[n][t?t.resourceUri:e]}function oK(i){const e={};for(const[t,n]of i){if(t===Ck&&n!==yl)return n;n!==yl&&typeof n<"u"&&n!==null&&(e[t]=n)}return e}function aK(i,e,t){if(!e.type||!e.id)throw new Error("Unknown entity");if(!t[e.type])throw new Error(`Serializer not found for ${e.type}`);function n(r){const s=t[r.type];if(!s)return yl;const o=sK(i,r.id)||(r.id&&r.type?r:null);if(!o)return yl;const a=s(o,i,{isTopLevel:e.id===r.id});let l=a.next();for(;!l.done;){const u=l.value;let c=yl;if(u)if(Array.isArray(u)){const h=[];for(const d of u)h.push(n(d));c=h}else c=n(u);l=a.next(c)}return l.value===yl?yl:oK(l.value)}return n(e)}function yc(i){if(!i)return;const e=Object.keys(i);if(e.length!==0){if(e.length===1){const t=e[0];if(!t)return"";const n=(i[t]||[]).join("");return t==="@none"||t==="none"||t==="en"?n:{"@language":t,"@value":n}}return e.map(t=>({"@language":t,"@value":(i[t]||[]).join("")}))}}function wk(i){return Array.isArray(i)?i.map(e=>wk(e)):typeof i=="string"?i:i.type&&i.type==="Canvas"?i.id:i}function ya(i,e=!1){if(i)return i.length>1&&!e?i:i[0]||void 0}function lK(i){if(i){if(typeof i=="string")return{"@id":i};if("@id"in i){const e={...i};return delete e["@type"],e}return{"@context":"http://iiif.io/api/image/2/context.json","@id":i.id,profile:`http://iiif.io/api/image/2/profiles/${i.profile}.json`}}}function vl(i,e){return[["@id",i.id],["@type",e],["format",i.format],["height",i.height],["width",i.width],["viewingDirection",i.viewingDirection!=="left-to-right"?i.viewingDirection:void 0]]}function*El(i){const e=i.provider?yield i.provider[0]:void 0;return[["label",yc(i.label)],["metadata",i.metadata&&i.metadata.length?i.metadata.map(t=>({label:yc(t.label)||"",value:yc(t.value)||""})):void 0],["description",yc(i.summary)],["thumbnail",ya(yield i.thumbnail)],["navDate",i.navDate],["logo",e?ya(e.logo):void 0],["homepage",e?e.homepage:void 0],["attribution",i.requiredStatement?yc(i.requiredStatement.value):void 0]]}function*ff(i){return[["seeAlso",ya(yield i.seeAlso)],["service",ya((i.service||[]).map(lK))],["rendering",ya(yield i.rendering)],["startCanvas",i.start?i.start.id:void 0]]}const uK={Manifest:function*(i){return[...vl(i,"sc:Manifest"),...yield*El(i),...yield*ff(i),["sequences",[{"@id":`${i.id}/sequence0`,"@type":"sc:Sequence",canvases:yield i.items}]],["structures",yield i.structures]]},Canvas:function*(i){const t=(yield i.items)[0];return[...vl(i,"sc:Canvas"),...yield*El(i),...yield*ff(i),["images",t?[t.resources]:void 0],["annotations",i.annotations&&i.annotations.length?ya(yield i.annotations):void 0]]},AnnotationPage:function*(i){return[...vl(i,"sc:AnnotationList"),...yield*El(i),["resources",i.items&&i.items.length?ya(yield i.items):void 0]]},Annotation:function*(i){return[["@id",i.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",wk(i.target)],["resource",ya(yield i.body,!0)]]},ContentResource:function*(i){switch(i.type){case"Image":return[...vl(i,"dctypes:Image"),...yield*El(i),...yield*ff(i)];case"Text":case"Dataset":default:return[...vl(i,void 0),...yield*El(i)]}},AnnotationCollection:function*(i){return[["@id",i.id],["@type","sc:Layer"],["label",yc(i.label)]]},Collection:function*(i){return[...vl(i,"sc:Collection"),...yield*El(i),...yield*ff(i),["members",yield*i.items]]},Range:function*(i){const e=[],t=[];if(i.items)for(const n of i.items){const r=yield n;e.push({"@id":n.id,"@type":n.type,label:r?r.label:void 0,within:i.id}),n.type==="Canvas"&&t.push(n.id)}return[...vl(i,"sc:Range"),...yield*El(i),...yield*ff(i),["canvases",t.length===e.length?t:void 0],["members",t.length!==e.length?e:void 0]]}};function Il(i){var e;return[["id",(e=i.id)!=null&&e.startsWith("vault://")?void 0:i.id],["type",i.type],["format",i.format],["profile",i.profile],["height",i.height],["width",i.width],["duration",i.duration||void 0],["viewingDirection",i.viewingDirection!=="left-to-right"?i.viewingDirection:void 0],["behavior",i.behavior&&i.behavior.length?i.behavior:void 0],["timeMode",i.timeMode],["motivation",Array.isArray(i.motivation)?i.motivation[0]:i.motivation]]}function Ri(i){if(!(!i||i.length===0))return i}function xk(i){if(i&&i.type&&i.type==="ImageService2"){const{id:e,type:t,profile:n,...r}=i,s=typeof n=="string"?n:Array.isArray(n)?n.find(o=>typeof o=="string"):"";return{"@id":e,"@type":t,profile:s?s.startsWith("http")?s:`http://iiif.io/api/image/2/${s}.json`:"http://iiif.io/api/image/2/level0.json",...r}}return i}function bk(i){if(!(!i||i.length===0))return i.map(xk)}function*_l(i){return[["label",i.label],["metadata",Ri(i.metadata)],["summary",i.summary],["requiredStatement",i.requiredStatement],["rights",i.rights],["navDate",i.navDate],["language",i.language],["thumbnail",Ri(yield i.thumbnail)],["placeholderCanvas",yield i.placeholderCanvas],["accompanyingCanvas",yield i.accompanyingCanvas],["provider",Ri(yield i.provider)]]}function*Cl(i){return[["seeAlso",Ri(yield i.seeAlso)],["service",bk(i.service)],["services",bk(i.services)],["rendering",Ri(yield i.rendering)],["supplementary",Ri(yield i.supplementary)],["homepage",Ri(yield i.homepage)],["logo",Ri(yield i.logo)],["partOf",Ri(yield i.partOf)],["start",i.start]]}const cK={Manifest:function*(i,e,{isTopLevel:t}){return t?[["@context","http://iiif.io/api/presentation/3/context.json"],...Il(i),...yield*_l(i),...yield*Cl(i),["items",yield i.items],["structures",Ri(yield i.structures)],["annotations",Ri(yield i.annotations)]]:[...Il(i),...yield*_l(i)]},Canvas:function*(i){return[...Il(i),...yield*_l(i),...yield*Cl(i),["items",yield i.items],["annotations",Ri(yield i.annotations)]]},Agent:function*(i){return[["id",i.id],["type","Agent"],["label",i.label],...yield*Cl(i)]},AnnotationPage:function*(i){return[...Object.entries(i).map(([t,n])=>[t,Array.isArray(n)?Ri(n):n]).filter(([t,n])=>t!=="items"),...yield*Cl(i),["items",yield i.items]]},Service:function*(i){return[[Ck,xk(i)]]},Annotation:function*(i){const e=Object.entries(i).map(([n,r])=>n==="motivation"?[n,Array.isArray(r)?r[0]:r]:[n,Array.isArray(r)?Ri(r):r]).filter(([n])=>n!=="body"),t=yield i.body;return[...e,["body",t.length===1?t[0]:t]]},ContentResource:function*(i){return[...Il(i),...yield*_l(i),...yield*Cl(i),["annotations",Ri(yield i.annotations)],["items",Ri(yield i.items)]]},AnnotationCollection:function*(i){return[["id",i.id],["type","AnnotationCollection"],["label",i.label]]},Collection:function*(i,e,{isTopLevel:t}){return t?[["@context","http://iiif.io/api/presentation/3/context.json"],...Il(i),...yield*_l(i),...yield*Cl(i),["items",Ri(yield i.items)]]:[...Il(i),...yield*_l(i)]},Range:function*(i){const e=[];for(const t of i.items)t.type==="Range"?e.push(yield t):e.push(t);return[...Il(i),...yield*_l(i),...yield*Cl(i),["items",e],["annotations",Ri(yield i.annotations)]]}};function Sk(i){return i==null}function Tk(i){throw new Error("Argument "+i+" is empty.")}function hK(i){return typeof i=="string"||typeof i=="symbol"}function Bk(i){return!hK(i)}function Rk(i){throw new Error("Argument "+i+" is invalid, it should be an action type of type: string | symbol")}function dK(i,e){return Sk(i)&&Tk(1),Bk(i)&&Rk(1),Object.assign(function(){var t=e!=null?e.apply(void 0,arguments):void 0;return Object.assign({type:i},t)},{getType:function(){return i},toString:function(){return i}})}function Vi(i,e,t){return Sk(i)&&Tk(1),Bk(i)&&Rk(1),function(){return dK(i,function(){var n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];return Object.assign({},n!==void 0&&{payload:n},{},r!==void 0&&{meta:r})})}}function gf(i){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gf(i)}function fK(i,e){if(gf(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(gf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function gK(i){var e=fK(i,"string");return gf(e)=="symbol"?e:e+""}function AK(i,e,t){return(e=gK(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Lk(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Dk(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Lk(Object(t),!0).forEach(function(n){AK(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Lk(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function rn(i){return"Minified Redux error #"+i+"; visit https://redux.js.org/Errors?code="+i+" for the full message or use the non-minified dev environment for full errors. "}var kk=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),u_=function(){return Math.random().toString(36).substring(7).split("").join(".")},X0={INIT:"@@redux/INIT"+u_(),REPLACE:"@@redux/REPLACE"+u_(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+u_()}};function pK(i){if(typeof i!="object"||i===null)return!1;for(var e=i;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(i)===e}function Pk(i,e,t){var n;if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(rn(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(rn(1));return t(Pk)(i,e)}if(typeof i!="function")throw new Error(rn(2));var r=i,s=e,o=[],a=o,l=!1;function u(){a===o&&(a=o.slice())}function c(){if(l)throw new Error(rn(3));return s}function h(p){if(typeof p!="function")throw new Error(rn(4));if(l)throw new Error(rn(5));var y=!0;return u(),a.push(p),function(){if(y){if(l)throw new Error(rn(6));y=!1,u();var E=a.indexOf(p);a.splice(E,1),o=null}}}function d(p){if(!pK(p))throw new Error(rn(7));if(typeof p.type>"u")throw new Error(rn(8));if(l)throw new Error(rn(9));try{l=!0,s=r(s,p)}finally{l=!1}for(var y=o=a,v=0;v<y.length;v++){var E=y[v];E()}return p}function g(p){if(typeof p!="function")throw new Error(rn(10));r=p,d({type:X0.REPLACE})}function A(){var p,y=h;return p={subscribe:function(E){if(typeof E!="object"||E===null)throw new Error(rn(11));function I(){E.next&&E.next(c())}I();var C=y(I);return{unsubscribe:C}}},p[kk]=function(){return this},p}return d({type:X0.INIT}),n={dispatch:d,subscribe:h,getState:c,replaceReducer:g},n[kk]=A,n}function mK(i){Object.keys(i).forEach(function(e){var t=i[e],n=t(void 0,{type:X0.INIT});if(typeof n>"u")throw new Error(rn(12));if(typeof t(void 0,{type:X0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(rn(13))})}function Mk(i){for(var e=Object.keys(i),t={},n=0;n<e.length;n++){var r=e[n];typeof i[r]=="function"&&(t[r]=i[r])}var s=Object.keys(t),o;try{mK(t)}catch(a){o=a}return function(l,u){if(l===void 0&&(l={}),o)throw o;for(var c=!1,h={},d=0;d<s.length;d++){var g=s[d],A=t[g],p=l[g],y=A(p,u);if(typeof y>"u")throw u&&u.type,new Error(rn(14));h[g]=y,c=c||y!==p}return c=c||s.length!==Object.keys(l).length,c?h:l}}function J0(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return e.length===0?function(n){return n}:e.length===1?e[0]:e.reduce(function(n,r){return function(){return n(r.apply(void 0,arguments))}})}function Fk(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return function(n){return function(){var r=n.apply(void 0,arguments),s=function(){throw new Error(rn(15))},o={getState:r.getState,dispatch:function(){return s.apply(void 0,arguments)}},a=e.map(function(l){return l(o)});return s=J0.apply(void 0,a)(r.dispatch),Dk(Dk({},r),{},{dispatch:s})}}}const Ok="@iiif/IMPORT_ENTITIES",Nk="@iiif/MODIFY_ENTITY_FIELD",Qk="@iiif/REORDER_ENTITY_FIELD",Uk="@iiif/ADD_REFERENCE",Gk="@iiif/REMOVE_REFERENCE",Hk=Vi(Ok)(),yK=Vi(Nk)(),vK=Vi(Qk)(),EK=Vi(Uk)(),IK=Vi(Gk)(),_K={importEntities:Hk,modifyEntityField:yK,reorderEntityField:vK,addReference:EK,removeReference:IK},zk="@iiif/ADD_MAPPING",Vk="@iiif/ADD_MAPPINGS",CK=Vi(zk)(),wK=Vi(Vk)(),qk="@iiif/SET_META_VALUE",$k="@iiif/SET_META_VALUE_DYNAMIC",jk="@iiif/UNSET_META_VALUE",xK=Vi(qk)(),bK=Vi($k)(),SK=Vi(jk)(),Wk={setMetaValue:xK,setMetaValueDynamic:bK,unsetMetaValue:SK},c_="RESOURCE_ERROR",Kk="RESOURCE_LOADING",h_="RESOURCE_READY",Yk="@iiif/REQUEST_RESOURCE",Zk="@iiif/REQUEST_ERROR",Xk="@iiif/REQUEST_MISMATCH",Jk="@iiif/REQUEST_COMPLETE",eP="@iiif/REQUEST_OFFLINE_RESOURCE",TK=Vi(Yk)(),tP=Vi(Zk)(),BK=Vi(Xk)(),RK=Vi(Jk)();Vi(eP)();const d_="@iiif/BATCH",iP="@iiif/BATCH_IMPORT",f_=Vi(d_)();Vi(iP)();const LK=(i,e)=>{const{entities:t,resource:n,mapping:r}=rK(e);if(n.id===void 0)return[tP({id:i,message:"ID is not defined in resource."})];const s=[Hk({entities:t}),wK({mapping:r})];return n.id!==i&&(s.push(CK({id:i,type:n.type})),s.push(BK({requestId:i,actualId:n.id}))),s.push(RK({id:i})),s},nP=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function DK(i,e){return!!(i===e||nP(i)&&nP(e))}function rP(i,e){if(!Array.isArray(i)||!Array.isArray(e))return i===e;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!DK(i[t],e[t]))return!1;return!0}function g_(i,e){const t=i.iiif.requests[e],n=i.iiif.mapping[e];if(!(!n||!i.iiif.entities[n][t.resourceUri]))return i.iiif.entities[n][t.resourceUri]}function sP(i,e,{waitTimeout:t=30}={}){return async(n,r)=>{const s=i.getState(),o=s.iiif.requests[n];if(o)switch(o.loadingState){case c_:break;case Kk:{let a,l=!1;try{const u=await Promise.race([new Promise((c,h)=>{l||(a=i.subscribe(()=>{const d=i.getState();if(d.iiif.requests[n].loadingState===c_){h();return}if(d.iiif.requests[n].loadingState===h_){const g=g_(d,n);g?c(g):h()}}))}),new Promise((c,h)=>setTimeout(()=>{l=!0,h()},t*60))]);if(a&&a(),u)return u}catch{a&&a();break}break}case h_:{const a=g_(s,n);if(a)return a;break}}i.dispatch(TK({id:n}));try{const a=await e(n,r);!a.id&&!a["@id"]&&(a["@type"]&&(a["@id"]=n),a.id=n);const l=LK(n,a);return i.dispatch(f_({actions:l})),g_(i.getState(),n)}catch(a){throw i.dispatch(tP({id:n,message:a.toString()})),a}}}function kK(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}const PK=(i={},e)=>{switch(e.type){case zk:return{...i,[e.payload.id]:e.payload.type};case Vk:return{...i,...e.payload.mapping};default:return i}};function A_(i,e,t,n){return!(!i[t]||!i[t][e]||!i[t][e][n]||!Array.isArray(i[t][e][n]))}function MK(i,e){const t={},n=[];for(const[r,s]of Object.entries(i||{})){n.push(r);const o=(e||{})[r];if(!o||o.length===0){t[r]=s;continue}t[r]=o}for(const[r,s]of Object.entries(e||{}))n.indexOf(r)===-1&&(t[r]=s);return t}const FK=(i=kK(),e)=>{var t;switch(e.type){case Nk:{if(!i[e.payload.type]||!i[e.payload.type][e.payload.id])return i;const n=i[e.payload.type][e.payload.id];return typeof n=="string"?i:{...i,[e.payload.type]:{...i[e.payload.type],[e.payload.id]:{...n,[e.payload.key]:e.payload.value}}}}case Qk:{if(!A_(i,e.payload.id,e.payload.type,e.payload.key))return i;const n=i[e.payload.type][e.payload.id];if(typeof n=="string")return i;const r=Array.from(n[e.payload.key]),[s]=r.splice(e.payload.startIndex,1);return r.splice(e.payload.endIndex,0,s),{...i,[e.payload.type]:{...i[e.payload.type],[e.payload.id]:{...n,[e.payload.key]:r}}}}case Ok:{const n=Object.keys(e.payload.entities),r={...i};for(const s of n){const o=e.payload.entities[s],a={...i[s]||{}};let l=!1;const u=Object.keys(o||{})||[];if(o&&u){for(const c of u)l=!0,a[c]=i[s][c]?MK(i[s][c],o[c]):o[c];l&&(r[s]=a)}}return r}case Uk:{if(!A_(i,e.payload.id,e.payload.type,e.payload.key))return i;const n=i[e.payload.type][e.payload.id],r=Array.from(n[e.payload.key]);return r.splice(e.payload.index||r.length+1,0,e.payload.reference),{...i,[e.payload.type]:{...i[e.payload.type],[e.payload.id]:{...n,[e.payload.key]:r}}}}case Gk:{if(!A_(i,e.payload.id,e.payload.type,e.payload.key))return i;const n=i[e.payload.type][e.payload.id],r=Array.from(n[e.payload.key]),s=e.payload.index||r.findIndex(o=>o&&o.id===e.payload.reference.id);return s===-1||((t=r[s])==null?void 0:t.id)!==e.payload.reference.id?i:(r.splice(s,1),{...i,[e.payload.type]:{...i[e.payload.type],[e.payload.id]:{...n,[e.payload.key]:r}}})}default:return i}},OK=(i={},e)=>{switch(e.type){case Yk:case eP:return{...i,[e.payload.id]:{requestUri:e.payload.id,loadingState:Kk,uriMismatch:!1,resourceUri:e.payload.id}};case Xk:return{...i,[e.payload.requestId]:{...i[e.payload.requestId]||{},uriMismatch:!0,resourceUri:e.payload.actualId},[e.payload.actualId]:{requestUri:e.payload.requestId,loadingState:i[e.payload.requestId].loadingState,uriMismatch:!0,resourceUri:e.payload.actualId}};case Zk:return{...i,[e.payload.id]:{...i[e.payload.id]||{},loadingState:c_,error:e.payload.message}};case Jk:return{...i,[e.payload.id]:{...i[e.payload.id]||{},loadingState:h_,error:void 0}}}return i},NK=(i={},e)=>{const{id:t,updateValue:n,value:r,meta:s,key:o}=e&&e.payload||{};switch(e.type){case qk:return{...i,[t]:{...i[t]||{},[s]:{...i[t]?i[t][s]||{}:{},[o]:r}}};case $k:return{...i,[t]:{...i[t]||{},[s]:{...i[t]?i[t][s]||{}:{},[o]:i[t]&&i[t][s]?n(i[t][s][o]):n(void 0)}}};case jk:return i[t]&&i[t][s]&&i[t][s][o]?{...i,[t]:{...i[t]||{},[s]:{...i[t]?i[t][s]||{}:{},[o]:void 0}}}:i;default:return i}};function QK(i){return(e,t)=>t&&t.type===d_?t.payload.actions.reduce(i,e):t&&t.type===iP?t.payload.state:i(e,t)}const UK=Mk({mapping:PK,entities:FK,requests:OK,meta:NK}),GK=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||J0;function HK(i={}){const{enableDevtools:e=!0,iiifStoreName:t="iiif",defaultState:n={},extraMiddleware:r=[],customReducers:s={}}=i,o=Mk({[t]:UK,...s});return Pk(QK(o),n,e?GK(Fk(...r)):J0(Fk(...r)))}function zK(i){return{all:i=i||new Map,on:function(e,t){var n=i.get(e);n?n.push(t):i.set(e,[t])},off:function(e,t){var n=i.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):i.set(e,[]))},emit:function(e,t){var n=i.get(e);n&&n.slice().map(function(r){r(t)}),(n=i.get("*"))&&n.slice().map(function(r){r(e,t)})}}}class Af{constructor(e,t){Ni(this,"options");Ni(this,"store");Ni(this,"emitter");Ni(this,"isBatching",!1);Ni(this,"batchQueue",[]);Ni(this,"remoteFetcher");Ni(this,"staticFetcher");Ni(this,"defaultFetcher",e=>fetch(e).then(t=>t.json()));Ni(this,"middleware",e=>t=>n=>{if(n.type===d_){for(const o of n.payload.actions)this.emitter.emit(o.type,{realAction:o,state:e.getState()});const s=t(n);for(const o of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:s});return s}this.emitter.emit(n.type,{action:n,state:e.getState()});const r=t(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:r}),r});this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||HK({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=zK(),this.remoteFetcher=sP(this.store,this.options.customFetcher),this.staticFetcher=sP(this.store,(n,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(f_({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(f_({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,n){this.dispatch(_K.modifyEntityField({id:e.id,type:e.type,key:t,value:n}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return aK(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,uK)}toPresentation3(e){return this.serialize(e,cK)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,n={}){typeof t!="string"&&(n=t||{},t=void 0);const{skipSelfReturn:r=!0}=n||{};if(Array.isArray(e))return e.map(u=>this.get(u,n));const s=this.getState();if(typeof e=="string"){const u=t||s.iiif.mapping[e];if(!u)return r?null:{id:e,type:"unknown"};e={id:e,type:u}}const o=t||e.type,a=e.id,l=s.iiif.entities[o];if(!l){const u=s.iiif.requests[a];return u&&u.resourceUri!==a?this.get(u.resourceUri,n):r?null:e}return l[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){const n=typeof e=="string"?e:e.id;return this.load(n,t)}loadCollection(e,t){const n=typeof e=="string"?e:e.id;return this.load(n,t)}load(e,t){const n=typeof e=="string"?e:e.id;return t?this.staticFetcher(n,t):this.remoteFetcher(n)}areInputsEqual(e,t){return rP(e,t)}subscribe(e,t,n){typeof n>"u"&&(typeof t>"u"||t===!1||t===!0)&&(n=t,t=e,e=s=>s);let r=n?null:e(this.store.getState());return n||t(r,this),this.store.subscribe(()=>{const s=this.store.getState(),o=e(s);r!==o&&!rP(r,o)&&t(o,this),r=o})}async ensureLoaded(e){const t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){const n=this.getState().iiif.meta[e];if(n)return t?n[t]:n}setMetaValue([e,t,n],r){this.dispatch(typeof r=="function"?Wk.setMetaValueDynamic({id:e,meta:t,key:n,updateValue:r}):Wk.setMetaValue({id:e,meta:t,key:n,value:r}))}}let ep;const VK=new Uint8Array(16);function qK(){if(!ep&&(ep=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ep))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ep(VK)}const qi=[];for(let i=0;i<256;++i)qi.push((i+256).toString(16).slice(1));function $K(i,e=0){return qi[i[e+0]]+qi[i[e+1]]+qi[i[e+2]]+qi[i[e+3]]+"-"+qi[i[e+4]]+qi[i[e+5]]+"-"+qi[i[e+6]]+qi[i[e+7]]+"-"+qi[i[e+8]]+qi[i[e+9]]+"-"+qi[i[e+10]]+qi[i[e+11]]+qi[i[e+12]]+qi[i[e+13]]+qi[i[e+14]]+qi[i[e+15]]}const oP={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function vc(i,e,t){if(oP.randomUUID&&!e&&!i)return oP.randomUUID();i=i||{};const n=i.random||(i.rng||qK)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,$K(n)}function Be(){return Be=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Be.apply(null,arguments)}function tt(i,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(i==null||i(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Or(i,e=[]){let t=[];function n(s,o){const a=k.createContext(o),l=t.length;t=[...t,o];function u(h){const{scope:d,children:g,...A}=h,p=(d==null?void 0:d[i][l])||a,y=k.useMemo(()=>A,Object.values(A));return k.createElement(p.Provider,{value:y},g)}function c(h,d){const g=(d==null?void 0:d[i][l])||a,A=k.useContext(g);if(A)return A;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const r=()=>{const s=t.map(o=>k.createContext(o));return function(a){const l=(a==null?void 0:a[i])||s;return k.useMemo(()=>({[`__scope${i}`]:{...a,[i]:l}}),[a,l])}};return r.scopeName=i,[n,jK(r,...e)]}function jK(...i){const e=i[0];if(i.length===1)return e;const t=()=>{const n=i.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=n.reduce((a,{useScope:l,scopeName:u})=>{const h=l(s)[`__scope${u}`];return{...a,...h}},{});return k.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function ls(i){const e=k.useRef(i);return k.useEffect(()=>{e.current=i}),k.useMemo(()=>(...t)=>{var n;return(n=e.current)===null||n===void 0?void 0:n.call(e,...t)},[])}function va({prop:i,defaultProp:e,onChange:t=()=>{}}){const[n,r]=WK({defaultProp:e,onChange:t}),s=i!==void 0,o=s?i:n,a=ls(t),l=k.useCallback(u=>{if(s){const h=typeof u=="function"?u(i):u;h!==i&&a(h)}else r(u)},[s,i,r,a]);return[o,l]}function WK({defaultProp:i,onChange:e}){const t=k.useState(i),[n]=t,r=k.useRef(n),s=ls(e);return k.useEffect(()=>{r.current!==n&&(s(n),r.current=n)},[n,r,s]),t}const pn=globalThis!=null&&globalThis.document?k.useLayoutEffect:()=>{};function KK(i,e){typeof i=="function"?i(e):i!=null&&(i.current=e)}function aP(...i){return e=>i.forEach(t=>KK(t,e))}function Gt(...i){return k.useCallback(aP(...i),i)}const Ec=k.forwardRef((i,e)=>{const{children:t,...n}=i,r=k.Children.toArray(t),s=r.find(ZK);if(s){const o=s.props.children,a=r.map(l=>l===s?k.Children.count(o)>1?k.Children.only(null):k.isValidElement(o)?o.props.children:null:l);return k.createElement(p_,Be({},n,{ref:e}),k.isValidElement(o)?k.cloneElement(o,void 0,a):null)}return k.createElement(p_,Be({},n,{ref:e}),t)});Ec.displayName="Slot";const p_=k.forwardRef((i,e)=>{const{children:t,...n}=i;return k.isValidElement(t)?k.cloneElement(t,{...XK(n,t.props),ref:e?aP(e,t.ref):t.ref}):k.Children.count(t)>1?k.Children.only(null):null});p_.displayName="SlotClone";const YK=({children:i})=>k.createElement(k.Fragment,null,i);function ZK(i){return k.isValidElement(i)&&i.type===YK}function XK(i,e){const t={...e};for(const n in e){const r=i[n],s=e[n];/^on[A-Z]/.test(n)?r&&s?t[n]=(...a)=>{s(...a),r(...a)}:r&&(t[n]=r):n==="style"?t[n]={...r,...s}:n==="className"&&(t[n]=[r,s].filter(Boolean).join(" "))}return{...i,...t}}const ht=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((i,e)=>{const t=k.forwardRef((n,r)=>{const{asChild:s,...o}=n,a=s?Ec:e;return k.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),k.createElement(a,Be({},o,{ref:r}))});return t.displayName=`Primitive.${e}`,{...i,[e]:t}},{});function JK(i,e){i&&pl.flushSync(()=>i.dispatchEvent(e))}function eY(i,e){return k.useReducer((t,n)=>{const r=e[t][n];return r??t},i)}const tp=i=>{const{present:e,children:t}=i,n=tY(e),r=typeof t=="function"?t({present:n.isPresent}):k.Children.only(t),s=Gt(n.ref,r.ref);return typeof t=="function"||n.isPresent?k.cloneElement(r,{ref:s}):null};tp.displayName="Presence";function tY(i){const[e,t]=k.useState(),n=k.useRef({}),r=k.useRef(i),s=k.useRef("none"),o=i?"mounted":"unmounted",[a,l]=eY(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return k.useEffect(()=>{const u=ip(n.current);s.current=a==="mounted"?u:"none"},[a]),pn(()=>{const u=n.current,c=r.current;if(c!==i){const d=s.current,g=ip(u);i?l("MOUNT"):g==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&d!==g?"ANIMATION_OUT":"UNMOUNT"),r.current=i}},[i,l]),pn(()=>{if(e){const u=h=>{const g=ip(n.current).includes(h.animationName);h.target===e&&g&&pl.flushSync(()=>l("ANIMATION_END"))},c=h=>{h.target===e&&(s.current=ip(n.current))};return e.addEventListener("animationstart",c),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{e.removeEventListener("animationstart",c),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:k.useCallback(u=>{u&&(n.current=getComputedStyle(u)),t(u)},[])}}function ip(i){return(i==null?void 0:i.animationName)||"none"}const iY=t$.useId||(()=>{});let nY=0;function Ea(i){const[e,t]=k.useState(iY());return pn(()=>{i||t(n=>n??String(nY++))},[i]),i||(e?`radix-${e}`:"")}const lP="Collapsible",[rY,hye]=Or(lP),[sY,m_]=rY(lP),oY=k.forwardRef((i,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:r,disabled:s,onOpenChange:o,...a}=i,[l=!1,u]=va({prop:n,defaultProp:r,onChange:o});return k.createElement(sY,{scope:t,disabled:s,contentId:Ea(),open:l,onOpenToggle:k.useCallback(()=>u(c=>!c),[u])},k.createElement(ht.div,Be({"data-state":y_(l),"data-disabled":s?"":void 0},a,{ref:e})))}),aY="CollapsibleTrigger",lY=k.forwardRef((i,e)=>{const{__scopeCollapsible:t,...n}=i,r=m_(aY,t);return k.createElement(ht.button,Be({type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":y_(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled},n,{ref:e,onClick:tt(i.onClick,r.onOpenToggle)}))}),uP="CollapsibleContent",uY=k.forwardRef((i,e)=>{const{forceMount:t,...n}=i,r=m_(uP,i.__scopeCollapsible);return k.createElement(tp,{present:t||r.open},({present:s})=>k.createElement(cY,Be({},n,{ref:e,present:s})))}),cY=k.forwardRef((i,e)=>{const{__scopeCollapsible:t,present:n,children:r,...s}=i,o=m_(uP,t),[a,l]=k.useState(n),u=k.useRef(null),c=Gt(e,u),h=k.useRef(0),d=h.current,g=k.useRef(0),A=g.current,p=o.open||a,y=k.useRef(p),v=k.useRef();return k.useEffect(()=>{const E=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(E)},[]),pn(()=>{const E=u.current;if(E){v.current=v.current||{transitionDuration:E.style.transitionDuration,animationName:E.style.animationName},E.style.transitionDuration="0s",E.style.animationName="none";const I=E.getBoundingClientRect();h.current=I.height,g.current=I.width,y.current||(E.style.transitionDuration=v.current.transitionDuration,E.style.animationName=v.current.animationName),l(n)}},[o.open,n]),k.createElement(ht.div,Be({"data-state":y_(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!p},s,{ref:c,style:{"--radix-collapsible-content-height":d?`${d}px`:void 0,"--radix-collapsible-content-width":A?`${A}px`:void 0,...i.style}}),p&&r)});function y_(i){return i?"open":"closed"}const hY=oY,dY=lY,fY=uY;var cP={exports:{}};(function(i){//! openseadragon 4.1.1
//! Built on 2024-04-01
//! Git commit: v4.1.1-0-f90d9814
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function e(t){return new e.Viewer(t)}(function(t){t.version={versionStr:"4.1.1",major:parseInt("4",10),minor:parseInt("1",10),revision:parseInt("1",10)};var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},r=Object.prototype.toString,s=Object.prototype.hasOwnProperty;t.isFunction=function(o){return t.type(o)==="function"},t.isArray=Array.isArray||function(o){return t.type(o)==="array"},t.isWindow=function(o){return o&&typeof o=="object"&&"setInterval"in o},t.type=function(o){return o==null?String(o):n[r.call(o)]||"object"},t.isPlainObject=function(o){if(!o||e.type(o)!=="object"||o.nodeType||t.isWindow(o)||o.constructor&&!s.call(o,"constructor")&&!s.call(o.constructor.prototype,"isPrototypeOf"))return!1;var a;for(var l in o)a=l;return a===void 0||s.call(o,a)},t.isEmptyObject=function(o){for(var a in o)return!1;return!0},t.freezeObject=function(o){return Object.freeze?t.freezeObject=Object.freeze:t.freezeObject=function(a){return a},t.freezeObject(o)},t.supportsCanvas=function(){var o=document.createElement("canvas");return!!(t.isFunction(o.getContext)&&o.getContext("2d"))}(),t.isCanvasTainted=function(o){var a=!1;try{o.getContext("2d").getImageData(0,0,1,1)}catch{a=!0}return a},t.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),t.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),t.supportsEventListenerOptions=function(){var o=0;if(t.supportsAddEventListener)try{var a={get capture(){return o++,!1},get once(){return o++,!1},get passive(){return o++,!1}};window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch{o=0}return o>=3}(),t.getCurrentPixelDensityRatio=function(){if(t.supportsCanvas){var o=document.createElement("canvas").getContext("2d"),a=window.devicePixelRatio||1,l=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1;return Math.max(a,1)/l}else return 1},t.pixelDensityRatio=t.getCurrentPixelDensityRatio()})(e),function(t){t.extend=function(){var l,u,c,h,d,g,A=arguments[0]||{},p=arguments.length,y=!1,v=1;for(typeof A=="boolean"&&(y=A,A=arguments[1]||{},v=2),typeof A!="object"&&!e.isFunction(A)&&(A={}),p===v&&(A=this,--v);v<p;v++)if(l=arguments[v],l!==null||l!==void 0)for(u in l){var E=Object.getOwnPropertyDescriptor(l,u);if(E!==void 0){if(E.get||E.set){Object.defineProperty(A,u,E);continue}h=E.value}else{t.console.warn('Could not copy inherited property "'+u+'".');continue}A!==h&&(y&&h&&(e.isPlainObject(h)||(d=e.isArray(h)))?(c=A[u],d?(d=!1,g=c&&e.isArray(c)?c:[]):g=c&&e.isPlainObject(c)?c:{},A[u]=e.extend(y,g,h)):h!==void 0&&(A[u]=h))}return A};var n=function(){if(typeof navigator!="object")return!1;var l=navigator.userAgent;return typeof l!="string"?!1:l.indexOf("iPhone")!==-1||l.indexOf("iPad")!==-1||l.indexOf("iPod")!==-1};t.extend(t,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:n(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(l,u){return function(){var c=arguments;return c===void 0&&(c=[]),u.apply(l,c)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(l){return t._viewers.get(this.getElement(l))},getElement:function(l){return typeof l=="string"&&(l=document.getElementById(l)),l},getElementPosition:function(l){var u=new t.Point,c,h;for(l=t.getElement(l),c=t.getElementStyle(l).position==="fixed",h=a(l,c);h;)u.x+=l.offsetLeft,u.y+=l.offsetTop,c&&(u=u.plus(t.getPageScroll())),l=h,c=t.getElementStyle(l).position==="fixed",h=a(l,c);return u},getElementOffset:function(l){l=t.getElement(l);var u=l&&l.ownerDocument,c,h,d={top:0,left:0};return u?(c=u.documentElement,typeof l.getBoundingClientRect<"u"&&(d=l.getBoundingClientRect()),h=u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1,new t.Point(d.left+(h.pageXOffset||c.scrollLeft)-(c.clientLeft||0),d.top+(h.pageYOffset||c.scrollTop)-(c.clientTop||0))):new t.Point},getElementSize:function(l){return l=t.getElement(l),new t.Point(l.clientWidth,l.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(l){return l=t.getElement(l),l.currentStyle}:function(l){return l=t.getElement(l),window.getComputedStyle(l,"")},getCssPropertyWithVendorPrefix:function(l){var u={};return t.getCssPropertyWithVendorPrefix=function(c){if(u[c]!==void 0)return u[c];var h=document.createElement("div").style,d=null;if(h[c]!==void 0)d=c;else for(var g=["Webkit","Moz","MS","O","webkit","moz","ms","o"],A=t.capitalizeFirstLetter(c),p=0;p<g.length;p++){var y=g[p]+A;if(h[y]!==void 0){d=y;break}}return u[c]=d,d},t.getCssPropertyWithVendorPrefix(l)},capitalizeFirstLetter:function(l){return l.charAt(0).toUpperCase()+l.slice(1)},positiveModulo:function(l,u){var c=l%u;return c<0&&(c+=u),c},pointInElement:function(l,u){l=t.getElement(l);var c=t.getElementOffset(l),h=t.getElementSize(l);return u.x>=c.x&&u.x<c.x+h.x&&u.y<c.y+h.y&&u.y>=c.y},getMousePosition:function(l){if(typeof l.pageX=="number")t.getMousePosition=function(u){var c=new t.Point;return c.x=u.pageX,c.y=u.pageY,c};else if(typeof l.clientX=="number")t.getMousePosition=function(u){var c=new t.Point;return c.x=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c.y=u.clientY+document.body.scrollTop+document.documentElement.scrollTop,c};else throw new Error("Unknown event mouse position, no known technique.");return t.getMousePosition(l)},getPageScroll:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.pageXOffset=="number")t.getPageScroll=function(){return new t.Point(window.pageXOffset,window.pageYOffset)};else if(u.scrollLeft||u.scrollTop)t.getPageScroll=function(){return new t.Point(document.body.scrollLeft,document.body.scrollTop)};else if(l.scrollLeft||l.scrollTop)t.getPageScroll=function(){return new t.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new t.Point(0,0);return t.getPageScroll()},setPageScroll:function(l){if(typeof window.scrollTo<"u")t.setPageScroll=function(h){window.scrollTo(h.x,h.y)};else{var u=t.getPageScroll();if(u.x===l.x&&u.y===l.y)return;document.body.scrollLeft=l.x,document.body.scrollTop=l.y;var c=t.getPageScroll();if(c.x!==u.x&&c.y!==u.y){t.setPageScroll=function(h){document.body.scrollLeft=h.x,document.body.scrollTop=h.y};return}if(document.documentElement.scrollLeft=l.x,document.documentElement.scrollTop=l.y,c=t.getPageScroll(),c.x!==u.x&&c.y!==u.y){t.setPageScroll=function(h){document.documentElement.scrollLeft=h.x,document.documentElement.scrollTop=h.y};return}t.setPageScroll=function(h){}}t.setPageScroll(l)},getWindowSize:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.innerWidth=="number")t.getWindowSize=function(){return new t.Point(window.innerWidth,window.innerHeight)};else if(l.clientWidth||l.clientHeight)t.getWindowSize=function(){return new t.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(u.clientWidth||u.clientHeight)t.getWindowSize=function(){return new t.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return t.getWindowSize()},makeCenteredNode:function(l){l=t.getElement(l);var u=[t.makeNeutralElement("div"),t.makeNeutralElement("div"),t.makeNeutralElement("div")];return t.extend(u[0].style,{display:"table",height:"100%",width:"100%"}),t.extend(u[1].style,{display:"table-row"}),t.extend(u[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),u[0].appendChild(u[1]),u[1].appendChild(u[2]),u[2].appendChild(l),u[0]},makeNeutralElement:function(l){var u=document.createElement(l),c=u.style;return c.background="transparent none",c.border="none",c.margin="0px",c.padding="0px",c.position="static",u},now:function(){return Date.now?t.now=Date.now:t.now=function(){return new Date().getTime()},t.now()},makeTransparentImage:function(l){var u=t.makeNeutralElement("img");return u.src=l,u},setElementOpacity:function(l,u,c){var h,d;l=t.getElement(l),c&&!t.Browser.alpha&&(u=Math.round(u)),t.Browser.opacity?l.style.opacity=u<1?u:"":u<1?(h=Math.round(100*u),d="alpha(opacity="+h+")",l.style.filter=d):l.style.filter=""},setElementTouchActionNone:function(l){l=t.getElement(l),typeof l.style.touchAction<"u"?l.style.touchAction="none":typeof l.style.msTouchAction<"u"&&(l.style.msTouchAction="none")},setElementPointerEvents:function(l,u){l=t.getElement(l),typeof l.style<"u"&&typeof l.style.pointerEvents<"u"&&(l.style.pointerEvents=u)},setElementPointerEventsNone:function(l){t.setElementPointerEvents(l,"none")},addClass:function(l,u){l=t.getElement(l),l.className?(" "+l.className+" ").indexOf(" "+u+" ")===-1&&(l.className+=" "+u):l.className=u},indexOf:function(l,u,c){return Array.prototype.indexOf?this.indexOf=function(h,d,g){return h.indexOf(d,g)}:this.indexOf=function(h,d,g){var A,p=g||0,y;if(!h)throw new TypeError;if(y=h.length,y===0||p>=y)return-1;for(p<0&&(p=y-Math.abs(p)),A=p;A<y;A++)if(h[A]===d)return A;return-1},this.indexOf(l,u,c)},removeClass:function(l,u){var c,h=[],d;for(l=t.getElement(l),c=l.className.split(/\s+/),d=0;d<c.length;d++)c[d]&&c[d]!==u&&h.push(c[d]);l.className=h.join(" ")},normalizeEventListenerOptions:function(l){var u;return typeof l<"u"?typeof l=="boolean"?u=t.supportsEventListenerOptions?{capture:l}:l:u=t.supportsEventListenerOptions?l:typeof l.capture<"u"?l.capture:!1:u=t.supportsEventListenerOptions?{capture:!1}:!1,u},addEvent:function(){if(t.supportsAddEventListener)return function(l,u,c,h){h=t.normalizeEventListenerOptions(h),l=t.getElement(l),l.addEventListener(u,c,h)};if(document.documentElement.attachEvent&&document.attachEvent)return function(l,u,c){l=t.getElement(l),l.attachEvent("on"+u,c)};throw new Error("No known event model.")}(),removeEvent:function(){if(t.supportsRemoveEventListener)return function(l,u,c,h){h=t.normalizeEventListenerOptions(h),l=t.getElement(l),l.removeEventListener(u,c,h)};if(document.documentElement.detachEvent&&document.detachEvent)return function(l,u,c){l=t.getElement(l),l.detachEvent("on"+u,c)};throw new Error("No known event model.")}(),cancelEvent:function(l){l.preventDefault()},eventIsCanceled:function(l){return l.defaultPrevented},stopEvent:function(l){l.stopPropagation()},createCallback:function(l,u){var c=[],h;for(h=2;h<arguments.length;h++)c.push(arguments[h]);return function(){var d=c.concat([]),g;for(g=0;g<arguments.length;g++)d.push(arguments[g]);return u.apply(l,d)}},getUrlParameter:function(l){var u=o[l];return u||null},getUrlProtocol:function(l){var u=l.match(/^([a-z]+:)\/\//i);return u===null?window.location.protocol:u[1].toLowerCase()},createAjaxRequest:function(l){var u;try{u=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{u=!1}if(u)window.XMLHttpRequest?t.createAjaxRequest=function(c){return c?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:t.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)t.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return t.createAjaxRequest(l)},makeAjaxRequest:function(l,u,c){var h,d,g,A;t.isPlainObject(l)&&(u=l.success,c=l.error,h=l.withCredentials,d=l.headers,g=l.responseType||null,A=l.postData||null,l=l.url);var p=t.getUrlProtocol(l),y=t.createAjaxRequest(p==="file:");if(!t.isFunction(u))throw new Error("makeAjaxRequest requires a success callback");y.onreadystatechange=function(){y.readyState===4&&(y.onreadystatechange=function(){},y.status>=200&&y.status<300||y.status===0&&p!=="http:"&&p!=="https:"?u(y):t.isFunction(c)?c(y):t.console.error("AJAX request returned %d: %s",y.status,l))};var v=A?"POST":"GET";try{if(y.open(v,l,!0),g&&(y.responseType=g),d)for(var E in d)Object.prototype.hasOwnProperty.call(d,E)&&d[E]&&y.setRequestHeader(E,d[E]);h&&(y.withCredentials=!0),y.send(A)}catch(I){t.console.error("%s while making AJAX request: %s",I.name,I.message),y.onreadystatechange=function(){},t.isFunction(c)&&c(y,I)}return y},jsonp:function(l){var u,c=l.url,h=document.head||document.getElementsByTagName("head")[0]||document.documentElement,d=l.callbackName||"openseadragon"+t.now(),g=window[d],A="$1"+d+"$2",p=l.param||"callback",y=l.callback;c=c.replace(/(=)\?(&|$)|\?\?/i,A),c+=(/\?/.test(c)?"&":"?")+p+"="+d,window[d]=function(v){if(g)window[d]=g;else try{delete window[d]}catch{}y&&t.isFunction(y)&&y(v)},u=document.createElement("script"),(l.async!==void 0||l.async!==!1)&&(u.async="async"),l.scriptCharset&&(u.charset=l.scriptCharset),u.src=c,u.onload=u.onreadystatechange=function(v,E){(E||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,h&&u.parentNode&&h.removeChild(u),u=void 0)},h.insertBefore(u,h.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(l){if(window.DOMParser)t.parseXml=function(u){var c=null,h;return h=new DOMParser,c=h.parseFromString(u,"text/xml"),c};else if(window.ActiveXObject)t.parseXml=function(u){var c=null;return c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(u),c};else throw new Error("Browser doesn't support XML DOM.");return t.parseXml(l)},parseJSON:function(l){return t.parseJSON=window.JSON.parse,t.parseJSON(l)},imageFormatSupported:function(l){return l=l||"",!!s[l.toLowerCase()]},setImageFormatsSupported:function(l){t.extend(s,l)}});var r=function(l){};t.console=window.console||{log:r,debug:r,info:r,warn:r,error:r,assert:r},t.Browser={vendor:t.BROWSERS.UNKNOWN,version:0,alpha:!0};var s={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},o={};(function(){var l=navigator.appVersion,u=navigator.userAgent,c;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(t.Browser.vendor=t.BROWSERS.IE,t.Browser.version=parseFloat(u.substring(u.indexOf("MSIE")+5,u.indexOf(";",u.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(u.indexOf("Edge")>=0?(t.Browser.vendor=t.BROWSERS.EDGE,t.Browser.version=parseFloat(u.substring(u.indexOf("Edge")+5))):u.indexOf("Edg")>=0?(t.Browser.vendor=t.BROWSERS.CHROMEEDGE,t.Browser.version=parseFloat(u.substring(u.indexOf("Edg")+4))):u.indexOf("Firefox")>=0?(t.Browser.vendor=t.BROWSERS.FIREFOX,t.Browser.version=parseFloat(u.substring(u.indexOf("Firefox")+8))):u.indexOf("Safari")>=0?(t.Browser.vendor=u.indexOf("Chrome")>=0?t.BROWSERS.CHROME:t.BROWSERS.SAFARI,t.Browser.version=parseFloat(u.substring(u.substring(0,u.indexOf("Safari")).lastIndexOf("/")+1,u.indexOf("Safari")))):(c=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),c.exec(u)!==null&&(t.Browser.vendor=t.BROWSERS.IE,t.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":t.Browser.vendor=t.BROWSERS.OPERA,t.Browser.version=parseFloat(l);break}var h=window.location.search.substring(1),d=h.split("&"),g,A,p;for(p=0;p<d.length;p++)if(g=d[p],A=g.indexOf("="),A>0){var y=g.substring(0,A),v=g.substring(A+1);try{o[y]=decodeURIComponent(v)}catch{t.console.error("Ignoring malformed URL parameter: %s=%s",y,v)}}t.Browser.alpha=!(t.Browser.vendor===t.BROWSERS.CHROME&&t.Browser.version<2),t.Browser.opacity=!0,t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<11&&t.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(l){var u=l.requestAnimationFrame||l.mozRequestAnimationFrame||l.webkitRequestAnimationFrame||l.msRequestAnimationFrame,c=l.cancelAnimationFrame||l.mozCancelAnimationFrame||l.webkitCancelAnimationFrame||l.msCancelAnimationFrame;if(u&&c)t.requestAnimationFrame=function(){return u.apply(l,arguments)},t.cancelAnimationFrame=function(){return c.apply(l,arguments)};else{var h=[],d=[],g=0,A;t.requestAnimationFrame=function(p){return h.push([++g,p]),A||(A=setInterval(function(){if(h.length){var y=t.now(),v=d;for(d=h,h=v;d.length;)d.shift()[1](y)}else clearInterval(A),A=void 0},1e3/50)),g},t.cancelAnimationFrame=function(p){var y,v;for(y=0,v=h.length;y<v;y+=1)if(h[y][0]===p){h.splice(y,1);return}for(y=0,v=d.length;y<v;y+=1)if(d[y][0]===p){d.splice(y,1);return}}}}(window);function a(l,u){return u&&l!==document.body?document.body:l.offsetParent}}(e),function(t,n){i.exports?i.exports=n():t.OpenSeadragon=n()}(We,function(){return e}),function(t){var n={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.fullscreenElement},n.requestFullScreen=function(r){return r.requestFullscreen()},n.exitFullScreen=function(){document.exitFullscreen()},n.fullScreenEventName="fullscreenchange",n.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.msFullscreenElement},n.requestFullScreen=function(r){return r.msRequestFullscreen()},n.exitFullScreen=function(){document.msExitFullscreen()},n.fullScreenEventName="MSFullscreenChange",n.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitFullscreenElement},n.requestFullScreen=function(r){return r.webkitRequestFullscreen()},n.exitFullScreen=function(){document.webkitExitFullscreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},n.requestFullScreen=function(r){return r.webkitRequestFullScreen()},n.exitFullScreen=function(){document.webkitCancelFullScreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.mozFullScreenElement},n.requestFullScreen=function(r){return r.mozRequestFullScreen()},n.exitFullScreen=function(){document.mozCancelFullScreen()},n.fullScreenEventName="mozfullscreenchange",n.fullScreenErrorEventName="mozfullscreenerror"),n.isFullScreen=function(){return n.getFullScreenElement()!==null},n.cancelFullScreen=function(){t.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),n.exitFullScreen()},t.extend(t,n)}(e),function(t){t.EventSource=function(){this.events={}},t.EventSource.prototype={addOnceHandler:function(n,r,s,o,a){var l=this;o=o||1;var u=0,c=function(h){return u++,u===o&&l.removeHandler(n,c),r(h)};this.addHandler(n,c,s,a)},addHandler:function(n,r,s,o){var a=this.events[n];if(a||(this.events[n]=a=[]),r&&t.isFunction(r)){var l=a.length,u={handler:r,userData:s||null,priority:o||0};for(a[l]=u;l>0&&a[l-1].priority<a[l].priority;)a[l]=a[l-1],a[l-1]=u,l--}},removeHandler:function(n,r){var s=this.events[n],o=[],a;if(s&&t.isArray(s)){for(a=0;a<s.length;a++)s[a].handler!==r&&o.push(s[a]);this.events[n]=o}},numberOfHandlers:function(n){var r=this.events[n];return r?r.length:0},removeAllHandlers:function(n){if(n)this.events[n]=[];else for(var r in this.events)this.events[r]=[]},getHandler:function(n){var r=this.events[n];return!r||!r.length?null:(r=r.length===1?[r[0]]:Array.apply(null,r),function(s,o){var a,l=r.length;for(a=0;a<l;a++)r[a]&&(o.eventSource=s,o.userData=r[a].userData,r[a].handler(o))})},raiseEvent:function(n,r){var s=this.getHandler(n);if(s)return s(this,r||{})}}}(e),function(t){var n={};t.MouseTracker=function(O){var F=arguments;t.isPlainObject(O)||(O={element:F[0],clickTimeThreshold:F[1],clickDistThreshold:F[2]}),this.hash=Math.random(),this.element=t.getElement(O.element),this.clickTimeThreshold=O.clickTimeThreshold||t.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=O.clickDistThreshold||t.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=O.dblClickTimeThreshold||t.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=O.dblClickDistThreshold||t.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=O.userData||null,this.stopDelay=O.stopDelay||50,this.preProcessEventHandler=O.preProcessEventHandler||null,this.contextMenuHandler=O.contextMenuHandler||null,this.enterHandler=O.enterHandler||null,this.leaveHandler=O.leaveHandler||null,this.exitHandler=O.exitHandler||null,this.overHandler=O.overHandler||null,this.outHandler=O.outHandler||null,this.pressHandler=O.pressHandler||null,this.nonPrimaryPressHandler=O.nonPrimaryPressHandler||null,this.releaseHandler=O.releaseHandler||null,this.nonPrimaryReleaseHandler=O.nonPrimaryReleaseHandler||null,this.moveHandler=O.moveHandler||null,this.scrollHandler=O.scrollHandler||null,this.clickHandler=O.clickHandler||null,this.dblClickHandler=O.dblClickHandler||null,this.dragHandler=O.dragHandler||null,this.dragEndHandler=O.dragEndHandler||null,this.pinchHandler=O.pinchHandler||null,this.stopHandler=O.stopHandler||null,this.keyDownHandler=O.keyDownHandler||null,this.keyUpHandler=O.keyUpHandler||null,this.keyHandler=O.keyHandler||null,this.focusHandler=O.focusHandler||null,this.blurHandler=O.blurHandler||null;var $=this;n[this.hash]={click:function(K){I($,K)},dblclick:function(K){C($,K)},keydown:function(K){w($,K)},keyup:function(K){S($,K)},keypress:function(K){x($,K)},focus:function(K){T($,K)},blur:function(K){Q($,K)},contextmenu:function(K){M($,K)},wheel:function(K){R($,K)},mousewheel:function(K){z($,K)},DOMMouseScroll:function(K){z($,K)},MozMousePixelScroll:function(K){z($,K)},losecapture:function(K){X($,K)},mouseenter:function(K){ce($,K)},mouseleave:function(K){ie($,K)},mouseover:function(K){ne($,K)},mouseout:function(K){ue($,K)},mousedown:function(K){fe($,K)},mouseup:function(K){me($,K)},mousemove:function(K){Qe($,K)},touchstart:function(K){N($,K)},touchend:function(K){G($,K)},touchmove:function(K){j($,K)},touchcancel:function(K){V($,K)},gesturestart:function(K){Z($,K)},gesturechange:function(K){Y($,K)},gotpointercapture:function(K){te($,K)},lostpointercapture:function(K){J($,K)},pointerenter:function(K){ce($,K)},pointerleave:function(K){ie($,K)},pointerover:function(K){ne($,K)},pointerout:function(K){ue($,K)},pointerdown:function(K){fe($,K)},pointerup:function(K){me($,K)},pointermove:function(K){Qe($,K)},pointercancel:function(K){ft($,K)},pointerupcaptured:function(K){Pe($,K)},pointermovecaptured:function(K){Oe($,K)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,t.MouseTracker.havePointerEvents&&t.setElementPointerEvents(this.element,"auto"),this.exitHandler&&t.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),O.startDisabled||this.setTracking(!0)},t.MouseTracker.prototype={destroy:function(){l(this),this.element=null,n[this.hash]=null,delete n[this.hash]},isTracking:function(){return n[this.hash].tracking},setTracking:function(O){return O?a(this):l(this),this},getActivePointersListByType:function(O){var F=n[this.hash],$,K=F.activePointersLists.length,ge;for($=0;$<K;$++)if(F.activePointersLists[$].type===O)return F.activePointersLists[$];return ge=new t.MouseTracker.GesturePointList(O),F.activePointersLists.push(ge),ge},getActivePointerCount:function(){var O=n[this.hash],F,$=O.activePointersLists.length,K=0;for(F=0;F<$;F++)K+=O.activePointersLists[F].getLength();return K},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var r=function(){try{return window.self!==window.top}catch{return!0}}();function s(O){try{return O.addEventListener&&O.removeEventListener}catch{return!1}}t.MouseTracker.gesturePointVelocityTracker=function(){var O=[],F=0,$=0,K=function(yt,Ne){return yt.hash.toString()+Ne.type+Ne.id.toString()},ge=function(){var yt,Ne=O.length,Fi,Zt,En=t.now(),Vr,qr,Wl;for(Vr=En-$,$=En,yt=0;yt<Ne;yt++)Fi=O[yt],Zt=Fi.gPoint,Zt.direction=Math.atan2(Zt.currentPos.y-Fi.lastPos.y,Zt.currentPos.x-Fi.lastPos.x),qr=Fi.lastPos.distanceTo(Zt.currentPos),Fi.lastPos=Zt.currentPos,Wl=1e3*qr/(Vr+1),Zt.speed=.75*Wl+.25*Zt.speed},Ie=function(yt,Ne){var Fi=K(yt,Ne);O.push({guid:Fi,gPoint:Ne,lastPos:Ne.currentPos}),O.length===1&&($=t.now(),F=window.setInterval(ge,50))},Ue=function(yt,Ne){var Fi=K(yt,Ne),Zt,En=O.length;for(Zt=0;Zt<En;Zt++)if(O[Zt].guid===Fi){O.splice(Zt,1),En--,En===0&&window.clearInterval(F);break}};return{addPoint:Ie,removePoint:Ue}}(),t.MouseTracker.captureElement=document,t.MouseTracker.wheelEventName=t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",t.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",t.MouseTracker.wheelEventName],t.MouseTracker.wheelEventName==="DOMMouseScroll"&&t.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),t.MouseTracker.havePointerCapture=function(){var O=document.createElement("div");return t.isFunction(O.setPointerCapture)&&t.isFunction(O.releasePointerCapture)}(),t.MouseTracker.havePointerCapture&&t.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(t.MouseTracker.havePointerEvents=!1,t.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),t.MouseTracker.mousePointerId="legacy-mouse",t.MouseTracker.havePointerCapture=function(){var O=document.createElement("div");return t.isFunction(O.setCapture)&&t.isFunction(O.releaseCapture)}(),t.MouseTracker.havePointerCapture&&t.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&t.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&t.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),t.MouseTracker.GesturePointList=function(O){this._gPoints=[],this.type=O,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},t.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(O){return this._gPoints.push(O)},removeById:function(O){var F,$=this._gPoints.length;for(F=0;F<$;F++)if(this._gPoints[F].id===O){this._gPoints.splice(F,1);break}return this._gPoints.length},getByIndex:function(O){return O<this._gPoints.length?this._gPoints[O]:null},getById:function(O){var F,$=this._gPoints.length;for(F=0;F<$;F++)if(this._gPoints[F].id===O)return this._gPoints[F];return null},getPrimary:function(O){var F,$=this._gPoints.length;for(F=0;F<$;F++)if(this._gPoints[F].isPrimary)return this._gPoints[F];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(t.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function o(O){var F=n[O.hash],$,K,ge,Ie,Ue,yt=F.activePointersLists.length;for($=0;$<yt;$++)if(ge=F.activePointersLists[$],ge.getLength()>0){for(Ue=[],Ie=ge.asArray(),K=0;K<Ie.length;K++)Ue.push(Ie[K]);for(K=0;K<Ue.length;K++)at(O,ge,Ue[K])}for($=0;$<yt;$++)F.activePointersLists.pop();F.sentDragEvent=!1}function a(O){var F=n[O.hash],$,K;if(!F.tracking){for(K=0;K<t.MouseTracker.subscribeEvents.length;K++)$=t.MouseTracker.subscribeEvents[K],t.addEvent(O.element,$,F[$],$===t.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);o(O),F.tracking=!0}}function l(O){var F=n[O.hash],$,K;if(F.tracking){for(K=0;K<t.MouseTracker.subscribeEvents.length;K++)$=t.MouseTracker.subscribeEvents[K],t.removeEvent(O.element,$,F[$],!1);o(O),F.tracking=!1}}function u(O,F){var $=n[O.hash];if(F==="pointerevent")return{upName:"pointerup",upHandler:$.pointerupcaptured,moveName:"pointermove",moveHandler:$.pointermovecaptured};if(F==="mouse")return{upName:"pointerup",upHandler:$.pointerupcaptured,moveName:"pointermove",moveHandler:$.pointermovecaptured};if(F==="touch")return{upName:"touchend",upHandler:$.touchendcaptured,moveName:"touchmove",moveHandler:$.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function c(O,F){var $;if(t.MouseTracker.havePointerCapture)if(t.MouseTracker.havePointerEvents)try{O.element.setPointerCapture(F.id)}catch{t.console.warn("setPointerCapture() called on invalid pointer ID");return}else O.element.setCapture(!0);else $=u(O,t.MouseTracker.havePointerEvents?"pointerevent":F.type),r&&s(window.top)&&t.addEvent(window.top,$.upName,$.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,$.upName,$.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,$.moveName,$.moveHandler,!0);oe(O,F,!0)}function h(O,F){var $,K,ge;if(t.MouseTracker.havePointerCapture)if(t.MouseTracker.havePointerEvents){if(K=O.getActivePointersListByType(F.type),ge=K.getById(F.id),!ge||!ge.captured)return;try{O.element.releasePointerCapture(F.id)}catch{}}else O.element.releaseCapture();else $=u(O,t.MouseTracker.havePointerEvents?"pointerevent":F.type),r&&s(window.top)&&t.removeEvent(window.top,$.upName,$.upHandler,!0),t.removeEvent(t.MouseTracker.captureElement,$.moveName,$.moveHandler,!0),t.removeEvent(t.MouseTracker.captureElement,$.upName,$.upHandler,!0);oe(O,F,!1)}function d(O){return t.MouseTracker.havePointerEvents?O.pointerId:t.MouseTracker.mousePointerId}function g(O){return t.MouseTracker.havePointerEvents?O.pointerType||(t.Browser.vendor===t.BROWSERS.IE?"mouse":""):"mouse"}function A(O){return t.MouseTracker.havePointerEvents?O.isPrimary:!0}function p(O){return t.getMousePosition(O)}function y(O,F){return v(p(O),F)}function v(O,F){var $=t.getElementOffset(F);return O.minus($)}function E(O,F){return new t.Point((O.x+F.x)/2,(O.y+F.y)/2)}function I(O,F){var $={originalEvent:F,eventType:"click",pointerType:"mouse",isEmulated:!1};W(O,$),$.preventDefault&&!$.defaultPrevented&&t.cancelEvent(F),$.stopPropagation&&t.stopEvent(F)}function C(O,F){var $={originalEvent:F,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};W(O,$),$.preventDefault&&!$.defaultPrevented&&t.cancelEvent(F),$.stopPropagation&&t.stopEvent(F)}function w(O,F){var $=null,K={originalEvent:F,eventType:"keydown",pointerType:"",isEmulated:!1};W(O,K),O.keyDownHandler&&!K.preventGesture&&!K.defaultPrevented&&($={eventSource:O,keyCode:F.keyCode?F.keyCode:F.charCode,ctrl:F.ctrlKey,shift:F.shiftKey,alt:F.altKey,meta:F.metaKey,originalEvent:F,preventDefault:K.preventDefault||K.defaultPrevented,userData:O.userData},O.keyDownHandler($)),($&&$.preventDefault||K.preventDefault&&!K.defaultPrevented)&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function S(O,F){var $=null,K={originalEvent:F,eventType:"keyup",pointerType:"",isEmulated:!1};W(O,K),O.keyUpHandler&&!K.preventGesture&&!K.defaultPrevented&&($={eventSource:O,keyCode:F.keyCode?F.keyCode:F.charCode,ctrl:F.ctrlKey,shift:F.shiftKey,alt:F.altKey,meta:F.metaKey,originalEvent:F,preventDefault:K.preventDefault||K.defaultPrevented,userData:O.userData},O.keyUpHandler($)),($&&$.preventDefault||K.preventDefault&&!K.defaultPrevented)&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function x(O,F){var $=null,K={originalEvent:F,eventType:"keypress",pointerType:"",isEmulated:!1};W(O,K),O.keyHandler&&!K.preventGesture&&!K.defaultPrevented&&($={eventSource:O,keyCode:F.keyCode?F.keyCode:F.charCode,ctrl:F.ctrlKey,shift:F.shiftKey,alt:F.altKey,meta:F.metaKey,originalEvent:F,preventDefault:K.preventDefault||K.defaultPrevented,userData:O.userData},O.keyHandler($)),($&&$.preventDefault||K.preventDefault&&!K.defaultPrevented)&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function T(O,F){var $={originalEvent:F,eventType:"focus",pointerType:"",isEmulated:!1};W(O,$),O.focusHandler&&!$.preventGesture&&O.focusHandler({eventSource:O,originalEvent:F,userData:O.userData})}function Q(O,F){var $={originalEvent:F,eventType:"blur",pointerType:"",isEmulated:!1};W(O,$),O.blurHandler&&!$.preventGesture&&O.blurHandler({eventSource:O,originalEvent:F,userData:O.userData})}function M(O,F){var $=null,K={originalEvent:F,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};W(O,K),O.contextMenuHandler&&!K.preventGesture&&!K.defaultPrevented&&($={eventSource:O,position:v(p(F),O.element),originalEvent:K.originalEvent,preventDefault:K.preventDefault||K.defaultPrevented,userData:O.userData},O.contextMenuHandler($)),($&&$.preventDefault||K.preventDefault&&!K.defaultPrevented)&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function R(O,F){q(O,F,F)}function z(O,F){var $={target:F.target||F.srcElement,type:"wheel",shiftKey:F.shiftKey||!1,clientX:F.clientX,clientY:F.clientY,pageX:F.pageX?F.pageX:F.clientX,pageY:F.pageY?F.pageY:F.clientY,deltaMode:F.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};t.MouseTracker.wheelEventName==="mousewheel"?$.deltaY=-F.wheelDelta/t.DEFAULT_SETTINGS.pixelsPerWheelLine:$.deltaY=F.detail,q(O,$,F)}function q(O,F,$){var K=0,ge,Ie=null;K=F.deltaY<0?1:-1,ge={originalEvent:F,eventType:"wheel",pointerType:"mouse",isEmulated:F!==$},W(O,ge),O.scrollHandler&&!ge.preventGesture&&!ge.defaultPrevented&&(Ie={eventSource:O,pointerType:"mouse",position:y(F,O.element),scroll:K,shift:F.shiftKey,isTouchEvent:!1,originalEvent:$,preventDefault:ge.preventDefault||ge.defaultPrevented,userData:O.userData},O.scrollHandler(Ie)),ge.stopPropagation&&t.stopEvent($),(Ie&&Ie.preventDefault||ge.preventDefault&&!ge.defaultPrevented)&&t.cancelEvent($)}function X(O,F){var $={id:t.MouseTracker.mousePointerId,type:"mouse"},K={originalEvent:F,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};W(O,K),F.target===O.element&&oe(O,$,!1),K.stopPropagation&&t.stopEvent(F)}function N(O,F){var $,K,ge=F.changedTouches.length,Ie,Ue=O.getActivePointersListByType("touch");$=t.now(),Ue.getLength()>F.touches.length-ge&&t.console.warn("Tracked touch contact count doesn't match event.touches.length");var yt={originalEvent:F,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(W(O,yt),K=0;K<ge;K++)Ie={id:F.changedTouches[K].identifier,type:"touch",isPrimary:Ue.getLength()===0,currentPos:p(F.changedTouches[K]),currentTime:$},ve(O,yt,Ie),Xe(O,yt,Ie,0),oe(O,Ie,!0);yt.preventDefault&&!yt.defaultPrevented&&t.cancelEvent(F),yt.stopPropagation&&t.stopEvent(F)}function G(O,F){var $,K,ge=F.changedTouches.length,Ie;$=t.now();var Ue={originalEvent:F,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(W(O,Ue),K=0;K<ge;K++)Ie={id:F.changedTouches[K].identifier,type:"touch",currentPos:p(F.changedTouches[K]),currentTime:$},ot(O,Ue,Ie,0),oe(O,Ie,!1),Ae(O,Ue,Ie);Ue.preventDefault&&!Ue.defaultPrevented&&t.cancelEvent(F),Ue.stopPropagation&&t.stopEvent(F)}function j(O,F){var $,K,ge=F.changedTouches.length,Ie;$=t.now();var Ue={originalEvent:F,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(W(O,Ue),K=0;K<ge;K++)Ie={id:F.changedTouches[K].identifier,type:"touch",currentPos:p(F.changedTouches[K]),currentTime:$},gt(O,Ue,Ie);Ue.preventDefault&&!Ue.defaultPrevented&&t.cancelEvent(F),Ue.stopPropagation&&t.stopEvent(F)}function V(O,F){var $=F.changedTouches.length,K,ge,Ie={originalEvent:F,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(W(O,Ie),K=0;K<$;K++)ge={id:F.changedTouches[K].identifier,type:"touch"},He(O,Ie,ge);Ie.stopPropagation&&t.stopEvent(F)}function Z(O,F){return t.eventIsCanceled(F)||F.preventDefault(),!1}function Y(O,F){return t.eventIsCanceled(F)||F.preventDefault(),!1}function te(O,F){var $={originalEvent:F,eventType:"gotpointercapture",pointerType:g(F),isEmulated:!1};W(O,$),F.target===O.element&&oe(O,{id:F.pointerId,type:g(F)},!0),$.stopPropagation&&t.stopEvent(F)}function J(O,F){var $={originalEvent:F,eventType:"lostpointercapture",pointerType:g(F),isEmulated:!1};W(O,$),F.target===O.element&&oe(O,{id:F.pointerId,type:g(F)},!1),$.stopPropagation&&t.stopEvent(F)}function ce(O,F){var $={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()},K={originalEvent:F,eventType:"pointerenter",pointerType:$.type,isEmulated:!1};W(O,K),ve(O,K,$)}function ie(O,F){var $={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()},K={originalEvent:F,eventType:"pointerleave",pointerType:$.type,isEmulated:!1};W(O,K),Ae(O,K,$)}function ne(O,F){var $={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()},K={originalEvent:F,eventType:"pointerover",pointerType:$.type,isEmulated:!1};W(O,K),Se(O,K,$),K.preventDefault&&!K.defaultPrevented&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function ue(O,F){var $={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()},K={originalEvent:F,eventType:"pointerout",pointerType:$.type,isEmulated:!1};W(O,K),xe(O,K,$),K.preventDefault&&!K.defaultPrevented&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function fe(O,F){var $={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()},K=t.MouseTracker.havePointerEvents&&$.type==="touch"&&t.Browser.vendor!==t.BROWSERS.IE,ge={originalEvent:F,eventType:"pointerdown",pointerType:$.type,isEmulated:!1};W(O,ge),Xe(O,ge,$,F.button),ge.preventDefault&&!ge.defaultPrevented&&t.cancelEvent(F),ge.stopPropagation&&t.stopEvent(F),ge.shouldCapture&&(K?oe(O,$,!0):c(O,$))}function me(O,F){Re(O,F)}function Pe(O,F){var $=O.getActivePointersListByType(g(F));$.getById(F.pointerId)&&Re(O,F),t.stopEvent(F)}function Re(O,F){var $;$={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()};var K={originalEvent:F,eventType:"pointerup",pointerType:$.type,isEmulated:!1};W(O,K),ot(O,K,$,F.button),K.preventDefault&&!K.defaultPrevented&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F),K.shouldReleaseCapture&&(F.target===O.element?h(O,$):oe(O,$,!1))}function Qe(O,F){wt(O,F)}function Oe(O,F){var $=O.getActivePointersListByType(g(F));$.getById(F.pointerId)&&wt(O,F),t.stopEvent(F)}function wt(O,F){var $={id:d(F),type:g(F),isPrimary:A(F),currentPos:p(F),currentTime:t.now()},K={originalEvent:F,eventType:"pointermove",pointerType:$.type,isEmulated:!1};W(O,K),gt(O,K,$),K.preventDefault&&!K.defaultPrevented&&t.cancelEvent(F),K.stopPropagation&&t.stopEvent(F)}function ft(O,F){var $={id:F.pointerId,type:g(F)},K={originalEvent:F,eventType:"pointercancel",pointerType:$.type,isEmulated:!1};W(O,K),He(O,K,$),K.stopPropagation&&t.stopEvent(F)}function pt(O,F){return F.speed=0,F.direction=0,F.contactPos=F.currentPos,F.contactTime=F.currentTime,F.lastPos=F.currentPos,F.lastTime=F.currentTime,O.add(F)}function at(O,F,$){var K,ge=F.getById($.id);return ge?(ge.captured&&(t.console.warn("stopTrackingPointer() called on captured pointer"),h(O,ge)),F.removeContact(),K=F.removeById($.id)):K=F.getLength(),K}function D(O,F){switch(F.eventType){case"pointermove":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!O.hasGestureHandlers,F.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!1,F.stopPropagation=!1;break;case"pointerdown":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!O.hasGestureHandlers,F.stopPropagation=!1;break;case"pointerup":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!O.hasGestureHandlers,F.stopPropagation=!1;break;case"wheel":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!1,F.preventGesture=!O.hasScrollHandler,F.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":F.isStoppable=!0,F.isCancelable=!1,F.preventDefault=!1,F.preventGesture=!1,F.stopPropagation=!1;break;case"click":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!!O.clickHandler,F.preventGesture=!1,F.stopPropagation=!1;break;case"dblclick":F.isStoppable=!0,F.isCancelable=!0,F.preventDefault=!!O.dblClickHandler,F.preventGesture=!1,F.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:F.isStoppable=!1,F.isCancelable=!1,F.preventDefault=!1,F.preventGesture=!1,F.stopPropagation=!1;break}}function W(O,F){F.eventSource=O,F.eventPhase=F.originalEvent&&typeof F.originalEvent.eventPhase<"u"?F.originalEvent.eventPhase:0,F.defaultPrevented=t.eventIsCanceled(F.originalEvent),F.shouldCapture=!1,F.shouldReleaseCapture=!1,F.userData=O.userData,D(O,F),O.preProcessEventHandler&&O.preProcessEventHandler(F)}function oe(O,F,$){var K=O.getActivePointersListByType(F.type),ge=K.getById(F.id);ge?$&&!ge.captured?(ge.captured=!0,K.captureCount++):!$&&ge.captured&&(ge.captured=!1,K.captureCount--,K.captureCount<0&&(K.captureCount=0,t.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):t.console.warn("updatePointerCaptured() called on untracked pointer")}function ve(O,F,$){var K=O.getActivePointersListByType($.type),ge;ge=K.getById($.id),ge?(ge.insideElement=!0,ge.lastPos=ge.currentPos,ge.lastTime=ge.currentTime,ge.currentPos=$.currentPos,ge.currentTime=$.currentTime,$=ge):($.captured=!1,$.insideElementPressed=!1,$.insideElement=!0,pt(K,$)),O.enterHandler&&O.enterHandler({eventSource:O,pointerType:$.type,position:v($.currentPos,O.element),buttons:K.buttons,pointers:O.getActivePointerCount(),insideElementPressed:$.insideElementPressed,buttonDownAny:K.buttons!==0,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData})}function Ae(O,F,$){var K=O.getActivePointersListByType($.type),ge,Ie;ge=K.getById($.id),ge?(ge.captured?(ge.insideElement=!1,ge.lastPos=ge.currentPos,ge.lastTime=ge.currentTime,ge.currentPos=$.currentPos,ge.currentTime=$.currentTime):at(O,K,ge),$=ge):($.captured=!1,$.insideElementPressed=!1),(O.leaveHandler||O.exitHandler)&&(Ie={eventSource:O,pointerType:$.type,position:$.currentPos&&v($.currentPos,O.element),buttons:K.buttons,pointers:O.getActivePointerCount(),insideElementPressed:$.insideElementPressed,buttonDownAny:K.buttons!==0,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData},O.leaveHandler&&O.leaveHandler(Ie),O.exitHandler&&O.exitHandler(Ie))}function Se(O,F,$){var K,ge;K=O.getActivePointersListByType($.type),ge=K.getById($.id),ge?$=ge:($.captured=!1,$.insideElementPressed=!1),O.overHandler&&O.overHandler({eventSource:O,pointerType:$.type,position:v($.currentPos,O.element),buttons:K.buttons,pointers:O.getActivePointerCount(),insideElementPressed:$.insideElementPressed,buttonDownAny:K.buttons!==0,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData})}function xe(O,F,$){var K,ge;K=O.getActivePointersListByType($.type),ge=K.getById($.id),ge?$=ge:($.captured=!1,$.insideElementPressed=!1),O.outHandler&&O.outHandler({eventSource:O,pointerType:$.type,position:$.currentPos&&v($.currentPos,O.element),buttons:K.buttons,pointers:O.getActivePointerCount(),insideElementPressed:$.insideElementPressed,buttonDownAny:K.buttons!==0,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData})}function Xe(O,F,$,K){var ge=n[O.hash],Ie=O.getActivePointersListByType($.type),Ue;if(typeof F.originalEvent.buttons<"u"?Ie.buttons=F.originalEvent.buttons:K===0?Ie.buttons|=1:K===1?Ie.buttons|=4:K===2?Ie.buttons|=2:K===3?Ie.buttons|=8:K===4?Ie.buttons|=16:K===5&&(Ie.buttons|=32),K!==0){F.shouldCapture=!1,F.shouldReleaseCapture=!1,O.nonPrimaryPressHandler&&!F.preventGesture&&!F.defaultPrevented&&(F.preventDefault=!0,O.nonPrimaryPressHandler({eventSource:O,pointerType:$.type,position:v($.currentPos,O.element),button:K,buttons:Ie.buttons,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData}));return}Ue=Ie.getById($.id),Ue?(Ue.insideElementPressed=!0,Ue.insideElement=!0,Ue.originalTarget=F.originalEvent.target,Ue.contactPos=$.currentPos,Ue.contactTime=$.currentTime,Ue.lastPos=Ue.currentPos,Ue.lastTime=Ue.currentTime,Ue.currentPos=$.currentPos,Ue.currentTime=$.currentTime,$=Ue):($.captured=!1,$.insideElementPressed=!0,$.insideElement=!0,$.originalTarget=F.originalEvent.target,pt(Ie,$)),Ie.addContact(),!F.preventGesture&&!F.defaultPrevented?(F.shouldCapture=!0,F.shouldReleaseCapture=!1,F.preventDefault=!0,(O.dragHandler||O.dragEndHandler||O.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.addPoint(O,$),Ie.contacts===1?O.pressHandler&&!F.preventGesture&&O.pressHandler({eventSource:O,pointerType:$.type,position:v($.contactPos,O.element),buttons:Ie.buttons,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData}):Ie.contacts===2&&O.pinchHandler&&$.type==="touch"&&(ge.pinchGPoints=Ie.asArray(),ge.lastPinchDist=ge.currentPinchDist=ge.pinchGPoints[0].currentPos.distanceTo(ge.pinchGPoints[1].currentPos),ge.lastPinchCenter=ge.currentPinchCenter=E(ge.pinchGPoints[0].currentPos,ge.pinchGPoints[1].currentPos))):(F.shouldCapture=!1,F.shouldReleaseCapture=!1)}function ot(O,F,$,K){var ge=n[O.hash],Ie=O.getActivePointersListByType($.type),Ue,yt,Ne,Fi=!1,Zt;if(typeof F.originalEvent.buttons<"u"?Ie.buttons=F.originalEvent.buttons:K===0?Ie.buttons^=-2:K===1?Ie.buttons^=-5:K===2?Ie.buttons^=-3:K===3?Ie.buttons^=-9:K===4?Ie.buttons^=-17:K===5&&(Ie.buttons^=-33),F.shouldCapture=!1,K!==0){F.shouldReleaseCapture=!1,O.nonPrimaryReleaseHandler&&!F.preventGesture&&!F.defaultPrevented&&(F.preventDefault=!0,O.nonPrimaryReleaseHandler({eventSource:O,pointerType:$.type,position:v($.currentPos,O.element),button:K,buttons:Ie.buttons,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData}));return}Ne=Ie.getById($.id),Ne?(Ie.removeContact(),Ne.captured&&(Fi=!0),Ne.lastPos=Ne.currentPos,Ne.lastTime=Ne.currentTime,Ne.currentPos=$.currentPos,Ne.currentTime=$.currentTime,Ne.insideElement||at(O,Ie,Ne),Ue=Ne.currentPos,yt=Ne.currentTime):($.captured=!1,$.insideElementPressed=!1,$.insideElement=!0,pt(Ie,$),Ne=$),!F.preventGesture&&!F.defaultPrevented&&(Fi?(F.shouldReleaseCapture=!0,F.preventDefault=!0,(O.dragHandler||O.dragEndHandler||O.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.removePoint(O,Ne),Ie.contacts===0?(O.releaseHandler&&Ue&&O.releaseHandler({eventSource:O,pointerType:Ne.type,position:v(Ue,O.element),buttons:Ie.buttons,insideElementPressed:Ne.insideElementPressed,insideElementReleased:Ne.insideElement,isTouchEvent:Ne.type==="touch",originalEvent:F.originalEvent,userData:O.userData}),O.dragEndHandler&&ge.sentDragEvent&&O.dragEndHandler({eventSource:O,pointerType:Ne.type,position:v(Ne.currentPos,O.element),speed:Ne.speed,direction:Ne.direction,shift:F.originalEvent.shiftKey,isTouchEvent:Ne.type==="touch",originalEvent:F.originalEvent,userData:O.userData}),ge.sentDragEvent=!1,(O.clickHandler||O.dblClickHandler)&&Ne.insideElement&&(Zt=yt-Ne.contactTime<=O.clickTimeThreshold&&Ne.contactPos.distanceTo(Ue)<=O.clickDistThreshold,O.clickHandler&&O.clickHandler({eventSource:O,pointerType:Ne.type,position:v(Ne.currentPos,O.element),quick:Zt,shift:F.originalEvent.shiftKey,isTouchEvent:Ne.type==="touch",originalEvent:F.originalEvent,originalTarget:Ne.originalTarget,userData:O.userData}),O.dblClickHandler&&Zt&&(Ie.clicks++,Ie.clicks===1?(ge.lastClickPos=Ue,ge.dblClickTimeOut=setTimeout(function(){Ie.clicks=0},O.dblClickTimeThreshold)):Ie.clicks===2&&(clearTimeout(ge.dblClickTimeOut),Ie.clicks=0,ge.lastClickPos.distanceTo(Ue)<=O.dblClickDistThreshold&&O.dblClickHandler({eventSource:O,pointerType:Ne.type,position:v(Ne.currentPos,O.element),shift:F.originalEvent.shiftKey,isTouchEvent:Ne.type==="touch",originalEvent:F.originalEvent,userData:O.userData}),ge.lastClickPos=null)))):Ie.contacts===2&&O.pinchHandler&&Ne.type==="touch"&&(ge.pinchGPoints=Ie.asArray(),ge.lastPinchDist=ge.currentPinchDist=ge.pinchGPoints[0].currentPos.distanceTo(ge.pinchGPoints[1].currentPos),ge.lastPinchCenter=ge.currentPinchCenter=E(ge.pinchGPoints[0].currentPos,ge.pinchGPoints[1].currentPos))):(F.shouldReleaseCapture=!1,O.releaseHandler&&Ue&&(O.releaseHandler({eventSource:O,pointerType:Ne.type,position:v(Ue,O.element),buttons:Ie.buttons,insideElementPressed:Ne.insideElementPressed,insideElementReleased:Ne.insideElement,isTouchEvent:Ne.type==="touch",originalEvent:F.originalEvent,userData:O.userData}),F.preventDefault=!0)))}function gt(O,F,$){var K=n[O.hash],ge=O.getActivePointersListByType($.type),Ie,Ue,yt;if(typeof F.originalEvent.buttons<"u"&&(ge.buttons=F.originalEvent.buttons),Ie=ge.getById($.id),Ie)Ie.lastPos=Ie.currentPos,Ie.lastTime=Ie.currentTime,Ie.currentPos=$.currentPos,Ie.currentTime=$.currentTime;else return;F.shouldCapture=!1,F.shouldReleaseCapture=!1,O.stopHandler&&$.type==="mouse"&&(clearTimeout(O.stopTimeOut),O.stopTimeOut=setTimeout(function(){Ct(O,F.originalEvent,$.type)},O.stopDelay)),ge.contacts===0?O.moveHandler&&O.moveHandler({eventSource:O,pointerType:$.type,position:v($.currentPos,O.element),buttons:ge.buttons,isTouchEvent:$.type==="touch",originalEvent:F.originalEvent,userData:O.userData}):ge.contacts===1?(O.moveHandler&&(Ie=ge.asArray()[0],O.moveHandler({eventSource:O,pointerType:Ie.type,position:v(Ie.currentPos,O.element),buttons:ge.buttons,isTouchEvent:Ie.type==="touch",originalEvent:F.originalEvent,userData:O.userData})),O.dragHandler&&!F.preventGesture&&!F.defaultPrevented&&(Ie=ge.asArray()[0],yt=Ie.currentPos.minus(Ie.lastPos),O.dragHandler({eventSource:O,pointerType:Ie.type,position:v(Ie.currentPos,O.element),buttons:ge.buttons,delta:yt,speed:Ie.speed,direction:Ie.direction,shift:F.originalEvent.shiftKey,isTouchEvent:Ie.type==="touch",originalEvent:F.originalEvent,userData:O.userData}),F.preventDefault=!0,K.sentDragEvent=!0)):ge.contacts===2&&(O.moveHandler&&(Ue=ge.asArray(),O.moveHandler({eventSource:O,pointerType:Ue[0].type,position:v(E(Ue[0].currentPos,Ue[1].currentPos),O.element),buttons:ge.buttons,isTouchEvent:Ue[0].type==="touch",originalEvent:F.originalEvent,userData:O.userData})),O.pinchHandler&&$.type==="touch"&&!F.preventGesture&&!F.defaultPrevented&&(yt=K.pinchGPoints[0].currentPos.distanceTo(K.pinchGPoints[1].currentPos),yt!==K.currentPinchDist&&(K.lastPinchDist=K.currentPinchDist,K.currentPinchDist=yt,K.lastPinchCenter=K.currentPinchCenter,K.currentPinchCenter=E(K.pinchGPoints[0].currentPos,K.pinchGPoints[1].currentPos),O.pinchHandler({eventSource:O,pointerType:"touch",gesturePoints:K.pinchGPoints,lastCenter:v(K.lastPinchCenter,O.element),center:v(K.currentPinchCenter,O.element),lastDistance:K.lastPinchDist,distance:K.currentPinchDist,shift:F.originalEvent.shiftKey,originalEvent:F.originalEvent,userData:O.userData}),F.preventDefault=!0)))}function He(O,F,$){var K=O.getActivePointersListByType($.type),ge;ge=K.getById($.id),ge&&at(O,K,ge)}function Ct(O,F,$){O.stopHandler&&O.stopHandler({eventSource:O,pointerType:$,position:y(F,O.element),buttons:O.getActivePointersListByType($).buttons,isTouchEvent:$==="touch",originalEvent:F,userData:O.userData})}}(e),function(t){t.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},t.Control=function(n,r,s){var o=n.parentNode;typeof r=="number"&&(t.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),r={anchor:r}),r.attachToViewer=typeof r.attachToViewer>"u"?!0:r.attachToViewer,this.autoFade=typeof r.autoFade>"u"?!0:r.autoFade,this.element=n,this.anchor=r.anchor,this.container=s,this.anchor===t.ControlAnchor.ABSOLUTE?(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof r.top=="number"?r.top+"px":r.top,this.wrapper.style.left=typeof r.left=="number"?r.left+"px":r.left,this.wrapper.style.height=typeof r.height=="number"?r.height+"px":r.height,this.wrapper.style.width=typeof r.width=="number"?r.width+"px":r.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===t.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),r.attachToViewer?this.anchor===t.ControlAnchor.TOP_RIGHT||this.anchor===t.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},t.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==t.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(n){this.wrapper.style.display=n?this.anchor===t.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(n){this.element[t.SIGNAL]&&t.Browser.vendor===t.BROWSERS.IE?t.setElementOpacity(this.element,n,!0):t.setElementOpacity(this.wrapper,n,!0)}}}(e),function(t){t.ControlDock=function(r){var s=["topleft","topright","bottomright","bottomleft"],o,a;for(t.extend(!0,this,{id:"controldock-"+t.now()+"-"+Math.floor(Math.random()*1e6),container:t.makeNeutralElement("div"),controls:[]},r),this.container.onsubmit=function(){return!1},this.element&&(this.element=t.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),a=0;a<s.length;a++)o=s[a],this.controls[o]=t.makeNeutralElement("div"),this.controls[o].style.position="absolute",o.match("left")&&(this.controls[o].style.left="0px"),o.match("right")&&(this.controls[o].style.right="0px"),o.match("top")&&(this.controls[o].style.top="0px"),o.match("bottom")&&(this.controls[o].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},t.ControlDock.prototype={addControl:function(r,s){r=t.getElement(r);var o=null;if(!(n(this,r)>=0)){switch(s.anchor){case t.ControlAnchor.TOP_RIGHT:o=this.controls.topright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingTop="0px";break;case t.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingBottom="0px";break;case t.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingBottom="0px";break;case t.ControlAnchor.TOP_LEFT:o=this.controls.topleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingTop="0px";break;case t.ControlAnchor.ABSOLUTE:o=this.container,r.style.margin="0px",r.style.padding="0px";break;default:case t.ControlAnchor.NONE:o=this.container,r.style.margin="0px",r.style.padding="0px";break}this.controls.push(new t.Control(r,s,o)),r.style.display="inline-block"}},removeControl:function(r){r=t.getElement(r);var s=n(this,r);return s>=0&&(this.controls[s].destroy(),this.controls.splice(s,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var r;for(r=this.controls.length-1;r>=0;r--)if(this.controls[r].isVisible())return!0;return!1},setControlsEnabled:function(r){var s;for(s=this.controls.length-1;s>=0;s--)this.controls[s].setVisible(r);return this}};function n(r,s){var o=r.controls,a;for(a=o.length-1;a>=0;a--)if(o[a].element===s)return a;return-1}}(e),function(t){t.Placement=t.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(e),function(t){var n={},r=1;t.Viewer=function(D){var W=arguments,oe=this,ve;if(t.isPlainObject(D)||(D={id:W[0],xmlPath:W.length>1?W[1]:void 0,prefixUrl:W.length>2?W[2]:void 0,controls:W.length>3?W[3]:void 0,overlays:W.length>4?W[4]:void 0}),D.config&&(t.extend(!0,D,D.config),delete D.config),t.extend(!0,this,{id:D.id,hash:D.hash||r++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},t.DEFAULT_SETTINGS,D),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof n[this.hash]<"u"&&t.console.warn("Hash "+this.hash+" has already been used."),n[this.hash]={fsBoundsDelta:new t.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=t.now(),t.EventSource.call(this),this.addHandler("open-failed",function(Ae){var Se=t.getString("Errors.OpenFailed",Ae.eventSource,Ae.message);oe._showMessage(Se)}),t.ControlDock.call(this,D),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=t.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(Ae){Ae.width="100%",Ae.height="100%",Ae.overflow="hidden",Ae.position="absolute",Ae.top="0px",Ae.left="0px"}(this.canvas.style),t.setElementTouchActionNone(this.canvas),D.tabIndex!==""&&(this.canvas.tabIndex=D.tabIndex===void 0?0:D.tabIndex),this.container.className="openseadragon-container",function(Ae){Ae.width="100%",Ae.height="100%",Ae.position="relative",Ae.overflow="hidden",Ae.left="0px",Ae.top="0px",Ae.textAlign="left"}(this.container.style),t.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new t.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:t.delegate(this,y),keyDownHandler:t.delegate(this,v),keyHandler:t.delegate(this,E),clickHandler:t.delegate(this,I),dblClickHandler:t.delegate(this,C),dragHandler:t.delegate(this,w),dragEndHandler:t.delegate(this,S),enterHandler:t.delegate(this,x),leaveHandler:t.delegate(this,T),pressHandler:t.delegate(this,Q),releaseHandler:t.delegate(this,M),nonPrimaryPressHandler:t.delegate(this,R),nonPrimaryReleaseHandler:t.delegate(this,z),scrollHandler:t.delegate(this,G),pinchHandler:t.delegate(this,q),focusHandler:t.delegate(this,X),blurHandler:t.delegate(this,N)}),this.outerTracker=new t.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:t.delegate(this,j),leaveHandler:t.delegate(this,V)}),this.toolbar&&(this.toolbar=new t.ControlDock({element:this.toolbar})),this.bindStandardControls(),n[this.hash].prevContainerSize=s(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){n[oe.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new t.World({viewer:this}),this.world.addHandler("add-item",function(Ae){oe.source=oe.world.getItemAt(0).source,n[oe.hash].forceRedraw=!0,oe._updateRequestId||(oe._updateRequestId=u(oe,Z))}),this.world.addHandler("remove-item",function(Ae){oe.world.getItemCount()?oe.source=oe.world.getItemAt(0).source:oe.source=null,n[oe.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(Ae){oe.viewport&&oe.viewport._setContentBounds(oe.world.getHomeBounds(),oe.world.getContentFactor())}),this.world.addHandler("item-index-change",function(Ae){oe.source=oe.world.getItemAt(0).source}),this.viewport=new t.Viewport({containerSize:n[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new t.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:D.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new t.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new t.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=t.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(ve=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(ve,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(ve=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(ve,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new t.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),ve=0;ve<this.customControls.length;ve++)this.addControl(this.customControls[ve].id,{anchor:this.customControls[ve].anchor});t.requestAnimationFrame(function(){h(oe)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),t._viewers.set(this.element,this)},t.extend(t.Viewer.prototype,t.EventSource.prototype,t.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(D){return t.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(D)},openTileSource:function(D){return t.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(D)},get buttons(){return t.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(D,W){var oe=this;if(this.close(),!D)return this;if(this.sequenceMode&&t.isArray(D))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof W<"u"&&!isNaN(W)&&(this.initialPage=W),this.tileSources=D,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(t.isArray(D)||(D=[D]),!D.length)return this;this._opening=!0;for(var ve=D.length,Ae=0,Se=0,xe,Xe=function(){if(Ae+Se===ve)if(Ae){(oe._firstOpen||!oe.preserveViewport)&&(oe.viewport.goHome(!0),oe.viewport.update()),oe._firstOpen=!1;var He=D[0];if(He.tileSource&&(He=He.tileSource),oe.overlays&&!oe.preserveOverlays)for(var Ct=0;Ct<oe.overlays.length;Ct++)oe.currentOverlays[Ct]=a(oe,oe.overlays[Ct]);oe._drawOverlays(),oe._opening=!1,oe.raiseEvent("open",{source:He})}else oe._opening=!1,oe.raiseEvent("open-failed",xe)},ot=function(He){(!t.isPlainObject(He)||!He.tileSource)&&(He={tileSource:He}),He.index!==void 0&&(t.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete He.index),He.collectionImmediately===void 0&&(He.collectionImmediately=!0);var Ct=He.success;He.success=function(F){if(Ae++,He.tileSource.overlays)for(var $=0;$<He.tileSource.overlays.length;$++)oe.addOverlay(He.tileSource.overlays[$]);Ct&&Ct(F),Xe()};var O=He.error;He.error=function(F){Se++,xe||(xe=F),O&&O(F),Xe()},oe.addTiledImage(He)},gt=0;gt<D.length;gt++)ot(D[gt]);return this},close:function(){return n[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),n[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(n[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(t.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),n[this.navigator.hash]=null,delete n[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),n[this.hash]=null,delete n[this.hash],this.canvas=null,this.container=null,t._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(D){return this.innerTracker.setTracking(D),this.outerTracker.setTracking(D),this.raiseEvent("mouse-enabled",{enabled:D}),this},areControlsEnabled:function(){var D=this.controls.length,W;for(W=0;W<this.controls.length;W++)D=D&&this.controls[W].isVisible();return D},setControlsEnabled:function(D){return D?g(this):h(this),this.raiseEvent("controls-enabled",{enabled:D}),this},setDebugMode:function(D){for(var W=0;W<this.world.getItemCount();W++)this.world.getItemAt(W).debugMode=D;this.debugMode=D,this.forceRedraw()},setAjaxHeaders:function(D,W){if(D===null&&(D={}),!t.isPlainObject(D)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(W===void 0&&(W=!0),this.ajaxHeaders=D,W){for(var oe=0;oe<this.world.getItemCount();oe++)this.world.getItemAt(oe)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(var ve in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[ve].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(D){this.buttonGroup.addButton(D)},isFullPage:function(){return n[this.hash].fullPage},setFullPage:function(D){var W=document.body,oe=W.style,ve=document.documentElement.style,Ae=this,Se,xe;if(D===this.isFullPage())return this;var Xe={fullPage:D,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",Xe),Xe.preventDefaultAction)return this;if(D){for(this.elementSize=t.getElementSize(this.element),this.pageScroll=t.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=oe.margin,this.docMargin=ve.margin,oe.margin="0",ve.margin="0",this.bodyPadding=oe.padding,this.docPadding=ve.padding,oe.padding="0",ve.padding="0",this.bodyWidth=oe.width,this.docWidth=ve.width,oe.width="100%",ve.width="100%",this.bodyHeight=oe.height,this.docHeight=ve.height,oe.height="100%",ve.height="100%",this.bodyDisplay=oe.display,oe.display="block",this.previousBody=[],n[this.hash].prevElementParent=this.element.parentNode,n[this.hash].prevNextSibling=this.element.nextSibling,n[this.hash].prevElementWidth=this.element.style.width,n[this.hash].prevElementHeight=this.element.style.height,Se=W.childNodes.length,xe=0;xe<Se;xe++)this.previousBody.push(W.childNodes[0]),W.removeChild(W.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,W.appendChild(this.toolbar.element),t.addClass(this.toolbar.element,"fullpage")),t.addClass(this.element,"fullpage"),W.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=t.getElementSize(this.element).y-t.getElementSize(this.toolbar.element).y+"px"),n[this.hash].fullPage=!0,t.delegate(this,j)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,oe.margin=this.bodyMargin,ve.margin=this.docMargin,oe.padding=this.bodyPadding,ve.padding=this.docPadding,oe.width=this.bodyWidth,ve.width=this.docWidth,oe.height=this.bodyHeight,ve.height=this.docHeight,oe.display=this.bodyDisplay,W.removeChild(this.element),Se=this.previousBody.length,xe=0;xe<Se;xe++)W.appendChild(this.previousBody.shift());t.removeClass(this.element,"fullpage"),n[this.hash].prevElementParent.insertBefore(this.element,n[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(W.removeChild(this.toolbar.element),t.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=n[this.hash].prevElementWidth,this.element.style.height=n[this.hash].prevElementHeight;var ot=0,gt=function(){t.setPageScroll(Ae.pageScroll);var He=t.getPageScroll();ot++,ot<10&&(He.x!==Ae.pageScroll.x||He.y!==Ae.pageScroll.y)&&t.requestAnimationFrame(gt)};t.requestAnimationFrame(gt),n[this.hash].fullPage=!1,t.delegate(this,V)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:D}),this},setFullScreen:function(D){var W=this;if(!t.supportsFullScreen)return this.setFullPage(D);if(t.isFullScreen()===D)return this;var oe={fullScreen:D,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",oe),oe.preventDefaultAction)return this;if(D){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var ve=function(){var Ae=t.isFullScreen();Ae||(t.removeEvent(document,t.fullScreenEventName,ve),t.removeEvent(document,t.fullScreenErrorEventName,ve),W.setFullPage(!1),W.isFullPage()&&(W.element.style.width=W.fullPageStyleWidth,W.element.style.height=W.fullPageStyleHeight)),W.navigator&&W.viewport&&setTimeout(function(){W.navigator.update(W.viewport)}),W.raiseEvent("full-screen",{fullScreen:Ae})};t.addEvent(document,t.fullScreenEventName,ve),t.addEvent(document,t.fullScreenErrorEventName,ve),t.requestFullScreen(document.body)}else t.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return t.isFullScreen()&&this.isFullPage()},setVisible:function(D){return this.container.style.visibility=D?"":"hidden",this.raiseEvent("visible",{visible:D}),this},addTiledImage:function(D){t.console.assert(D,"[Viewer.addTiledImage] options is required"),t.console.assert(D.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),t.console.assert(!D.replace||D.index>-1&&D.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var W=this;D.replace&&(D.replaceItem=W.world.getItemAt(D.index)),this._hideMessage(),D.placeholderFillStyle===void 0&&(D.placeholderFillStyle=this.placeholderFillStyle),D.opacity===void 0&&(D.opacity=this.opacity),D.preload===void 0&&(D.preload=this.preload),D.compositeOperation===void 0&&(D.compositeOperation=this.compositeOperation),D.crossOriginPolicy===void 0&&(D.crossOriginPolicy=D.tileSource.crossOriginPolicy!==void 0?D.tileSource.crossOriginPolicy:this.crossOriginPolicy),D.ajaxWithCredentials===void 0&&(D.ajaxWithCredentials=this.ajaxWithCredentials),D.loadTilesWithAjax===void 0&&(D.loadTilesWithAjax=this.loadTilesWithAjax),t.isPlainObject(D.ajaxHeaders)||(D.ajaxHeaders={});var oe={options:D};function ve(xe){for(var Xe=0;Xe<W._loadQueue.length;Xe++)if(W._loadQueue[Xe]===oe){W._loadQueue.splice(Xe,1);break}W._loadQueue.length===0&&Ae(oe),W.raiseEvent("add-item-failed",xe),D.error&&D.error(xe)}function Ae(xe){W.collectionMode&&(W.world.arrange({immediately:xe.options.collectionImmediately,rows:W.collectionRows,columns:W.collectionColumns,layout:W.collectionLayout,tileSize:W.collectionTileSize,tileMargin:W.collectionTileMargin}),W.world.setAutoRefigureSizes(!0))}if(t.isArray(D.tileSource)){setTimeout(function(){ve({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:D.tileSource,options:D})});return}this._loadQueue.push(oe);function Se(){for(var xe,Xe,ot;W._loadQueue.length&&(xe=W._loadQueue[0],!!xe.tileSource);){if(W._loadQueue.splice(0,1),xe.options.replace){var gt=W.world.getIndexOfItem(xe.options.replaceItem);gt!==-1&&(xe.options.index=gt),W.world.removeItem(xe.options.replaceItem)}Xe=new t.TiledImage({viewer:W,source:xe.tileSource,viewport:W.viewport,drawer:W.drawer,tileCache:W.tileCache,imageLoader:W.imageLoader,x:xe.options.x,y:xe.options.y,width:xe.options.width,height:xe.options.height,fitBounds:xe.options.fitBounds,fitBoundsPlacement:xe.options.fitBoundsPlacement,clip:xe.options.clip,placeholderFillStyle:xe.options.placeholderFillStyle,opacity:xe.options.opacity,preload:xe.options.preload,degrees:xe.options.degrees,flipped:xe.options.flipped,compositeOperation:xe.options.compositeOperation,springStiffness:W.springStiffness,animationTime:W.animationTime,minZoomImageRatio:W.minZoomImageRatio,wrapHorizontal:W.wrapHorizontal,wrapVertical:W.wrapVertical,immediateRender:W.immediateRender,blendTime:W.blendTime,alwaysBlend:W.alwaysBlend,minPixelRatio:W.minPixelRatio,smoothTileEdgesMinZoom:W.smoothTileEdgesMinZoom,iOSDevice:W.iOSDevice,crossOriginPolicy:xe.options.crossOriginPolicy,ajaxWithCredentials:xe.options.ajaxWithCredentials,loadTilesWithAjax:xe.options.loadTilesWithAjax,ajaxHeaders:xe.options.ajaxHeaders,debugMode:W.debugMode,subPixelRoundingForTransparency:W.subPixelRoundingForTransparency}),W.collectionMode&&W.world.setAutoRefigureSizes(!1),W.navigator&&(ot=t.extend({},xe.options,{replace:!1,originalTiledImage:Xe,tileSource:xe.tileSource}),W.navigator.addTiledImage(ot)),W.world.addItem(Xe,{index:xe.options.index}),W._loadQueue.length===0&&Ae(xe),W.world.getItemCount()===1&&!W.preserveViewport&&W.viewport.goHome(!0),xe.options.success&&xe.options.success({item:Xe})}}o(this,D.tileSource,D,function(xe){oe.tileSource=xe,Se()},function(xe){xe.options=D,ve(xe),Se()})},addSimpleImage:function(D){t.console.assert(D,"[Viewer.addSimpleImage] options is required"),t.console.assert(D.url,"[Viewer.addSimpleImage] options.url is required");var W=t.extend({},D,{tileSource:{type:"image",url:D.url}});delete W.url,this.addTiledImage(W)},addLayer:function(D){var W=this;t.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var oe=t.extend({},D,{success:function(ve){W.raiseEvent("add-layer",{options:D,drawer:ve.item})},error:function(ve){W.raiseEvent("add-layer-failed",ve)}});return this.addTiledImage(oe),this},getLayerAtLevel:function(D){return t.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(D)},getLevelOfLayer:function(D){return t.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(D)},getLayersCount:function(){return t.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(D,W){return t.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(D,W)},removeLayer:function(D){return t.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(D)},forceRedraw:function(){return n[this.hash].forceRedraw=!0,this},forceResize:function(){n[this.hash].needsResize=!0,n[this.hash].forceResize=!0},bindSequenceControls:function(){var D=t.delegate(this,A),W=t.delegate(this,p),oe=t.delegate(this,this.goToNextPage),ve=t.delegate(this,this.goToPreviousPage),Ae=this.navImages,Se=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(Se=!1),this.previousButton=new t.Button({element:this.previousButton?t.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.PreviousPage"),srcRest:ce(this.prefixUrl,Ae.previous.REST),srcGroup:ce(this.prefixUrl,Ae.previous.GROUP),srcHover:ce(this.prefixUrl,Ae.previous.HOVER),srcDown:ce(this.prefixUrl,Ae.previous.DOWN),onRelease:ve,onFocus:D,onBlur:W}),this.nextButton=new t.Button({element:this.nextButton?t.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.NextPage"),srcRest:ce(this.prefixUrl,Ae.next.REST),srcGroup:ce(this.prefixUrl,Ae.next.GROUP),srcHover:ce(this.prefixUrl,Ae.next.HOVER),srcDown:ce(this.prefixUrl,Ae.next.DOWN),onRelease:oe,onFocus:D,onBlur:W}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),Se&&(this.paging=new t.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:t.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var D=t.delegate(this,ie),W=t.delegate(this,ue),oe=t.delegate(this,Pe),ve=t.delegate(this,ne),Ae=t.delegate(this,Re),Se=t.delegate(this,Oe),xe=t.delegate(this,wt),Xe=t.delegate(this,ft),ot=t.delegate(this,pt),gt=t.delegate(this,at),He=t.delegate(this,A),Ct=t.delegate(this,p),O=this.navImages,F=[],$=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&($=!1),this.showZoomControl&&(F.push(this.zoomInButton=new t.Button({element:this.zoomInButton?t.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomIn"),srcRest:ce(this.prefixUrl,O.zoomIn.REST),srcGroup:ce(this.prefixUrl,O.zoomIn.GROUP),srcHover:ce(this.prefixUrl,O.zoomIn.HOVER),srcDown:ce(this.prefixUrl,O.zoomIn.DOWN),onPress:D,onRelease:W,onClick:oe,onEnter:D,onExit:W,onFocus:He,onBlur:Ct})),F.push(this.zoomOutButton=new t.Button({element:this.zoomOutButton?t.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomOut"),srcRest:ce(this.prefixUrl,O.zoomOut.REST),srcGroup:ce(this.prefixUrl,O.zoomOut.GROUP),srcHover:ce(this.prefixUrl,O.zoomOut.HOVER),srcDown:ce(this.prefixUrl,O.zoomOut.DOWN),onPress:ve,onRelease:W,onClick:Ae,onEnter:ve,onExit:W,onFocus:He,onBlur:Ct}))),this.showHomeControl&&F.push(this.homeButton=new t.Button({element:this.homeButton?t.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Home"),srcRest:ce(this.prefixUrl,O.home.REST),srcGroup:ce(this.prefixUrl,O.home.GROUP),srcHover:ce(this.prefixUrl,O.home.HOVER),srcDown:ce(this.prefixUrl,O.home.DOWN),onRelease:Se,onFocus:He,onBlur:Ct})),this.showFullPageControl&&F.push(this.fullPageButton=new t.Button({element:this.fullPageButton?t.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.FullPage"),srcRest:ce(this.prefixUrl,O.fullpage.REST),srcGroup:ce(this.prefixUrl,O.fullpage.GROUP),srcHover:ce(this.prefixUrl,O.fullpage.HOVER),srcDown:ce(this.prefixUrl,O.fullpage.DOWN),onRelease:xe,onFocus:He,onBlur:Ct})),this.showRotationControl&&(F.push(this.rotateLeftButton=new t.Button({element:this.rotateLeftButton?t.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateLeft"),srcRest:ce(this.prefixUrl,O.rotateleft.REST),srcGroup:ce(this.prefixUrl,O.rotateleft.GROUP),srcHover:ce(this.prefixUrl,O.rotateleft.HOVER),srcDown:ce(this.prefixUrl,O.rotateleft.DOWN),onRelease:Xe,onFocus:He,onBlur:Ct})),F.push(this.rotateRightButton=new t.Button({element:this.rotateRightButton?t.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateRight"),srcRest:ce(this.prefixUrl,O.rotateright.REST),srcGroup:ce(this.prefixUrl,O.rotateright.GROUP),srcHover:ce(this.prefixUrl,O.rotateright.HOVER),srcDown:ce(this.prefixUrl,O.rotateright.DOWN),onRelease:ot,onFocus:He,onBlur:Ct}))),this.showFlipControl&&F.push(this.flipButton=new t.Button({element:this.flipButton?t.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Flip"),srcRest:ce(this.prefixUrl,O.flip.REST),srcGroup:ce(this.prefixUrl,O.flip.GROUP),srcHover:ce(this.prefixUrl,O.flip.HOVER),srcDown:ce(this.prefixUrl,O.flip.DOWN),onRelease:gt,onFocus:He,onBlur:Ct})),$?(this.buttonGroup=new t.ButtonGroup({buttons:F,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",t.delegate(this,Qe)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT})):this.customButtons=F),this},currentPage:function(){return this._sequenceIndex},goToPage:function(D){return this.tileSources&&D>=0&&D<this.tileSources.length&&(this._sequenceIndex=D,this._updateSequenceButtons(D),this.open(this.tileSources[D]),this.referenceStrip&&this.referenceStrip.setFocus(D),this.raiseEvent("page",{page:D})),this},addOverlay:function(D,W,oe,ve){var Ae;if(t.isPlainObject(D)?Ae=D:Ae={element:D,location:W,placement:oe,onDraw:ve},D=t.getElement(Ae.element),l(this.currentOverlays,D)>=0)return this;var Se=a(this,Ae);return this.currentOverlays.push(Se),Se.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:D,location:Ae.location,placement:Ae.placement}),this},updateOverlay:function(D,W,oe){var ve;return D=t.getElement(D),ve=l(this.currentOverlays,D),ve>=0&&(this.currentOverlays[ve].update(W,oe),n[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:D,location:W,placement:oe})),this},removeOverlay:function(D){var W;return D=t.getElement(D),W=l(this.currentOverlays,D),W>=0&&(this.currentOverlays[W].destroy(),this.currentOverlays.splice(W,1),n[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:D})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return n[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(D){var W;return D=t.getElement(D),W=l(this.currentOverlays,D),W>=0?this.currentOverlays[W]:null},_updateSequenceButtons:function(D){this.nextButton&&(!this.tileSources||this.tileSources.length-1===D?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(D>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(D){this._hideMessage();var W=t.makeNeutralElement("div");W.appendChild(document.createTextNode(D)),this.messageDiv=t.makeCenteredNode(W),t.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var D=this.messageDiv;D&&(D.parentNode.removeChild(D),delete this.messageDiv)},gestureSettingsByDeviceType:function(D){switch(D){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var D,W=this.currentOverlays.length;for(D=0;D<W;D++)this.currentOverlays[D].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new t.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else t.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),t.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){t.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var D=t.pixelDensityRatio,W=t.getCurrentPixelDensityRatio();D!==W&&(t.pixelDensityRatio=W,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var D=this._sequenceIndex-1;this.navPrevNextWrap&&D<0&&(D+=this.tileSources.length),this.goToPage(D)},goToNextPage:function(){var D=this._sequenceIndex+1;this.navPrevNextWrap&&D>=this.tileSources.length&&(D=0),this.goToPage(D)},isAnimating:function(){return n[this.hash].animating}});function s(D){return D=t.getElement(D),new t.Point(D.clientWidth===0?1:D.clientWidth,D.clientHeight===0?1:D.clientHeight)}function o(D,W,oe,ve,Ae){var Se=D;if(t.type(W)==="string"){if(W.match(/^\s*<.*>\s*$/))W=t.parseXml(W);else if(W.match(/^\s*[{[].*[}\]]\s*$/))try{var xe=t.parseJSON(W);W=xe}catch{}}function Xe(ot,gt){ot.ready?ve(ot):(ot.addHandler("ready",function(){ve(ot)}),ot.addHandler("open-failed",function(He){Ae({message:He.message,source:gt})}))}setTimeout(function(){if(t.type(W)==="string")W=new t.TileSource({url:W,crossOriginPolicy:oe.crossOriginPolicy!==void 0?oe.crossOriginPolicy:D.crossOriginPolicy,ajaxWithCredentials:D.ajaxWithCredentials,ajaxHeaders:oe.ajaxHeaders?oe.ajaxHeaders:D.ajaxHeaders,splitHashDataForPost:D.splitHashDataForPost,useCanvas:D.useCanvas,success:function(Ct){ve(Ct.tileSource)}}),W.addHandler("open-failed",function(Ct){Ae(Ct)});else if(t.isPlainObject(W)||W.nodeType)if(W.crossOriginPolicy===void 0&&(oe.crossOriginPolicy!==void 0||D.crossOriginPolicy!==void 0)&&(W.crossOriginPolicy=oe.crossOriginPolicy!==void 0?oe.crossOriginPolicy:D.crossOriginPolicy),W.ajaxWithCredentials===void 0&&(W.ajaxWithCredentials=D.ajaxWithCredentials),W.useCanvas===void 0&&(W.useCanvas=D.useCanvas),t.isFunction(W.getTileUrl)){var ot=new t.TileSource(W);ot.getTileUrl=W.getTileUrl,ve(ot)}else{var gt=t.TileSource.determineType(Se,W);if(!gt){Ae({message:"Unable to load TileSource",source:W});return}var He=gt.prototype.configure.apply(Se,[W]);Xe(new gt(He),W)}else Xe(W,W)})}function a(D,W){if(W instanceof t.Overlay)return W;var oe=null;if(W.element)oe=t.getElement(W.element);else{var ve=W.id?W.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);oe=t.getElement(W.id),oe||(oe=document.createElement("a"),oe.href="#/overlay/"+ve),oe.id=ve,t.addClass(oe,W.className?W.className:"openseadragon-overlay")}var Ae=W.location,Se=W.width,xe=W.height;if(!Ae){var Xe=W.x,ot=W.y;if(W.px!==void 0){var gt=D.viewport.imageToViewportRectangle(new t.Rect(W.px,W.py,Se||0,xe||0));Xe=gt.x,ot=gt.y,Se=Se!==void 0?gt.width:void 0,xe=xe!==void 0?gt.height:void 0}Ae=new t.Point(Xe,ot)}var He=W.placement;return He&&t.type(He)==="string"&&(He=t.Placement[W.placement.toUpperCase()]),new t.Overlay({element:oe,location:Ae,placement:He,onDraw:W.onDraw,checkResize:W.checkResize,width:Se,height:xe,rotationMode:W.rotationMode})}function l(D,W){var oe;for(oe=D.length-1;oe>=0;oe--)if(D[oe].element===W)return oe;return-1}function u(D,W){return t.requestAnimationFrame(function(){W(D)})}function c(D){t.requestAnimationFrame(function(){d(D)})}function h(D){D.autoHideControls&&(D.controlsShouldFade=!0,D.controlsFadeBeginTime=t.now()+D.controlsFadeDelay,window.setTimeout(function(){c(D)},D.controlsFadeDelay))}function d(D){var W,oe,ve,Ae;if(D.controlsShouldFade){for(W=t.now(),oe=W-D.controlsFadeBeginTime,ve=1-oe/D.controlsFadeLength,ve=Math.min(1,ve),ve=Math.max(0,ve),Ae=D.controls.length-1;Ae>=0;Ae--)D.controls[Ae].autoFade&&D.controls[Ae].setOpacity(ve);ve>0&&c(D)}}function g(D){var W;for(D.controlsShouldFade=!1,W=D.controls.length-1;W>=0;W--)D.controls[W].setOpacity(1)}function A(){g(this)}function p(){h(this)}function y(D){var W={tracker:D.eventSource,position:D.position,originalEvent:D.originalEvent,preventDefault:D.preventDefault};this.raiseEvent("canvas-contextmenu",W),D.preventDefault=W.preventDefault}function v(D){var W={originalEvent:D.originalEvent,preventDefaultAction:!1,preventVerticalPan:D.preventVerticalPan||!this.panVertical,preventHorizontalPan:D.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",W),!W.preventDefaultAction&&!D.ctrl&&!D.alt&&!D.meta)switch(D.keyCode){case 38:W.preventVerticalPan||(D.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 40:W.preventVerticalPan||(D.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 37:W.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 39:W.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),D.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),D.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),D.preventDefault=!0;break;case 87:W.preventVerticalPan||(D.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-40))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 83:W.preventVerticalPan||(D.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,40))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 65:W.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-40,0))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 68:W.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(40,0))),this.viewport.applyConstraints()),D.preventDefault=!0;break;case 82:D.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),D.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),D.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:D.preventDefault=!1;break}else D.preventDefault=!1}function E(D){var W={originalEvent:D.originalEvent};this.raiseEvent("canvas-key-press",W)}function I(D){var W,oe=document.activeElement===this.canvas;oe||this.canvas.focus(),this.viewport.flipped&&(D.position.x=this.viewport.getContainerSize().x-D.position.x);var ve={tracker:D.eventSource,position:D.position,quick:D.quick,shift:D.shift,originalEvent:D.originalEvent,originalTarget:D.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",ve),!ve.preventDefaultAction&&this.viewport&&D.quick&&(W=this.gestureSettingsByDeviceType(D.pointerType),W.clickToZoom===!0&&(this.viewport.zoomBy(D.shift?1/this.zoomPerClick:this.zoomPerClick,W.zoomToRefPoint?this.viewport.pointFromPixel(D.position,!0):null),this.viewport.applyConstraints()),W.dblClickDragToZoom&&(n[this.hash].draggingToZoom===!0?(n[this.hash].lastClickTime=null,n[this.hash].draggingToZoom=!1):n[this.hash].lastClickTime=t.now()))}function C(D){var W,oe={tracker:D.eventSource,position:D.position,shift:D.shift,originalEvent:D.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",oe),!oe.preventDefaultAction&&this.viewport&&(W=this.gestureSettingsByDeviceType(D.pointerType),W.dblClickToZoom&&(this.viewport.zoomBy(D.shift?1/this.zoomPerClick:this.zoomPerClick,W.zoomToRefPoint?this.viewport.pointFromPixel(D.position,!0):null),this.viewport.applyConstraints()))}function w(D){var W,oe={tracker:D.eventSource,pointerType:D.pointerType,position:D.position,delta:D.delta,speed:D.speed,direction:D.direction,shift:D.shift,originalEvent:D.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",oe),W=this.gestureSettingsByDeviceType(D.pointerType),!oe.preventDefaultAction&&this.viewport){if(W.dblClickDragToZoom&&n[this.hash].draggingToZoom){var ve=Math.pow(this.zoomPerDblClickDrag,D.delta.y/50);this.viewport.zoomBy(ve)}else if(W.dragToPan&&!n[this.hash].draggingToZoom){if(this.panHorizontal||(D.delta.x=0),this.panVertical||(D.delta.y=0),this.viewport.flipped&&(D.delta.x=-D.delta.x),this.constrainDuringPan){var Ae=this.viewport.deltaPointsFromPixels(D.delta.negate());this.viewport.centerSpringX.target.value+=Ae.x,this.viewport.centerSpringY.target.value+=Ae.y;var Se=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=Ae.x,this.viewport.centerSpringY.target.value-=Ae.y,Se.xConstrained&&(D.delta.x=0),Se.yConstrained&&(D.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(D.delta.negate()),W.flickEnabled&&!this.constrainDuringPan)}}}function S(D){var W,oe={tracker:D.eventSource,pointerType:D.pointerType,position:D.position,speed:D.speed,direction:D.direction,shift:D.shift,originalEvent:D.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",oe),W=this.gestureSettingsByDeviceType(D.pointerType),!oe.preventDefaultAction&&this.viewport){if(!n[this.hash].draggingToZoom&&W.flickEnabled&&D.speed>=W.flickMinSpeed){var ve=0;this.panHorizontal&&(ve=W.flickMomentum*D.speed*Math.cos(D.direction));var Ae=0;this.panVertical&&(Ae=W.flickMomentum*D.speed*Math.sin(D.direction));var Se=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),xe=this.viewport.pointFromPixel(new t.Point(Se.x-ve,Se.y-Ae));this.viewport.panTo(xe,!1)}this.viewport.applyConstraints()}W.dblClickDragToZoom&&n[this.hash].draggingToZoom===!0&&(n[this.hash].draggingToZoom=!1)}function x(D){this.raiseEvent("canvas-enter",{tracker:D.eventSource,pointerType:D.pointerType,position:D.position,buttons:D.buttons,pointers:D.pointers,insideElementPressed:D.insideElementPressed,buttonDownAny:D.buttonDownAny,originalEvent:D.originalEvent})}function T(D){this.raiseEvent("canvas-exit",{tracker:D.eventSource,pointerType:D.pointerType,position:D.position,buttons:D.buttons,pointers:D.pointers,insideElementPressed:D.insideElementPressed,buttonDownAny:D.buttonDownAny,originalEvent:D.originalEvent})}function Q(D){var W;if(this.raiseEvent("canvas-press",{tracker:D.eventSource,pointerType:D.pointerType,position:D.position,insideElementPressed:D.insideElementPressed,insideElementReleased:D.insideElementReleased,originalEvent:D.originalEvent}),W=this.gestureSettingsByDeviceType(D.pointerType),W.dblClickDragToZoom){var oe=n[this.hash].lastClickTime,ve=t.now();if(oe===null)return;ve-oe<this.dblClickTimeThreshold&&(n[this.hash].draggingToZoom=!0),n[this.hash].lastClickTime=null}}function M(D){this.raiseEvent("canvas-release",{tracker:D.eventSource,pointerType:D.pointerType,position:D.position,insideElementPressed:D.insideElementPressed,insideElementReleased:D.insideElementReleased,originalEvent:D.originalEvent})}function R(D){this.raiseEvent("canvas-nonprimary-press",{tracker:D.eventSource,position:D.position,pointerType:D.pointerType,button:D.button,buttons:D.buttons,originalEvent:D.originalEvent})}function z(D){this.raiseEvent("canvas-nonprimary-release",{tracker:D.eventSource,position:D.position,pointerType:D.pointerType,button:D.button,buttons:D.buttons,originalEvent:D.originalEvent})}function q(D){var W,oe,ve,Ae,Se={tracker:D.eventSource,pointerType:D.pointerType,gesturePoints:D.gesturePoints,lastCenter:D.lastCenter,center:D.center,lastDistance:D.lastDistance,distance:D.distance,shift:D.shift,originalEvent:D.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",Se),this.viewport&&(W=this.gestureSettingsByDeviceType(D.pointerType),W.pinchToZoom&&(!Se.preventDefaultPanAction||!Se.preventDefaultZoomAction)&&(oe=this.viewport.pointFromPixel(D.center,!0),W.zoomToRefPoint&&!Se.preventDefaultPanAction&&(ve=this.viewport.pointFromPixel(D.lastCenter,!0),Ae=ve.minus(oe),this.panHorizontal||(Ae.x=0),this.panVertical||(Ae.y=0),this.viewport.panBy(Ae,!0)),Se.preventDefaultZoomAction||this.viewport.zoomBy(D.distance/D.lastDistance,oe,!0),this.viewport.applyConstraints()),W.pinchRotate&&!Se.preventDefaultRotateAction)){var xe=Math.atan2(D.gesturePoints[0].currentPos.y-D.gesturePoints[1].currentPos.y,D.gesturePoints[0].currentPos.x-D.gesturePoints[1].currentPos.x),Xe=Math.atan2(D.gesturePoints[0].lastPos.y-D.gesturePoints[1].lastPos.y,D.gesturePoints[0].lastPos.x-D.gesturePoints[1].lastPos.x);oe=this.viewport.pointFromPixel(D.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(xe-Xe)*(180/Math.PI),oe,!0)}}function X(D){this.raiseEvent("canvas-focus",{tracker:D.eventSource,originalEvent:D.originalEvent})}function N(D){this.raiseEvent("canvas-blur",{tracker:D.eventSource,originalEvent:D.originalEvent})}function G(D){var W,oe,ve,Ae,Se;Ae=t.now(),Se=Ae-this._lastScrollTime,Se>this.minScrollDeltaTime?(this._lastScrollTime=Ae,W={tracker:D.eventSource,position:D.position,scroll:D.scroll,shift:D.shift,originalEvent:D.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",W),!W.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(D.position.x=this.viewport.getContainerSize().x-D.position.x),oe=this.gestureSettingsByDeviceType(D.pointerType),oe.scrollToZoom&&(ve=Math.pow(this.zoomPerScroll,D.scroll),this.viewport.zoomBy(ve,oe.zoomToRefPoint?this.viewport.pointFromPixel(D.position,!0):null),this.viewport.applyConstraints())),D.preventDefault=W.preventDefault):D.preventDefault=!0}function j(D){n[this.hash].mouseInside=!0,g(this),this.raiseEvent("container-enter",{tracker:D.eventSource,pointerType:D.pointerType,position:D.position,buttons:D.buttons,pointers:D.pointers,insideElementPressed:D.insideElementPressed,buttonDownAny:D.buttonDownAny,originalEvent:D.originalEvent})}function V(D){D.pointers<1&&(n[this.hash].mouseInside=!1,n[this.hash].animating||h(this)),this.raiseEvent("container-exit",{tracker:D.eventSource,pointerType:D.pointerType,position:D.position,buttons:D.buttons,pointers:D.pointers,insideElementPressed:D.insideElementPressed,buttonDownAny:D.buttonDownAny,originalEvent:D.originalEvent})}function Z(D){te(D),D.isOpen()?D._updateRequestId=u(D,Z):D._updateRequestId=!1}function Y(D,W){var oe=D.viewport,ve=oe.getZoom(),Ae=oe.getCenter();oe.resize(W,D.preserveImageSizeOnResize),oe.panTo(Ae,!0);var Se;if(D.preserveImageSizeOnResize)Se=n[D.hash].prevContainerSize.x/W.x;else{var xe=new t.Point(0,0),Xe=new t.Point(n[D.hash].prevContainerSize.x,n[D.hash].prevContainerSize.y).distanceTo(xe),ot=new t.Point(W.x,W.y).distanceTo(xe);Se=ot/Xe*n[D.hash].prevContainerSize.x/W.x}oe.zoomTo(ve*Se,null,!0),n[D.hash].prevContainerSize=W,n[D.hash].forceRedraw=!0,n[D.hash].needsResize=!1,n[D.hash].forceResize=!1}function te(D){if(!(D._opening||!n[D.hash])){if(D.autoResize||n[D.hash].forceResize){var W;if(D._autoResizePolling){W=s(D.container);var oe=n[D.hash].prevContainerSize;W.equals(oe)||(n[D.hash].needsResize=!0)}n[D.hash].needsResize&&Y(D,W||s(D.container))}var ve=D.viewport.update(),Ae=D.world.update()||ve;ve&&D.raiseEvent("viewport-change"),D.referenceStrip&&(Ae=D.referenceStrip.update(D.viewport)||Ae);var Se=n[D.hash].animating;!Se&&Ae&&(D.raiseEvent("animation-start"),g(D));var xe=Se&&!Ae;xe&&(n[D.hash].animating=!1),(Ae||xe||n[D.hash].forceRedraw||D.world.needsDraw())&&(J(D),D._drawOverlays(),D.navigator&&D.navigator.update(D.viewport),n[D.hash].forceRedraw=!1,Ae&&D.raiseEvent("animation")),xe&&(D.raiseEvent("animation-finish"),n[D.hash].mouseInside||h(D)),n[D.hash].animating=Ae}}function J(D){D.imageLoader.clear(),D.drawer.clear(),D.world.draw(),D.raiseEvent("update-viewport",{})}function ce(D,W){return D?D+W:W}function ie(){n[this.hash].lastZoomTime=t.now(),n[this.hash].zoomFactor=this.zoomPerSecond,n[this.hash].zooming=!0,fe(this)}function ne(){n[this.hash].lastZoomTime=t.now(),n[this.hash].zoomFactor=1/this.zoomPerSecond,n[this.hash].zooming=!0,fe(this)}function ue(){n[this.hash].zooming=!1}function fe(D){t.requestAnimationFrame(t.delegate(D,me))}function me(){var D,W,oe;n[this.hash].zooming&&this.viewport&&(D=t.now(),W=D-n[this.hash].lastZoomTime,oe=Math.pow(n[this.hash].zoomFactor,W/1e3),this.viewport.zoomBy(oe),this.viewport.applyConstraints(),n[this.hash].lastZoomTime=D,fe(this))}function Pe(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Re(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function Qe(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function Oe(){this.viewport&&this.viewport.goHome()}function wt(){this.isFullPage()&&!t.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function ft(){if(this.viewport){var D=this.viewport.getRotation();this.viewport.flipped?D+=this.rotationIncrement:D-=this.rotationIncrement,this.viewport.setRotation(D)}}function pt(){if(this.viewport){var D=this.viewport.getRotation();this.viewport.flipped?D-=this.rotationIncrement:D+=this.rotationIncrement,this.viewport.setRotation(D)}}function at(){this.viewport.toggleFlip()}}(e),function(t){t.Navigator=function(u){var c=u.viewer,h=this,d,g;u.element||u.id?(u.element?(u.id&&t.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),u.element.id?u.id=u.element.id:u.id="navigator-"+t.now(),this.element=u.element):this.element=document.getElementById(u.id),u.controlOptions={anchor:t.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(u.id="navigator-"+t.now(),this.element=t.makeNeutralElement("div"),u.controlOptions={anchor:t.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:u.autoFade},u.position&&(u.position==="BOTTOM_RIGHT"?u.controlOptions.anchor=t.ControlAnchor.BOTTOM_RIGHT:u.position==="BOTTOM_LEFT"?u.controlOptions.anchor=t.ControlAnchor.BOTTOM_LEFT:u.position==="TOP_RIGHT"?u.controlOptions.anchor=t.ControlAnchor.TOP_RIGHT:u.position==="TOP_LEFT"?u.controlOptions.anchor=t.ControlAnchor.TOP_LEFT:u.position==="ABSOLUTE"&&(u.controlOptions.anchor=t.ControlAnchor.ABSOLUTE,u.controlOptions.top=u.top,u.controlOptions.left=u.left,u.controlOptions.height=u.height,u.controlOptions.width=u.width))),this.element.id=u.id,this.element.className+=" navigator",u=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.navigatorSizeRatio},u,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:u.animationTime,autoResize:!1,minZoomImageRatio:1,background:u.background,opacity:u.opacity,borderColor:u.borderColor,displayRegionColor:u.displayRegionColor}),u.minPixelRatio=this.minPixelRatio=c.minPixelRatio,t.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new t.Point(1,1),this.totalBorderWidths=new t.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),u.controlOptions.anchor!==t.ControlAnchor.NONE&&function(y,v){y.margin="0px",y.border=v+"px solid "+u.borderColor,y.padding="0px",y.background=u.background,y.opacity=u.opacity,y.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=t.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(y,v){y.position="relative",y.top="0px",y.left="0px",y.fontSize="0px",y.overflow="hidden",y.border=v+"px solid "+u.displayRegionColor,y.margin="0px",y.padding="0px",y.background="transparent",y.float="left",y.cssFloat="left",y.styleFloat="left",y.zIndex=999999999,y.cursor="default",y.boxSizing="content-box"}(this.displayRegion.style,this.borderWidth),t.setElementPointerEventsNone(this.displayRegion),t.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=t.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",t.setElementPointerEventsNone(this.displayRegionContainer),t.setElementTouchActionNone(this.displayRegionContainer),c.addControl(this.element,u.controlOptions),this._resizeWithViewer=u.controlOptions.anchor!==t.ControlAnchor.ABSOLUTE&&u.controlOptions.anchor!==t.ControlAnchor.NONE,u.width&&u.height?(this.setWidth(u.width),this.setHeight(u.height)):this._resizeWithViewer&&(d=t.getElementSize(c.element),this.element.style.height=Math.round(d.y*u.sizeRatio)+"px",this.element.style.width=Math.round(d.x*u.sizeRatio)+"px",this.oldViewerSize=d,g=t.getElementSize(this.element),this.elementArea=g.x*g.y),this.oldContainerSize=new t.Point(0,0),t.Viewer.apply(this,[u]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function A(y,v){a(h.displayRegionContainer,y),a(h.displayRegion,-y),h.viewport.setRotation(y,v)}if(u.navigatorRotate){var p=u.viewer.viewport?u.viewer.viewport.getRotation():u.viewer.degrees||0;A(p,!0),u.viewer.addHandler("rotate",function(y){A(y.degrees,y.immediately)})}this.innerTracker.destroy(),this.innerTracker=new t.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:t.delegate(this,r),clickHandler:t.delegate(this,n),releaseHandler:t.delegate(this,s),scrollHandler:t.delegate(this,o),preProcessEventHandler:function(y){y.eventType==="wheel"&&(y.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",t.setElementPointerEventsNone(this.canvas),t.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){h.viewport&&h.viewport.goHome(!0)}),c.world.addHandler("item-index-change",function(y){window.setTimeout(function(){var v=h.world.getItemAt(y.previousIndex);h.world.setItemIndex(v,y.newIndex)},1)}),c.world.addHandler("remove-item",function(y){var v=y.item,E=h._getMatchingItem(v);E&&h.world.removeItem(E)}),this.update(c.viewport)},t.extend(t.Navigator.prototype,t.EventSource.prototype,t.Viewer.prototype,{updateSize:function(){if(this.viewport){var u=new t.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);u.equals(this.oldContainerSize)||(this.viewport.resize(u,!0),this.viewport.goHome(!0),this.oldContainerSize=u,this.drawer.clear(),this.world.draw())}},setWidth:function(u){this.width=u,this.element.style.width=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(u){this.height=u,this.element.style.height=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(u){return this.viewport.setFlip(u),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(u){l(this.displayRegion,u),l(this.canvas,u),l(this.element,u)},update:function(u){var c,h,d,g,A,p;if(c=t.getElementSize(this.viewer.element),this._resizeWithViewer&&c.x&&c.y&&!c.equals(this.oldViewerSize)&&(this.oldViewerSize=c,this.maintainSizeRatio||!this.elementArea?(h=c.x*this.sizeRatio,d=c.y*this.sizeRatio):(h=Math.sqrt(this.elementArea*(c.x/c.y)),d=this.elementArea/h),this.element.style.width=Math.round(h)+"px",this.element.style.height=Math.round(d)+"px",this.elementArea||(this.elementArea=h*d),this.updateSize()),u&&this.viewport){if(g=u.getBoundsNoRotate(!0),A=this.viewport.pixelFromPointNoRotate(g.getTopLeft(),!1),p=this.viewport.pixelFromPointNoRotate(g.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate){var y=u.getRotation(!0);a(this.displayRegion,-y)}var v=this.displayRegion.style;v.display=this.world.getItemCount()?"block":"none",v.top=A.y.toFixed(2)+"px",v.left=A.x.toFixed(2)+"px";var E=p.x-A.x,I=p.y-A.y;v.width=Math.round(Math.max(E,0))+"px",v.height=Math.round(Math.max(I,0))+"px"}},addTiledImage:function(u){var c=this,h=u.originalTiledImage;delete u.original;var d=t.extend({},u,{success:function(g){var A=g.item;A._originalForNavigator=h,c._matchBounds(A,h,!0),c._matchOpacity(A,h),c._matchCompositeOperation(A,h);function p(){c._matchBounds(A,h)}function y(){c._matchOpacity(A,h)}function v(){c._matchCompositeOperation(A,h)}h.addHandler("bounds-change",p),h.addHandler("clip-change",p),h.addHandler("opacity-change",y),h.addHandler("composite-operation-change",v)}});return t.Viewer.prototype.addTiledImage.apply(this,[d])},destroy:function(){return t.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(u){for(var c=this.world.getItemCount(),h,d=0;d<c;d++)if(h=this.world.getItemAt(d),h._originalForNavigator===u)return h;return null},_matchBounds:function(u,c,h){var d=c.getBoundsNoRotate();u.setPosition(d.getTopLeft(),h),u.setWidth(d.width,h),u.setRotation(c.getRotation(),h),u.setClip(c.getClip()),u.setFlip(c.getFlip())},_matchOpacity:function(u,c){u.setOpacity(c.opacity)},_matchCompositeOperation:function(u,c){u.setCompositeOperation(c.compositeOperation)}});function n(u){var c={tracker:u.eventSource,position:u.position,quick:u.quick,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",c),!c.preventDefaultAction&&u.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(u.position.x=this.viewport.getContainerSize().x-u.position.x);var h=this.viewport.pointFromPixel(u.position);this.panVertical?this.panHorizontal||(h.x=this.viewer.viewport.getCenter(!0).x):h.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(h),this.viewer.viewport.applyConstraints()}}function r(u){var c={tracker:u.eventSource,position:u.position,delta:u.delta,speed:u.speed,direction:u.direction,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",c),!c.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(u.delta.x=0),this.panVertical||(u.delta.y=0),this.viewer.viewport.flipped&&(u.delta.x=-u.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(u.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function s(u){u.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function o(u){var c={tracker:u.eventSource,position:u.position,scroll:u.scroll,shift:u.shift,originalEvent:u.originalEvent,preventDefault:u.preventDefault};this.viewer.raiseEvent("navigator-scroll",c),u.preventDefault=c.preventDefault}function a(u,c){l(u,"rotate("+c+"deg)")}function l(u,c){u.style.webkitTransform=c,u.style.mozTransform=c,u.style.msTransform=c,u.style.oTransform=c,u.style.transform=c}}(e),function(t){var n={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};t.extend(t,{getString:function(r){var s=r.split("."),o=null,a=arguments,l=n,u;for(u=0;u<s.length-1;u++)l=l[s[u]]||{};return o=l[s[u]],typeof o!="string"&&(t.console.error("Untranslated source string:",r),o=""),o.replace(/\{\d+\}/g,function(c){var h=parseInt(c.match(/\d+/),10)+1;return h<a.length?a[h]:""})},setString:function(r,s){var o=r.split("."),a=n,l;for(l=0;l<o.length-1;l++)a[o[l]]||(a[o[l]]={}),a=a[o[l]];a[o[l]]=s}})}(e),function(t){t.Point=function(n,r){this.x=typeof n=="number"?n:0,this.y=typeof r=="number"?r:0},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},plus:function(n){return new t.Point(this.x+n.x,this.y+n.y)},minus:function(n){return new t.Point(this.x-n.x,this.y-n.y)},times:function(n){return new t.Point(this.x*n,this.y*n)},divide:function(n){return new t.Point(this.x/n,this.y/n)},negate:function(){return new t.Point(-this.x,-this.y)},distanceTo:function(n){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))},squaredDistanceTo:function(n){return Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2)},apply:function(n){return new t.Point(n(this.x),n(this.y))},equals:function(n){return n instanceof t.Point&&this.x===n.x&&this.y===n.y},rotate:function(n,r){r=r||new t.Point(0,0);var s,o;if(n%90===0){var a=t.positiveModulo(n,360);switch(a){case 0:s=1,o=0;break;case 90:s=0,o=1;break;case 180:s=-1,o=0;break;case 270:s=0,o=-1;break}}else{var l=n*Math.PI/180;s=Math.cos(l),o=Math.sin(l)}var u=s*(this.x-r.x)-o*(this.y-r.y)+r.x,c=o*(this.x-r.x)+s*(this.y-r.y)+r.y;return new t.Point(u,c)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(e),function(t){t.TileSource=function(r,s,o,a,l,u){var c=this,h=arguments,d,g;if(t.isPlainObject(r)?d=r:d={width:h[0],height:h[1],tileSize:h[2],tileOverlap:h[3],minLevel:h[4],maxLevel:h[5]},t.EventSource.call(this),t.extend(!0,this,d),!this.success){for(g=0;g<arguments.length;g++)if(t.isFunction(arguments[g])){this.success=arguments[g];break}}this.success&&this.addHandler("ready",function(A){c.success(A)}),t.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new t.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=d.width&&d.height?d.width/d.height:1,this.dimensions=new t.Point(d.width,d.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=d.tileOverlap?d.tileOverlap:0,this.minLevel=d.minLevel?d.minLevel:0,this.maxLevel=d.maxLevel!==void 0&&d.maxLevel!==null?d.maxLevel:d.width&&d.height?Math.ceil(Math.log(Math.max(d.width,d.height))/Math.log(2)):0,this.success&&t.isFunction(this.success)&&this.success(this))},t.TileSource.prototype={getTileSize:function(r){return t.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(r){return this._tileWidth?this._tileWidth:this.getTileSize(r)},getTileHeight:function(r){return this._tileHeight?this._tileHeight:this.getTileSize(r)},setMaxLevel:function(r){this.maxLevel=r,this._memoizeLevelScale()},getLevelScale:function(r){return this._memoizeLevelScale(),this.getLevelScale(r)},_memoizeLevelScale:function(){var r={},s;for(s=0;s<=this.maxLevel;s++)r[s]=1/Math.pow(2,this.maxLevel-s);this.getLevelScale=function(o){return r[o]}},getNumTiles:function(r){var s=this.getLevelScale(r),o=Math.ceil(s*this.dimensions.x/this.getTileWidth(r)),a=Math.ceil(s*this.dimensions.y/this.getTileHeight(r));return new t.Point(o,a)},getPixelRatio:function(r){var s=this.dimensions.times(this.getLevelScale(r)),o=1/s.x*t.pixelDensityRatio,a=1/s.y*t.pixelDensityRatio;return new t.Point(o,a)},getClosestLevel:function(){var r,s;for(r=this.minLevel+1;r<=this.maxLevel&&(s=this.getNumTiles(r),!(s.x>1||s.y>1));r++);return r-1},getTileAtPoint:function(r,s){var o=s.x>=0&&s.x<=1&&s.y>=0&&s.y<=1/this.aspectRatio;t.console.assert(o,"[TileSource.getTileAtPoint] must be called with a valid point.");var a=this.dimensions.x*this.getLevelScale(r),l=s.x*a,u=s.y*a,c=Math.floor(l/this.getTileWidth(r)),h=Math.floor(u/this.getTileHeight(r));s.x>=1&&(c=this.getNumTiles(r).x-1);var d=1e-15;return s.y>=1/this.aspectRatio-d&&(h=this.getNumTiles(r).y-1),new t.Point(c,h)},getTileBounds:function(r,s,o,a){var l=this.dimensions.times(this.getLevelScale(r)),u=this.getTileWidth(r),c=this.getTileHeight(r),h=s===0?0:u*s-this.tileOverlap,d=o===0?0:c*o-this.tileOverlap,g=u+(s===0?1:2)*this.tileOverlap,A=c+(o===0?1:2)*this.tileOverlap,p=1/l.x;return g=Math.min(g,l.x-h),A=Math.min(A,l.y-d),a?new t.Rect(0,0,g,A):new t.Rect(h*p,d*p,g*p,A*p)},getImageInfo:function(r){var s=this,o,a,l,u,c,h,d;r&&(c=r.split("/"),h=c[c.length-1],d=h.lastIndexOf("."),d>-1&&(c[c.length-1]=h.slice(0,d)));var g=null;if(this.splitHashDataForPost){var A=r.indexOf("#");A!==-1&&(g=r.substring(A+1),r=r.substr(0,A))}a=function(p){typeof p=="string"&&(p=t.parseXml(p));var y=t.TileSource.determineType(s,p,r);if(!y){s.raiseEvent("open-failed",{message:"Unable to load TileSource",source:r});return}u=y.prototype.configure.apply(s,[p,r,g]),u.ajaxWithCredentials===void 0&&(u.ajaxWithCredentials=s.ajaxWithCredentials),l=new y(u),s.ready=!0,s.raiseEvent("ready",{tileSource:l})},r.match(/\.js$/)?(o=r.split("/").pop().replace(".js",""),t.jsonp({url:r,async:!1,callbackName:o,callback:a})):t.makeAjaxRequest({url:r,postData:g,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(p){var y=n(p);a(y)},error:function(p,y){var v;try{v="HTTP "+p.status+" attempting to load TileSource: "+r}catch{var E;typeof y>"u"||!y.toString?E="Unknown error":E=y.toString(),v=E+" attempting to load TileSource: "+r}t.console.error(v),s.raiseEvent("open-failed",{message:v,source:r,postData:g})}})},supports:function(r,s){return!1},configure:function(r,s,o){throw new Error("Method not implemented.")},getTileUrl:function(r,s,o){throw new Error("Method not implemented.")},getTilePostData:function(r,s,o){return null},getTileAjaxHeaders:function(r,s,o){return{}},getTileHashKey:function(r,s,o,a,l,u){function c(h){return l?h+"+"+JSON.stringify(l):h}return c(typeof a!="string"?r+"/"+s+"_"+o:a)},tileExists:function(r,s,o){var a=this.getNumTiles(r);return r>=this.minLevel&&r<=this.maxLevel&&s>=0&&o>=0&&s<a.x&&o<a.y},hasTransparency:function(r,s,o,a){return!!r||s.match(".png")},downloadTileStart:function(r){var s=r.userData,o=new Image;s.image=o,s.request=null;var a=function(l){if(!o){r.finish(null,s.request,"Image load failed: undefined Image instance.");return}o.onload=o.onerror=o.onabort=null,r.finish(l?null:o,s.request,l)};o.onload=function(){a()},o.onabort=o.onerror=function(){a("Image load aborted.")},r.loadWithAjax?s.request=t.makeAjaxRequest({url:r.src,withCredentials:r.ajaxWithCredentials,headers:r.ajaxHeaders,responseType:"arraybuffer",postData:r.postData,success:function(l){var u;try{u=new window.Blob([l.response])}catch(d){var c=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(d.name==="TypeError"&&c){var h=new c;h.append(l.response),u=h.getBlob()}}u.size===0?a("Empty image response."):o.src=(window.URL||window.webkitURL).createObjectURL(u)},error:function(l){a("Image load aborted - XHR error")}}):(r.crossOriginPolicy!==!1&&(o.crossOrigin=r.crossOriginPolicy),o.src=r.src)},downloadTileAbort:function(r){r.userData.request&&r.userData.request.abort();var s=r.userData.image;r.userData.image&&(s.onload=s.onerror=s.onabort=null)},createTileCache:function(r,s,o){r._data=s},destroyTileCache:function(r){r._data=null,r._renderedContext=null},getTileCacheData:function(r){return r._data},getTileCacheDataAsImage:function(r){return r._data},getTileCacheDataAsContext2D:function(r){if(!r._renderedContext){var s=document.createElement("canvas");s.width=r._data.width,s.height=r._data.height,r._renderedContext=s.getContext("2d"),r._renderedContext.drawImage(r._data,0,0),r._data=null}return r._renderedContext}},t.extend(!0,t.TileSource.prototype,t.EventSource.prototype);function n(r){var s=r.responseText,o=r.status,a,l;if(r){if(r.status!==200&&r.status!==0)throw o=r.status,a=o===404?"Not Found":r.statusText,new Error(t.getString("Errors.Status",o,a))}else throw new Error(t.getString("Errors.Security"));if(s.match(/^\s*<.*/))try{l=r.responseXML&&r.responseXML.documentElement?r.responseXML:t.parseXml(s)}catch{l=r.responseText}else if(s.match(/\s*[{[].*/))try{l=t.parseJSON(s)}catch{l=s}else l=s;return l}t.TileSource.determineType=function(r,s,o){var a;for(a in e)if(a.match(/.+TileSource$/)&&t.isFunction(e[a])&&t.isFunction(e[a].prototype.supports)&&e[a].prototype.supports.call(r,s,o))return e[a];return t.console.error("No TileSource was able to open %s %s",o,s),null}}(e),function(t){t.DziTileSource=function(s,o,a,l,u,c,h,d,g){var A,p,y,v;if(t.isPlainObject(s)?v=s:v={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=v.tilesUrl,this.fileFormat=v.fileFormat,this.displayRects=v.displayRects,this.displayRects)for(A=this.displayRects.length-1;A>=0;A--)for(p=this.displayRects[A],y=p.minLevel;y<=p.maxLevel;y++)this._levelRects[y]||(this._levelRects[y]=[]),this._levelRects[y].push(p);t.TileSource.apply(this,[v])},t.extend(t.DziTileSource.prototype,t.TileSource.prototype,{supports:function(s,o){var a;return s.Image?a=s.Image.xmlns:s.documentElement&&(s.documentElement.localName==="Image"||s.documentElement.tagName==="Image")&&(a=s.documentElement.namespaceURI),a=(a||"").toLowerCase(),a.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||a.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(s,o,a){var l;return t.isPlainObject(s)?l=r(this,s):l=n(this,s),o&&!l.tilesUrl&&(l.tilesUrl=o.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),o.search(/\.(dzi|xml|js)\?/)!==-1?l.queryParams=o.match(/\?.*/):l.queryParams=""),l},getTileUrl:function(s,o,a){return[this.tilesUrl,s,"/",o,"_",a,".",this.fileFormat,this.queryParams].join("")},tileExists:function(s,o,a){var l=this._levelRects[s],u,c,h,d,g,A,p;if(this.minLevel&&s<this.minLevel||this.maxLevel&&s>this.maxLevel)return!1;if(!l||!l.length)return!0;for(p=l.length-1;p>=0;p--)if(u=l[p],!(s<u.minLevel||s>u.maxLevel)&&(c=this.getLevelScale(s),h=u.x*c,d=u.y*c,g=h+u.width*c,A=d+u.height*c,h=Math.floor(h/this._tileWidth),d=Math.floor(d/this._tileWidth),g=Math.ceil(g/this._tileWidth),A=Math.ceil(A/this._tileWidth),h<=o&&o<g&&d<=a&&a<A))return!0;return!1}});function n(s,o){if(!o||!o.documentElement)throw new Error(t.getString("Errors.Xml"));var a=o.documentElement,l=a.localName||a.tagName,u=o.documentElement.namespaceURI,c=null,h=[],d,g,A,p,y;if(l==="Image")try{if(p=a.getElementsByTagName("Size")[0],p===void 0&&(p=a.getElementsByTagNameNS(u,"Size")[0]),c={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:a.getAttribute("Url"),Format:a.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(a.getAttribute("Overlap"),10),TileSize:parseInt(a.getAttribute("TileSize"),10),Size:{Height:parseInt(p.getAttribute("Height"),10),Width:parseInt(p.getAttribute("Width"),10)}}},!t.imageFormatSupported(c.Image.Format))throw new Error(t.getString("Errors.ImageFormat",c.Image.Format.toUpperCase()));for(d=a.getElementsByTagName("DisplayRect"),d===void 0&&(d=a.getElementsByTagNameNS(u,"DisplayRect")[0]),y=0;y<d.length;y++)g=d[y],A=g.getElementsByTagName("Rect")[0],A===void 0&&(A=g.getElementsByTagNameNS(u,"Rect")[0]),h.push({Rect:{X:parseInt(A.getAttribute("X"),10),Y:parseInt(A.getAttribute("Y"),10),Width:parseInt(A.getAttribute("Width"),10),Height:parseInt(A.getAttribute("Height"),10),MinLevel:parseInt(g.getAttribute("MinLevel"),10),MaxLevel:parseInt(g.getAttribute("MaxLevel"),10)}});return h.length&&(c.Image.DisplayRect=h),r(s,c)}catch(I){throw I instanceof Error?I:new Error(t.getString("Errors.Dzi"))}else{if(l==="Collection")throw new Error(t.getString("Errors.Dzc"));if(l==="Error"){var v=a.getElementsByTagName("Message")[0],E=v.firstChild.nodeValue;throw new Error(E)}}throw new Error(t.getString("Errors.Dzi"))}function r(s,o){var a=o.Image,l=a.Url,u=a.Format,c=a.Size,h=a.DisplayRect||[],d=parseInt(c.Width,10),g=parseInt(c.Height,10),A=parseInt(a.TileSize,10),p=parseInt(a.Overlap,10),y=[],v,E;for(E=0;E<h.length;E++)v=h[E].Rect,y.push(new t.DisplayRect(parseInt(v.X,10),parseInt(v.Y,10),parseInt(v.Width,10),parseInt(v.Height,10),parseInt(v.MinLevel,10),parseInt(v.MaxLevel,10)));return t.extend(!0,{width:d,height:g,tileSize:A,tileOverlap:p,minLevel:null,maxLevel:null,tilesUrl:l,fileFormat:u,displayRects:y},o)}}(e),function(t){t.IIIFTileSource=function(a){if(t.extend(!0,this,a),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(a.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=a.version,this.tile_width&&this.tile_height)a.tileWidth=this.tile_width,a.tileHeight=this.tile_height;else if(this.tile_width)a.tileSize=this.tile_width;else if(this.tile_height)a.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)a.tileWidth=this.tiles[0].width,a.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var l=0;l<this.tiles.length;l++)for(var u=0;u<this.tiles[l].scaleFactors.length;u++){var c=this.tiles[l].scaleFactors[u];this.scale_factors.push(c),a.tileSizePerScaleFactor[c]={width:this.tiles[l].width,height:this.tiles[l].height||this.tiles[l].width}}}else if(n(a)){for(var h=Math.min(this.height,this.width),d=[256,512,1024],g=[],A=0;A<d.length;A++)d[A]<=h&&g.push(d[A]);g.length>0?a.tileSize=Math.max.apply(null,g):a.tileSize=h}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,a.levels=r(this),t.extend(!0,a,{width:a.levels[a.levels.length-1].width,height:a.levels[a.levels.length-1].height,tileSize:Math.max(a.height,a.width),tileOverlap:0,minLevel:0,maxLevel:a.levels.length-1}),this.levels=a.levels):t.console.error("Nothing in the info.json to construct image pyramids from");if(!a.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)a.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var p=Math.max.apply(null,this.scale_factors);a.maxLevel=Math.round(Math.log(p)*Math.LOG2E)}if(this.sizes){var y=this.sizes.length;(y===a.maxLevel||y===a.maxLevel+1)&&(this.levelSizes=this.sizes.slice().sort(function(v,E){return v.width-E.width}),y===a.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))}t.TileSource.apply(this,[a])},t.extend(t.IIIFTileSource.prototype,t.TileSource.prototype,{supports:function(a,l){return a.protocol&&a.protocol==="http://iiif.io/api/image"||a["@context"]&&(a["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||a["@context"]==="http://iiif.io/api/image/1/context.json")||a.profile&&a.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||a.identifier&&a.width&&a.height?!0:!!(a.documentElement&&a.documentElement.tagName==="info"&&a.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(a,l,u){if(t.isPlainObject(a)){if(!a["@context"])a["@context"]="http://iiif.io/api/image/1.0/context.json",a["@id"]=l.replace("/info.json",""),a.version=1;else{var h=a["@context"];if(Array.isArray(h)){for(var d=0;d<h.length;d++)if(typeof h[d]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(h[d])||h[d]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){h=h[d];break}}switch(h){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":a.version=1;break;case"http://iiif.io/api/image/2/context.json":a.version=2;break;case"http://iiif.io/api/image/3/context.json":a.version=3;break;default:t.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(a.preferredFormats){for(var g=0;g<a.preferredFormats.length;g++)if(e.imageFormatSupported(a.preferredFormats[g])){a.tileFormat=a.preferredFormats[g];break}}return a}else{var c=s(a);return c["@context"]="http://iiif.io/api/image/1.0/context.json",c["@id"]=l.replace("/info.xml",""),c.version=1,c}},getTileWidth:function(a){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileWidth.call(this,a);var l=Math.pow(2,this.maxLevel-a);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].width:this._tileWidth},getTileHeight:function(a){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileHeight.call(this,a);var l=Math.pow(2,this.maxLevel-a);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].height:this._tileHeight},getLevelScale:function(a){if(this.emulateLegacyImagePyramid){var l=NaN;return this.levels.length>0&&a>=this.minLevel&&a<=this.maxLevel&&(l=this.levels[a].width/this.levels[this.maxLevel].width),l}return t.TileSource.prototype.getLevelScale.call(this,a)},getNumTiles:function(a){if(this.emulateLegacyImagePyramid){var l=this.getLevelScale(a);return l?new t.Point(1,1):new t.Point(0,0)}if(this.levelSizes){var u=this.levelSizes[a],c=Math.ceil(u.width/this.getTileWidth(a)),h=Math.ceil(u.height/this.getTileHeight(a));return new t.Point(c,h)}else return t.TileSource.prototype.getNumTiles.call(this,a)},getTileAtPoint:function(a,l){if(this.emulateLegacyImagePyramid)return new t.Point(0,0);if(this.levelSizes){var u=l.x>=0&&l.x<=1&&l.y>=0&&l.y<=1/this.aspectRatio;t.console.assert(u,"[TileSource.getTileAtPoint] must be called with a valid point.");var c=this.levelSizes[a].width,h=l.x*c,d=l.y*c,g=Math.floor(h/this.getTileWidth(a)),A=Math.floor(d/this.getTileHeight(a));l.x>=1&&(g=this.getNumTiles(a).x-1);var p=1e-15;return l.y>=1/this.aspectRatio-p&&(A=this.getNumTiles(a).y-1),new t.Point(g,A)}return t.TileSource.prototype.getTileAtPoint.call(this,a,l)},getTileUrl:function(a,l,u){if(this.emulateLegacyImagePyramid){var c=null;return this.levels.length>0&&a>=this.minLevel&&a<=this.maxLevel&&(c=this.levels[a].url),c}var h="0",d=Math.pow(.5,this.maxLevel-a),g,A,p,y,v,E,I,C,w,S,x,T,Q,M,R,z;return this.levelSizes?(g=this.levelSizes[a].width,A=this.levelSizes[a].height):(g=Math.ceil(this.width*d),A=Math.ceil(this.height*d)),p=this.getTileWidth(a),y=this.getTileHeight(a),v=Math.round(p/d),E=Math.round(y/d),this.version===1?R="native."+this.tileFormat:R="default."+this.tileFormat,g<p&&A<y?(this.version===2&&g===this.width?T="full":this.version===3&&g===this.width&&A===this.height?T="max":this.version===3?T=g+","+A:T=g+",",I="full"):(C=l*v,w=u*E,S=Math.min(v,this.width-C),x=Math.min(E,this.height-w),l===0&&u===0&&S===this.width&&x===this.height?I="full":I=[C,w,S,x].join(","),Q=Math.min(p,g-l*p),M=Math.min(y,A-u*y),this.version===2&&Q===this.width?T="full":this.version===3&&Q===this.width&&M===this.height?T="max":this.version===3?T=Q+","+M:T=Q+","),z=[this._id,I,T,h,R].join("/"),z},__testonly__:{canBeTiled:n,constructLevels:r}});function n(a){var l=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],u=Array.isArray(a.profile)?a.profile[0]:a.profile,c=l.indexOf(u)!==-1,h=!1;return a.version===2&&a.profile.length>1&&a.profile[1].supports&&(h=a.profile[1].supports.indexOf("sizeByW")!==-1),a.version===3&&a.extraFeatures&&(h=a.extraFeatures.indexOf("sizeByWh")!==-1),!c||h}function r(a){for(var l=[],u=0;u<a.sizes.length;u++)l.push({url:a._id+"/full/"+a.sizes[u].width+","+(a.version===3?a.sizes[u].height:"")+"/0/default."+a.tileFormat,width:a.sizes[u].width,height:a.sizes[u].height});return l.sort(function(c,h){return c.width-h.width})}function s(a){if(!a||!a.documentElement)throw new Error(t.getString("Errors.Xml"));var l=a.documentElement,u=l.tagName,c=null;if(u==="info")try{return c={},o(l,c),c}catch(h){throw h instanceof Error?h:new Error(t.getString("Errors.IIIF"))}throw new Error(t.getString("Errors.IIIF"))}function o(a,l,u){var c,h;if(a.nodeType===3&&u)h=a.nodeValue.trim(),h.match(/^\d*$/)&&(h=Number(h)),l[u]?(t.isArray(l[u])||(l[u]=[l[u]]),l[u].push(h)):l[u]=h;else if(a.nodeType===1)for(c=0;c<a.childNodes.length;c++)o(a.childNodes[c],l,a.nodeName)}}(e),function(t){t.OsmTileSource=function(n,r,s,o,a){var l;t.isPlainObject(n)?l=n:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!l.width||!l.height)&&(l.width=65572864,l.height=65572864),l.tileSize||(l.tileSize=256,l.tileOverlap=0),l.tilesUrl||(l.tilesUrl="http://tile.openstreetmap.org/"),l.minLevel=8,t.TileSource.apply(this,[l])},t.extend(t.OsmTileSource.prototype,t.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="openstreetmaps"},configure:function(n,r,s){return n},getTileUrl:function(n,r,s){return this.tilesUrl+(n-8)+"/"+r+"/"+s+".png"}})}(e),function(t){t.TmsTileSource=function(n,r,s,o,a){var l;t.isPlainObject(n)?l=n:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var u=Math.ceil(l.width/256)*256,c=Math.ceil(l.height/256)*256,h;u>c?h=u/256:h=c/256,l.maxLevel=Math.ceil(Math.log(h)/Math.log(2))-1,l.tileSize=256,l.width=u,l.height=c,t.TileSource.apply(this,[l])},t.extend(t.TmsTileSource.prototype,t.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="tiledmapservice"},configure:function(n,r,s){return n},getTileUrl:function(n,r,s){var o=this.getNumTiles(n).y-1;return this.tilesUrl+n+"/"+r+"/"+(o-s)+".png"}})}(e),function(t){t.ZoomifyTileSource=function(n){typeof n.tileSize>"u"&&(n.tileSize=256),typeof n.fileFormat>"u"&&(n.fileFormat="jpg",this.fileFormat=n.fileFormat);var r={x:n.width,y:n.height};for(n.imageSizes=[{x:n.width,y:n.height}],n.gridSize=[this._getGridSize(n.width,n.height,n.tileSize)];parseInt(r.x,10)>n.tileSize||parseInt(r.y,10)>n.tileSize;)r.x=Math.floor(r.x/2),r.y=Math.floor(r.y/2),n.imageSizes.push({x:r.x,y:r.y}),n.gridSize.push(this._getGridSize(r.x,r.y,n.tileSize));n.imageSizes.reverse(),n.gridSize.reverse(),n.minLevel=0,n.maxLevel=n.gridSize.length-1,e.TileSource.apply(this,[n])},t.extend(t.ZoomifyTileSource.prototype,t.TileSource.prototype,{_getGridSize:function(n,r,s){return{x:Math.ceil(n/s),y:Math.ceil(r/s)}},_calculateAbsoluteTileNumber:function(n,r,s){for(var o=0,a={},l=0;l<n;l++)a=this.gridSize[l],o+=a.x*a.y;return a=this.gridSize[n],o+=a.x*s+r,o},supports:function(n,r){return n.type&&n.type==="zoomifytileservice"},configure:function(n,r,s){return n},getTileUrl:function(n,r,s){var o=0,a=this._calculateAbsoluteTileNumber(n,r,s);return o=Math.floor(a/256),this.tilesUrl+"TileGroup"+o+"/"+n+"-"+r+"-"+s+"."+this.fileFormat}})}(e),function(t){t.LegacyTileSource=function(o){var a,l,u;t.isArray(o)&&(a={type:"legacy-image-pyramid",levels:o}),a.levels=n(a.levels),a.levels.length>0?(l=a.levels[a.levels.length-1].width,u=a.levels[a.levels.length-1].height):(l=0,u=0,t.console.error("No supported image formats found")),t.extend(!0,a,{width:l,height:u,tileSize:Math.max(u,l),tileOverlap:0,minLevel:0,maxLevel:a.levels.length>0?a.levels.length-1:0}),t.TileSource.apply(this,[a]),this.levels=a.levels},t.extend(t.LegacyTileSource.prototype,t.TileSource.prototype,{supports:function(o,a){return o.type&&o.type==="legacy-image-pyramid"||o.documentElement&&o.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(o,a,l){var u;return t.isPlainObject(o)?u=s(this,o):u=r(this,o),u},getLevelScale:function(o){var a=NaN;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(a=this.levels[o].width/this.levels[this.maxLevel].width),a},getNumTiles:function(o){var a=this.getLevelScale(o);return a?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(o,a,l){var u=null;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(u=this.levels[o].url),u}});function n(o){var a=[],l,u;for(u=0;u<o.length;u++)l=o[u],l.height&&l.width&&l.url?a.push({url:l.url,width:Number(l.width),height:Number(l.height)}):t.console.error("Unsupported image format: %s",l.url?l.url:"<no URL>");return a.sort(function(c,h){return c.height-h.height})}function r(o,a){if(!a||!a.documentElement)throw new Error(t.getString("Errors.Xml"));var l=a.documentElement,u=l.tagName,c=null,h=[],d,g;if(u==="image")try{for(c={type:l.getAttribute("type"),levels:[]},h=l.getElementsByTagName("level"),g=0;g<h.length;g++)d=h[g],c.levels.push({url:d.getAttribute("url"),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10)});return s(o,c)}catch(A){throw A instanceof Error?A:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(u==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(u==="error")throw new Error("Error: "+a)}throw new Error("Unknown element "+u)}function s(o,a){return a.levels}}(e),function(t){t.ImageTileSource=function(n){n=t.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},n),t.TileSource.apply(this,[n])},t.extend(t.ImageTileSource.prototype,t.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="image"},configure:function(n,r,s){return n},getImageInfo:function(n){var r=this._image=new Image,s=this;this.crossOriginPolicy&&(r.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(r.useCredentials=this.ajaxWithCredentials),t.addEvent(r,"load",function(){s.width=r.naturalWidth,s.height=r.naturalHeight,s.aspectRatio=s.width/s.height,s.dimensions=new t.Point(s.width,s.height),s._tileWidth=s.width,s._tileHeight=s.height,s.tileOverlap=0,s.minLevel=0,s.levels=s._buildLevels(),s.maxLevel=s.levels.length-1,s.ready=!0,s.raiseEvent("ready",{tileSource:s})}),t.addEvent(r,"error",function(){s.raiseEvent("open-failed",{message:"Error loading image at "+n,source:n})}),r.src=n},getLevelScale:function(n){var r=NaN;return n>=this.minLevel&&n<=this.maxLevel&&(r=this.levels[n].width/this.levels[this.maxLevel].width),r},getNumTiles:function(n){var r=this.getLevelScale(n);return r?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(n,r,s){var o=null;return n>=this.minLevel&&n<=this.maxLevel&&(o=this.levels[n].url),o},getContext2D:function(n,r,s){var o=null;return n>=this.minLevel&&n<=this.maxLevel&&(o=this.levels[n].context2D),o},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var n=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!t.supportsCanvas||!this.useCanvas)return delete this._image,n;var r=this._image.naturalWidth,s=this._image.naturalHeight,o=document.createElement("canvas"),a=o.getContext("2d");if(o.width=r,o.height=s,a.drawImage(this._image,0,0,r,s),n[0].context2D=a,delete this._image,t.isCanvasTainted(o))return n;for(;r>=2&&s>=2;){r=Math.floor(r/2),s=Math.floor(s/2);var l=document.createElement("canvas"),u=l.getContext("2d");l.width=r,l.height=s,u.drawImage(o,0,0,r,s),n.splice(0,0,{context2D:u,width:r,height:s}),o=l,a=u}return n},_freeupCanvasMemory:function(){for(var n=0;n<this.levels.length;n++)this.levels[n].context2D&&(this.levels[n].context2D.canvas.height=0,this.levels[n].context2D.canvas.width=0)}})}(e),function(t){t.TileSourceCollection=function(n,r,s,o){t.console.error("TileSourceCollection is deprecated; use World instead")}}(e),function(t){t.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},t.Button=function(u){var c=this;t.EventSource.call(this),t.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},u),this.element=u.element||t.makeNeutralElement("div"),u.element||(this.imgRest=t.makeTransparentImage(this.srcRest),this.imgGroup=t.makeTransparentImage(this.srcGroup),this.imgHover=t.makeTransparentImage(this.srcHover),this.imgDown=t.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,t.setElementPointerEventsNone(this.imgRest),t.setElementPointerEventsNone(this.imgGroup),t.setElementPointerEventsNone(this.imgHover),t.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",t.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",t.Browser.vendor===t.BROWSERS.FIREFOX&&t.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=t.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new t.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(h){h.insideElementPressed?(a(c,t.ButtonState.DOWN),c.raiseEvent("enter",{originalEvent:h.originalEvent})):h.buttonDownAny||a(c,t.ButtonState.HOVER)},focusHandler:function(h){c.tracker.enterHandler(h),c.raiseEvent("focus",{originalEvent:h.originalEvent})},leaveHandler:function(h){l(c,t.ButtonState.GROUP),h.insideElementPressed&&c.raiseEvent("exit",{originalEvent:h.originalEvent})},blurHandler:function(h){c.tracker.leaveHandler(h),c.raiseEvent("blur",{originalEvent:h.originalEvent})},pressHandler:function(h){a(c,t.ButtonState.DOWN),c.raiseEvent("press",{originalEvent:h.originalEvent})},releaseHandler:function(h){h.insideElementPressed&&h.insideElementReleased?(l(c,t.ButtonState.HOVER),c.raiseEvent("release",{originalEvent:h.originalEvent})):h.insideElementPressed?l(c,t.ButtonState.GROUP):a(c,t.ButtonState.HOVER)},clickHandler:function(h){h.quick&&c.raiseEvent("click",{originalEvent:h.originalEvent})},keyHandler:function(h){h.keyCode===13?(c.raiseEvent("click",{originalEvent:h.originalEvent}),c.raiseEvent("release",{originalEvent:h.originalEvent}),h.preventDefault=!0):h.preventDefault=!1}}),l(this,t.ButtonState.REST)},t.extend(t.Button.prototype,t.EventSource.prototype,{notifyGroupEnter:function(){a(this,t.ButtonState.GROUP)},notifyGroupExit:function(){l(this,t.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),t.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),t.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function n(u){t.requestAnimationFrame(function(){r(u)})}function r(u){var c,h,d;u.shouldFade&&(c=t.now(),h=c-u.fadeBeginTime,d=1-h/u.fadeLength,d=Math.min(1,d),d=Math.max(0,d),u.imgGroup&&t.setElementOpacity(u.imgGroup,d,!0),d>0&&n(u))}function s(u){u.shouldFade=!0,u.fadeBeginTime=t.now()+u.fadeDelay,window.setTimeout(function(){n(u)},u.fadeDelay)}function o(u){u.shouldFade=!1,u.imgGroup&&t.setElementOpacity(u.imgGroup,1,!0)}function a(u,c){u.element.disabled||(c>=t.ButtonState.GROUP&&u.currentState===t.ButtonState.REST&&(o(u),u.currentState=t.ButtonState.GROUP),c>=t.ButtonState.HOVER&&u.currentState===t.ButtonState.GROUP&&(u.imgHover&&(u.imgHover.style.visibility=""),u.currentState=t.ButtonState.HOVER),c>=t.ButtonState.DOWN&&u.currentState===t.ButtonState.HOVER&&(u.imgDown&&(u.imgDown.style.visibility=""),u.currentState=t.ButtonState.DOWN))}function l(u,c){u.element.disabled||(c<=t.ButtonState.HOVER&&u.currentState===t.ButtonState.DOWN&&(u.imgDown&&(u.imgDown.style.visibility="hidden"),u.currentState=t.ButtonState.HOVER),c<=t.ButtonState.GROUP&&u.currentState===t.ButtonState.HOVER&&(u.imgHover&&(u.imgHover.style.visibility="hidden"),u.currentState=t.ButtonState.GROUP),c<=t.ButtonState.REST&&u.currentState===t.ButtonState.GROUP&&(s(u),u.currentState=t.ButtonState.REST))}}(e),function(t){t.ButtonGroup=function(n){t.extend(!0,this,{buttons:[],clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},n);var r=this.buttons.concat([]),s=this,o;if(this.element=n.element||t.makeNeutralElement("div"),!n.group)for(this.element.style.display="inline-block",o=0;o<r.length;o++)this.element.appendChild(r[o].element);t.setElementTouchActionNone(this.element),this.tracker=new t.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(a){var l;for(l=0;l<s.buttons.length;l++)s.buttons[l].notifyGroupEnter()},leaveHandler:function(a){var l;if(!a.insideElementPressed)for(l=0;l<s.buttons.length;l++)s.buttons[l].notifyGroupExit()}})},t.ButtonGroup.prototype={addButton:function(n){this.buttons.push(n),this.element.appendChild(n.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var n=this.buttons.pop();this.element.removeChild(n.element),n.destroy()}this.tracker.destroy(),this.element=null}}}(e),function(t){t.Rect=function(n,r,s,o,a){this.x=typeof n=="number"?n:0,this.y=typeof r=="number"?r:0,this.width=typeof s=="number"?s:0,this.height=typeof o=="number"?o:0,this.degrees=typeof a=="number"?a:0,this.degrees=t.positiveModulo(this.degrees,360);var l,u;this.degrees>=270?(l=this.getTopRight(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=270):this.degrees>=180?(l=this.getBottomRight(),this.x=l.x,this.y=l.y,this.degrees-=180):this.degrees>=90&&(l=this.getBottomLeft(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=90)},t.Rect.fromSummits=function(n,r,s){var o=n.distanceTo(r),a=n.distanceTo(s),l=r.minus(n),u=Math.atan(l.y/l.x);return l.x<0?u+=Math.PI:l.y<0&&(u+=2*Math.PI),new t.Rect(n.x,n.y,o,a,u/Math.PI*180)},t.Rect.prototype={clone:function(){return new t.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new t.Point(this.x,this.y)},getBottomRight:function(){return new t.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new t.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new t.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new t.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new t.Point(this.width,this.height)},equals:function(n){return n instanceof t.Rect&&this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height&&this.degrees===n.degrees},times:function(n){return new t.Rect(this.x*n,this.y*n,this.width*n,this.height*n,this.degrees)},translate:function(n){return new t.Rect(this.x+n.x,this.y+n.y,this.width,this.height,this.degrees)},union:function(n){var r=this.getBoundingBox(),s=n.getBoundingBox(),o=Math.min(r.x,s.x),a=Math.min(r.y,s.y),l=Math.max(r.x+r.width,s.x+s.width),u=Math.max(r.y+r.height,s.y+s.height);return new t.Rect(o,a,l-o,u-a)},intersection:function(n){var r=1e-10,s=[],o=this.getTopLeft();n.containsPoint(o,r)&&s.push(o);var a=this.getTopRight();n.containsPoint(a,r)&&s.push(a);var l=this.getBottomLeft();n.containsPoint(l,r)&&s.push(l);var u=this.getBottomRight();n.containsPoint(u,r)&&s.push(u);var c=n.getTopLeft();this.containsPoint(c,r)&&s.push(c);var h=n.getTopRight();this.containsPoint(h,r)&&s.push(h);var d=n.getBottomLeft();this.containsPoint(d,r)&&s.push(d);var g=n.getBottomRight();this.containsPoint(g,r)&&s.push(g);for(var A=this._getSegments(),p=n._getSegments(),y=0;y<A.length;y++)for(var v=A[y],E=0;E<p.length;E++){var I=p[E],C=w(v[0],v[1],I[0],I[1]);C&&s.push(C)}function w(z,q,X,N){var G=q.minus(z),j=N.minus(X),V=-j.x*G.y+G.x*j.y;if(V===0)return null;var Z=(G.x*(z.y-X.y)-G.y*(z.x-X.x))/V,Y=(j.x*(z.y-X.y)-j.y*(z.x-X.x))/V;return-r<=Z&&Z<=1-r&&-r<=Y&&Y<=1-r?new t.Point(z.x+Y*G.x,z.y+Y*G.y):null}if(s.length===0)return null;for(var S=s[0].x,x=s[0].x,T=s[0].y,Q=s[0].y,M=1;M<s.length;M++){var R=s[M];R.x<S&&(S=R.x),R.x>x&&(x=R.x),R.y<T&&(T=R.y),R.y>Q&&(Q=R.y)}return new t.Rect(S,T,x-S,Q-T)},_getSegments:function(){var n=this.getTopLeft(),r=this.getTopRight(),s=this.getBottomLeft(),o=this.getBottomRight();return[[n,r],[r,o],[o,s],[s,n]]},rotate:function(n,r){if(n=t.positiveModulo(n,360),n===0)return this.clone();r=r||this.getCenter();var s=this.getTopLeft().rotate(n,r),o=this.getTopRight().rotate(n,r),a=o.minus(s);a=a.apply(function(u){var c=1e-15;return Math.abs(u)<c?0:u});var l=Math.atan(a.y/a.x);return a.x<0?l+=Math.PI:a.y<0&&(l+=2*Math.PI),new t.Rect(s.x,s.y,this.width,this.height,l/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var n=this.getTopLeft(),r=this.getTopRight(),s=this.getBottomLeft(),o=this.getBottomRight(),a=Math.min(n.x,r.x,s.x,o.x),l=Math.max(n.x,r.x,s.x,o.x),u=Math.min(n.y,r.y,s.y,o.y),c=Math.max(n.y,r.y,s.y,o.y);return new t.Rect(a,u,l-a,c-u)},getIntegerBoundingBox:function(){var n=this.getBoundingBox(),r=Math.floor(n.x),s=Math.floor(n.y),o=Math.ceil(n.width+n.x-r),a=Math.ceil(n.height+n.y-s);return new t.Rect(r,s,o,a)},containsPoint:function(n,r){r=r||0;var s=this.getTopLeft(),o=this.getTopRight(),a=this.getBottomLeft(),l=o.minus(s),u=a.minus(s);return(n.x-s.x)*l.x+(n.y-s.y)*l.y>=-r&&(n.x-o.x)*l.x+(n.y-o.y)*l.y<=r&&(n.x-s.x)*u.x+(n.y-s.y)*u.y>=-r&&(n.x-a.x)*u.x+(n.y-a.y)*u.y<=r},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(e),function(t){var n={};t.ReferenceStrip=function(d){var g=this,A=d.viewer,p=t.getElementSize(A.element),y,v,E;for(d.id||(d.id="referencestrip-"+t.now(),this.element=t.makeNeutralElement("div"),this.element.id=d.id,this.element.className="referencestrip"),d=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.referenceStripSizeRatio,position:t.DEFAULT_SETTINGS.referenceStripPosition,scroll:t.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold},d,{element:this.element}),t.extend(this,d),n[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,v=this.element.style,v.marginTop="0px",v.marginRight="0px",v.marginBottom="0px",v.marginLeft="0px",v.left="0px",v.bottom="0px",v.border="0px",v.background="#000",v.position="relative",t.setElementTouchActionNone(this.element),t.setElementOpacity(this.element,.8),this.viewer=A,this.tracker=new t.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:t.delegate(this,r),dragHandler:t.delegate(this,s),scrollHandler:t.delegate(this,o),enterHandler:t.delegate(this,l),leaveHandler:t.delegate(this,u),keyDownHandler:t.delegate(this,c),keyHandler:t.delegate(this,h),preProcessEventHandler:function(I){I.eventType==="wheel"&&(I.preventDefault=!0)}}),d.width&&d.height?(this.element.style.width=d.width+"px",this.element.style.height=d.height+"px",A.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):d.scroll==="horizontal"?(this.element.style.width=p.x*d.sizeRatio*A.tileSources.length+12*A.tileSources.length+"px",this.element.style.height=p.y*d.sizeRatio+"px",A.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=p.y*d.sizeRatio*A.tileSources.length+12*A.tileSources.length+"px",this.element.style.width=p.x*d.sizeRatio+"px",A.addControl(this.element,{anchor:t.ControlAnchor.TOP_LEFT})),this.panelWidth=p.x*this.sizeRatio+8,this.panelHeight=p.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},E=0;E<A.tileSources.length;E++)y=t.makeNeutralElement("div"),y.id=this.element.id+"-"+E,y.style.width=g.panelWidth+"px",y.style.height=g.panelHeight+"px",y.style.display="inline",y.style.float="left",y.style.cssFloat="left",y.style.styleFloat="left",y.style.padding="2px",t.setElementTouchActionNone(y),t.setElementPointerEventsNone(y),this.element.appendChild(y),y.activePanel=!1,this.panels.push(y);a(this,this.scroll==="vertical"?p.y:p.x,0),this.setFocus(0)},t.ReferenceStrip.prototype={setFocus:function(d){var g=this.element.querySelector("#"+this.element.id+"-"+d),A=t.getElementSize(this.viewer.canvas),p=Number(this.element.style.width.replace("px","")),y=Number(this.element.style.height.replace("px","")),v=-Number(this.element.style.marginLeft.replace("px","")),E=-Number(this.element.style.marginTop.replace("px","")),I;this.currentSelected!==g&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=g,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(I=Number(d)*(this.panelWidth+3),I>v+A.x-this.panelWidth?(I=Math.min(I,p-A.x),this.element.style.marginLeft=-I+"px",a(this,A.x,-I)):I<v&&(I=Math.max(0,I-A.x/2),this.element.style.marginLeft=-I+"px",a(this,A.x,-I))):(I=Number(d)*(this.panelHeight+3),I>E+A.y-this.panelHeight?(I=Math.min(I,y-A.y),this.element.style.marginTop=-I+"px",a(this,A.y,-I)):I<E&&(I=Math.max(0,I-A.y/2),this.element.style.marginTop=-I+"px",a(this,A.y,-I))),this.currentPage=d,l.call(this,{eventSource:this.tracker}))},update:function(){return!!n[this.id].animating},destroy:function(){if(this.miniViewers)for(var d in this.miniViewers)this.miniViewers[d].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function r(d){if(d.quick){var g;this.scroll==="horizontal"?g=Math.floor(d.position.x/(this.panelWidth+4)):g=Math.floor(d.position.y/this.panelHeight),this.viewer.goToPage(g)}this.element.focus()}function s(d){if(this.dragging=!0,this.element){var g=Number(this.element.style.marginLeft.replace("px","")),A=Number(this.element.style.marginTop.replace("px","")),p=Number(this.element.style.width.replace("px","")),y=Number(this.element.style.height.replace("px","")),v=t.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-d.delta.x>0?g>-(p-v.x)&&(this.element.style.marginLeft=g+d.delta.x*2+"px",a(this,v.x,g+d.delta.x*2)):-d.delta.x<0&&g<0&&(this.element.style.marginLeft=g+d.delta.x*2+"px",a(this,v.x,g+d.delta.x*2)):-d.delta.y>0?A>-(y-v.y)&&(this.element.style.marginTop=A+d.delta.y*2+"px",a(this,v.y,A+d.delta.y*2)):-d.delta.y<0&&A<0&&(this.element.style.marginTop=A+d.delta.y*2+"px",a(this,v.y,A+d.delta.y*2))}}function o(d){if(this.element){var g=Number(this.element.style.marginLeft.replace("px","")),A=Number(this.element.style.marginTop.replace("px","")),p=Number(this.element.style.width.replace("px","")),y=Number(this.element.style.height.replace("px","")),v=t.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?d.scroll>0?g>-(p-v.x)&&(this.element.style.marginLeft=g-d.scroll*60+"px",a(this,v.x,g-d.scroll*60)):d.scroll<0&&g<0&&(this.element.style.marginLeft=g-d.scroll*60+"px",a(this,v.x,g-d.scroll*60)):d.scroll<0?A>v.y-y&&(this.element.style.marginTop=A+d.scroll*60+"px",a(this,v.y,A+d.scroll*60)):d.scroll>0&&A<0&&(this.element.style.marginTop=A+d.scroll*60+"px",a(this,v.y,A+d.scroll*60)),d.preventDefault=!0}}function a(d,g,A){var p,y,v,E,I,C;for(d.scroll==="horizontal"?p=d.panelWidth:p=d.panelHeight,y=Math.ceil(g/p)+5,v=Math.ceil((Math.abs(A)+g)/p)+1,y=v-y,y=y<0?0:y,I=y;I<v&&I<d.panels.length;I++)if(C=d.panels[I],!C.activePanel){var w,S=d.viewer.tileSources[I];S.referenceStripThumbnailUrl?w={type:"image",url:S.referenceStripThumbnailUrl}:w=S,E=new t.Viewer({id:C.id,tileSources:[w],element:C,navigatorSizeRatio:d.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:d.viewer.loadTilesWithAjax,ajaxHeaders:d.viewer.ajaxHeaders,useCanvas:d.useCanvas}),t.setElementPointerEventsNone(E.canvas),t.setElementPointerEventsNone(E.container),E.innerTracker.setTracking(!1),E.outerTracker.setTracking(!1),d.miniViewers[C.id]=E,C.activePanel=!0}}function l(d){var g=d.eventSource.element;this.scroll==="horizontal"?g.style.marginBottom="0px":g.style.marginLeft="0px"}function u(d){var g=d.eventSource.element;this.scroll==="horizontal"?g.style.marginBottom="-"+t.getElementSize(g).y/2+"px":g.style.marginLeft="-"+t.getElementSize(g).x/2+"px"}function c(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 38:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 40:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 37:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 39:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}function h(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 61:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 45:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 48:case 119:case 87:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 115:case 83:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 97:o.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 100:o.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}}(e),function(t){t.DisplayRect=function(n,r,s,o,a,l){t.Rect.apply(this,[n,r,s,o]),this.minLevel=a,this.maxLevel=l},t.extend(t.DisplayRect.prototype,t.Rect.prototype)}(e),function(t){t.Spring=function(r){var s=arguments;typeof r!="object"&&(r={initial:s.length&&typeof s[0]=="number"?s[0]:void 0,springStiffness:s.length>1?s[1].springStiffness:5,animationTime:s.length>1?s[1].animationTime:1.5}),t.console.assert(typeof r.springStiffness=="number"&&r.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),t.console.assert(typeof r.animationTime=="number"&&r.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),r.exponential&&(this._exponential=!0,delete r.exponential),t.extend(!0,this,r),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:t.now()},t.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},t.Spring.prototype={resetTo:function(r){t.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=r,this.start.time=this.target.time=this.current.time=t.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(r){t.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=r,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(r){this.start.value+=r,this.target.value+=r,this._exponential&&(t.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(r){this._exponential=r,this._exponential&&(t.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=t.now();var r,s;this._exponential?(r=this.start._logValue,s=this.target._logValue):(r=this.start.value,s=this.target.value);var o=this.current.time>=this.target.time?s:r+(s-r)*n(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),a=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,a!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function n(r,s){return(1-Math.exp(r*-s))/(1-Math.exp(-r))}}(e),function(t){t.ImageJob=function(r){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},r),this.data=null,this.userData={},this.errorMsg=null},t.ImageJob.prototype={start:function(){this.tries++;var r=this,s=this.abort;this.jobId=window.setTimeout(function(){r.finish(null,null,"Image load exceeded timeout ("+r.timeout+" ms)")},this.timeout),this.abort=function(){r.source.downloadTileAbort(r),typeof s=="function"&&s()},this.source.downloadTileStart(this)},finish:function(r,s,o){this.data=r,this.request=s,this.errorMsg=o,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(r){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},r)},t.ImageLoader.prototype={addJob:function(r){if(!r.source){t.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var s=t.TileSource.prototype;r.source={downloadTileStart:s.downloadTileStart,downloadTileAbort:s.downloadTileAbort}}var o=this,a=function(c){n(o,c,r.callback)},l={src:r.src,tile:r.tile||{},source:r.source,loadWithAjax:r.loadWithAjax,ajaxHeaders:r.loadWithAjax?r.ajaxHeaders:null,crossOriginPolicy:r.crossOriginPolicy,ajaxWithCredentials:r.ajaxWithCredentials,postData:r.postData,callback:a,abort:r.abort,timeout:this.timeout},u=new t.ImageJob(l);!this.jobLimit||this.jobsInProgress<this.jobLimit?(u.start(),this.jobsInProgress++):this.jobQueue.push(u)},clear:function(){for(var r=0;r<this.jobQueue.length;r++){var s=this.jobQueue[r];typeof s.abort=="function"&&s.abort()}this.jobQueue=[]}};function n(r,s,o){s.errorMsg!==""&&(s.data===null||s.data===void 0)&&s.tries<1+r.tileRetryMax&&r.failedTiles.push(s);var a;r.jobsInProgress--,(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.jobQueue.length>0&&(a=r.jobQueue.shift(),a.start(),r.jobsInProgress++),r.tileRetryMax>0&&r.jobQueue.length===0&&(!r.jobLimit||r.jobsInProgress<r.jobLimit)&&r.failedTiles.length>0&&(a=r.failedTiles.shift(),setTimeout(function(){a.start()},r.tileRetryDelay),r.jobsInProgress++),o(s.data,s.errorMsg,s.request)}}(e),function(t){t.Tile=function(n,r,s,o,a,l,u,c,h,d,g,A){this.level=n,this.x=r,this.y=s,this.bounds=o,this.sourceBounds=d,this.exists=a,this._url=l,this.postData=g,this.context2D=u,this.loadWithAjax=c,this.ajaxHeaders=h,A===void 0&&(t.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),A=t.TileSource.prototype.getTileHashKey(n,r,s,l,h,g)),this.cacheKey=A,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},t.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},drawHTML:function(n){if(!this.cacheImageRecord){t.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}if(!this.element){var r=this.getImage();if(!r)return;this.element=t.makeNeutralElement("div"),this.imgElement=r.cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"}this.element.parentNode!==n&&n.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),t.setElementOpacity(this.element,this.opacity)},get image(){return t.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return t.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord.getRenderedContext()},drawCanvas:function(n,r,s,o,a,l){var u=this.position.times(t.pixelDensityRatio),c=this.size.times(t.pixelDensityRatio),h;if(!this.context2D&&!this.cacheImageRecord){t.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(h=this.getCanvasContext(),!this.loaded||!h){t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}n.save(),n.globalAlpha=this.opacity,typeof s=="number"&&s!==1&&(u=u.times(s),c=c.times(s)),o instanceof t.Point&&(u=u.plus(o)),n.globalAlpha===1&&this.hasTransparency&&(a&&(u.x=Math.round(u.x),u.y=Math.round(u.y),c.x=Math.round(c.x),c.y=Math.round(c.y)),n.clearRect(u.x,u.y,c.x,c.y)),r({context:n,tile:this,rendered:h});var d,g;this.sourceBounds?(d=Math.min(this.sourceBounds.width,h.canvas.width),g=Math.min(this.sourceBounds.height,h.canvas.height)):(d=h.canvas.width,g=h.canvas.height),n.translate(u.x+c.x/2,0),this.flipped&&n.scale(-1,1),n.drawImage(h.canvas,0,0,d,g,-c.x/2,u.y,c.x,c.y),n.restore()},getScaleForEdgeSmoothing:function(){var n;if(this.cacheImageRecord)n=this.cacheImageRecord.getRenderedContext();else if(this.context2D)n=this.context2D;else return t.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return n.canvas.width/(this.size.x*t.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(n,r,s){var o=Math.max(1,Math.ceil((s.x-r.x)/2)),a=Math.max(1,Math.ceil((s.y-r.y)/2));return new t.Point(o,a).minus(this.position.times(t.pixelDensityRatio).times(n||1).apply(function(l){return l%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(e),function(t){t.OverlayPlacement=t.Placement,t.OverlayRotationMode=t.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),t.Overlay=function(n,r,s){var o;t.isPlainObject(n)?o=n:o={element:n,location:r,placement:s},this.element=o.element,this.style=o.element.style,this._init(o)},t.Overlay.prototype={_init:function(n){this.location=n.location,this.placement=n.placement===void 0?t.Placement.TOP_LEFT:n.placement,this.onDraw=n.onDraw,this.checkResize=n.checkResize===void 0?!0:n.checkResize,this.width=n.width===void 0?null:n.width,this.height=n.height===void 0?null:n.height,this.rotationMode=n.rotationMode||t.OverlayRotationMode.EXACT,this.location instanceof t.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=t.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new t.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(n,r){var s=t.Placement.properties[this.placement];s&&(s.isHorizontallyCentered?n.x-=r.x/2:s.isRight&&(n.x-=r.x),s.isVerticallyCentered?n.y-=r.y/2:s.isBottom&&(n.y-=r.y))},destroy:function(){var n=this.element,r=this.style;n.parentNode&&(n.parentNode.removeChild(n),n.prevElementParent&&(r.display="none",document.body.appendChild(n))),this.onDraw=null,r.top="",r.left="",r.position="",this.width!==null&&(r.width=""),this.height!==null&&(r.height="");var s=t.getCssPropertyWithVendorPrefix("transformOrigin"),o=t.getCssPropertyWithVendorPrefix("transform");s&&o&&(r[s]="",r[o]="")},drawHTML:function(n,r){var s=this.element;s.parentNode!==n&&(s.prevElementParent=s.parentNode,s.prevNextSibling=s.nextSibling,n.appendChild(s),this.style.position="absolute",this.size=t.getElementSize(s));var o=this._getOverlayPositionAndSize(r),a=o.position,l=this.size=o.size,u=o.rotate;if(this.onDraw)this.onDraw(a,l,this.element);else{var c=this.style;c.left=a.x+"px",c.top=a.y+"px",this.width!==null&&(c.width=l.x+"px"),this.height!==null&&(c.height=l.y+"px");var h=t.getCssPropertyWithVendorPrefix("transformOrigin"),d=t.getCssPropertyWithVendorPrefix("transform");h&&d&&(u?(c[h]=this._getTransformOrigin(),c[d]="rotate("+u+"deg)"):(c[h]="",c[d]="")),c.display="block"}},_getOverlayPositionAndSize:function(n){var r=n.pixelFromPoint(this.location,!0),s=this._getSizeInPixels(n);this.adjust(r,s);var o=0;if(n.getRotation(!0)&&this.rotationMode!==t.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var a=new t.Rect(r.x,r.y,s.x,s.y),l=this._getBoundingBox(a,n.getRotation(!0));r=l.getTopLeft(),s=l.getSize()}else o=n.getRotation(!0);return{position:r,size:s,rotate:o}},_getSizeInPixels:function(n){var r=this.size.x,s=this.size.y;if(this.width!==null||this.height!==null){var o=n.deltaPixelsFromPointsNoRotate(new t.Point(this.width||0,this.height||0),!0);this.width!==null&&(r=o.x),this.height!==null&&(s=o.y)}if(this.checkResize&&(this.width===null||this.height===null)){var a=this.size=t.getElementSize(this.element);this.width===null&&(r=a.x),this.height===null&&(s=a.y)}return new t.Point(r,s)},_getBoundingBox:function(n,r){var s=this._getPlacementPoint(n);return n.rotate(r,s).getBoundingBox()},_getPlacementPoint:function(n){var r=new t.Point(n.x,n.y),s=t.Placement.properties[this.placement];return s&&(s.isHorizontallyCentered?r.x+=n.width/2:s.isRight&&(r.x+=n.width),s.isVerticallyCentered?r.y+=n.height/2:s.isBottom&&(r.y+=n.height)),r},_getTransformOrigin:function(){var n="",r=t.Placement.properties[this.placement];return r&&(r.isLeft?n="left":r.isRight&&(n="right"),r.isTop?n+=" top":r.isBottom&&(n+=" bottom")),n},update:function(n,r){var s=t.isPlainObject(n)?n:{location:n,placement:r};this._init({location:s.location||this.location,placement:s.placement!==void 0?s.placement:this.placement,onDraw:s.onDraw||this.onDraw,checkResize:s.checkResize||this.checkResize,width:s.width!==void 0?s.width:this.width,height:s.height!==void 0?s.height:this.height,rotationMode:s.rotationMode||this.rotationMode})},getBounds:function(n){t.console.assert(n,"A viewport must now be passed to Overlay.getBounds.");var r=this.width,s=this.height;if(r===null||s===null){var o=n.deltaPointsFromPixelsNoRotate(this.size,!0);r===null&&(r=o.x),s===null&&(s=o.y)}var a=this.location.clone();return this.adjust(a,new t.Point(r,s)),this._adjustBoundsForRotation(n,new t.Rect(a.x,a.y,r,s))},_adjustBoundsForRotation:function(n,r){if(!n||n.getRotation(!0)===0||this.rotationMode===t.OverlayRotationMode.EXACT)return r;if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return r;var s=this._getOverlayPositionAndSize(n);return n.viewerElementToViewportRectangle(new t.Rect(s.position.x,s.position.y,s.size.x,s.size.y))}return r.rotate(-n.getRotation(!0),this._getPlacementPoint(r))}}}(e),function(t){t.Drawer=function(n){t.console.assert(n.viewer,"[Drawer] options.viewer is required");var r=arguments;if(t.isPlainObject(n)||(n={source:r[0],viewport:r[1],element:r[2]}),t.console.assert(n.viewport,"[Drawer] options.viewport is required"),t.console.assert(n.element,"[Drawer] options.element is required"),n.source&&t.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=n.viewer,this.viewport=n.viewport,this.debugGridColor=typeof n.debugGridColor=="string"?[n.debugGridColor]:n.debugGridColor||t.DEFAULT_SETTINGS.debugGridColor,n.opacity&&t.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=t.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=t.getElement(n.element),this.canvas=t.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var s=this._calculateCanvasSize();this.canvas.width=s.x,this.canvas.height=s.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",t.setElementOpacity(this.canvas,this.opacity,!0),t.setElementPointerEventsNone(this.canvas),t.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},t.Drawer.prototype={addOverlay:function(n,r,s,o){return t.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(n,r,s,o),this},updateOverlay:function(n,r,s){return t.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(n,r,s),this},removeOverlay:function(n){return t.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(n),this},clearOverlays:function(){return t.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(n){var r=this.viewport.pixelFromPointNoRotate(n,!0);return new t.Point(r.x*t.pixelDensityRatio,r.y*t.pixelDensityRatio)},clipWithPolygons:function(n,r){if(this.useCanvas){var s=this._getContext(r);s.beginPath(),n.forEach(function(o){o.forEach(function(a,l){s[l===0?"moveTo":"lineTo"](a.x,a.y)})}),s.clip()}},setOpacity:function(n){t.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var r=this.viewer.world,s=0;s<r.getItemCount();s++)r.getItemAt(s).setOpacity(n);return this},getOpacity:function(){t.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var n=this.viewer.world,r=0,s=0;s<n.getItemCount();s++){var o=n.getItemAt(s).getOpacity();o>r&&(r=o)}return r},needsUpdate:function(){return t.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return t.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return t.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return t.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var n=this._calculateCanvasSize();if((this.canvas.width!==n.x||this.canvas.height!==n.y)&&(this.canvas.width=n.x,this.canvas.height=n.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var r=this._calculateSketchCanvasSize();this.sketchCanvas.width=r.x,this.sketchCanvas.height=r.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(n,r){if(this.useCanvas){var s=this._getContext(n);if(r)s.clearRect(r.x,r.y,r.width,r.height);else{var o=s.canvas;s.clearRect(0,0,o.width,o.height)}}},viewportToDrawerRectangle:function(n){var r=this.viewport.pixelFromPointNoRotate(n.getTopLeft(),!0),s=this.viewport.deltaPixelsFromPointsNoRotate(n.getSize(),!0);return new t.Rect(r.x*t.pixelDensityRatio,r.y*t.pixelDensityRatio,s.x*t.pixelDensityRatio,s.y*t.pixelDensityRatio)},drawTile:function(n,r,s,o,a,l,u){if(t.console.assert(n,"[Drawer.drawTile] tile is required"),t.console.assert(r,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var c=this._getContext(s);o=o||1,n.drawCanvas(c,r,o,a,l,u)}else n.drawHTML(this.canvas)},_getContext:function(n){var r=this.context;if(n){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var s=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=s.x,this.sketchCanvas.height=s.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var o=this;this.viewer.addHandler("rotate",function a(){if(o.viewport.getRotation()!==0){o.viewer.removeHandler("rotate",a);var l=o._calculateSketchCanvasSize();o.sketchCanvas.width=l.x,o.sketchCanvas.height=l.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}r=this.sketchContext}return r},saveContext:function(n){this.useCanvas&&this._getContext(n).save()},restoreContext:function(n){this.useCanvas&&this._getContext(n).restore()},setClip:function(n,r){if(this.useCanvas){var s=this._getContext(r);s.beginPath(),s.rect(n.x,n.y,n.width,n.height),s.clip()}},drawRectangle:function(n,r,s){if(this.useCanvas){var o=this._getContext(s);o.save(),o.fillStyle=r,o.fillRect(n.x,n.y,n.width,n.height),o.restore()}},blendSketch:function(n,r,s,o){var a=n;if(t.isPlainObject(a)||(a={opacity:n,scale:r,translate:s,compositeOperation:o}),!(!this.useCanvas||!this.sketchCanvas)){n=a.opacity,o=a.compositeOperation;var l=a.bounds;if(this.context.save(),this.context.globalAlpha=n,o&&(this.context.globalCompositeOperation=o),l)l.x<0&&(l.width+=l.x,l.x=0),l.x+l.width>this.canvas.width&&(l.width=this.canvas.width-l.x),l.y<0&&(l.height+=l.y,l.y=0),l.y+l.height>this.canvas.height&&(l.height=this.canvas.height-l.y),this.context.drawImage(this.sketchCanvas,l.x,l.y,l.width,l.height,l.x,l.y,l.width,l.height);else{r=a.scale||1,s=a.translate;var u=s instanceof t.Point?s:new t.Point(0,0),c=0,h=0;if(s){var d=this.sketchCanvas.width-this.canvas.width,g=this.sketchCanvas.height-this.canvas.height;c=Math.round(d/2),h=Math.round(g/2)}this.context.drawImage(this.sketchCanvas,u.x-c*r,u.y-h*r,(this.canvas.width+2*c)*r,(this.canvas.height+2*h)*r,-c,-h,this.canvas.width+2*c,this.canvas.height+2*h)}this.context.restore()}},drawDebugInfo:function(n,r,s,o){if(this.useCanvas){var a=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,l=this.context;l.save(),l.lineWidth=2*t.pixelDensityRatio,l.font="small-caps bold "+13*t.pixelDensityRatio+"px arial",l.strokeStyle=this.debugGridColor[a],l.fillStyle=this.debugGridColor[a],this.viewport.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:this.viewport.getRotation(!0)}),o.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:o.getRotation(!0),point:o.viewport.pixelFromPointNoRotate(o._getRotationPoint(!0),!0)}),o.viewport.getRotation(!0)%360===0&&o.getRotation(!0)%360===0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),l.strokeRect(n.position.x*t.pixelDensityRatio,n.position.y*t.pixelDensityRatio,n.size.x*t.pixelDensityRatio,n.size.y*t.pixelDensityRatio);var u=(n.position.x+n.size.x/2)*t.pixelDensityRatio,c=(n.position.y+n.size.y/2)*t.pixelDensityRatio;l.translate(u,c),l.rotate(Math.PI/180*-this.viewport.getRotation(!0)),l.translate(-u,-c),n.x===0&&n.y===0&&(l.fillText("Zoom: "+this.viewport.getZoom(),n.position.x*t.pixelDensityRatio,(n.position.y-30)*t.pixelDensityRatio),l.fillText("Pan: "+this.viewport.getBounds().toString(),n.position.x*t.pixelDensityRatio,(n.position.y-20)*t.pixelDensityRatio)),l.fillText("Level: "+n.level,(n.position.x+10)*t.pixelDensityRatio,(n.position.y+20)*t.pixelDensityRatio),l.fillText("Column: "+n.x,(n.position.x+10)*t.pixelDensityRatio,(n.position.y+30)*t.pixelDensityRatio),l.fillText("Row: "+n.y,(n.position.x+10)*t.pixelDensityRatio,(n.position.y+40)*t.pixelDensityRatio),l.fillText("Order: "+s+" of "+r,(n.position.x+10)*t.pixelDensityRatio,(n.position.y+50)*t.pixelDensityRatio),l.fillText("Size: "+n.size.toString(),(n.position.x+10)*t.pixelDensityRatio,(n.position.y+60)*t.pixelDensityRatio),l.fillText("Position: "+n.position.toString(),(n.position.x+10)*t.pixelDensityRatio,(n.position.y+70)*t.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.viewport.getRotation(!0)%360===0&&o.getRotation(!0)%360===0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),l.restore()}},debugRect:function(n){if(this.useCanvas){var r=this.context;r.save(),r.lineWidth=2*t.pixelDensityRatio,r.strokeStyle=this.debugGridColor[0],r.fillStyle=this.debugGridColor[0],r.strokeRect(n.x*t.pixelDensityRatio,n.y*t.pixelDensityRatio,n.width*t.pixelDensityRatio,n.height*t.pixelDensityRatio),r.restore()}},setImageSmoothingEnabled:function(n){this.useCanvas&&(this._imageSmoothingEnabled=n,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(n){n.msImageSmoothingEnabled=this._imageSmoothingEnabled,n.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(n){var r=this._getContext(n).canvas;return new t.Point(r.width,r.height)},getCanvasCenter:function(){return new t.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(n){var r=n.point?n.point.times(t.pixelDensityRatio):this.getCanvasCenter(),s=this._getContext(n.useSketch);s.save(),s.translate(r.x,r.y),this.viewer.viewport.flipped?(s.rotate(Math.PI/180*-n.degrees),s.scale(-1,1)):s.rotate(Math.PI/180*n.degrees),s.translate(-r.x,-r.y)},_flip:function(n){n=n||{};var r=n.point?n.point.times(t.pixelDensityRatio):this.getCanvasCenter(),s=this._getContext(n.useSketch);s.translate(r.x,0),s.scale(-1,1),s.translate(-r.x,0)},_restoreRotationChanges:function(n){var r=this._getContext(n);r.restore()},_calculateCanvasSize:function(){var n=t.pixelDensityRatio,r=this.viewport.getContainerSize();return{x:Math.round(r.x*n),y:Math.round(r.y*n)}},_calculateSketchCanvasSize:function(){var n=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return n;var r=Math.ceil(Math.sqrt(n.x*n.x+n.y*n.y));return{x:r,y:r}}}}(e),function(t){t.Viewport=function(n){var r=arguments;r.length&&r[0]instanceof t.Point&&(n={containerSize:r[0],contentSize:r[1],config:r[2]}),n.config&&(t.extend(!0,n,n.config),delete n.config),this._margins=t.extend({left:0,top:0,right:0,bottom:0},n.margins||{}),delete n.margins,n.initialDegrees=n.degrees,delete n.degrees,t.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:t.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:t.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:t.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:t.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:t.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:t.DEFAULT_SETTINGS.degrees,flipped:t.DEFAULT_SETTINGS.flipped,homeFillsViewer:t.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:t.DEFAULT_SETTINGS.silenceMultiImageWarnings},n),this._updateContainerInnerSize(),this.centerSpringX=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new t.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new t.Spring({initial:n.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new t.Rect(0,0,1,1),1),this.goHome(!0),this.update()},t.Viewport.prototype={get degrees(){return t.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(n){t.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(n)},resetContentSize:function(n){return t.console.assert(n,"[Viewport.resetContentSize] contentSize is required"),t.console.assert(n instanceof t.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),t.console.assert(n.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),t.console.assert(n.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new t.Rect(0,0,1,n.y/n.x),n.x),this},setHomeBounds:function(n,r){t.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(n,r)},_setContentBounds:function(n,r){t.console.assert(n,"[Viewport._setContentBounds] bounds is required"),t.console.assert(n instanceof t.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),t.console.assert(n.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),t.console.assert(n.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=n.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(r),this._contentBounds=n.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(r),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:r,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var n=this._contentAspectRatio/this.getAspectRatio(),r;return this.homeFillsViewer?r=n>=1?n:1:r=n>=1?1:n,r/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var n=this._contentBounds.getCenter(),r=1/this.getHomeZoom(),s=r/this.getAspectRatio();return new t.Rect(n.x-r/2,n.y-s/2,r,s)},goHome:function(n){return this.viewer&&this.viewer.raiseEvent("home",{immediately:n}),this.fitBounds(this.getHomeBounds(),n)},getMinZoom:function(){var n=this.getHomeZoom(),r=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*n;return r},getMaxZoom:function(){var n=this.maxZoomLevel;return n||(n=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,n/=this._contentBounds.width),Math.max(n,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new t.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return t.extend({},this._margins)},setMargins:function(n){t.console.assert(t.type(n)==="object","[Viewport.setMargins] margins must be an object"),this._margins=t.extend({left:0,top:0,right:0,bottom:0},n),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(n){return this.getBoundsNoRotate(n).rotate(-this.getRotation(n))},getBoundsNoRotate:function(n){var r=this.getCenter(n),s=1/this.getZoom(n),o=s/this.getAspectRatio();return new t.Rect(r.x-s/2,r.y-o/2,s,o)},getBoundsWithMargins:function(n){return this.getBoundsNoRotateWithMargins(n).rotate(-this.getRotation(n),this.getCenter(n))},getBoundsNoRotateWithMargins:function(n){var r=this.getBoundsNoRotate(n),s=this._containerInnerSize.x*this.getZoom(n);return r.x-=this._margins.left/s,r.y-=this._margins.top/s,r.width+=(this._margins.left+this._margins.right)/s,r.height+=(this._margins.top+this._margins.bottom)/s,r},getCenter:function(n){var r=new t.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),s=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),o,a,l,u,c,h,d,g;return n?r:this.zoomPoint?(o=this.pixelFromPoint(this.zoomPoint,!0),a=this.getZoom(),l=1/a,u=l/this.getAspectRatio(),c=new t.Rect(r.x-l/2,r.y-u/2,l,u),h=this._pixelFromPoint(this.zoomPoint,c),d=h.minus(o).rotate(-this.getRotation(!0)),g=d.divide(this._containerInnerSize.x*a),s.plus(g)):s},getZoom:function(n){return n?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(n){return Math.max(Math.min(n,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(n){var r=this.viewportToViewerElementRectangle(n).getBoundingBox(),s=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),o=!1,a=!1;if(!this.wrapHorizontal){var l=r.x+r.width,u=s.x+s.width,c,h,d;r.width>s.width?c=this.visibilityRatio*s.width:c=this.visibilityRatio*r.width,h=s.x-l+c,d=u-r.x-c,c>s.width?(r.x+=(h+d)/2,o=!0):d<0?(r.x+=d,o=!0):h>0&&(r.x+=h,o=!0)}if(!this.wrapVertical){var g=r.y+r.height,A=s.y+s.height,p,y,v;r.height>s.height?p=this.visibilityRatio*s.height:p=this.visibilityRatio*r.height,y=s.y-g+p,v=A-r.y-p,p>s.height?(r.y+=(y+v)/2,a=!0):v<0?(r.y+=v,a=!0):y>0&&(r.y+=y,a=!0)}var E=o||a,I=E?this.viewerElementToViewportRectangle(r):n.clone();return I.xConstrained=o,I.yConstrained=a,I.constraintApplied=E,I},_raiseConstraintsEvent:function(n){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:n})},applyConstraints:function(n){var r=this.getZoom(),s=this._applyZoomConstraints(r);r!==s&&this.zoomTo(s,this.zoomPoint,n);var o=this.getConstrainedBounds(!1);return o.constraintApplied&&(this.fitBounds(o,n),this._raiseConstraintsEvent(n)),this},ensureVisible:function(n){return this.applyConstraints(n)},_fitBounds:function(n,r){r=r||{};var s=r.immediately||!1,o=r.constraints||!1,a=this.getAspectRatio(),l=n.getCenter(),u=new t.Rect(n.x,n.y,n.width,n.height,n.degrees+this.getRotation()).getBoundingBox();u.getAspectRatio()>=a?u.height=u.width/a:u.width=u.height*a,u.x=l.x-u.width/2,u.y=l.y-u.height/2;var c=1/u.width;if(s)return this.panTo(l,!0),this.zoomTo(c,null,!0),o&&this.applyConstraints(!0),this;var h=this.getCenter(!0),d=this.getZoom(!0);this.panTo(h,!0),this.zoomTo(d,null,!0);var g=this.getBounds(),A=this.getZoom();if(A===0||Math.abs(c/A-1)<1e-8)return this.zoomTo(c,null,!0),this.panTo(l,s),o&&this.applyConstraints(!1),this;if(o){this.panTo(l,!1),c=this._applyZoomConstraints(c),this.zoomTo(c,null,!1);var p=this.getConstrainedBounds();this.panTo(h,!0),this.zoomTo(d,null,!0),this.fitBounds(p)}else{var y=u.rotate(-this.getRotation()),v=y.getTopLeft().times(c).minus(g.getTopLeft().times(A)).divide(c-A);this.zoomTo(c,v,s)}return this},fitBounds:function(n,r){return this._fitBounds(n,{immediately:r,constraints:!1})},fitBoundsWithConstraints:function(n,r){return this._fitBounds(n,{immediately:r,constraints:!0})},fitVertically:function(n){var r=new t.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(r,n)},fitHorizontally:function(n){var r=new t.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(r,n)},getConstrainedBounds:function(n){var r,s;return r=this.getBounds(n),s=this._applyBoundaryConstraints(r),s},panBy:function(n,r){var s=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(s.plus(n),r)},panTo:function(n,r){return r?(this.centerSpringX.resetTo(n.x),this.centerSpringY.resetTo(n.y)):(this.centerSpringX.springTo(n.x),this.centerSpringY.springTo(n.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:n,immediately:r}),this},zoomBy:function(n,r,s){return this.zoomTo(this.zoomSpring.target.value*n,r,s)},zoomTo:function(n,r,s){var o=this;return this.zoomPoint=r instanceof t.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,s?this._adjustCenterSpringsForZoomPoint(function(){o.zoomSpring.resetTo(n)}):this.zoomSpring.springTo(n),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:n,refPoint:r,immediately:s}),this},setRotation:function(n,r){return this.rotateTo(n,null,r)},getRotation:function(n){return n?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(n,r,s){return this.rotateTo(n,r,s)},rotateTo:function(n,r,s){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===n&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=r instanceof t.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,s)if(this.rotationPivot){var o=n-this._oldDegrees;if(!o)return this.rotationPivot=null,this;this._rotateAboutPivot(n)}else this.degreesSpring.resetTo(n);else{var a=t.positiveModulo(this.degreesSpring.current.value,360),l=t.positiveModulo(n,360),u=l-a;u>180?l-=360:u<-180&&(l+=360);var c=a-l;this.degreesSpring.resetTo(n+c),this.degreesSpring.springTo(n)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:n,immediately:!!s,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(n,r,s){return this.rotateTo(this.degreesSpring.target.value+n,r,s)},resize:function(n,r){var s=this.getBoundsNoRotate(),o=s,a;this.containerSize.x=n.x,this.containerSize.y=n.y,this._updateContainerInnerSize(),r&&(a=n.x/this.containerSize.x,o.width=s.width*a,o.height=o.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:n,maintain:r});var l=this.fitBounds(o,!0);return this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:n,maintain:r}),l},_updateContainerInnerSize:function(){this._containerInnerSize=new t.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var n=this;this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var r=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,r},_rotateAboutPivot:function(n){var r=n===!0,s=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(s.x),this.centerSpringY.shiftBy(s.y),r?this.degreesSpring.update():this.degreesSpring.resetTo(n);var o=this.degreesSpring.current.value-this._oldDegrees,a=s.rotate(o*-1).times(-1);this.centerSpringX.shiftBy(a.x),this.centerSpringY.shiftBy(a.y)},_adjustCenterSpringsForZoomPoint:function(n){if(this.zoomPoint){var r=this.pixelFromPoint(this.zoomPoint,!0);n();var s=this.pixelFromPoint(this.zoomPoint,!0),o=s.minus(r),a=this.deltaPointsFromPixels(o,!0);this.centerSpringX.shiftBy(a.x),this.centerSpringY.shiftBy(a.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else n()},deltaPixelsFromPointsNoRotate:function(n,r){return n.times(this._containerInnerSize.x*this.getZoom(r))},deltaPixelsFromPoints:function(n,r){return this.deltaPixelsFromPointsNoRotate(n.rotate(this.getRotation(r)),r)},deltaPointsFromPixelsNoRotate:function(n,r){return n.divide(this._containerInnerSize.x*this.getZoom(r))},deltaPointsFromPixels:function(n,r){return this.deltaPointsFromPixelsNoRotate(n,r).rotate(-this.getRotation(r))},pixelFromPointNoRotate:function(n,r){return this._pixelFromPointNoRotate(n,this.getBoundsNoRotate(r))},pixelFromPoint:function(n,r){return this._pixelFromPoint(n,this.getBoundsNoRotate(r))},_pixelFromPointNoRotate:function(n,r){return n.minus(r.getTopLeft()).times(this._containerInnerSize.x/r.width).plus(new t.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(n,r){return this._pixelFromPointNoRotate(n.rotate(this.getRotation(!0),this.getCenter(!0)),r)},pointFromPixelNoRotate:function(n,r){var s=this.getBoundsNoRotate(r);return n.minus(new t.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/s.width).plus(s.getTopLeft())},pointFromPixel:function(n,r){return this.pointFromPixelNoRotate(n,r).rotate(-this.getRotation(r),this.getCenter(r))},_viewportToImageDelta:function(n,r){var s=this._contentBoundsNoRotate.width;return new t.Point(n*this._contentSizeNoRotate.x/s,r*this._contentSizeNoRotate.x/s)},viewportToImageCoordinates:function(n,r){if(n instanceof t.Point)return this.viewportToImageCoordinates(n.x,n.y);if(this.viewer){var s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(s===1){var o=this.viewer.world.getItemAt(0);return o.viewportToImageCoordinates(n,r,!0)}}return this._viewportToImageDelta(n-this._contentBoundsNoRotate.x,r-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(n,r){var s=this._contentBoundsNoRotate.width;return new t.Point(n/this._contentSizeNoRotate.x*s,r/this._contentSizeNoRotate.x*s)},imageToViewportCoordinates:function(n,r){if(n instanceof t.Point)return this.imageToViewportCoordinates(n.x,n.y);if(this.viewer){var s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(s===1){var o=this.viewer.world.getItemAt(0);return o.imageToViewportCoordinates(n,r,!0)}}var a=this._imageToViewportDelta(n,r);return a.x+=this._contentBoundsNoRotate.x,a.y+=this._contentBoundsNoRotate.y,a},imageToViewportRectangle:function(n,r,s,o){var a=n;if(a instanceof t.Rect||(a=new t.Rect(n,r,s,o)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.imageToViewportRectangle(n,r,s,o,!0)}}var c=this.imageToViewportCoordinates(a.x,a.y),h=this._imageToViewportDelta(a.width,a.height);return new t.Rect(c.x,c.y,h.x,h.y,a.degrees)},viewportToImageRectangle:function(n,r,s,o){var a=n;if(a instanceof t.Rect||(a=new t.Rect(n,r,s,o)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.viewportToImageRectangle(n,r,s,o,!0)}}var c=this.viewportToImageCoordinates(a.x,a.y),h=this._viewportToImageDelta(a.width,a.height);return new t.Rect(c.x,c.y,h.x,h.y,a.degrees)},viewerElementToImageCoordinates:function(n){var r=this.pointFromPixel(n,!0);return this.viewportToImageCoordinates(r)},imageToViewerElementCoordinates:function(n){var r=this.imageToViewportCoordinates(n);return this.pixelFromPoint(r,!0)},windowToImageCoordinates:function(n){t.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var r=n.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(r)},imageToWindowCoordinates:function(n){t.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var r=this.imageToViewerElementCoordinates(n);return r.plus(t.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(n){return this.pointFromPixel(n,!0)},viewportToViewerElementCoordinates:function(n){return this.pixelFromPoint(n,!0)},viewerElementToViewportRectangle:function(n){return t.Rect.fromSummits(this.pointFromPixel(n.getTopLeft(),!0),this.pointFromPixel(n.getTopRight(),!0),this.pointFromPixel(n.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(n){return t.Rect.fromSummits(this.pixelFromPoint(n.getTopLeft(),!0),this.pixelFromPoint(n.getTopRight(),!0),this.pixelFromPoint(n.getBottomLeft(),!0))},windowToViewportCoordinates:function(n){t.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var r=n.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(r)},viewportToWindowCoordinates:function(n){t.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var r=this.viewportToViewerElementCoordinates(n);return r.plus(t.getElementPosition(this.viewer.element))},viewportToImageZoom:function(n){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(r===1){var s=this.viewer.world.getItemAt(0);return s.viewportToImageZoom(n)}}var o=this._contentSizeNoRotate.x,a=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=a/o*l;return n*u},imageToViewportZoom:function(n){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)this.silenceMultiImageWarnings||t.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(r===1){var s=this.viewer.world.getItemAt(0);return s.imageToViewportZoom(n)}}var o=this._contentSizeNoRotate.x,a=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=o/a/l;return n*u},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(n){return this.flipped===n?this:(this.flipped=n,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:n}),this)}}}(e),function(t){t.TiledImage=function(a){var l=this;t.console.assert(a.tileCache,"[TiledImage] options.tileCache is required"),t.console.assert(a.drawer,"[TiledImage] options.drawer is required"),t.console.assert(a.viewer,"[TiledImage] options.viewer is required"),t.console.assert(a.imageLoader,"[TiledImage] options.imageLoader is required"),t.console.assert(a.source,"[TiledImage] options.source is required"),t.console.assert(!a.clip||a.clip instanceof t.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),t.EventSource.call(this),this._tileCache=a.tileCache,delete a.tileCache,this._drawer=a.drawer,delete a.drawer,this._imageLoader=a.imageLoader,delete a.imageLoader,a.clip instanceof t.Rect&&(this._clip=a.clip.clone()),delete a.clip;var u=a.x||0;delete a.x;var c=a.y||0;delete a.y,this.normHeight=a.source.dimensions.y/a.source.dimensions.x,this.contentAspectX=a.source.dimensions.x/a.source.dimensions.y;var h=1;a.width?(h=a.width,delete a.width,a.height&&(t.console.error("specifying both width and height to a tiledImage is not supported"),delete a.height)):a.height&&(h=a.height/this.normHeight,delete a.height);var d=a.fitBounds;delete a.fitBounds;var g=a.fitBoundsPlacement||e.Placement.CENTER;delete a.fitBoundsPlacement;var A=a.degrees||0;delete a.degrees;var p=a.ajaxHeaders;delete a.ajaxHeaders,t.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,immediateRender:t.DEFAULT_SETTINGS.immediateRender,blendTime:t.DEFAULT_SETTINGS.blendTime,alwaysBlend:t.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:t.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:t.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:t.DEFAULT_SETTINGS.iOSDevice,debugMode:t.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:t.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:t.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:t.DEFAULT_SETTINGS.placeholderFillStyle,opacity:t.DEFAULT_SETTINGS.opacity,preload:t.DEFAULT_SETTINGS.preload,compositeOperation:t.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:t.DEFAULT_SETTINGS.subPixelRoundingForTransparency},a),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new t.Spring({initial:u,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new t.Spring({initial:c,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new t.Spring({initial:h,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new t.Spring({initial:A,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),d&&this.fitBounds(d,g,!0),this._drawingHandler=function(y){l.viewer.raiseEvent("tile-drawing",t.extend({tiledImage:l},y))},this._ownAjaxHeaders={},this.setAjaxHeaders(p,!1)},t.extend(t.TiledImage.prototype,t.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(a){a!==this._fullyLoaded&&(this._fullyLoaded=a,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=t.now(),this._needsDraw=!0},update:function(){var a=this._xSpring.update(),l=this._ySpring.update(),u=this._scaleSpring.update(),c=this._degreesSpring.update();return a||l||u||c?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(a){return this.getBoundsNoRotate(a).rotate(this.getRotation(a),this._getRotationPoint(a))},getBoundsNoRotate:function(a){return a?new t.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new t.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return t.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(a){var l=this.getBoundsNoRotate(a);if(this._clip){var u=a?this._worldWidthCurrent:this._worldWidthTarget,c=u/this.source.dimensions.x,h=this._clip.times(c);l=new t.Rect(l.x+h.x,l.y+h.y,h.width,h.height)}return l.rotate(this.getRotation(a),this._getRotationPoint(a))},getTileBounds:function(a,l,u){var c=this.source.getNumTiles(a),h=(c.x+l%c.x)%c.x,d=(c.y+u%c.y)%c.y,g=this.source.getTileBounds(a,h,d);return this.getFlip()&&(g.x=1-g.x-g.width),g.x+=(l-h)/c.x,g.y+=this._worldHeightCurrent/this._worldWidthCurrent*((u-d)/c.y),g},getContentSize:function(){return new t.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var a=this.imageToWindowCoordinates(new t.Point(0,0)),l=this.imageToWindowCoordinates(this.getContentSize());return new t.Point(l.x-a.x,l.y-a.y)},_viewportToImageDelta:function(a,l,u){var c=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(a*(this.source.dimensions.x/c),l*(this.source.dimensions.y*this.contentAspectX/c))},viewportToImageCoordinates:function(a,l,u){var c;return a instanceof t.Point?(u=l,c=a):c=new t.Point(a,l),c=c.rotate(-this.getRotation(u),this._getRotationPoint(u)),u?this._viewportToImageDelta(c.x-this._xSpring.current.value,c.y-this._ySpring.current.value):this._viewportToImageDelta(c.x-this._xSpring.target.value,c.y-this._ySpring.target.value)},_imageToViewportDelta:function(a,l,u){var c=u?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(a/this.source.dimensions.x*c,l/this.source.dimensions.y/this.contentAspectX*c)},imageToViewportCoordinates:function(a,l,u){a instanceof t.Point&&(u=l,l=a.y,a=a.x);var c=this._imageToViewportDelta(a,l);return u?(c.x+=this._xSpring.current.value,c.y+=this._ySpring.current.value):(c.x+=this._xSpring.target.value,c.y+=this._ySpring.target.value),c.rotate(this.getRotation(u),this._getRotationPoint(u))},imageToViewportRectangle:function(a,l,u,c,h){var d=a;d instanceof t.Rect?h=l:d=new t.Rect(a,l,u,c);var g=this.imageToViewportCoordinates(d.getTopLeft(),h),A=this._imageToViewportDelta(d.width,d.height,h);return new t.Rect(g.x,g.y,A.x,A.y,d.degrees+this.getRotation(h))},viewportToImageRectangle:function(a,l,u,c,h){var d=a;a instanceof t.Rect?h=l:d=new t.Rect(a,l,u,c);var g=this.viewportToImageCoordinates(d.getTopLeft(),h),A=this._viewportToImageDelta(d.width,d.height,h);return new t.Rect(g.x,g.y,A.x,A.y,d.degrees-this.getRotation(h))},viewerElementToImageCoordinates:function(a){var l=this.viewport.pointFromPixel(a,!0);return this.viewportToImageCoordinates(l)},imageToViewerElementCoordinates:function(a){var l=this.imageToViewportCoordinates(a);return this.viewport.pixelFromPoint(l,!0)},windowToImageCoordinates:function(a){var l=a.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(l)},imageToWindowCoordinates:function(a){var l=this.imageToViewerElementCoordinates(a);return l.plus(e.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(a){var l=this._scaleSpring.current.value;return a=a.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new t.Rect((a.x-this._xSpring.current.value)/l,(a.y-this._ySpring.current.value)/l,a.width/l,a.height/l,a.degrees)},viewportToImageZoom:function(a){var l=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return l*a},imageToViewportZoom:function(a){var l=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return a/l},setPosition:function(a,l){var u=this._xSpring.target.value===a.x&&this._ySpring.target.value===a.y;if(l){if(u&&this._xSpring.current.value===a.x&&this._ySpring.current.value===a.y)return;this._xSpring.resetTo(a.x),this._ySpring.resetTo(a.y),this._needsDraw=!0}else{if(u)return;this._xSpring.springTo(a.x),this._ySpring.springTo(a.y),this._needsDraw=!0}u||this._raiseBoundsChange()},setWidth:function(a,l){this._setScale(a,l)},setHeight:function(a,l){this._setScale(a/this.normHeight,l)},setCroppingPolygons:function(a){var l=function(c){return c instanceof t.Point||typeof c.x=="number"&&typeof c.y=="number"},u=function(c){return c.map(function(h){try{if(l(h))return{x:h.x,y:h.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!t.isArray(a))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=a.map(function(c){return u(c)})}catch(c){t.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),t.console.error(c),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(a,l,u){l=l||t.Placement.CENTER;var c=t.Placement.properties[l],h=this.contentAspectX,d=0,g=0,A=1,p=1;if(this._clip&&(h=this._clip.getAspectRatio(),A=this._clip.width/this.source.dimensions.x,p=this._clip.height/this.source.dimensions.y,a.getAspectRatio()>h?(d=this._clip.x/this._clip.height*a.height,g=this._clip.y/this._clip.height*a.height):(d=this._clip.x/this._clip.width*a.width,g=this._clip.y/this._clip.width*a.width)),a.getAspectRatio()>h){var y=a.height/p,v=0;c.isHorizontallyCentered?v=(a.width-a.height*h)/2:c.isRight&&(v=a.width-a.height*h),this.setPosition(new t.Point(a.x-d+v,a.y-g),u),this.setHeight(y,u)}else{var E=a.width/A,I=0;c.isVerticallyCentered?I=(a.height-a.width/h)/2:c.isBottom&&(I=a.height-a.width/h),this.setPosition(new t.Point(a.x-d,a.y-g+I),u),this.setWidth(E,u)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(a){t.console.assert(!a||a instanceof t.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),a instanceof t.Rect?this._clip=a.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(a){this.flipped=!!a,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(a){a!==this.opacity&&(this.opacity=a,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(a){this._preload=!!a,this._needsDraw=!0},getRotation:function(a){return a?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(a,l){this._degreesSpring.target.value===a&&this._degreesSpring.isAtTargetValue()||(l?this._degreesSpring.resetTo(a):this._degreesSpring.springTo(a),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(a){return this.getBoundsNoRotate(a).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(a){a!==this.compositeOperation&&(this.compositeOperation=a,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},setAjaxHeaders:function(a,l){if(a===null&&(a={}),!t.isPlainObject(a)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=a,this._updateAjaxHeaders(l)},_updateAjaxHeaders:function(a){if(a===void 0&&(a=!0),t.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=t.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,a){var l,u,c,h;for(var d in this.tilesMatrix){l=this.source.getNumTiles(d);for(var g in this.tilesMatrix[d]){u=(l.x+g%l.x)%l.x;for(var A in this.tilesMatrix[d][g])if(c=(l.y+A%l.y)%l.y,h=this.tilesMatrix[d][g][A],h.loadWithAjax=this.loadTilesWithAjax,h.loadWithAjax){var p=this.source.getTileAjaxHeaders(d,u,c);h.ajaxHeaders=t.extend({},this.ajaxHeaders,p)}else h.ajaxHeaders=null}}for(var y=0;y<this._imageLoader.jobQueue.length;y++){var v=this._imageLoader.jobQueue[y];v.loadWithAjax=v.tile.loadWithAjax,v.ajaxHeaders=v.tile.loadWithAjax?v.tile.ajaxHeaders:null}}},_setScale:function(a,l){var u=this._scaleSpring.target.value===a;if(l){if(u&&this._scaleSpring.current.value===a)return;this._scaleSpring.resetTo(a),this._updateForScale(),this._needsDraw=!0}else{if(u)return;this._scaleSpring.springTo(a),this._updateForScale(),this._needsDraw=!0}u||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var a=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),l=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,u=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(l/this.minPixelRatio)/Math.log(2))));return u=Math.max(u,this.source.minLevel||0),a=Math.min(a,u),{lowestLevel:a,highestLevel:u}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var a=this.lastDrawn.pop();a.beingDrawn=!1}var l=this.viewport,u=this._viewportToTiledImageRectangle(l.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var c=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(u=u.intersection(c),u===null)return}for(var h=this._getLevelsInterval(),d=h.lowestLevel,g=h.highestLevel,A=null,p=!1,y=t.now(),v=g;v>=d;v--){var E=!1,I=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(v),!0).x*this._scaleSpring.current.value;if(v===d||!p&&I>=this.minPixelRatio)E=!0,p=!0;else if(!p)continue;var C=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(v),!1).x*this._scaleSpring.current.value,w=l.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,S=this.immediateRender?1:w,x=Math.min(1,(I-.5)/.5),T=S/Math.abs(S-C);if(A=this._updateLevel(p,E,v,x,T,u,y,A),this._providesCoverage(this.coverage,v))break}this._drawTiles(this.lastDrawn),A&&!A.context2D?(this._loadTile(A,y),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(a,l,u){var c,h;this.wrapHorizontal?(c=t.positiveModulo(l.x,1),h=t.positiveModulo(u.x,1)):(c=Math.max(0,l.x),h=Math.min(1,u.x));var d,g,A=1/this.source.aspectRatio;this.wrapVertical?(d=t.positiveModulo(l.y,A),g=t.positiveModulo(u.y,A)):(d=Math.max(0,l.y),g=Math.min(A,u.y));var p=this.source.getTileAtPoint(a,new t.Point(c,d)),y=this.source.getTileAtPoint(a,new t.Point(h,g)),v=this.source.getNumTiles(a);return this.wrapHorizontal&&(p.x+=v.x*Math.floor(l.x),y.x+=v.x*Math.floor(u.x)),this.wrapVertical&&(p.y+=v.y*Math.floor(l.y/A),y.y+=v.y*Math.floor(u.y/A)),{topLeft:p,bottomRight:y}},_updateLevel:function(a,l,u,c,h,d,g,A){var p=d.getBoundingBox().getTopLeft(),y=d.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:a,level:u,opacity:c,visibility:h,drawArea:d,topleft:p,bottomright:y,currenttime:g,best:A}),this._resetCoverage(this.coverage,u),this._resetCoverage(this.loadingCoverage,u);var v=this._getCornerTiles(u,p,y),E=v.topLeft,I=v.bottomRight,C=this.source.getNumTiles(u),w=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(I.x+=1,this.wrapHorizontal||(I.x=Math.min(I.x,C.x-1)));for(var S=E.x;S<=I.x;S++)for(var x=E.y;x<=I.y;x++){var T;if(this.getFlip()){var Q=(C.x+S%C.x)%C.x;T=S+C.x-Q-Q-1}else T=S;d.intersection(this.getTileBounds(u,T,x))!==null&&(A=this._updateTile(l,a,T,x,u,c,h,w,C,g,A))}return A},_updateTile:function(a,l,u,c,h,d,g,A,p,y,v){var E=this._getTile(u,c,h,y,p,this._worldWidthCurrent,this._worldHeightCurrent),I=l;this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:E}),this._setCoverage(this.coverage,h,u,c,!1);var C=E.loaded||E.loading||this._isCovered(this.loadingCoverage,h,u,c);if(this._setCoverage(this.loadingCoverage,h,u,c,C),!E.exists||(a&&!I&&(this._isCovered(this.coverage,h,u,c)?this._setCoverage(this.coverage,h,u,c,!0):I=!0),!I))return v;if(this._positionTile(E,this.source.tileOverlap,this.viewport,A,g),!E.loaded)if(E.context2D)this._setTileLoaded(E);else{var w=this._tileCache.getImageRecord(E.cacheKey);w&&this._setTileLoaded(E,w.getData())}if(E.loaded){var S=this._blendTile(E,u,c,h,d,y);S&&(this._needsDraw=!0)}else E.loading?this._tilesLoading++:C||(v=this._compareTiles(v,E));return v},_getTile:function(a,l,u,c,h,d,g){var A,p,y,v,E,I,C,w,S,x,T=this.tilesMatrix,Q=this.source;return T[u]||(T[u]={}),T[u][a]||(T[u][a]={}),(!T[u][a][l]||!T[u][a][l].flipped!=!this.flipped)&&(A=(h.x+a%h.x)%h.x,p=(h.y+l%h.y)%h.y,y=this.getTileBounds(u,a,l),v=Q.getTileBounds(u,A,p,!0),E=Q.tileExists(u,A,p),I=Q.getTileUrl(u,A,p),C=Q.getTilePostData(u,A,p),this.loadTilesWithAjax?(w=Q.getTileAjaxHeaders(u,A,p),t.isPlainObject(this.ajaxHeaders)&&(w=t.extend({},this.ajaxHeaders,w))):w=null,S=Q.getContext2D?Q.getContext2D(u,A,p):void 0,x=new t.Tile(u,a,l,y,E,I,S,this.loadTilesWithAjax,w,v,C,Q.getTileHashKey(u,A,p,I,w,C)),this.getFlip()?A===0&&(x.isRightMost=!0):A===h.x-1&&(x.isRightMost=!0),p===h.y-1&&(x.isBottomMost=!0),x.flipped=this.flipped,T[u][a][l]=x),x=T[u][a][l],x.lastTouchTime=c,x},_loadTile:function(a,l){var u=this;a.loading=!0,this._imageLoader.addJob({src:a.getUrl(),tile:a,source:this.source,postData:a.postData,loadWithAjax:a.loadWithAjax,ajaxHeaders:a.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(c,h,d){u._onTileLoad(a,l,c,h,d)},abort:function(){a.loading=!1}})},_onTileLoad:function(a,l,u,c,h){if(u)a.exists=!0;else{t.console.error("Tile %s failed to load: %s - error: %s",a,a.getUrl(),c),this.viewer.raiseEvent("tile-load-failed",{tile:a,tiledImage:this,time:l,message:c,tileRequest:h}),a.loading=!1,a.exists=!1;return}if(l<this.lastResetTime){t.console.warn("Ignoring tile %s loaded before reset: %s",a,a.getUrl()),a.loading=!1;return}var d=this,g=function(){var A=d.source,p=A.getClosestLevel();d._setTileLoaded(a,u,p,h)};this._midDraw?window.setTimeout(g,1):g()},_setTileLoaded:function(a,l,u,c){var h=0,d=!1,g=this;function A(){return d&&t.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),h++,p}function p(){h--,h===0&&(a.loading=!1,a.loaded=!0,a.hasTransparency=g.source.hasTransparency(a.context2D,a.getUrl(),a.ajaxHeaders,a.postData),a.context2D||g._tileCache.cacheTile({data:l,tile:a,cutoff:u,tiledImage:g}),g._needsDraw=!0)}var y=A();this.viewer.raiseEvent("tile-loaded",{tile:a,tiledImage:this,tileRequest:c,get image(){return t.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),l},data:l,getCompletionCallback:A}),d=!0,y()},_positionTile:function(a,l,u,c,h){var d=a.bounds.getTopLeft();d.x*=this._scaleSpring.current.value,d.y*=this._scaleSpring.current.value,d.x+=this._xSpring.current.value,d.y+=this._ySpring.current.value;var g=a.bounds.getSize();g.x*=this._scaleSpring.current.value,g.y*=this._scaleSpring.current.value;var A=u.pixelFromPointNoRotate(d,!0),p=u.pixelFromPointNoRotate(d,!1),y=u.deltaPixelsFromPointsNoRotate(g,!0),v=u.deltaPixelsFromPointsNoRotate(g,!1),E=p.plus(v.divide(2)),I=c.squaredDistanceTo(E);l||(y=y.plus(new t.Point(1,1))),a.isRightMost&&this.wrapHorizontal&&(y.x+=.75),a.isBottomMost&&this.wrapVertical&&(y.y+=.75),a.position=A,a.size=y,a.squaredDistance=I,a.visibility=h},_blendTile:function(a,l,u,c,h,d){var g=1e3*this.blendTime,A,p;if(a.blendStart||(a.blendStart=d),A=d-a.blendStart,p=g?Math.min(1,A/g):1,this.alwaysBlend&&(p*=h),a.opacity=p,this.lastDrawn.push(a),p===1)this._setCoverage(this.coverage,c,l,u,!0),this._hasOpaqueTile=!0;else if(A<g)return!0;return!1},_compareTiles:function(a,l){return!a||l.visibility>a.visibility||l.visibility===a.visibility&&l.squaredDistance<a.squaredDistance?l:a},_drawTiles:function(a){if(!(this.opacity===0||a.length===0&&!this.placeholderFillStyle)){var l=a[0],u;l&&(u=this.opacity<1||this.compositeOperation&&this.compositeOperation!=="source-over"||!this._isBottomItem()&&this.source.hasTransparency(l.context2D,l.getUrl(),l.ajaxHeaders,l.postData));var c,h,d=this.viewport.getZoom(!0),g=this.viewportToImageZoom(d);a.length>1&&g>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360===0&&t.supportsCanvas&&this.viewer.useCanvas&&(u=!0,c=l.getScaleForEdgeSmoothing(),h=l.getTranslationForEdgeSmoothing(c,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0)));var A;u&&(c||(A=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),this._drawer.viewer.viewport.getFlip()&&(this.viewport.getRotation(!0)%360!==0||this.getRotation(!0)%360!==0)&&(A.x=this._drawer.viewer.container.clientWidth-(A.x+A.width)),A=A.times(t.pixelDensityRatio)),this._drawer._clear(!0,A)),c||(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:u}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:u}),this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip());var p=!1;if(this._clip){this._drawer.saveContext(u);var y=this.imageToViewportRectangle(this._clip,!0);y=y.rotate(-this.getRotation(!0),this._getRotationPoint(!0));var v=this._drawer.viewportToDrawerRectangle(y);c&&(v=v.times(c)),h&&(v=v.translate(h)),this._drawer.setClip(v,u),p=!0}if(this._croppingPolygons){var E=this;this._drawer.saveContext(u);try{var I=this._croppingPolygons.map(function(M){return M.map(function(R){var z=E.imageToViewportCoordinates(R.x,R.y,!0).rotate(-E.getRotation(!0),E._getRotationPoint(!0)),q=E._drawer.viewportCoordToDrawerCoord(z);return c&&(q=q.times(c)),h&&(q=q.plus(h)),q})});this._drawer.clipWithPolygons(I,u)}catch(M){t.console.error(M)}p=!0}if(this.placeholderFillStyle&&this._hasOpaqueTile===!1){var C=this._drawer.viewportToDrawerRectangle(this.getBounds(!0));c&&(C=C.times(c)),h&&(C=C.translate(h));var w=null;typeof this.placeholderFillStyle=="function"?w=this.placeholderFillStyle(this,this._drawer.context):w=this.placeholderFillStyle,this._drawer.drawRectangle(C,w,u)}var S=o(this.subPixelRoundingForTransparency),x=!1;if(S===t.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)x=!0;else if(S===t.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var T=this.viewer&&this.viewer.isAnimating();x=!T}for(var Q=a.length-1;Q>=0;Q--)l=a[Q],this._drawer.drawTile(l,this._drawingHandler,u,c,h,x,this.source),l.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:l});p&&this._drawer.restoreContext(u),c||(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(u)),u&&(c&&(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:!1}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1})),this._drawer.blendSketch({opacity:this.opacity,scale:c,translate:h,compositeOperation:this.compositeOperation,bounds:A}),c&&(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1))),c||this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(a)}},_drawDebugInfo:function(a){if(this.debugMode)for(var l=a.length-1;l>=0;l--){var u=a[l];try{this._drawer.drawDebugInfo(u,a.length,l,this)}catch(c){t.console.error(c)}}},_providesCoverage:function(a,l,u,c){var h,d,g,A;if(!a[l])return!1;if(u===void 0||c===void 0){h=a[l];for(g in h)if(Object.prototype.hasOwnProperty.call(h,g)){d=h[g];for(A in d)if(Object.prototype.hasOwnProperty.call(d,A)&&!d[A])return!1}return!0}return a[l][u]===void 0||a[l][u][c]===void 0||a[l][u][c]===!0},_isCovered:function(a,l,u,c){return u===void 0||c===void 0?this._providesCoverage(a,l+1):this._providesCoverage(a,l+1,2*u,2*c)&&this._providesCoverage(a,l+1,2*u,2*c+1)&&this._providesCoverage(a,l+1,2*u+1,2*c)&&this._providesCoverage(a,l+1,2*u+1,2*c+1)},_setCoverage:function(a,l,u,c,h){if(!a[l]){t.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",l);return}a[l][u]||(a[l][u]={}),a[l][u][c]=h},_resetCoverage:function(a,l){a[l]={}}});var n=t.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function r(a){return a!==t.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&a!==t.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&a!==t.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function s(a){return r(a)?n:a}function o(a){if(typeof a=="number")return s(a);if(!a||!t.Browser)return n;var l=a[t.Browser.vendor];return r(l)&&(l=a["*"]),s(l)}}(e),function(t){var n=function(s){t.console.assert(s,"[TileCache.cacheTile] options is required"),t.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=s.tile,this.tiledImage=s.tiledImage},r=function(s){t.console.assert(s,"[ImageRecord] options is required"),t.console.assert(s.data,"[ImageRecord] options.data is required"),this._tiles=[],s.create.apply(null,[this,s.data,s.ownerTile]),this._destroyImplementation=s.destroy.bind(null,this),this.getImage=s.getImage.bind(null,this),this.getData=s.getData.bind(null,this),this.getRenderedContext=s.getRenderedContext.bind(null,this)};r.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(s){t.console.assert(s,"[ImageRecord.addTile] tile is required"),this._tiles.push(s)},removeTile:function(s){for(var o=0;o<this._tiles.length;o++)if(this._tiles[o]===s){this._tiles.splice(o,1);return}t.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",s)},getTileCount:function(){return this._tiles.length}},t.TileCache=function(s){s=s||{},this._maxImageCacheCount=s.maxImageCacheCount||t.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},t.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(s){t.console.assert(s,"[TileCache.cacheTile] options is required"),t.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(s.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),t.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var o=s.cutoff||0,a=this._tilesLoaded.length,l=this._imagesLoaded[s.tile.cacheKey];if(l||(s.data||(t.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),s.data=s.image),t.console.assert(s.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),l=this._imagesLoaded[s.tile.cacheKey]=new r({data:s.data,ownerTile:s.tile,create:s.tiledImage.source.createTileCache,destroy:s.tiledImage.source.destroyTileCache,getImage:s.tiledImage.source.getTileCacheDataAsImage,getData:s.tiledImage.source.getTileCacheData,getRenderedContext:s.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),l.addTile(s.tile),s.tile.cacheImageRecord=l,this._imagesLoadedCount>this._maxImageCacheCount){for(var u=null,c=-1,h=null,d,g,A,p,y,v,E=this._tilesLoaded.length-1;E>=0;E--)if(v=this._tilesLoaded[E],d=v.tile,!(d.level<=o||d.beingDrawn)){if(!u){u=d,c=E,h=v;continue}p=d.lastTouchTime,g=u.lastTouchTime,y=d.level,A=u.level,(p<g||p===g&&y>A)&&(u=d,c=E,h=v)}u&&c>=0&&(this._unloadTile(h),a=c)}this._tilesLoaded[a]=new n({tile:s.tile,tiledImage:s.tiledImage})},clearTilesFor:function(s){t.console.assert(s,"[TileCache.clearTilesFor] tiledImage is required");for(var o,a=0;a<this._tilesLoaded.length;++a)o=this._tilesLoaded[a],o.tiledImage===s&&(this._unloadTile(o),this._tilesLoaded.splice(a,1),a--)},getImageRecord:function(s){return t.console.assert(s,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[s]},_unloadTile:function(s){t.console.assert(s,"[TileCache._unloadTile] tileRecord is required");var o=s.tile,a=s.tiledImage;o.unload(),o.cacheImageRecord=null;var l=this._imagesLoaded[o.cacheKey];l.removeTile(o),l.getTileCount()||(l.destroy(),delete this._imagesLoaded[o.cacheKey],this._imagesLoadedCount--),a.viewer.raiseEvent("tile-unloaded",{tile:o,tiledImage:a})}}}(e),function(t){t.World=function(n){var r=this;t.console.assert(n.viewer,"[World] options.viewer is required"),t.EventSource.call(this),this.viewer=n.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(s){r._autoRefigureSizes?r._figureSizes():r._needsSizesFigured=!0},this._figureSizes()},t.extend(t.World.prototype,t.EventSource.prototype,{addItem:function(n,r){if(t.console.assert(n,"[World.addItem] item is required"),t.console.assert(n instanceof t.TiledImage,"[World.addItem] only TiledImages supported at this time"),r=r||{},r.index!==void 0){var s=Math.max(0,Math.min(this._items.length,r.index));this._items.splice(s,0,n)}else this._items.push(n);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,n.addHandler("bounds-change",this._delegatedFigureSizes),n.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:n})},getItemAt:function(n){return t.console.assert(n!==void 0,"[World.getItemAt] index is required"),this._items[n]},getIndexOfItem:function(n){return t.console.assert(n,"[World.getIndexOfItem] item is required"),t.indexOf(this._items,n)},getItemCount:function(){return this._items.length},setItemIndex:function(n,r){t.console.assert(n,"[World.setItemIndex] item is required"),t.console.assert(r!==void 0,"[World.setItemIndex] index is required");var s=this.getIndexOfItem(n);if(r>=this._items.length)throw new Error("Index bigger than number of layers.");r===s||s===-1||(this._items.splice(s,1),this._items.splice(r,0,n),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:n,previousIndex:s,newIndex:r}))},removeItem:function(n){t.console.assert(n,"[World.removeItem] item is required");var r=t.indexOf(this._items,n);r!==-1&&(n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy(),this._items.splice(r,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(n))},removeAll:function(){this.viewer._cancelPendingImages();var n,r;for(r=0;r<this._items.length;r++)n=this._items[r],n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy();var s=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,r=0;r<s.length;r++)n=s[r],this._raiseRemoveItem(n)},resetItems:function(){for(var n=0;n<this._items.length;n++)this._items[n].reset()},update:function(){for(var n=!1,r=0;r<this._items.length;r++)n=this._items[r].update()||n;return n},draw:function(){for(var n=0;n<this._items.length;n++)this._items[n].draw();this._needsDraw=!1},needsDraw:function(){for(var n=0;n<this._items.length;n++)if(this._items[n].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(n){this._autoRefigureSizes=n,n&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(n){n=n||{};var r=n.immediately||!1,s=n.layout||t.DEFAULT_SETTINGS.collectionLayout,o=n.rows||t.DEFAULT_SETTINGS.collectionRows,a=n.columns||t.DEFAULT_SETTINGS.collectionColumns,l=n.tileSize||t.DEFAULT_SETTINGS.collectionTileSize,u=n.tileMargin||t.DEFAULT_SETTINGS.collectionTileMargin,c=l+u,h;!n.rows&&a?h=a:h=Math.ceil(this._items.length/o);var d=0,g=0,A,p,y,v,E;this.setAutoRefigureSizes(!1);for(var I=0;I<this._items.length;I++)I&&I%h===0&&(s==="horizontal"?(g+=c,d=0):(d+=c,g=0)),A=this._items[I],p=A.getBounds(),p.width>p.height?y=l:y=l*(p.width/p.height),v=y*(p.height/p.width),E=new t.Point(d+(l-y)/2,g+(l-v)/2),A.setPosition(E,r),A.setWidth(y,r),s==="horizontal"?d+=c:g+=c;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var n=this._homeBounds?this._homeBounds.clone():null,r=this._contentSize?this._contentSize.clone():null,s=this._contentFactor||0;if(!this._items.length)this._homeBounds=new t.Rect(0,0,1,1),this._contentSize=new t.Point(1,1),this._contentFactor=1;else{var o=this._items[0],a=o.getBounds();this._contentFactor=o.getContentSize().x/a.width;for(var l=o.getClippedBounds().getBoundingBox(),u=l.x,c=l.y,h=l.x+l.width,d=l.y+l.height,g=1;g<this._items.length;g++)o=this._items[g],a=o.getBounds(),this._contentFactor=Math.max(this._contentFactor,o.getContentSize().x/a.width),l=o.getClippedBounds().getBoundingBox(),u=Math.min(u,l.x),c=Math.min(c,l.y),h=Math.max(h,l.x+l.width),d=Math.max(d,l.y+l.height);this._homeBounds=new t.Rect(u,c,h-u,d-c),this._contentSize=new t.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==s||!this._homeBounds.equals(n)||!this._contentSize.equals(r))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(n){this.raiseEvent("remove-item",{item:n})}})}(e)})(cP);var gY=cP.exports;const Ic=jo(gY);function AY(i){const t=pY(i).replace(/-/g,"+").replace(/_/g,"/"),n=typeof atob>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t);return decodeURIComponent(n).trim()}function pY(i){const e=i.length%4;if(e===1)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return i+(e?"====".slice(0,4-e):"")}const mY=k.createContext(null),v_={didCatch:!1,error:null};class np extends k.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=v_}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,n,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];(t=(n=this.props).onReset)===null||t===void 0||t.call(n,{args:s,reason:"imperative-api"}),this.setState(v_)}}componentDidCatch(e,t){var n,r;(n=(r=this.props).onError)===null||n===void 0||n.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:r}=this.props;if(n&&t.error!==null&&yY(e.resetKeys,r)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(v_)}}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:s,error:o}=this.state;let a=e;if(s){const l={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")a=t(l);else if(n)a=k.createElement(n,l);else if(r===null||k.isValidElement(r))a=r;else throw o}return k.createElement(mY.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},a)}}function yY(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return i.length!==e.length||i.some((t,n)=>!Object.is(t,e[n]))}var Pt="colors",mn="sizes",Fe="space",vY={gap:Fe,gridGap:Fe,columnGap:Fe,gridColumnGap:Fe,rowGap:Fe,gridRowGap:Fe,inset:Fe,insetBlock:Fe,insetBlockEnd:Fe,insetBlockStart:Fe,insetInline:Fe,insetInlineEnd:Fe,insetInlineStart:Fe,margin:Fe,marginTop:Fe,marginRight:Fe,marginBottom:Fe,marginLeft:Fe,marginBlock:Fe,marginBlockEnd:Fe,marginBlockStart:Fe,marginInline:Fe,marginInlineEnd:Fe,marginInlineStart:Fe,padding:Fe,paddingTop:Fe,paddingRight:Fe,paddingBottom:Fe,paddingLeft:Fe,paddingBlock:Fe,paddingBlockEnd:Fe,paddingBlockStart:Fe,paddingInline:Fe,paddingInlineEnd:Fe,paddingInlineStart:Fe,top:Fe,right:Fe,bottom:Fe,left:Fe,scrollMargin:Fe,scrollMarginTop:Fe,scrollMarginRight:Fe,scrollMarginBottom:Fe,scrollMarginLeft:Fe,scrollMarginX:Fe,scrollMarginY:Fe,scrollMarginBlock:Fe,scrollMarginBlockEnd:Fe,scrollMarginBlockStart:Fe,scrollMarginInline:Fe,scrollMarginInlineEnd:Fe,scrollMarginInlineStart:Fe,scrollPadding:Fe,scrollPaddingTop:Fe,scrollPaddingRight:Fe,scrollPaddingBottom:Fe,scrollPaddingLeft:Fe,scrollPaddingX:Fe,scrollPaddingY:Fe,scrollPaddingBlock:Fe,scrollPaddingBlockEnd:Fe,scrollPaddingBlockStart:Fe,scrollPaddingInline:Fe,scrollPaddingInlineEnd:Fe,scrollPaddingInlineStart:Fe,fontSize:"fontSizes",background:Pt,backgroundColor:Pt,backgroundImage:Pt,borderImage:Pt,border:Pt,borderBlock:Pt,borderBlockEnd:Pt,borderBlockStart:Pt,borderBottom:Pt,borderBottomColor:Pt,borderColor:Pt,borderInline:Pt,borderInlineEnd:Pt,borderInlineStart:Pt,borderLeft:Pt,borderLeftColor:Pt,borderRight:Pt,borderRightColor:Pt,borderTop:Pt,borderTopColor:Pt,caretColor:Pt,color:Pt,columnRuleColor:Pt,fill:Pt,outline:Pt,outlineColor:Pt,stroke:Pt,textDecorationColor:Pt,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:mn,minBlockSize:mn,maxBlockSize:mn,inlineSize:mn,minInlineSize:mn,maxInlineSize:mn,width:mn,minWidth:mn,maxWidth:mn,height:mn,minHeight:mn,maxHeight:mn,flexBasis:mn,gridTemplateColumns:mn,gridTemplateRows:mn,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},EY=(i,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,_c=()=>{const i=Object.create(null);return(e,t,...n)=>{const r=(s=>JSON.stringify(s,EY))(e);return r in i?i[r]:i[r]=t(e,...n)}},wl=Symbol.for("sxs.internal"),E_=(i,e)=>Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)),hP=i=>{for(const e in i)return!0;return!1},{hasOwnProperty:IY}=Object.prototype,I_=i=>i.includes("-")?i:i.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),_Y=/\s+(?![^()]*\))/,Cc=i=>e=>i(...typeof e=="string"?String(e).split(_Y):[e]),dP={appearance:i=>({WebkitAppearance:i,appearance:i}),backfaceVisibility:i=>({WebkitBackfaceVisibility:i,backfaceVisibility:i}),backdropFilter:i=>({WebkitBackdropFilter:i,backdropFilter:i}),backgroundClip:i=>({WebkitBackgroundClip:i,backgroundClip:i}),boxDecorationBreak:i=>({WebkitBoxDecorationBreak:i,boxDecorationBreak:i}),clipPath:i=>({WebkitClipPath:i,clipPath:i}),content:i=>({content:i.includes('"')||i.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(i)?i:`"${i}"`}),hyphens:i=>({WebkitHyphens:i,hyphens:i}),maskImage:i=>({WebkitMaskImage:i,maskImage:i}),maskSize:i=>({WebkitMaskSize:i,maskSize:i}),tabSize:i=>({MozTabSize:i,tabSize:i}),textSizeAdjust:i=>({WebkitTextSizeAdjust:i,textSizeAdjust:i}),userSelect:i=>({WebkitUserSelect:i,userSelect:i}),marginBlock:Cc((i,e)=>({marginBlockStart:i,marginBlockEnd:e||i})),marginInline:Cc((i,e)=>({marginInlineStart:i,marginInlineEnd:e||i})),maxSize:Cc((i,e)=>({maxBlockSize:i,maxInlineSize:e||i})),minSize:Cc((i,e)=>({minBlockSize:i,minInlineSize:e||i})),paddingBlock:Cc((i,e)=>({paddingBlockStart:i,paddingBlockEnd:e||i})),paddingInline:Cc((i,e)=>({paddingInlineStart:i,paddingInlineEnd:e||i}))},__=/([\d.]+)([^]*)/,CY=(i,e)=>i.length?i.reduce((t,n)=>(t.push(...e.map(r=>r.includes("&")?r.replace(/&/g,/[ +>|~]/.test(n)&&/&.*&/.test(r)?`:is(${n})`:n):n+" "+r)),t),[]):e,wY=(i,e)=>i in xY&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(t,n,r,s)=>n+(r==="stretch"?`-moz-available${s};${I_(i)}:${n}-webkit-fill-available`:`-moz-fit-content${s};${I_(i)}:${n}fit-content`)+s):String(e),xY={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},io=i=>i?i+"-":"",fP=(i,e,t)=>i.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(n,r,s,o,a)=>o=="$"==!!s?n:(r||o=="--"?"calc(":"")+"var(--"+(o==="$"?io(e)+(a.includes("$")?"":io(t))+a.replace(/\$/g,"-"):a)+")"+(r||o=="--"?"*"+(r||"")+(s||"1")+")":"")),bY=/\s*,\s*(?![^()]*\))/,SY=Object.prototype.toString,wc=(i,e,t,n,r)=>{let s,o,a;const l=(u,c,h)=>{let d,g;const A=p=>{for(d in p){const E=d.charCodeAt(0)===64,I=E&&Array.isArray(p[d])?p[d]:[p[d]];for(g of I){const C=/[A-Z]/.test(v=d)?v:v.replace(/-[^]/g,S=>S[1].toUpperCase()),w=typeof g=="object"&&g&&g.toString===SY&&(!n.utils[C]||!c.length);if(C in n.utils&&!w){const S=n.utils[C];if(S!==o){o=S,A(S(g)),o=null;continue}}else if(C in dP){const S=dP[C];if(S!==a){a=S,A(S(g)),a=null;continue}}if(E&&(y=d.slice(1)in n.media?"@media "+n.media[d.slice(1)]:d,d=y.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(S,x,T,Q,M,R)=>{const z=__.test(x),q=.0625*(z?-1:1),[X,N]=z?[Q,x]:[x,Q];return"("+(T[0]==="="?"":T[0]===">"===z?"max-":"min-")+X+":"+(T[0]!=="="&&T.length===1?N.replace(__,(G,j,V)=>Number(j)+q*(T===">"?1:-1)+V):N)+(M?") and ("+(M[0]===">"?"min-":"max-")+X+":"+(M.length===1?R.replace(__,(G,j,V)=>Number(j)+q*(M===">"?-1:1)+V):R):"")+")"})),w){const S=E?h.concat(d):[...h],x=E?[...c]:CY(c,d.split(bY));s!==void 0&&r(gP(...s)),s=void 0,l(g,x,S)}else s===void 0&&(s=[[],c,h]),d=E||d.charCodeAt(0)!==36?d:`--${io(n.prefix)}${d.slice(1).replace(/\$/g,"-")}`,g=w?g:typeof g=="number"?g&&C in TY?String(g)+"px":String(g):fP(wY(C,g??""),n.prefix,n.themeMap[C]),s[0].push(`${E?`${d} `:`${I_(d)}:`}${g}`)}}var y,v};A(u),s!==void 0&&r(gP(...s)),s=void 0};l(i,e,t)},gP=(i,e,t)=>`${t.map(n=>`${n}{`).join("")}${e.length?`${e.join(",")}{`:""}${i.join(";")}${e.length?"}":""}${Array(t.length?t.length+1:0).join("}")}`,TY={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},AP=i=>String.fromCharCode(i+(i>25?39:97)),xl=i=>(e=>{let t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=AP(t%52)+n;return AP(t%52)+n})(((e,t)=>{let n=t.length;for(;n;)e=33*e^t.charCodeAt(--n);return e})(5381,JSON.stringify(i))>>>0),pf=["themed","global","styled","onevar","resonevar","allvar","inline"],BY=i=>{if(i.href&&!i.href.startsWith(location.origin))return!1;try{return!!i.cssRules}catch{return!1}},RY=i=>{let e;const t=()=>{const{cssRules:r}=e.sheet;return[].map.call(r,(s,o)=>{const{cssText:a}=s;let l="";if(a.startsWith("--sxs"))return"";if(r[o-1]&&(l=r[o-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const u in e.rules)if(e.rules[u].group===s)return`--sxs{--sxs:${[...e.rules[u].cache].join(" ")}}${a}`;return s.cssRules.length?`${l}${a}`:""}return a}).join("")},n=()=>{if(e){const{rules:a,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const u in a)delete a[u]}const r=Object(i).styleSheets||[];for(const a of r)if(BY(a)){for(let l=0,u=a.cssRules;u[l];++l){const c=Object(u[l]);if(c.type!==1)continue;const h=Object(u[l+1]);if(h.type!==4)continue;++l;const{cssText:d}=c;if(!d.startsWith("--sxs"))continue;const g=d.slice(14,-3).trim().split(/\s+/),A=pf[g[0]];A&&(e||(e={sheet:a,reset:n,rules:{},toString:t}),e.rules[A]={group:h,index:l,cache:new Set(g)})}if(e)break}if(!e){const a=(l,u)=>({type:u,cssRules:[],insertRule(c,h){this.cssRules.splice(h,0,a(c,{import:3,undefined:1}[(c.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,c=>c.cssText).join("")}}`:l}});e={sheet:i?(i.head||i).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:n,toString:t}}const{sheet:s,rules:o}=e;for(let a=pf.length-1;a>=0;--a){const l=pf[a];if(!o[l]){const u=pf[a+1],c=o[u]?o[u].index:s.cssRules.length;s.insertRule("@media{}",c),s.insertRule(`--sxs{--sxs:${a}}`,c),o[l]={group:s.cssRules[c+1],index:c,cache:new Set([a])}}LY(o[l])}};return n(),e},LY=i=>{const e=i.group;let t=e.cssRules.length;i.apply=n=>{try{e.insertRule(n,t),++t}catch{}}},mf=Symbol(),DY=_c(),pP=(i,e)=>DY(i,()=>(...t)=>{let n={type:null,composers:new Set};for(const r of t)if(r!=null)if(r[wl]){n.type==null&&(n.type=r[wl].type);for(const s of r[wl].composers)n.composers.add(s)}else r.constructor!==Object||r.$$typeof?n.type==null&&(n.type=r):n.composers.add(kY(r,i));return n.type==null&&(n.type="span"),n.composers.size||n.composers.add(["PJLV",{},[],[],{},[]]),PY(i,n,e)}),kY=({variants:i,compoundVariants:e,defaultVariants:t,...n},r)=>{const s=`${io(r.prefix)}c-${xl(n)}`,o=[],a=[],l=Object.create(null),u=[];for(const d in t)l[d]=String(t[d]);if(typeof i=="object"&&i)for(const d in i){c=l,h=d,IY.call(c,h)||(l[d]="undefined");const g=i[d];for(const A in g){const p={[d]:String(A)};String(A)==="undefined"&&u.push(d);const y=g[A],v=[p,y,!hP(y)];o.push(v)}}var c,h;if(typeof e=="object"&&e)for(const d of e){let{css:g,...A}=d;g=typeof g=="object"&&g||{};for(const y in A)A[y]=String(A[y]);const p=[A,g,!hP(g)];a.push(p)}return[s,n,o,a,l,u]},PY=(i,e,t)=>{const[n,r,s,o]=MY(e.composers),a=typeof e.type=="function"||e.type.$$typeof?(h=>{function d(){for(let g=0;g<d[mf].length;g++){const[A,p]=d[mf][g];h.rules[A].apply(p)}return d[mf]=[],null}return d[mf]=[],d.rules={},pf.forEach(g=>d.rules[g]={apply:A=>d[mf].push([g,A])}),d})(t):null,l=(a||t).rules,u=`.${n}${r.length>1?`:where(.${r.slice(1).join(".")})`:""}`,c=h=>{h=typeof h=="object"&&h||FY;const{css:d,...g}=h,A={};for(const v in s)if(delete g[v],v in h){let E=h[v];typeof E=="object"&&E?A[v]={"@initial":s[v],...E}:(E=String(E),A[v]=E!=="undefined"||o.has(v)?E:s[v])}else A[v]=s[v];const p=new Set([...r]);for(const[v,E,I,C]of e.composers){t.rules.styled.cache.has(v)||(t.rules.styled.cache.add(v),wc(E,[`.${v}`],[],i,x=>{l.styled.apply(x)}));const w=mP(I,A,i.media),S=mP(C,A,i.media,!0);for(const x of w)if(x!==void 0)for(const[T,Q,M]of x){const R=`${v}-${xl(Q)}-${T}`;p.add(R);const z=(M?t.rules.resonevar:t.rules.onevar).cache,q=M?l.resonevar:l.onevar;z.has(R)||(z.add(R),wc(Q,[`.${R}`],[],i,X=>{q.apply(X)}))}for(const x of S)if(x!==void 0)for(const[T,Q]of x){const M=`${v}-${xl(Q)}-${T}`;p.add(M),t.rules.allvar.cache.has(M)||(t.rules.allvar.cache.add(M),wc(Q,[`.${M}`],[],i,R=>{l.allvar.apply(R)}))}}if(typeof d=="object"&&d){const v=`${n}-i${xl(d)}-css`;p.add(v),t.rules.inline.cache.has(v)||(t.rules.inline.cache.add(v),wc(d,[`.${v}`],[],i,E=>{l.inline.apply(E)}))}for(const v of String(h.className||"").trim().split(/\s+/))v&&p.add(v);const y=g.className=[...p].join(" ");return{type:e.type,className:y,selector:u,props:g,toString:()=>y,deferredInjector:a}};return E_(c,{className:n,selector:u,[wl]:e,toString:()=>(t.rules.styled.cache.has(n)||c(),n)})},MY=i=>{let e="";const t=[],n={},r=[];for(const[s,,,,o,a]of i){e===""&&(e=s),t.push(s),r.push(...a);for(const l in o){const u=o[l];(n[l]===void 0||u!=="undefined"||a.includes(u))&&(n[l]=u)}}return[e,t,n,new Set(r)]},mP=(i,e,t,n)=>{const r=[];e:for(let[s,o,a]of i){if(a)continue;let l,u=0,c=!1;for(l in s){const h=s[l];let d=e[l];if(d!==h){if(typeof d!="object"||!d)continue e;{let g,A,p=0;for(const y in d){if(h===String(d[y])){if(y!=="@initial"){const v=y.slice(1);(A=A||[]).push(v in t?t[v]:y.replace(/^@media ?/,"")),c=!0}u+=p,g=!0}++p}if(A&&A.length&&(o={["@media "+A.join(", ")]:o}),!g)continue e}}}(r[u]=r[u]||[]).push([n?"cv":`${l}-${s[l]}`,o,c])}return r},FY={},OY=_c(),NY=(i,e)=>OY(i,()=>(...t)=>{const n=()=>{for(let r of t){r=typeof r=="object"&&r||{};let s=xl(r);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in r){let o=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let a of[].concat(r["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,e.sheet.insertRule(`@import ${a};`,o++);delete r["@import"]}wc(r,[],[],i,o=>{e.rules.global.apply(o)})}}return""};return E_(n,{toString:n})}),QY=_c(),UY=(i,e)=>QY(i,()=>t=>{const n=`${io(i.prefix)}k-${xl(t)}`,r=()=>{if(!e.rules.global.cache.has(n)){e.rules.global.cache.add(n);const s=[];wc(t,[],[],i,a=>s.push(a));const o=`@keyframes ${n}{${s.join("")}}`;e.rules.global.apply(o)}return n};return E_(r,{get name(){return r()},toString:r})}),GY=class{constructor(e,t,n,r){this.token=e==null?"":String(e),this.value=t==null?"":String(t),this.scale=n==null?"":String(n),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+io(this.prefix)+io(this.scale)+this.token}toString(){return this.computedValue}},HY=_c(),zY=(i,e)=>HY(i,()=>(t,n)=>{n=typeof t=="object"&&t||Object(n);const r=`.${t=(t=typeof t=="string"?t:"")||`${io(i.prefix)}t-${xl(n)}`}`,s={},o=[];for(const l in n){s[l]={};for(const u in n[l]){const c=`--${io(i.prefix)}${l}-${u}`,h=fP(String(n[l][u]),i.prefix,l);s[l][u]=new GY(u,h,l,i.prefix),o.push(`${c}:${h}`)}}const a=()=>{if(o.length&&!e.rules.themed.cache.has(t)){e.rules.themed.cache.add(t);const l=`${n===i.theme?":root,":""}.${t}{${o.join(";")}}`;e.rules.themed.apply(l)}return t};return{...s,get className(){return a()},selector:r,toString:a}}),VY=_c(),yP,qY=_c(),C_=i=>{const e=(t=>{let n=!1;const r=VY(t,s=>{n=!0;const o="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",a=typeof s.media=="object"&&s.media||{},l=typeof s.root=="object"?s.root||null:globalThis.document||null,u=typeof s.theme=="object"&&s.theme||{},c={prefix:o,media:a,theme:u,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...vY},utils:typeof s.utils=="object"&&s.utils||{}},h=RY(l),d={css:pP(c,h),globalCss:NY(c,h),keyframes:UY(c,h),createTheme:zY(c,h),reset(){h.reset(),d.theme.toString()},theme:{},sheet:h,config:c,prefix:o,getCssText:h.toString,toString:h.toString};return String(d.theme=d.createTheme(u)),d});return n||r.reset(),r})(i);return e.styled=(({config:t,sheet:n})=>qY(t,()=>{const r=pP(t,n);return(...s)=>{const o=r(...s),a=o[wl].type,l=P.forwardRef((u,c)=>{const h=u&&u.as||a,{props:d,deferredInjector:g}=o(u);return delete d.as,d.ref=c,g?P.createElement(P.Fragment,null,P.createElement(h,d),P.createElement(g,null)):P.createElement(h,d)});return l.className=o.className,l.displayName=`Styled.${a.displayName||a.name||a}`,l.selector=o.selector,l.toString=()=>o.selector,l[wl]=o[wl],l}}))(e),e},$Y=()=>yP||(yP=C_()),jY=(...i)=>$Y().createTheme(...i);function vP(i){const e=i+"CollectionProvider",[t,n]=Or(e),[r,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:A,children:p}=g,y=P.useRef(null),v=P.useRef(new Map).current;return P.createElement(r,{scope:A,itemMap:v,collectionRef:y},p)},a=i+"CollectionSlot",l=P.forwardRef((g,A)=>{const{scope:p,children:y}=g,v=s(a,p),E=Gt(A,v.collectionRef);return P.createElement(Ec,{ref:E},y)}),u=i+"CollectionItemSlot",c="data-radix-collection-item",h=P.forwardRef((g,A)=>{const{scope:p,children:y,...v}=g,E=P.useRef(null),I=Gt(A,E),C=s(u,p);return P.useEffect(()=>(C.itemMap.set(E,{ref:E,...v}),()=>void C.itemMap.delete(E))),P.createElement(Ec,{[c]:"",ref:I},y)});function d(g){const A=s(i+"CollectionConsumer",g);return P.useCallback(()=>{const y=A.collectionRef.current;if(!y)return[];const v=Array.from(y.querySelectorAll(`[${c}]`));return Array.from(A.itemMap.values()).sort((C,w)=>v.indexOf(C.ref.current)-v.indexOf(w.ref.current))},[A.collectionRef,A.itemMap])}return[{Provider:o,Slot:l,ItemSlot:h},d,n]}const WY=k.createContext(void 0);function rp(i){const e=k.useContext(WY);return i||e||"ltr"}const w_="rovingFocusGroup.onEntryFocus",KY={bubbles:!1,cancelable:!0},x_="RovingFocusGroup",[b_,EP,YY]=vP(x_),[ZY,sp]=Or(x_,[YY]),[XY,JY]=ZY(x_),eZ=k.forwardRef((i,e)=>k.createElement(b_.Provider,{scope:i.__scopeRovingFocusGroup},k.createElement(b_.Slot,{scope:i.__scopeRovingFocusGroup},k.createElement(tZ,Be({},i,{ref:e}))))),tZ=k.forwardRef((i,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,...c}=i,h=k.useRef(null),d=Gt(e,h),g=rp(s),[A=null,p]=va({prop:o,defaultProp:a,onChange:l}),[y,v]=k.useState(!1),E=ls(u),I=EP(t),C=k.useRef(!1),[w,S]=k.useState(0);return k.useEffect(()=>{const x=h.current;if(x)return x.addEventListener(w_,E),()=>x.removeEventListener(w_,E)},[E]),k.createElement(XY,{scope:t,orientation:n,dir:g,loop:r,currentTabStopId:A,onItemFocus:k.useCallback(x=>p(x),[p]),onItemShiftTab:k.useCallback(()=>v(!0),[]),onFocusableItemAdd:k.useCallback(()=>S(x=>x+1),[]),onFocusableItemRemove:k.useCallback(()=>S(x=>x-1),[])},k.createElement(ht.div,Be({tabIndex:y||w===0?-1:0,"data-orientation":n},c,{ref:d,style:{outline:"none",...i.style},onMouseDown:tt(i.onMouseDown,()=>{C.current=!0}),onFocus:tt(i.onFocus,x=>{const T=!C.current;if(x.target===x.currentTarget&&T&&!y){const Q=new CustomEvent(w_,KY);if(x.currentTarget.dispatchEvent(Q),!Q.defaultPrevented){const M=I().filter(N=>N.focusable),R=M.find(N=>N.active),z=M.find(N=>N.id===A),X=[R,z,...M].filter(Boolean).map(N=>N.ref.current);IP(X)}}C.current=!1}),onBlur:tt(i.onBlur,()=>v(!1))})))}),iZ="RovingFocusGroupItem",nZ=k.forwardRef((i,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:r=!1,tabStopId:s,...o}=i,a=Ea(),l=s||a,u=JY(iZ,t),c=u.currentTabStopId===l,h=EP(t),{onFocusableItemAdd:d,onFocusableItemRemove:g}=u;return k.useEffect(()=>{if(n)return d(),()=>g()},[n,d,g]),k.createElement(b_.ItemSlot,{scope:t,id:l,focusable:n,active:r},k.createElement(ht.span,Be({tabIndex:c?0:-1,"data-orientation":u.orientation},o,{ref:e,onMouseDown:tt(i.onMouseDown,A=>{n?u.onItemFocus(l):A.preventDefault()}),onFocus:tt(i.onFocus,()=>u.onItemFocus(l)),onKeyDown:tt(i.onKeyDown,A=>{if(A.key==="Tab"&&A.shiftKey){u.onItemShiftTab();return}if(A.target!==A.currentTarget)return;const p=oZ(A,u.orientation,u.dir);if(p!==void 0){A.preventDefault();let v=h().filter(E=>E.focusable).map(E=>E.ref.current);if(p==="last")v.reverse();else if(p==="prev"||p==="next"){p==="prev"&&v.reverse();const E=v.indexOf(A.currentTarget);v=u.loop?aZ(v,E+1):v.slice(E+1)}setTimeout(()=>IP(v))}})})))}),rZ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function sZ(i,e){return e!=="rtl"?i:i==="ArrowLeft"?"ArrowRight":i==="ArrowRight"?"ArrowLeft":i}function oZ(i,e,t){const n=sZ(i.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return rZ[n]}function IP(i){const e=document.activeElement;for(const t of i)if(t===e||(t.focus(),document.activeElement!==e))return}function aZ(i,e){return i.map((t,n)=>i[(e+n)%i.length])}const _P=eZ,CP=nZ,wP="Tabs",[lZ,dye]=Or(wP,[sp]),xP=sp(),[uZ,S_]=lZ(wP),cZ=k.forwardRef((i,e)=>{const{__scopeTabs:t,value:n,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...u}=i,c=rp(a),[h,d]=va({prop:n,onChange:r,defaultProp:s});return k.createElement(uZ,{scope:t,baseId:Ea(),value:h,onValueChange:d,orientation:o,dir:c,activationMode:l},k.createElement(ht.div,Be({dir:c,"data-orientation":o},u,{ref:e})))}),hZ="TabsList",dZ=k.forwardRef((i,e)=>{const{__scopeTabs:t,loop:n=!0,...r}=i,s=S_(hZ,t),o=xP(t);return k.createElement(_P,Be({asChild:!0},o,{orientation:s.orientation,dir:s.dir,loop:n}),k.createElement(ht.div,Be({role:"tablist","aria-orientation":s.orientation},r,{ref:e})))}),fZ="TabsTrigger",gZ=k.forwardRef((i,e)=>{const{__scopeTabs:t,value:n,disabled:r=!1,...s}=i,o=S_(fZ,t),a=xP(t),l=bP(o.baseId,n),u=SP(o.baseId,n),c=n===o.value;return k.createElement(CP,Be({asChild:!0},a,{focusable:!r,active:c}),k.createElement(ht.button,Be({type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l},s,{ref:e,onMouseDown:tt(i.onMouseDown,h=>{!r&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:tt(i.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:tt(i.onFocus,()=>{const h=o.activationMode!=="manual";!c&&!r&&h&&o.onValueChange(n)})})))}),AZ="TabsContent",pZ=k.forwardRef((i,e)=>{const{__scopeTabs:t,value:n,forceMount:r,children:s,...o}=i,a=S_(AZ,t),l=bP(a.baseId,n),u=SP(a.baseId,n),c=n===a.value,h=k.useRef(c);return k.useEffect(()=>{const d=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(d)},[]),k.createElement(tp,{present:r||c},({present:d})=>k.createElement(ht.div,Be({"data-state":c?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!d,id:u,tabIndex:0},o,{ref:e,style:{...i.style,animationDuration:h.current?"0s":void 0}}),d&&s))});function bP(i,e){return`${i}-trigger-${e}`}function SP(i,e){return`${i}-content-${e}`}const mZ=cZ,yZ=dZ,vZ=gZ,EZ=pZ;function T_(i){const[e,t]=k.useState(void 0);return pn(()=>{if(i){t({width:i.offsetWidth,height:i.offsetHeight});const n=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=i.offsetWidth,a=i.offsetHeight;t({width:o,height:a})});return n.observe(i,{box:"border-box"}),()=>n.unobserve(i)}else t(void 0)},[i]),e}function B_(i){const e=k.useRef({value:i,previous:i});return k.useMemo(()=>(e.current.value!==i&&(e.current.previous=e.current.value,e.current.value=i),e.current.previous),[i])}const TP="Radio",[IZ,BP]=Or(TP),[_Z,fye]=IZ(TP),CZ=k.forwardRef((i,e)=>{const{__scopeRadio:t,name:n,checked:r=!1,required:s,disabled:o,value:a="on",onCheck:l,...u}=i,[c,h]=k.useState(null),d=Gt(e,p=>h(p)),g=k.useRef(!1),A=c?!!c.closest("form"):!0;return k.createElement(_Z,{scope:t,checked:r,disabled:o},k.createElement(ht.button,Be({type:"button",role:"radio","aria-checked":r,"data-state":xZ(r),"data-disabled":o?"":void 0,disabled:o,value:a},u,{ref:d,onClick:tt(i.onClick,p=>{r||l==null||l(),A&&(g.current=p.isPropagationStopped(),g.current||p.stopPropagation())})})),A&&k.createElement(wZ,{control:c,bubbles:!g.current,name:n,value:a,checked:r,required:s,disabled:o,style:{transform:"translateX(-100%)"}}))}),wZ=i=>{const{control:e,checked:t,bubbles:n=!0,...r}=i,s=k.useRef(null),o=B_(t),a=T_(e);return k.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==t&&h){const d=new Event("click",{bubbles:n});h.call(l,t),l.dispatchEvent(d)}},[o,t,n]),k.createElement("input",Be({type:"radio","aria-hidden":!0,defaultChecked:t},r,{tabIndex:-1,ref:s,style:{...i.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function xZ(i){return i?"checked":"unchecked"}const bZ=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],RP="RadioGroup",[SZ,gye]=Or(RP,[sp,BP]),LP=sp(),TZ=BP(),[BZ,RZ]=SZ(RP),LZ=k.forwardRef((i,e)=>{const{__scopeRadioGroup:t,name:n,defaultValue:r,value:s,required:o=!1,disabled:a=!1,orientation:l,dir:u,loop:c=!0,onValueChange:h,...d}=i,g=LP(t),A=rp(u),[p,y]=va({prop:s,defaultProp:r,onChange:h});return k.createElement(BZ,{scope:t,name:n,required:o,disabled:a,value:p,onValueChange:y},k.createElement(_P,Be({asChild:!0},g,{orientation:l,dir:A,loop:c}),k.createElement(ht.div,Be({role:"radiogroup","aria-required":o,"aria-orientation":l,"data-disabled":a?"":void 0,dir:A},d,{ref:e}))))}),DZ="RadioGroupItem",kZ=k.forwardRef((i,e)=>{const{__scopeRadioGroup:t,disabled:n,...r}=i,s=RZ(DZ,t),o=s.disabled||n,a=LP(t),l=TZ(t),u=k.useRef(null),c=Gt(e,u),h=s.value===r.value,d=k.useRef(!1);return k.useEffect(()=>{const g=p=>{bZ.includes(p.key)&&(d.current=!0)},A=()=>d.current=!1;return document.addEventListener("keydown",g),document.addEventListener("keyup",A),()=>{document.removeEventListener("keydown",g),document.removeEventListener("keyup",A)}},[]),k.createElement(CP,Be({asChild:!0},a,{focusable:!o,active:h}),k.createElement(CZ,Be({disabled:o,required:s.required,checked:h},l,r,{name:s.name,ref:c,onCheck:()=>s.onValueChange(r.value),onKeyDown:tt(g=>{g.key==="Enter"&&g.preventDefault()}),onFocus:tt(r.onFocus,()=>{var g;d.current&&((g=u.current)===null||g===void 0||g.click())})})))}),DP=LZ,kP=kZ;function hr(i,e){this.message=i,this.error=e}hr.prototype=Object.create(Error.prototype);const R_=/([0-9]+)?:?([0-9]{2}):([0-9]{2}\.[0-9]{2,3})/;function PZ(i,e){e||(e={});const{meta:t=!1,strict:n=!0}=e;if(typeof i!="string")throw new hr("Input must be a string");i=i.trim(),i=i.replace(/\r\n/g,`
`),i=i.replace(/\r/g,`
`);const r=i.split(`

`),s=r.shift();if(!s.startsWith("WEBVTT"))throw new hr('Must start with "WEBVTT"');const o=s.split(`
`),a=o[0].replace("WEBVTT","");if(a.length>0&&a[0]!==" "&&a[0]!=="	")throw new hr("Header comment must start with space or tab");if(r.length===0&&o.length===1)return{valid:!0,strict:n,cues:[],errors:[]};if(!t&&o.length>1&&o[1]!=="")throw new hr("Missing blank line after signature");const{cues:l,errors:u}=FZ(r,n);if(n&&u.length>0)throw u[0];const c=t?MZ(o):null,h={valid:u.length===0,strict:n,cues:l,errors:u};return t&&(h.meta=c),h}function MZ(i){const e={};return i.slice(1).forEach(t=>{const n=t.indexOf(":"),r=t.slice(0,n).trim(),s=t.slice(n+1).trim();e[r]=s}),Object.keys(e).length>0?e:null}function FZ(i,e){const t=[];return{cues:i.map((r,s)=>{try{return OZ(r,s,e)}catch(o){return t.push(o),null}}).filter(Boolean),errors:t}}function OZ(i,e,t){let n="",r=0,s=.01,o="",a="";const l=i.split(`
`).filter(Boolean);if(l.length>0&&l[0].trim().startsWith("NOTE"))return null;if(l.length===1&&!l[0].includes("-->"))throw new hr(`Cue identifier cannot be standalone (cue #${e})`);if(l.length>1&&!(l[0].includes("-->")||l[1].includes("-->"))){const c=`Cue identifier needs to be followed by timestamp (cue #${e})`;throw new hr(c)}l.length>1&&l[1].includes("-->")&&(n=l.shift());const u=typeof l[0]=="string"&&l[0].split(" --> ");if(u.length!==2||!PP(u[0])||!PP(u[1]))throw new hr(`Invalid cue timestamp (cue #${e})`);if(r=MP(u[0]),s=MP(u[1]),t){if(r>s)throw new hr(`Start timestamp greater than end (cue #${e})`);if(s<=r)throw new hr(`End must be greater than start (cue #${e})`)}if(!t&&s<r)throw new hr(`End must be greater or equal to start when not strict (cue #${e})`);return a=u[1].replace(R_,"").trim(),l.shift(),o=l.join(`
`),o?{identifier:n,start:r,end:s,text:o,styles:a}:!1}function PP(i){return R_.test(i)}function MP(i){const e=i.match(R_);let t=parseFloat(e[1]||0)*60*60;return t+=parseFloat(e[2])*60,t+=parseFloat(e[3]),t}var FP={ParserError:hr,parse:PZ};function sn(i,e){this.message=i,this.error=e}sn.prototype=Object.create(Error.prototype);function NZ(i){if(!i)throw new sn("Input must be non-null");if(typeof i!="object")throw new sn("Input must be an object");if(Array.isArray(i))throw new sn("Input cannot be array");if(!i.valid)throw new sn("Input must be valid");let e=`WEBVTT
`;if(i.meta){if(typeof i.meta!="object"||Array.isArray(i.meta))throw new sn("Metadata must be an object");Object.entries(i.meta).forEach(n=>{if(typeof n[1]!="string")throw new sn(`Metadata value for "${n[0]}" must be string`);e+=`${n[0]}: ${n[1]}
`})}let t=null;return i.cues.forEach((n,r)=>{if(t&&t>n.start)throw new sn(`Cue number ${r} is not in chronological order`);t=n.start,e+=`
`,e+=QZ(n),e+=`
`}),e}function QZ(i){if(typeof i!="object")throw new sn("Cue malformed: not of type object");if(typeof i.identifier!="string"&&typeof i.identifier!="number"&&i.identifier!==null)throw new sn(`Cue malformed: identifier value is not a string.
    ${JSON.stringify(i)}`);if(isNaN(i.start))throw new sn(`Cue malformed: null start value.
    ${JSON.stringify(i)}`);if(isNaN(i.end))throw new sn(`Cue malformed: null end value.
    ${JSON.stringify(i)}`);if(i.start>=i.end)throw new sn(`Cue malformed: start timestamp greater than end
    ${JSON.stringify(i)}`);if(typeof i.text!="string")throw new sn(`Cue malformed: null text value.
    ${JSON.stringify(i)}`);if(typeof i.styles!="string")throw new sn(`Cue malformed: null styles value.
    ${JSON.stringify(i)}`);let e="";i.identifier.length>0&&(e+=`${i.identifier}
`);const t=OP(i.start),n=OP(i.end);return e+=`${t} --> ${n}`,e+=i.styles?` ${i.styles}`:"",e+=`
${i.text}`,e}function OP(i){const e=op(UZ(i),2),t=op(GZ(i),2),n=op(HZ(i),2),r=op(zZ(i),3);return`${e}:${t}:${n}.${r}`}function op(i,e){let t=`${i}`;for(;t.length<e;)t=`0${t}`;return t}function UZ(i){return Math.floor(i/60/60)}function GZ(i){return Math.floor(i/60)%60}function HZ(i){return Math.floor(i%60)}function zZ(i){return Math.floor((i%1).toFixed(4)*1e3)}var VZ={CompilerError:sn,compile:NZ};const qZ=FP.parse;function $Z(i,e){e=e||10;const t=qZ(i),n=[];let r=[],s=null,o=0,a=0;return t.cues.forEach((l,u)=>{const c=u===0,h=u===t.cues.length-1,d=l.start,g=l.end,A=h?1/0:t.cues[u+1].start,p=c?g:g-d,y=c?0:d-t.cues[u-1].end;o=o+p+y,`${u}`,n.length+1,s&&(r.push(s),o+=s.end-a,s=null),r.push(l);let v=A-g<e&&y<e&&o>e;if(jZ(a,e,A,y)){const E=WZ(h,g,e,o,a);n.push({duration:E,cues:r}),a+=E,o=0,r=[]}else v=!1;v&&(s=l)}),n}function jZ(i,e,t,n){const r=NP(n,e);return(n<=e||r+i<t)&&t-i>=e}function WZ(i,e,t,n,r){let s=t;return n>t&&(s=NP(n-t,t)),i?s=parseFloat((e-r).toFixed(2)):s=Math.round(s),s}function NP(i,e){return i+=e-i%e,i}function Aye(i){}var QP={segment:$Z};const UP=QP.segment;function KZ(i,e,t){typeof t>"u"&&(t="900000");const n=UP(i,e),r=[];return n.forEach((s,o)=>{const a=`WEBVTT
X-TIMESTAMP-MAP=MPEGTS:${t},LOCAL:00:00:00.000

${JZ(s.cues)}
`,l=GP(o);r.push({filename:l,content:a})}),r}function YZ(i,e){const t=UP(i,e),n=ZZ(t);return`#EXTM3U
#EXT-X-TARGETDURATION:${Math.round(XZ(t))}
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:0
#EXT-X-PLAYLIST-TYPE:VOD
${n}
#EXT-X-ENDLIST
`}function ap(i,e){return`${"0".repeat(Math.max(0,e-i.toString().length))}${i}`}function GP(i){return`${i}.vtt`}function ZZ(i){const e=[];return i.forEach((t,n)=>{e.push(`#EXTINF:${t.duration.toFixed(5)},
${GP(n)}`)}),e.join(`
`)}function XZ(i){let e=0;return i.forEach(t=>{t.duration>e&&(e=t.duration)}),e}function JZ(i){const e=[];return i.forEach(t=>{e.push(eX(t))}),e.join(`

`)}function eX(i){const e=[];i.identifier&&e.push(i.identifier);const t=HP(i.start),n=HP(i.end),r=i.styles?`${i.styles}`:"";return e.push(`${t} --> ${n} ${r}`),e.push(i.text),e.join(`
`)}function HP(i){const e=(i%1).toFixed(3);i=Math.round(i-e);const t=Math.floor(i/3600),n=Math.floor((i-t*3600)/60),r=i-t*3600-n*60;return`${`${ap(t,2)}:`}${ap(n,2)}:${ap(r,2)}.${ap(e*1e3,3)}`}var tX={hlsSegment:KZ,hlsSegmentPlaylist:YZ};const iX=FP.parse,nX=VZ.compile,rX=QP.segment;var sX={parse:iX,compile:nX,segment:rX,hls:tX};const[L_,mye]=Or("Form"),zP="Form",[oX,VP]=L_(zP),[aX,lX]=L_(zP),uX=k.forwardRef((i,e)=>{const{__scopeForm:t,onClearServerErrors:n=()=>{},...r}=i,s=k.useRef(null),o=Gt(e,s),[a,l]=k.useState({}),u=k.useCallback(M=>a[M],[a]),c=k.useCallback((M,R)=>l(z=>{var q;return{...z,[M]:{...(q=z[M])!==null&&q!==void 0?q:{},...R}}}),[]),h=k.useCallback(M=>{l(R=>({...R,[M]:void 0})),E(R=>({...R,[M]:{}}))},[]),[d,g]=k.useState({}),A=k.useCallback(M=>{var R;return(R=d[M])!==null&&R!==void 0?R:[]},[d]),p=k.useCallback((M,R)=>{g(z=>{var q;return{...z,[M]:[...(q=z[M])!==null&&q!==void 0?q:[],R]}})},[]),y=k.useCallback((M,R)=>{g(z=>{var q;return{...z,[M]:((q=z[M])!==null&&q!==void 0?q:[]).filter(X=>X.id!==R)}})},[]),[v,E]=k.useState({}),I=k.useCallback(M=>{var R;return(R=v[M])!==null&&R!==void 0?R:{}},[v]),C=k.useCallback((M,R)=>{E(z=>{var q;return{...z,[M]:{...(q=z[M])!==null&&q!==void 0?q:{},...R}}})},[]),[w,S]=k.useState({}),x=k.useCallback((M,R)=>{S(z=>{const q=new Set(z[M]).add(R);return{...z,[M]:q}})},[]),T=k.useCallback((M,R)=>{S(z=>{const q=new Set(z[M]);return q.delete(R),{...z,[M]:q}})},[]),Q=k.useCallback(M=>{var R;return Array.from((R=w[M])!==null&&R!==void 0?R:[]).join(" ")||void 0},[w]);return k.createElement(oX,{scope:t,getFieldValidity:u,onFieldValidityChange:c,getFieldCustomMatcherEntries:A,onFieldCustomMatcherEntryAdd:p,onFieldCustomMatcherEntryRemove:y,getFieldCustomErrors:I,onFieldCustomErrorsChange:C,onFieldValiditionClear:h},k.createElement(aX,{scope:t,onFieldMessageIdAdd:x,onFieldMessageIdRemove:T,getFieldDescription:Q},k.createElement(ht.form,Be({},r,{ref:o,onInvalid:tt(i.onInvalid,M=>{const R=jP(M.currentTarget);R===M.target&&R.focus(),M.preventDefault()}),onSubmit:tt(i.onSubmit,n,{checkForDefaultPrevented:!1}),onReset:tt(i.onReset,n)}))))}),qP="FormField",[cX,hX]=L_(qP),dX=k.forwardRef((i,e)=>{const{__scopeForm:t,name:n,serverInvalid:r=!1,...s}=i,a=VP(qP,t).getFieldValidity(n),l=Ea();return k.createElement(cX,{scope:t,id:l,name:n,serverInvalid:r},k.createElement(ht.div,Be({"data-valid":WP(a,r),"data-invalid":KP(a,r)},s,{ref:e})))}),D_="FormControl",fX=k.forwardRef((i,e)=>{const{__scopeForm:t,...n}=i,r=VP(D_,t),s=hX(D_,t),o=lX(D_,t),a=k.useRef(null),l=Gt(e,a),u=n.name||s.name,c=n.id||s.id,h=r.getFieldCustomMatcherEntries(u),{onFieldValidityChange:d,onFieldCustomErrorsChange:g,onFieldValiditionClear:A}=r,p=k.useCallback(async E=>{if(IX(E.validity)){const z=k_(E.validity);d(u,z);return}const I=E.form?new FormData(E.form):new FormData,C=[E.value,I],w=[],S=[];h.forEach(z=>{yX(z,C)?S.push(z):vX(z)&&w.push(z)});const x=w.map(({id:z,match:q})=>[z,q(...C)]),T=Object.fromEntries(x),Q=Object.values(T).some(Boolean),M=Q;E.setCustomValidity(M?$P:"");const R=k_(E.validity);if(d(u,R),g(u,T),!Q&&S.length>0){const z=S.map(({id:V,match:Z})=>Z(...C).then(Y=>[V,Y])),q=await Promise.all(z),X=Object.fromEntries(q),G=Object.values(X).some(Boolean);E.setCustomValidity(G?$P:"");const j=k_(E.validity);d(u,j),g(u,X)}},[h,u,g,d]);k.useEffect(()=>{const E=a.current;if(E){const I=()=>p(E);return E.addEventListener("change",I),()=>E.removeEventListener("change",I)}},[p]);const y=k.useCallback(()=>{const E=a.current;E&&(E.setCustomValidity(""),A(u))},[u,A]);k.useEffect(()=>{var E;const I=(E=a.current)===null||E===void 0?void 0:E.form;if(I)return I.addEventListener("reset",y),()=>I.removeEventListener("reset",y)},[y]),k.useEffect(()=>{const E=a.current,I=E==null?void 0:E.closest("form");if(I&&s.serverInvalid){const C=jP(I);C===E&&C.focus()}},[s.serverInvalid]);const v=r.getFieldValidity(u);return k.createElement(ht.input,Be({"data-valid":WP(v,s.serverInvalid),"data-invalid":KP(v,s.serverInvalid),"aria-invalid":s.serverInvalid?!0:void 0,"aria-describedby":o.getFieldDescription(u),title:""},n,{ref:l,id:c,name:u,onInvalid:tt(i.onInvalid,E=>{const I=E.currentTarget;p(I)}),onChange:tt(i.onChange,E=>{y()})}))}),$P="This value is not valid",gX=k.forwardRef((i,e)=>{const{__scopeForm:t,...n}=i;return k.createElement(ht.button,Be({type:"submit"},n,{ref:e}))});function k_(i){const e={};for(const t in i)e[t]=i[t];return e}function AX(i){return i instanceof HTMLElement}function pX(i){return"validity"in i}function mX(i){return pX(i)&&(i.validity.valid===!1||i.getAttribute("aria-invalid")==="true")}function jP(i){const e=i.elements,[t]=Array.from(e).filter(AX).filter(mX);return t}function yX(i,e){return i.match.constructor.name==="AsyncFunction"||EX(i.match,e)}function vX(i){return i.match.constructor.name==="Function"}function EX(i,e){return i(...e)instanceof Promise}function IX(i){let e=!1;for(const t in i){const n=t;if(n!=="valid"&&n!=="customError"&&i[n]){e=!0;break}}return e}function WP(i,e){if((i==null?void 0:i.valid)===!0&&!e)return!0}function KP(i,e){if((i==null?void 0:i.valid)===!1||e)return!0}const _X=uX,CX=dX,wX=fX,xX=gX;var YP={},yf={},P_={},vf={},M_={};Object.defineProperty(M_,"__esModule",{value:!0}),M_.default=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(function(i){return i.charCodeAt(0)}));var F_={};Object.defineProperty(F_,"__esModule",{value:!0}),F_.default=new Uint16Array("Ȁaglq	\x1Bɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(function(i){return i.charCodeAt(0)}));var O_={};(function(i){var e;Object.defineProperty(i,"__esModule",{value:!0}),i.replaceCodePoint=i.fromCodePoint=void 0;var t=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);i.fromCodePoint=(e=String.fromCodePoint)!==null&&e!==void 0?e:function(s){var o="";return s>65535&&(s-=65536,o+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),o+=String.fromCharCode(s),o};function n(s){var o;return s>=55296&&s<=57343||s>1114111?65533:(o=t.get(s))!==null&&o!==void 0?o:s}i.replaceCodePoint=n;function r(s){return(0,i.fromCodePoint)(n(s))}i.default=r})(O_),function(i){var e=We&&We.__createBinding||(Object.create?function(R,z,q,X){X===void 0&&(X=q);var N=Object.getOwnPropertyDescriptor(z,q);(!N||("get"in N?!z.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return z[q]}}),Object.defineProperty(R,X,N)}:function(R,z,q,X){X===void 0&&(X=q),R[X]=z[q]}),t=We&&We.__setModuleDefault||(Object.create?function(R,z){Object.defineProperty(R,"default",{enumerable:!0,value:z})}:function(R,z){R.default=z}),n=We&&We.__importStar||function(R){if(R&&R.__esModule)return R;var z={};if(R!=null)for(var q in R)q!=="default"&&Object.prototype.hasOwnProperty.call(R,q)&&e(z,R,q);return t(z,R),z},r=We&&We.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(i,"__esModule",{value:!0}),i.decodeXML=i.decodeHTMLStrict=i.decodeHTMLAttribute=i.decodeHTML=i.determineBranch=i.EntityDecoder=i.DecodingMode=i.BinTrieFlags=i.fromCodePoint=i.replaceCodePoint=i.decodeCodePoint=i.xmlDecodeTree=i.htmlDecodeTree=void 0;var s=r(M_);i.htmlDecodeTree=s.default;var o=r(F_);i.xmlDecodeTree=o.default;var a=n(O_);i.decodeCodePoint=a.default;var l=O_;Object.defineProperty(i,"replaceCodePoint",{enumerable:!0,get:function(){return l.replaceCodePoint}}),Object.defineProperty(i,"fromCodePoint",{enumerable:!0,get:function(){return l.fromCodePoint}});var u;(function(R){R[R.NUM=35]="NUM",R[R.SEMI=59]="SEMI",R[R.EQUALS=61]="EQUALS",R[R.ZERO=48]="ZERO",R[R.NINE=57]="NINE",R[R.LOWER_A=97]="LOWER_A",R[R.LOWER_F=102]="LOWER_F",R[R.LOWER_X=120]="LOWER_X",R[R.LOWER_Z=122]="LOWER_Z",R[R.UPPER_A=65]="UPPER_A",R[R.UPPER_F=70]="UPPER_F",R[R.UPPER_Z=90]="UPPER_Z"})(u||(u={}));var c=32,h;(function(R){R[R.VALUE_LENGTH=49152]="VALUE_LENGTH",R[R.BRANCH_LENGTH=16256]="BRANCH_LENGTH",R[R.JUMP_TABLE=127]="JUMP_TABLE"})(h=i.BinTrieFlags||(i.BinTrieFlags={}));function d(R){return R>=u.ZERO&&R<=u.NINE}function g(R){return R>=u.UPPER_A&&R<=u.UPPER_F||R>=u.LOWER_A&&R<=u.LOWER_F}function A(R){return R>=u.UPPER_A&&R<=u.UPPER_Z||R>=u.LOWER_A&&R<=u.LOWER_Z||d(R)}function p(R){return R===u.EQUALS||A(R)}var y;(function(R){R[R.EntityStart=0]="EntityStart",R[R.NumericStart=1]="NumericStart",R[R.NumericDecimal=2]="NumericDecimal",R[R.NumericHex=3]="NumericHex",R[R.NamedEntity=4]="NamedEntity"})(y||(y={}));var v;(function(R){R[R.Legacy=0]="Legacy",R[R.Strict=1]="Strict",R[R.Attribute=2]="Attribute"})(v=i.DecodingMode||(i.DecodingMode={}));var E=function(){function R(z,q,X){this.decodeTree=z,this.emitCodePoint=q,this.errors=X,this.state=y.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=v.Strict}return R.prototype.startEntity=function(z){this.decodeMode=z,this.state=y.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},R.prototype.write=function(z,q){switch(this.state){case y.EntityStart:return z.charCodeAt(q)===u.NUM?(this.state=y.NumericStart,this.consumed+=1,this.stateNumericStart(z,q+1)):(this.state=y.NamedEntity,this.stateNamedEntity(z,q));case y.NumericStart:return this.stateNumericStart(z,q);case y.NumericDecimal:return this.stateNumericDecimal(z,q);case y.NumericHex:return this.stateNumericHex(z,q);case y.NamedEntity:return this.stateNamedEntity(z,q)}},R.prototype.stateNumericStart=function(z,q){return q>=z.length?-1:(z.charCodeAt(q)|c)===u.LOWER_X?(this.state=y.NumericHex,this.consumed+=1,this.stateNumericHex(z,q+1)):(this.state=y.NumericDecimal,this.stateNumericDecimal(z,q))},R.prototype.addToNumericResult=function(z,q,X,N){if(q!==X){var G=X-q;this.result=this.result*Math.pow(N,G)+parseInt(z.substr(q,G),N),this.consumed+=G}},R.prototype.stateNumericHex=function(z,q){for(var X=q;q<z.length;){var N=z.charCodeAt(q);if(d(N)||g(N))q+=1;else return this.addToNumericResult(z,X,q,16),this.emitNumericEntity(N,3)}return this.addToNumericResult(z,X,q,16),-1},R.prototype.stateNumericDecimal=function(z,q){for(var X=q;q<z.length;){var N=z.charCodeAt(q);if(d(N))q+=1;else return this.addToNumericResult(z,X,q,10),this.emitNumericEntity(N,2)}return this.addToNumericResult(z,X,q,10),-1},R.prototype.emitNumericEntity=function(z,q){var X;if(this.consumed<=q)return(X=this.errors)===null||X===void 0||X.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(z===u.SEMI)this.consumed+=1;else if(this.decodeMode===v.Strict)return 0;return this.emitCodePoint((0,a.replaceCodePoint)(this.result),this.consumed),this.errors&&(z!==u.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},R.prototype.stateNamedEntity=function(z,q){for(var X=this.decodeTree,N=X[this.treeIndex],G=(N&h.VALUE_LENGTH)>>14;q<z.length;q++,this.excess++){var j=z.charCodeAt(q);if(this.treeIndex=C(X,N,this.treeIndex+Math.max(1,G),j),this.treeIndex<0)return this.result===0||this.decodeMode===v.Attribute&&(G===0||p(j))?0:this.emitNotTerminatedNamedEntity();if(N=X[this.treeIndex],G=(N&h.VALUE_LENGTH)>>14,G!==0){if(j===u.SEMI)return this.emitNamedEntityData(this.treeIndex,G,this.consumed+this.excess);this.decodeMode!==v.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},R.prototype.emitNotTerminatedNamedEntity=function(){var z,q=this,X=q.result,N=q.decodeTree,G=(N[X]&h.VALUE_LENGTH)>>14;return this.emitNamedEntityData(X,G,this.consumed),(z=this.errors)===null||z===void 0||z.missingSemicolonAfterCharacterReference(),this.consumed},R.prototype.emitNamedEntityData=function(z,q,X){var N=this.decodeTree;return this.emitCodePoint(q===1?N[z]&~h.VALUE_LENGTH:N[z+1],X),q===3&&this.emitCodePoint(N[z+2],X),X},R.prototype.end=function(){var z;switch(this.state){case y.NamedEntity:return this.result!==0&&(this.decodeMode!==v.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case y.NumericDecimal:return this.emitNumericEntity(0,2);case y.NumericHex:return this.emitNumericEntity(0,3);case y.NumericStart:return(z=this.errors)===null||z===void 0||z.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case y.EntityStart:return 0}},R}();i.EntityDecoder=E;function I(R){var z="",q=new E(R,function(X){return z+=(0,a.fromCodePoint)(X)});return function(N,G){for(var j=0,V=0;(V=N.indexOf("&",V))>=0;){z+=N.slice(j,V),q.startEntity(G);var Z=q.write(N,V+1);if(Z<0){j=V+q.end();break}j=V+Z,V=Z===0?j+1:j}var Y=z+N.slice(j);return z="",Y}}function C(R,z,q,X){var N=(z&h.BRANCH_LENGTH)>>7,G=z&h.JUMP_TABLE;if(N===0)return G!==0&&X===G?q:-1;if(G){var j=X-G;return j<0||j>=N?-1:R[q+j]-1}for(var V=q,Z=V+N-1;V<=Z;){var Y=V+Z>>>1,te=R[Y];if(te<X)V=Y+1;else if(te>X)Z=Y-1;else return R[Y+N]}return-1}i.determineBranch=C;var w=I(s.default),S=I(o.default);function x(R,z){return z===void 0&&(z=v.Legacy),w(R,z)}i.decodeHTML=x;function T(R){return w(R,v.Attribute)}i.decodeHTMLAttribute=T;function Q(R){return w(R,v.Strict)}i.decodeHTMLStrict=Q;function M(R){return S(R,v.Strict)}i.decodeXML=M}(vf),function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.QuoteType=void 0;var e=vf,t;(function(d){d[d.Tab=9]="Tab",d[d.NewLine=10]="NewLine",d[d.FormFeed=12]="FormFeed",d[d.CarriageReturn=13]="CarriageReturn",d[d.Space=32]="Space",d[d.ExclamationMark=33]="ExclamationMark",d[d.Number=35]="Number",d[d.Amp=38]="Amp",d[d.SingleQuote=39]="SingleQuote",d[d.DoubleQuote=34]="DoubleQuote",d[d.Dash=45]="Dash",d[d.Slash=47]="Slash",d[d.Zero=48]="Zero",d[d.Nine=57]="Nine",d[d.Semi=59]="Semi",d[d.Lt=60]="Lt",d[d.Eq=61]="Eq",d[d.Gt=62]="Gt",d[d.Questionmark=63]="Questionmark",d[d.UpperA=65]="UpperA",d[d.LowerA=97]="LowerA",d[d.UpperF=70]="UpperF",d[d.LowerF=102]="LowerF",d[d.UpperZ=90]="UpperZ",d[d.LowerZ=122]="LowerZ",d[d.LowerX=120]="LowerX",d[d.OpeningSquareBracket=91]="OpeningSquareBracket"})(t||(t={}));var n;(function(d){d[d.Text=1]="Text",d[d.BeforeTagName=2]="BeforeTagName",d[d.InTagName=3]="InTagName",d[d.InSelfClosingTag=4]="InSelfClosingTag",d[d.BeforeClosingTagName=5]="BeforeClosingTagName",d[d.InClosingTagName=6]="InClosingTagName",d[d.AfterClosingTagName=7]="AfterClosingTagName",d[d.BeforeAttributeName=8]="BeforeAttributeName",d[d.InAttributeName=9]="InAttributeName",d[d.AfterAttributeName=10]="AfterAttributeName",d[d.BeforeAttributeValue=11]="BeforeAttributeValue",d[d.InAttributeValueDq=12]="InAttributeValueDq",d[d.InAttributeValueSq=13]="InAttributeValueSq",d[d.InAttributeValueNq=14]="InAttributeValueNq",d[d.BeforeDeclaration=15]="BeforeDeclaration",d[d.InDeclaration=16]="InDeclaration",d[d.InProcessingInstruction=17]="InProcessingInstruction",d[d.BeforeComment=18]="BeforeComment",d[d.CDATASequence=19]="CDATASequence",d[d.InSpecialComment=20]="InSpecialComment",d[d.InCommentLike=21]="InCommentLike",d[d.BeforeSpecialS=22]="BeforeSpecialS",d[d.SpecialStartSequence=23]="SpecialStartSequence",d[d.InSpecialTag=24]="InSpecialTag",d[d.BeforeEntity=25]="BeforeEntity",d[d.BeforeNumericEntity=26]="BeforeNumericEntity",d[d.InNamedEntity=27]="InNamedEntity",d[d.InNumericEntity=28]="InNumericEntity",d[d.InHexEntity=29]="InHexEntity"})(n||(n={}));function r(d){return d===t.Space||d===t.NewLine||d===t.Tab||d===t.FormFeed||d===t.CarriageReturn}function s(d){return d===t.Slash||d===t.Gt||r(d)}function o(d){return d>=t.Zero&&d<=t.Nine}function a(d){return d>=t.LowerA&&d<=t.LowerZ||d>=t.UpperA&&d<=t.UpperZ}function l(d){return d>=t.UpperA&&d<=t.UpperF||d>=t.LowerA&&d<=t.LowerF}var u;(function(d){d[d.NoValue=0]="NoValue",d[d.Unquoted=1]="Unquoted",d[d.Single=2]="Single",d[d.Double=3]="Double"})(u=i.QuoteType||(i.QuoteType={}));var c={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},h=function(){function d(g,A){var p=g.xmlMode,y=p===void 0?!1:p,v=g.decodeEntities,E=v===void 0?!0:v;this.cbs=A,this.state=n.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=n.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=y,this.decodeEntities=E,this.entityTrie=y?e.xmlDecodeTree:e.htmlDecodeTree}return d.prototype.reset=function(){this.state=n.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=n.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},d.prototype.write=function(g){this.offset+=this.buffer.length,this.buffer=g,this.parse()},d.prototype.end=function(){this.running&&this.finish()},d.prototype.pause=function(){this.running=!1},d.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},d.prototype.getIndex=function(){return this.index},d.prototype.getSectionStart=function(){return this.sectionStart},d.prototype.stateText=function(g){g===t.Lt||!this.decodeEntities&&this.fastForwardTo(t.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=n.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&g===t.Amp&&(this.state=n.BeforeEntity)},d.prototype.stateSpecialStartSequence=function(g){var A=this.sequenceIndex===this.currentSequence.length,p=A?s(g):(g|32)===this.currentSequence[this.sequenceIndex];if(!p)this.isSpecial=!1;else if(!A){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=n.InTagName,this.stateInTagName(g)},d.prototype.stateInSpecialTag=function(g){if(this.sequenceIndex===this.currentSequence.length){if(g===t.Gt||r(g)){var A=this.index-this.currentSequence.length;if(this.sectionStart<A){var p=this.index;this.index=A,this.cbs.ontext(this.sectionStart,A),this.index=p}this.isSpecial=!1,this.sectionStart=A+2,this.stateInClosingTagName(g);return}this.sequenceIndex=0}(g|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===c.TitleEnd?this.decodeEntities&&g===t.Amp&&(this.state=n.BeforeEntity):this.fastForwardTo(t.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(g===t.Lt)},d.prototype.stateCDATASequence=function(g){g===c.Cdata[this.sequenceIndex]?++this.sequenceIndex===c.Cdata.length&&(this.state=n.InCommentLike,this.currentSequence=c.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=n.InDeclaration,this.stateInDeclaration(g))},d.prototype.fastForwardTo=function(g){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===g)return!0;return this.index=this.buffer.length+this.offset-1,!1},d.prototype.stateInCommentLike=function(g){g===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===c.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=n.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):g!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},d.prototype.isTagStartChar=function(g){return this.xmlMode?!s(g):a(g)},d.prototype.startSpecial=function(g,A){this.isSpecial=!0,this.currentSequence=g,this.sequenceIndex=A,this.state=n.SpecialStartSequence},d.prototype.stateBeforeTagName=function(g){if(g===t.ExclamationMark)this.state=n.BeforeDeclaration,this.sectionStart=this.index+1;else if(g===t.Questionmark)this.state=n.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(g)){var A=g|32;this.sectionStart=this.index,!this.xmlMode&&A===c.TitleEnd[2]?this.startSpecial(c.TitleEnd,3):this.state=!this.xmlMode&&A===c.ScriptEnd[2]?n.BeforeSpecialS:n.InTagName}else g===t.Slash?this.state=n.BeforeClosingTagName:(this.state=n.Text,this.stateText(g))},d.prototype.stateInTagName=function(g){s(g)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=n.BeforeAttributeName,this.stateBeforeAttributeName(g))},d.prototype.stateBeforeClosingTagName=function(g){r(g)||(g===t.Gt?this.state=n.Text:(this.state=this.isTagStartChar(g)?n.InClosingTagName:n.InSpecialComment,this.sectionStart=this.index))},d.prototype.stateInClosingTagName=function(g){(g===t.Gt||r(g))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=n.AfterClosingTagName,this.stateAfterClosingTagName(g))},d.prototype.stateAfterClosingTagName=function(g){(g===t.Gt||this.fastForwardTo(t.Gt))&&(this.state=n.Text,this.baseState=n.Text,this.sectionStart=this.index+1)},d.prototype.stateBeforeAttributeName=function(g){g===t.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=n.InSpecialTag,this.sequenceIndex=0):this.state=n.Text,this.baseState=this.state,this.sectionStart=this.index+1):g===t.Slash?this.state=n.InSelfClosingTag:r(g)||(this.state=n.InAttributeName,this.sectionStart=this.index)},d.prototype.stateInSelfClosingTag=function(g){g===t.Gt?(this.cbs.onselfclosingtag(this.index),this.state=n.Text,this.baseState=n.Text,this.sectionStart=this.index+1,this.isSpecial=!1):r(g)||(this.state=n.BeforeAttributeName,this.stateBeforeAttributeName(g))},d.prototype.stateInAttributeName=function(g){(g===t.Eq||s(g))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=n.AfterAttributeName,this.stateAfterAttributeName(g))},d.prototype.stateAfterAttributeName=function(g){g===t.Eq?this.state=n.BeforeAttributeValue:g===t.Slash||g===t.Gt?(this.cbs.onattribend(u.NoValue,this.index),this.state=n.BeforeAttributeName,this.stateBeforeAttributeName(g)):r(g)||(this.cbs.onattribend(u.NoValue,this.index),this.state=n.InAttributeName,this.sectionStart=this.index)},d.prototype.stateBeforeAttributeValue=function(g){g===t.DoubleQuote?(this.state=n.InAttributeValueDq,this.sectionStart=this.index+1):g===t.SingleQuote?(this.state=n.InAttributeValueSq,this.sectionStart=this.index+1):r(g)||(this.sectionStart=this.index,this.state=n.InAttributeValueNq,this.stateInAttributeValueNoQuotes(g))},d.prototype.handleInAttributeValue=function(g,A){g===A||!this.decodeEntities&&this.fastForwardTo(A)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(A===t.DoubleQuote?u.Double:u.Single,this.index),this.state=n.BeforeAttributeName):this.decodeEntities&&g===t.Amp&&(this.baseState=this.state,this.state=n.BeforeEntity)},d.prototype.stateInAttributeValueDoubleQuotes=function(g){this.handleInAttributeValue(g,t.DoubleQuote)},d.prototype.stateInAttributeValueSingleQuotes=function(g){this.handleInAttributeValue(g,t.SingleQuote)},d.prototype.stateInAttributeValueNoQuotes=function(g){r(g)||g===t.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(u.Unquoted,this.index),this.state=n.BeforeAttributeName,this.stateBeforeAttributeName(g)):this.decodeEntities&&g===t.Amp&&(this.baseState=this.state,this.state=n.BeforeEntity)},d.prototype.stateBeforeDeclaration=function(g){g===t.OpeningSquareBracket?(this.state=n.CDATASequence,this.sequenceIndex=0):this.state=g===t.Dash?n.BeforeComment:n.InDeclaration},d.prototype.stateInDeclaration=function(g){(g===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=n.Text,this.sectionStart=this.index+1)},d.prototype.stateInProcessingInstruction=function(g){(g===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=n.Text,this.sectionStart=this.index+1)},d.prototype.stateBeforeComment=function(g){g===t.Dash?(this.state=n.InCommentLike,this.currentSequence=c.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=n.InDeclaration},d.prototype.stateInSpecialComment=function(g){(g===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=n.Text,this.sectionStart=this.index+1)},d.prototype.stateBeforeSpecialS=function(g){var A=g|32;A===c.ScriptEnd[3]?this.startSpecial(c.ScriptEnd,4):A===c.StyleEnd[3]?this.startSpecial(c.StyleEnd,4):(this.state=n.InTagName,this.stateInTagName(g))},d.prototype.stateBeforeEntity=function(g){this.entityExcess=1,this.entityResult=0,g===t.Number?this.state=n.BeforeNumericEntity:g===t.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=n.InNamedEntity,this.stateInNamedEntity(g))},d.prototype.stateInNamedEntity=function(g){if(this.entityExcess+=1,this.trieIndex=(0,e.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,g),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var A=this.trieCurrent&e.BinTrieFlags.VALUE_LENGTH;if(A){var p=(A>>14)-1;if(!this.allowLegacyEntity()&&g!==t.Semi)this.trieIndex+=p;else{var y=this.index-this.entityExcess+1;y>this.sectionStart&&this.emitPartial(this.sectionStart,y),this.entityResult=this.trieIndex,this.trieIndex+=p,this.entityExcess=0,this.sectionStart=this.index+1,p===0&&this.emitNamedEntity()}}},d.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var g=(this.entityTrie[this.entityResult]&e.BinTrieFlags.VALUE_LENGTH)>>14;switch(g){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~e.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},d.prototype.stateBeforeNumericEntity=function(g){(g|32)===t.LowerX?(this.entityExcess++,this.state=n.InHexEntity):(this.state=n.InNumericEntity,this.stateInNumericEntity(g))},d.prototype.emitNumericEntity=function(g){var A=this.index-this.entityExcess-1,p=A+2+ +(this.state===n.InHexEntity);p!==this.index&&(A>this.sectionStart&&this.emitPartial(this.sectionStart,A),this.sectionStart=this.index+Number(g),this.emitCodePoint((0,e.replaceCodePoint)(this.entityResult))),this.state=this.baseState},d.prototype.stateInNumericEntity=function(g){g===t.Semi?this.emitNumericEntity(!0):o(g)?(this.entityResult=this.entityResult*10+(g-t.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},d.prototype.stateInHexEntity=function(g){g===t.Semi?this.emitNumericEntity(!0):o(g)?(this.entityResult=this.entityResult*16+(g-t.Zero),this.entityExcess++):l(g)?(this.entityResult=this.entityResult*16+((g|32)-t.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},d.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===n.Text||this.baseState===n.InSpecialTag)},d.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===n.Text||this.state===n.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===n.InAttributeValueDq||this.state===n.InAttributeValueSq||this.state===n.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},d.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},d.prototype.parse=function(){for(;this.shouldContinue();){var g=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case n.Text:{this.stateText(g);break}case n.SpecialStartSequence:{this.stateSpecialStartSequence(g);break}case n.InSpecialTag:{this.stateInSpecialTag(g);break}case n.CDATASequence:{this.stateCDATASequence(g);break}case n.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(g);break}case n.InAttributeName:{this.stateInAttributeName(g);break}case n.InCommentLike:{this.stateInCommentLike(g);break}case n.InSpecialComment:{this.stateInSpecialComment(g);break}case n.BeforeAttributeName:{this.stateBeforeAttributeName(g);break}case n.InTagName:{this.stateInTagName(g);break}case n.InClosingTagName:{this.stateInClosingTagName(g);break}case n.BeforeTagName:{this.stateBeforeTagName(g);break}case n.AfterAttributeName:{this.stateAfterAttributeName(g);break}case n.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(g);break}case n.BeforeAttributeValue:{this.stateBeforeAttributeValue(g);break}case n.BeforeClosingTagName:{this.stateBeforeClosingTagName(g);break}case n.AfterClosingTagName:{this.stateAfterClosingTagName(g);break}case n.BeforeSpecialS:{this.stateBeforeSpecialS(g);break}case n.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(g);break}case n.InSelfClosingTag:{this.stateInSelfClosingTag(g);break}case n.InDeclaration:{this.stateInDeclaration(g);break}case n.BeforeDeclaration:{this.stateBeforeDeclaration(g);break}case n.BeforeComment:{this.stateBeforeComment(g);break}case n.InProcessingInstruction:{this.stateInProcessingInstruction(g);break}case n.InNamedEntity:{this.stateInNamedEntity(g);break}case n.BeforeEntity:{this.stateBeforeEntity(g);break}case n.InHexEntity:{this.stateInHexEntity(g);break}case n.InNumericEntity:{this.stateInNumericEntity(g);break}default:this.stateBeforeNumericEntity(g)}this.index++}this.cleanup()},d.prototype.finish=function(){this.state===n.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},d.prototype.handleTrailingData=function(){var g=this.buffer.length+this.offset;this.state===n.InCommentLike?this.currentSequence===c.CdataEnd?this.cbs.oncdata(this.sectionStart,g,0):this.cbs.oncomment(this.sectionStart,g,0):this.state===n.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===n.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===n.InTagName||this.state===n.BeforeAttributeName||this.state===n.BeforeAttributeValue||this.state===n.AfterAttributeName||this.state===n.InAttributeName||this.state===n.InAttributeValueSq||this.state===n.InAttributeValueDq||this.state===n.InAttributeValueNq||this.state===n.InClosingTagName||this.cbs.ontext(this.sectionStart,g)},d.prototype.emitPartial=function(g,A){this.baseState!==n.Text&&this.baseState!==n.InSpecialTag?this.cbs.onattribdata(g,A):this.cbs.ontext(g,A)},d.prototype.emitCodePoint=function(g){this.baseState!==n.Text&&this.baseState!==n.InSpecialTag?this.cbs.onattribentity(g):this.cbs.ontextentity(g)},d}();i.default=h}(P_);var bX=We&&We.__createBinding||(Object.create?function(i,e,t,n){n===void 0&&(n=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,n,r)}:function(i,e,t,n){n===void 0&&(n=t),i[n]=e[t]}),SX=We&&We.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),TX=We&&We.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&bX(e,i,t);return SX(e,i),e};Object.defineProperty(yf,"__esModule",{value:!0}),yf.Parser=void 0;var lp=TX(P_),ZP=vf,xc=new Set(["input","option","optgroup","select","button","datalist","textarea"]),Mt=new Set(["p"]),XP=new Set(["thead","tbody"]),JP=new Set(["dd","dt"]),eM=new Set(["rt","rp"]),BX=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",Mt],["h1",Mt],["h2",Mt],["h3",Mt],["h4",Mt],["h5",Mt],["h6",Mt],["select",xc],["input",xc],["output",xc],["button",xc],["datalist",xc],["textarea",xc],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",JP],["dt",JP],["address",Mt],["article",Mt],["aside",Mt],["blockquote",Mt],["details",Mt],["div",Mt],["dl",Mt],["fieldset",Mt],["figcaption",Mt],["figure",Mt],["footer",Mt],["form",Mt],["header",Mt],["hr",Mt],["main",Mt],["nav",Mt],["ol",Mt],["pre",Mt],["section",Mt],["table",Mt],["ul",Mt],["rt",eM],["rp",eM],["tbody",XP],["tfoot",XP]]),RX=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),tM=new Set(["math","svg"]),iM=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),LX=/\s|\//,DX=function(){function i(e,t){t===void 0&&(t={});var n,r,s,o,a;this.options=t,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=e??{},this.lowerCaseTagNames=(n=t.lowerCaseTags)!==null&&n!==void 0?n:!t.xmlMode,this.lowerCaseAttributeNames=(r=t.lowerCaseAttributeNames)!==null&&r!==void 0?r:!t.xmlMode,this.tokenizer=new((s=t.Tokenizer)!==null&&s!==void 0?s:lp.default)(this.options,this),(a=(o=this.cbs).onparserinit)===null||a===void 0||a.call(o,this)}return i.prototype.ontext=function(e,t){var n,r,s=this.getSlice(e,t);this.endIndex=t-1,(r=(n=this.cbs).ontext)===null||r===void 0||r.call(n,s),this.startIndex=t},i.prototype.ontextentity=function(e){var t,n,r=this.tokenizer.getSectionStart();this.endIndex=r-1,(n=(t=this.cbs).ontext)===null||n===void 0||n.call(t,(0,ZP.fromCodePoint)(e)),this.startIndex=r},i.prototype.isVoidElement=function(e){return!this.options.xmlMode&&RX.has(e)},i.prototype.onopentagname=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);this.lowerCaseTagNames&&(n=n.toLowerCase()),this.emitOpenTag(n)},i.prototype.emitOpenTag=function(e){var t,n,r,s;this.openTagStart=this.startIndex,this.tagname=e;var o=!this.options.xmlMode&&BX.get(e);if(o)for(;this.stack.length>0&&o.has(this.stack[this.stack.length-1]);){var a=this.stack.pop();(n=(t=this.cbs).onclosetag)===null||n===void 0||n.call(t,a,!0)}this.isVoidElement(e)||(this.stack.push(e),tM.has(e)?this.foreignContext.push(!0):iM.has(e)&&this.foreignContext.push(!1)),(s=(r=this.cbs).onopentagname)===null||s===void 0||s.call(r,e),this.cbs.onopentag&&(this.attribs={})},i.prototype.endOpenTag=function(e){var t,n;this.startIndex=this.openTagStart,this.attribs&&((n=(t=this.cbs).onopentag)===null||n===void 0||n.call(t,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},i.prototype.onopentagend=function(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1},i.prototype.onclosetag=function(e,t){var n,r,s,o,a,l;this.endIndex=t;var u=this.getSlice(e,t);if(this.lowerCaseTagNames&&(u=u.toLowerCase()),(tM.has(u)||iM.has(u))&&this.foreignContext.pop(),this.isVoidElement(u))!this.options.xmlMode&&u==="br"&&((r=(n=this.cbs).onopentagname)===null||r===void 0||r.call(n,"br"),(o=(s=this.cbs).onopentag)===null||o===void 0||o.call(s,"br",{},!0),(l=(a=this.cbs).onclosetag)===null||l===void 0||l.call(a,"br",!1));else{var c=this.stack.lastIndexOf(u);if(c!==-1)if(this.cbs.onclosetag)for(var h=this.stack.length-c;h--;)this.cbs.onclosetag(this.stack.pop(),h!==0);else this.stack.length=c;else!this.options.xmlMode&&u==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=t+1},i.prototype.onselfclosingtag=function(e){this.endIndex=e,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)},i.prototype.closeCurrentTag=function(e){var t,n,r=this.tagname;this.endOpenTag(e),this.stack[this.stack.length-1]===r&&((n=(t=this.cbs).onclosetag)===null||n===void 0||n.call(t,r,!e),this.stack.pop())},i.prototype.onattribname=function(e,t){this.startIndex=e;var n=this.getSlice(e,t);this.attribname=this.lowerCaseAttributeNames?n.toLowerCase():n},i.prototype.onattribdata=function(e,t){this.attribvalue+=this.getSlice(e,t)},i.prototype.onattribentity=function(e){this.attribvalue+=(0,ZP.fromCodePoint)(e)},i.prototype.onattribend=function(e,t){var n,r;this.endIndex=t,(r=(n=this.cbs).onattribute)===null||r===void 0||r.call(n,this.attribname,this.attribvalue,e===lp.QuoteType.Double?'"':e===lp.QuoteType.Single?"'":e===lp.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},i.prototype.getInstructionName=function(e){var t=e.search(LX),n=t<0?e:e.substr(0,t);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n},i.prototype.ondeclaration=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){var r=this.getInstructionName(n);this.cbs.onprocessinginstruction("!".concat(r),"!".concat(n))}this.startIndex=t+1},i.prototype.onprocessinginstruction=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){var r=this.getInstructionName(n);this.cbs.onprocessinginstruction("?".concat(r),"?".concat(n))}this.startIndex=t+1},i.prototype.oncomment=function(e,t,n){var r,s,o,a;this.endIndex=t,(s=(r=this.cbs).oncomment)===null||s===void 0||s.call(r,this.getSlice(e,t-n)),(a=(o=this.cbs).oncommentend)===null||a===void 0||a.call(o),this.startIndex=t+1},i.prototype.oncdata=function(e,t,n){var r,s,o,a,l,u,c,h,d,g;this.endIndex=t;var A=this.getSlice(e,t-n);this.options.xmlMode||this.options.recognizeCDATA?((s=(r=this.cbs).oncdatastart)===null||s===void 0||s.call(r),(a=(o=this.cbs).ontext)===null||a===void 0||a.call(o,A),(u=(l=this.cbs).oncdataend)===null||u===void 0||u.call(l)):((h=(c=this.cbs).oncomment)===null||h===void 0||h.call(c,"[CDATA[".concat(A,"]]")),(g=(d=this.cbs).oncommentend)===null||g===void 0||g.call(d)),this.startIndex=t+1},i.prototype.onend=function(){var e,t;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var n=this.stack.length;n>0;this.cbs.onclosetag(this.stack[--n],!0));}(t=(e=this.cbs).onend)===null||t===void 0||t.call(e)},i.prototype.reset=function(){var e,t,n,r;(t=(e=this.cbs).onreset)===null||t===void 0||t.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(r=(n=this.cbs).onparserinit)===null||r===void 0||r.call(n,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},i.prototype.parseComplete=function(e){this.reset(),this.end(e)},i.prototype.getSlice=function(e,t){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var n=this.buffers[0].slice(e-this.bufferOffset,t-this.bufferOffset);t-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),n+=this.buffers[0].slice(0,t-this.bufferOffset);return n},i.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},i.prototype.write=function(e){var t,n;if(this.ended){(n=(t=this.cbs).onerror)===null||n===void 0||n.call(t,new Error(".write() after done!"));return}this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++)},i.prototype.end=function(e){var t,n;if(this.ended){(n=(t=this.cbs).onerror)===null||n===void 0||n.call(t,new Error(".end() after done!"));return}e&&this.write(e),this.ended=!0,this.tokenizer.end()},i.prototype.pause=function(){this.tokenizer.pause()},i.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},i.prototype.parseChunk=function(e){this.write(e)},i.prototype.done=function(e){this.end(e)},i}();yf.Parser=DX;var no={},bc={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Doctype=i.CDATA=i.Tag=i.Style=i.Script=i.Comment=i.Directive=i.Text=i.Root=i.isTag=i.ElementType=void 0;var e;(function(n){n.Root="root",n.Text="text",n.Directive="directive",n.Comment="comment",n.Script="script",n.Style="style",n.Tag="tag",n.CDATA="cdata",n.Doctype="doctype"})(e=i.ElementType||(i.ElementType={}));function t(n){return n.type===e.Tag||n.type===e.Script||n.type===e.Style}i.isTag=t,i.Root=e.Root,i.Text=e.Text,i.Directive=e.Directive,i.Comment=e.Comment,i.Script=e.Script,i.Style=e.Style,i.Tag=e.Tag,i.CDATA=e.CDATA,i.Doctype=e.Doctype})(bc);var dt={},Ia=We&&We.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ef=We&&We.__assign||function(){return Ef=Object.assign||function(i){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}return i},Ef.apply(this,arguments)};Object.defineProperty(dt,"__esModule",{value:!0}),dt.cloneNode=dt.hasChildren=dt.isDocument=dt.isDirective=dt.isComment=dt.isText=dt.isCDATA=dt.isTag=dt.Element=dt.Document=dt.CDATA=dt.NodeWithChildren=dt.ProcessingInstruction=dt.Comment=dt.Text=dt.DataNode=dt.Node=void 0;var kn=bc,N_=function(){function i(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(i.prototype,"parentNode",{get:function(){return this.parent},set:function(e){this.parent=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"previousSibling",{get:function(){return this.prev},set:function(e){this.prev=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"nextSibling",{get:function(){return this.next},set:function(e){this.next=e},enumerable:!1,configurable:!0}),i.prototype.cloneNode=function(e){return e===void 0&&(e=!1),Q_(this,e)},i}();dt.Node=N_;var up=function(i){Ia(e,i);function e(t){var n=i.call(this)||this;return n.data=t,n}return Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.data},set:function(t){this.data=t},enumerable:!1,configurable:!0}),e}(N_);dt.DataNode=up;var nM=function(i){Ia(e,i);function e(){var t=i!==null&&i.apply(this,arguments)||this;return t.type=kn.ElementType.Text,t}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),e}(up);dt.Text=nM;var rM=function(i){Ia(e,i);function e(){var t=i!==null&&i.apply(this,arguments)||this;return t.type=kn.ElementType.Comment,t}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),e}(up);dt.Comment=rM;var sM=function(i){Ia(e,i);function e(t,n){var r=i.call(this,n)||this;return r.name=t,r.type=kn.ElementType.Directive,r}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),e}(up);dt.ProcessingInstruction=sM;var cp=function(i){Ia(e,i);function e(t){var n=i.call(this)||this;return n.children=t,n}return Object.defineProperty(e.prototype,"firstChild",{get:function(){var t;return(t=this.children[0])!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.children},set:function(t){this.children=t},enumerable:!1,configurable:!0}),e}(N_);dt.NodeWithChildren=cp;var oM=function(i){Ia(e,i);function e(){var t=i!==null&&i.apply(this,arguments)||this;return t.type=kn.ElementType.CDATA,t}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),e}(cp);dt.CDATA=oM;var aM=function(i){Ia(e,i);function e(){var t=i!==null&&i.apply(this,arguments)||this;return t.type=kn.ElementType.Root,t}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),e}(cp);dt.Document=aM;var lM=function(i){Ia(e,i);function e(t,n,r,s){r===void 0&&(r=[]),s===void 0&&(s=t==="script"?kn.ElementType.Script:t==="style"?kn.ElementType.Style:kn.ElementType.Tag);var o=i.call(this,r)||this;return o.name=t,o.attribs=n,o.type=s,o}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.name},set:function(t){this.name=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){var t=this;return Object.keys(this.attribs).map(function(n){var r,s;return{name:n,value:t.attribs[n],namespace:(r=t["x-attribsNamespace"])===null||r===void 0?void 0:r[n],prefix:(s=t["x-attribsPrefix"])===null||s===void 0?void 0:s[n]}})},enumerable:!1,configurable:!0}),e}(cp);dt.Element=lM;function uM(i){return(0,kn.isTag)(i)}dt.isTag=uM;function cM(i){return i.type===kn.ElementType.CDATA}dt.isCDATA=cM;function hM(i){return i.type===kn.ElementType.Text}dt.isText=hM;function dM(i){return i.type===kn.ElementType.Comment}dt.isComment=dM;function fM(i){return i.type===kn.ElementType.Directive}dt.isDirective=fM;function gM(i){return i.type===kn.ElementType.Root}dt.isDocument=gM;function kX(i){return Object.prototype.hasOwnProperty.call(i,"children")}dt.hasChildren=kX;function Q_(i,e){e===void 0&&(e=!1);var t;if(hM(i))t=new nM(i.data);else if(dM(i))t=new rM(i.data);else if(uM(i)){var n=e?U_(i.children):[],r=new lM(i.name,Ef({},i.attribs),n);n.forEach(function(l){return l.parent=r}),i.namespace!=null&&(r.namespace=i.namespace),i["x-attribsNamespace"]&&(r["x-attribsNamespace"]=Ef({},i["x-attribsNamespace"])),i["x-attribsPrefix"]&&(r["x-attribsPrefix"]=Ef({},i["x-attribsPrefix"])),t=r}else if(cM(i)){var n=e?U_(i.children):[],s=new oM(n);n.forEach(function(u){return u.parent=s}),t=s}else if(gM(i)){var n=e?U_(i.children):[],o=new aM(n);n.forEach(function(u){return u.parent=o}),i["x-mode"]&&(o["x-mode"]=i["x-mode"]),t=o}else if(fM(i)){var a=new sM(i.name,i.data);i["x-name"]!=null&&(a["x-name"]=i["x-name"],a["x-publicId"]=i["x-publicId"],a["x-systemId"]=i["x-systemId"]),t=a}else throw new Error("Not implemented yet: ".concat(i.type));return t.startIndex=i.startIndex,t.endIndex=i.endIndex,i.sourceCodeLocation!=null&&(t.sourceCodeLocation=i.sourceCodeLocation),t}dt.cloneNode=Q_;function U_(i){for(var e=i.map(function(n){return Q_(n,!0)}),t=1;t<e.length;t++)e[t].prev=e[t-1],e[t-1].next=e[t];return e}(function(i){var e=We&&We.__createBinding||(Object.create?function(a,l,u,c){c===void 0&&(c=u);var h=Object.getOwnPropertyDescriptor(l,u);(!h||("get"in h?!l.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return l[u]}}),Object.defineProperty(a,c,h)}:function(a,l,u,c){c===void 0&&(c=u),a[c]=l[u]}),t=We&&We.__exportStar||function(a,l){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(l,u)&&e(l,a,u)};Object.defineProperty(i,"__esModule",{value:!0}),i.DomHandler=void 0;var n=bc,r=dt;t(dt,i);var s={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},o=function(){function a(l,u,c){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof u=="function"&&(c=u,u=s),typeof l=="object"&&(u=l,l=void 0),this.callback=l??null,this.options=u??s,this.elementCB=c??null}return a.prototype.onparserinit=function(l){this.parser=l},a.prototype.onreset=function(){this.dom=[],this.root=new r.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},a.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},a.prototype.onerror=function(l){this.handleCallback(l)},a.prototype.onclosetag=function(){this.lastNode=null;var l=this.tagStack.pop();this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(l)},a.prototype.onopentag=function(l,u){var c=this.options.xmlMode?n.ElementType.Tag:void 0,h=new r.Element(l,u,void 0,c);this.addNode(h),this.tagStack.push(h)},a.prototype.ontext=function(l){var u=this.lastNode;if(u&&u.type===n.ElementType.Text)u.data+=l,this.options.withEndIndices&&(u.endIndex=this.parser.endIndex);else{var c=new r.Text(l);this.addNode(c),this.lastNode=c}},a.prototype.oncomment=function(l){if(this.lastNode&&this.lastNode.type===n.ElementType.Comment){this.lastNode.data+=l;return}var u=new r.Comment(l);this.addNode(u),this.lastNode=u},a.prototype.oncommentend=function(){this.lastNode=null},a.prototype.oncdatastart=function(){var l=new r.Text(""),u=new r.CDATA([l]);this.addNode(u),l.parent=u,this.lastNode=l},a.prototype.oncdataend=function(){this.lastNode=null},a.prototype.onprocessinginstruction=function(l,u){var c=new r.ProcessingInstruction(l,u);this.addNode(c)},a.prototype.handleCallback=function(l){if(typeof this.callback=="function")this.callback(l,this.dom);else if(l)throw l},a.prototype.addNode=function(l){var u=this.tagStack[this.tagStack.length-1],c=u.children[u.children.length-1];this.options.withStartIndices&&(l.startIndex=this.parser.startIndex),this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),u.children.push(l),c&&(l.prev=c,c.next=l),l.parent=u,this.lastNode=null},a}();i.DomHandler=o,i.default=o})(no);var hp={},Zn={},If={},AM={},bl={},G_={};Object.defineProperty(G_,"__esModule",{value:!0});function dp(i){for(var e=1;e<i.length;e++)i[e][0]+=i[e-1][0]+1;return i}G_.default=new Map(dp([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(dp([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(dp([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(dp([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var fp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.escapeText=i.escapeAttribute=i.escapeUTF8=i.escape=i.encodeXML=i.getCodePoint=i.xmlReplacer=void 0,i.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var e=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);i.getCodePoint=String.prototype.codePointAt!=null?function(r,s){return r.codePointAt(s)}:function(r,s){return(r.charCodeAt(s)&64512)===55296?(r.charCodeAt(s)-55296)*1024+r.charCodeAt(s+1)-56320+65536:r.charCodeAt(s)};function t(r){for(var s="",o=0,a;(a=i.xmlReplacer.exec(r))!==null;){var l=a.index,u=r.charCodeAt(l),c=e.get(u);c!==void 0?(s+=r.substring(o,l)+c,o=l+1):(s+="".concat(r.substring(o,l),"&#x").concat((0,i.getCodePoint)(r,l).toString(16),";"),o=i.xmlReplacer.lastIndex+=+((u&64512)===55296))}return s+r.substr(o)}i.encodeXML=t,i.escape=t;function n(r,s){return function(a){for(var l,u=0,c="";l=r.exec(a);)u!==l.index&&(c+=a.substring(u,l.index)),c+=s.get(l[0].charCodeAt(0)),u=l.index+1;return c+a.substring(u)}}i.escapeUTF8=n(/[&<>'"]/g,e),i.escapeAttribute=n(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),i.escapeText=n(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))})(fp);var PX=We&&We.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(bl,"__esModule",{value:!0}),bl.encodeNonAsciiHTML=bl.encodeHTML=void 0;var MX=PX(G_),pM=fp,FX=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function OX(i){return mM(FX,i)}bl.encodeHTML=OX;function NX(i){return mM(pM.xmlReplacer,i)}bl.encodeNonAsciiHTML=NX;function mM(i,e){for(var t="",n=0,r;(r=i.exec(e))!==null;){var s=r.index;t+=e.substring(n,s);var o=e.charCodeAt(s),a=MX.default.get(o);if(typeof a=="object"){if(s+1<e.length){var l=e.charCodeAt(s+1),u=typeof a.n=="number"?a.n===l?a.o:void 0:a.n.get(l);if(u!==void 0){t+=u,n=i.lastIndex+=1;continue}}a=a.v}if(a!==void 0)t+=a,n=s+1;else{var c=(0,pM.getCodePoint)(e,s);t+="&#x".concat(c.toString(16),";"),n=i.lastIndex+=+(c!==o)}}return t+e.substr(n)}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.decodeXMLStrict=i.decodeHTML5Strict=i.decodeHTML4Strict=i.decodeHTML5=i.decodeHTML4=i.decodeHTMLAttribute=i.decodeHTMLStrict=i.decodeHTML=i.decodeXML=i.DecodingMode=i.EntityDecoder=i.encodeHTML5=i.encodeHTML4=i.encodeNonAsciiHTML=i.encodeHTML=i.escapeText=i.escapeAttribute=i.escapeUTF8=i.escape=i.encodeXML=i.encode=i.decodeStrict=i.decode=i.EncodingMode=i.EntityLevel=void 0;var e=vf,t=bl,n=fp,r;(function(d){d[d.XML=0]="XML",d[d.HTML=1]="HTML"})(r=i.EntityLevel||(i.EntityLevel={}));var s;(function(d){d[d.UTF8=0]="UTF8",d[d.ASCII=1]="ASCII",d[d.Extensive=2]="Extensive",d[d.Attribute=3]="Attribute",d[d.Text=4]="Text"})(s=i.EncodingMode||(i.EncodingMode={}));function o(d,g){g===void 0&&(g=r.XML);var A=typeof g=="number"?g:g.level;if(A===r.HTML){var p=typeof g=="object"?g.mode:void 0;return(0,e.decodeHTML)(d,p)}return(0,e.decodeXML)(d)}i.decode=o;function a(d,g){var A;g===void 0&&(g=r.XML);var p=typeof g=="number"?{level:g}:g;return(A=p.mode)!==null&&A!==void 0||(p.mode=e.DecodingMode.Strict),o(d,p)}i.decodeStrict=a;function l(d,g){g===void 0&&(g=r.XML);var A=typeof g=="number"?{level:g}:g;return A.mode===s.UTF8?(0,n.escapeUTF8)(d):A.mode===s.Attribute?(0,n.escapeAttribute)(d):A.mode===s.Text?(0,n.escapeText)(d):A.level===r.HTML?A.mode===s.ASCII?(0,t.encodeNonAsciiHTML)(d):(0,t.encodeHTML)(d):(0,n.encodeXML)(d)}i.encode=l;var u=fp;Object.defineProperty(i,"encodeXML",{enumerable:!0,get:function(){return u.encodeXML}}),Object.defineProperty(i,"escape",{enumerable:!0,get:function(){return u.escape}}),Object.defineProperty(i,"escapeUTF8",{enumerable:!0,get:function(){return u.escapeUTF8}}),Object.defineProperty(i,"escapeAttribute",{enumerable:!0,get:function(){return u.escapeAttribute}}),Object.defineProperty(i,"escapeText",{enumerable:!0,get:function(){return u.escapeText}});var c=bl;Object.defineProperty(i,"encodeHTML",{enumerable:!0,get:function(){return c.encodeHTML}}),Object.defineProperty(i,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return c.encodeNonAsciiHTML}}),Object.defineProperty(i,"encodeHTML4",{enumerable:!0,get:function(){return c.encodeHTML}}),Object.defineProperty(i,"encodeHTML5",{enumerable:!0,get:function(){return c.encodeHTML}});var h=vf;Object.defineProperty(i,"EntityDecoder",{enumerable:!0,get:function(){return h.EntityDecoder}}),Object.defineProperty(i,"DecodingMode",{enumerable:!0,get:function(){return h.DecodingMode}}),Object.defineProperty(i,"decodeXML",{enumerable:!0,get:function(){return h.decodeXML}}),Object.defineProperty(i,"decodeHTML",{enumerable:!0,get:function(){return h.decodeHTML}}),Object.defineProperty(i,"decodeHTMLStrict",{enumerable:!0,get:function(){return h.decodeHTMLStrict}}),Object.defineProperty(i,"decodeHTMLAttribute",{enumerable:!0,get:function(){return h.decodeHTMLAttribute}}),Object.defineProperty(i,"decodeHTML4",{enumerable:!0,get:function(){return h.decodeHTML}}),Object.defineProperty(i,"decodeHTML5",{enumerable:!0,get:function(){return h.decodeHTML}}),Object.defineProperty(i,"decodeHTML4Strict",{enumerable:!0,get:function(){return h.decodeHTMLStrict}}),Object.defineProperty(i,"decodeHTML5Strict",{enumerable:!0,get:function(){return h.decodeHTMLStrict}}),Object.defineProperty(i,"decodeXMLStrict",{enumerable:!0,get:function(){return h.decodeXML}})})(AM);var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.attributeNames=Sc.elementNames=void 0,Sc.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(i){return[i.toLowerCase(),i]})),Sc.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(i){return[i.toLowerCase(),i]}));var Tc=We&&We.__assign||function(){return Tc=Object.assign||function(i){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}return i},Tc.apply(this,arguments)},QX=We&&We.__createBinding||(Object.create?function(i,e,t,n){n===void 0&&(n=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(i,n,r)}:function(i,e,t,n){n===void 0&&(n=t),i[n]=e[t]}),UX=We&&We.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),GX=We&&We.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&QX(e,i,t);return UX(e,i),e};Object.defineProperty(If,"__esModule",{value:!0}),If.render=void 0;var ro=GX(bc),gp=AM,yM=Sc,HX=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function zX(i){return i.replace(/"/g,"&quot;")}function VX(i,e){var t;if(i){var n=((t=e.encodeEntities)!==null&&t!==void 0?t:e.decodeEntities)===!1?zX:e.xmlMode||e.encodeEntities!=="utf8"?gp.encodeXML:gp.escapeAttribute;return Object.keys(i).map(function(r){var s,o,a=(s=i[r])!==null&&s!==void 0?s:"";return e.xmlMode==="foreign"&&(r=(o=yM.attributeNames.get(r))!==null&&o!==void 0?o:r),!e.emptyAttrs&&!e.xmlMode&&a===""?r:"".concat(r,'="').concat(n(a),'"')}).join(" ")}}var vM=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function Ap(i,e){e===void 0&&(e={});for(var t=("length"in i)?i:[i],n="",r=0;r<t.length;r++)n+=qX(t[r],e);return n}If.render=Ap,If.default=Ap;function qX(i,e){switch(i.type){case ro.Root:return Ap(i.children,e);case ro.Doctype:case ro.Directive:return KX(i);case ro.Comment:return XX(i);case ro.CDATA:return ZX(i);case ro.Script:case ro.Style:case ro.Tag:return WX(i,e);case ro.Text:return YX(i,e)}}var $X=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),jX=new Set(["svg","math"]);function WX(i,e){var t;e.xmlMode==="foreign"&&(i.name=(t=yM.elementNames.get(i.name))!==null&&t!==void 0?t:i.name,i.parent&&$X.has(i.parent.name)&&(e=Tc(Tc({},e),{xmlMode:!1}))),!e.xmlMode&&jX.has(i.name)&&(e=Tc(Tc({},e),{xmlMode:"foreign"}));var n="<".concat(i.name),r=VX(i.attribs,e);return r&&(n+=" ".concat(r)),i.children.length===0&&(e.xmlMode?e.selfClosingTags!==!1:e.selfClosingTags&&vM.has(i.name))?(e.xmlMode||(n+=" "),n+="/>"):(n+=">",i.children.length>0&&(n+=Ap(i.children,e)),(e.xmlMode||!vM.has(i.name))&&(n+="</".concat(i.name,">"))),n}function KX(i){return"<".concat(i.data,">")}function YX(i,e){var t,n=i.data||"";return((t=e.encodeEntities)!==null&&t!==void 0?t:e.decodeEntities)!==!1&&!(!e.xmlMode&&i.parent&&HX.has(i.parent.name))&&(n=e.xmlMode||e.encodeEntities!=="utf8"?(0,gp.encodeXML)(n):(0,gp.escapeText)(n)),n}function ZX(i){return"<![CDATA[".concat(i.children[0].data,"]]>")}function XX(i){return"<!--".concat(i.data,"-->")}var JX=We&&We.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.innerText=Zn.textContent=Zn.getText=Zn.getInnerHTML=Zn.getOuterHTML=void 0;var us=no,eJ=JX(If),tJ=bc;function EM(i,e){return(0,eJ.default)(i,e)}Zn.getOuterHTML=EM;function iJ(i,e){return(0,us.hasChildren)(i)?i.children.map(function(t){return EM(t,e)}).join(""):""}Zn.getInnerHTML=iJ;function pp(i){return Array.isArray(i)?i.map(pp).join(""):(0,us.isTag)(i)?i.name==="br"?`
`:pp(i.children):(0,us.isCDATA)(i)?pp(i.children):(0,us.isText)(i)?i.data:""}Zn.getText=pp;function H_(i){return Array.isArray(i)?i.map(H_).join(""):(0,us.hasChildren)(i)&&!(0,us.isComment)(i)?H_(i.children):(0,us.isText)(i)?i.data:""}Zn.textContent=H_;function z_(i){return Array.isArray(i)?i.map(z_).join(""):(0,us.hasChildren)(i)&&(i.type===tJ.ElementType.Tag||(0,us.isCDATA)(i))?z_(i.children):(0,us.isText)(i)?i.data:""}Zn.innerText=z_;var Li={};Object.defineProperty(Li,"__esModule",{value:!0}),Li.prevElementSibling=Li.nextElementSibling=Li.getName=Li.hasAttrib=Li.getAttributeValue=Li.getSiblings=Li.getParent=Li.getChildren=void 0;var V_=no;function IM(i){return(0,V_.hasChildren)(i)?i.children:[]}Li.getChildren=IM;function _M(i){return i.parent||null}Li.getParent=_M;function nJ(i){var e,t,n=_M(i);if(n!=null)return IM(n);for(var r=[i],s=i.prev,o=i.next;s!=null;)r.unshift(s),e=s,s=e.prev;for(;o!=null;)r.push(o),t=o,o=t.next;return r}Li.getSiblings=nJ;function rJ(i,e){var t;return(t=i.attribs)===null||t===void 0?void 0:t[e]}Li.getAttributeValue=rJ;function sJ(i,e){return i.attribs!=null&&Object.prototype.hasOwnProperty.call(i.attribs,e)&&i.attribs[e]!=null}Li.hasAttrib=sJ;function oJ(i){return i.name}Li.getName=oJ;function aJ(i){for(var e,t=i.next;t!==null&&!(0,V_.isTag)(t);)e=t,t=e.next;return t}Li.nextElementSibling=aJ;function lJ(i){for(var e,t=i.prev;t!==null&&!(0,V_.isTag)(t);)e=t,t=e.prev;return t}Li.prevElementSibling=lJ;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.prepend=Pn.prependChild=Pn.append=Pn.appendChild=Pn.replaceElement=Pn.removeElement=void 0;function _f(i){if(i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),i.parent){var e=i.parent.children,t=e.lastIndexOf(i);t>=0&&e.splice(t,1)}i.next=null,i.prev=null,i.parent=null}Pn.removeElement=_f;function uJ(i,e){var t=e.prev=i.prev;t&&(t.next=e);var n=e.next=i.next;n&&(n.prev=e);var r=e.parent=i.parent;if(r){var s=r.children;s[s.lastIndexOf(i)]=e,i.parent=null}}Pn.replaceElement=uJ;function cJ(i,e){if(_f(e),e.next=null,e.parent=i,i.children.push(e)>1){var t=i.children[i.children.length-2];t.next=e,e.prev=t}else e.prev=null}Pn.appendChild=cJ;function hJ(i,e){_f(e);var t=i.parent,n=i.next;if(e.next=n,e.prev=i,i.next=e,e.parent=t,n){if(n.prev=e,t){var r=t.children;r.splice(r.lastIndexOf(n),0,e)}}else t&&t.children.push(e)}Pn.append=hJ;function dJ(i,e){if(_f(e),e.parent=i,e.prev=null,i.children.unshift(e)!==1){var t=i.children[1];t.prev=e,e.next=t}else e.next=null}Pn.prependChild=dJ;function fJ(i,e){_f(e);var t=i.parent;if(t){var n=t.children;n.splice(n.indexOf(i),0,e)}i.prev&&(i.prev.next=e),e.parent=t,e.prev=i.prev,e.next=i,i.prev=e}Pn.prepend=fJ;var yn={};Object.defineProperty(yn,"__esModule",{value:!0}),yn.findAll=yn.existsOne=yn.findOne=yn.findOneChild=yn.find=yn.filter=void 0;var mp=no;function gJ(i,e,t,n){return t===void 0&&(t=!0),n===void 0&&(n=1/0),CM(i,Array.isArray(e)?e:[e],t,n)}yn.filter=gJ;function CM(i,e,t,n){for(var r=[],s=[e],o=[0];;){if(o[0]>=s[0].length){if(o.length===1)return r;s.shift(),o.shift();continue}var a=s[0][o[0]++];if(i(a)&&(r.push(a),--n<=0))return r;t&&(0,mp.hasChildren)(a)&&a.children.length>0&&(o.unshift(0),s.unshift(a.children))}}yn.find=CM;function AJ(i,e){return e.find(i)}yn.findOneChild=AJ;function wM(i,e,t){t===void 0&&(t=!0);for(var n=null,r=0;r<e.length&&!n;r++){var s=e[r];if((0,mp.isTag)(s))i(s)?n=s:t&&s.children.length>0&&(n=wM(i,s.children,!0));else continue}return n}yn.findOne=wM;function xM(i,e){return e.some(function(t){return(0,mp.isTag)(t)&&(i(t)||xM(i,t.children))})}yn.existsOne=xM;function pJ(i,e){for(var t=[],n=[e],r=[0];;){if(r[0]>=n[0].length){if(n.length===1)return t;n.shift(),r.shift();continue}var s=n[0][r[0]++];(0,mp.isTag)(s)&&(i(s)&&t.push(s),s.children.length>0&&(r.unshift(0),n.unshift(s.children)))}}yn.findAll=pJ;var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.getElementsByTagType=Xn.getElementsByTagName=Xn.getElementById=Xn.getElements=Xn.testElement=void 0;var Sl=no,yp=yn,vp={tag_name:function(i){return typeof i=="function"?function(e){return(0,Sl.isTag)(e)&&i(e.name)}:i==="*"?Sl.isTag:function(e){return(0,Sl.isTag)(e)&&e.name===i}},tag_type:function(i){return typeof i=="function"?function(e){return i(e.type)}:function(e){return e.type===i}},tag_contains:function(i){return typeof i=="function"?function(e){return(0,Sl.isText)(e)&&i(e.data)}:function(e){return(0,Sl.isText)(e)&&e.data===i}}};function bM(i,e){return typeof e=="function"?function(t){return(0,Sl.isTag)(t)&&e(t.attribs[i])}:function(t){return(0,Sl.isTag)(t)&&t.attribs[i]===e}}function mJ(i,e){return function(t){return i(t)||e(t)}}function SM(i){var e=Object.keys(i).map(function(t){var n=i[t];return Object.prototype.hasOwnProperty.call(vp,t)?vp[t](n):bM(t,n)});return e.length===0?null:e.reduce(mJ)}function yJ(i,e){var t=SM(i);return t?t(e):!0}Xn.testElement=yJ;function vJ(i,e,t,n){n===void 0&&(n=1/0);var r=SM(i);return r?(0,yp.filter)(r,e,t,n):[]}Xn.getElements=vJ;function EJ(i,e,t){return t===void 0&&(t=!0),Array.isArray(e)||(e=[e]),(0,yp.findOne)(bM("id",i),e,t)}Xn.getElementById=EJ;function IJ(i,e,t,n){return t===void 0&&(t=!0),n===void 0&&(n=1/0),(0,yp.filter)(vp.tag_name(i),e,t,n)}Xn.getElementsByTagName=IJ;function _J(i,e,t,n){return t===void 0&&(t=!0),n===void 0&&(n=1/0),(0,yp.filter)(vp.tag_type(i),e,t,n)}Xn.getElementsByTagType=_J;var TM={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.uniqueSort=i.compareDocumentPosition=i.DocumentPosition=i.removeSubsets=void 0;var e=no;function t(o){for(var a=o.length;--a>=0;){var l=o[a];if(a>0&&o.lastIndexOf(l,a-1)>=0){o.splice(a,1);continue}for(var u=l.parent;u;u=u.parent)if(o.includes(u)){o.splice(a,1);break}}return o}i.removeSubsets=t;var n;(function(o){o[o.DISCONNECTED=1]="DISCONNECTED",o[o.PRECEDING=2]="PRECEDING",o[o.FOLLOWING=4]="FOLLOWING",o[o.CONTAINS=8]="CONTAINS",o[o.CONTAINED_BY=16]="CONTAINED_BY"})(n=i.DocumentPosition||(i.DocumentPosition={}));function r(o,a){var l=[],u=[];if(o===a)return 0;for(var c=(0,e.hasChildren)(o)?o:o.parent;c;)l.unshift(c),c=c.parent;for(c=(0,e.hasChildren)(a)?a:a.parent;c;)u.unshift(c),c=c.parent;for(var h=Math.min(l.length,u.length),d=0;d<h&&l[d]===u[d];)d++;if(d===0)return n.DISCONNECTED;var g=l[d-1],A=g.children,p=l[d],y=u[d];return A.indexOf(p)>A.indexOf(y)?g===a?n.FOLLOWING|n.CONTAINED_BY:n.FOLLOWING:g===o?n.PRECEDING|n.CONTAINS:n.PRECEDING}i.compareDocumentPosition=r;function s(o){return o=o.filter(function(a,l,u){return!u.includes(a,l+1)}),o.sort(function(a,l){var u=r(a,l);return u&n.PRECEDING?-1:u&n.FOLLOWING?1:0}),o}i.uniqueSort=s})(TM);var Ep={};Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.getFeed=void 0;var CJ=Zn,Cf=Xn;function wJ(i){var e=Ip(BJ,i);return e?e.name==="feed"?xJ(e):bJ(e):null}Ep.getFeed=wJ;function xJ(i){var e,t=i.children,n={type:"atom",items:(0,Cf.getElementsByTagName)("entry",t).map(function(o){var a,l=o.children,u={media:BM(l)};Mn(u,"id","id",l),Mn(u,"title","title",l);var c=(a=Ip("link",l))===null||a===void 0?void 0:a.attribs.href;c&&(u.link=c);var h=_a("summary",l)||_a("content",l);h&&(u.description=h);var d=_a("updated",l);return d&&(u.pubDate=new Date(d)),u})};Mn(n,"id","id",t),Mn(n,"title","title",t);var r=(e=Ip("link",t))===null||e===void 0?void 0:e.attribs.href;r&&(n.link=r),Mn(n,"description","subtitle",t);var s=_a("updated",t);return s&&(n.updated=new Date(s)),Mn(n,"author","email",t,!0),n}function bJ(i){var e,t,n=(t=(e=Ip("channel",i.children))===null||e===void 0?void 0:e.children)!==null&&t!==void 0?t:[],r={type:i.name.substr(0,3),id:"",items:(0,Cf.getElementsByTagName)("item",i.children).map(function(o){var a=o.children,l={media:BM(a)};Mn(l,"id","guid",a),Mn(l,"title","title",a),Mn(l,"link","link",a),Mn(l,"description","description",a);var u=_a("pubDate",a)||_a("dc:date",a);return u&&(l.pubDate=new Date(u)),l})};Mn(r,"title","title",n),Mn(r,"link","link",n),Mn(r,"description","description",n);var s=_a("lastBuildDate",n);return s&&(r.updated=new Date(s)),Mn(r,"author","managingEditor",n,!0),r}var SJ=["url","type","lang"],TJ=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function BM(i){return(0,Cf.getElementsByTagName)("media:content",i).map(function(e){for(var t=e.attribs,n={medium:t.medium,isDefault:!!t.isDefault},r=0,s=SJ;r<s.length;r++){var o=s[r];t[o]&&(n[o]=t[o])}for(var a=0,l=TJ;a<l.length;a++){var o=l[a];t[o]&&(n[o]=parseInt(t[o],10))}return t.expression&&(n.expression=t.expression),n})}function Ip(i,e){return(0,Cf.getElementsByTagName)(i,e,!0,1)[0]}function _a(i,e,t){return t===void 0&&(t=!1),(0,CJ.textContent)((0,Cf.getElementsByTagName)(i,e,t,1)).trim()}function Mn(i,e,t,n,r){r===void 0&&(r=!1);var s=_a(t,n,r);s&&(i[e]=s)}function BJ(i){return i==="rss"||i==="feed"||i==="rdf:RDF"}(function(i){var e=We&&We.__createBinding||(Object.create?function(r,s,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(s,o);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(r,a,l)}:function(r,s,o,a){a===void 0&&(a=o),r[a]=s[o]}),t=We&&We.__exportStar||function(r,s){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,r,o)};Object.defineProperty(i,"__esModule",{value:!0}),i.hasChildren=i.isDocument=i.isComment=i.isText=i.isCDATA=i.isTag=void 0,t(Zn,i),t(Li,i),t(Pn,i),t(yn,i),t(Xn,i),t(TM,i),t(Ep,i);var n=no;Object.defineProperty(i,"isTag",{enumerable:!0,get:function(){return n.isTag}}),Object.defineProperty(i,"isCDATA",{enumerable:!0,get:function(){return n.isCDATA}}),Object.defineProperty(i,"isText",{enumerable:!0,get:function(){return n.isText}}),Object.defineProperty(i,"isComment",{enumerable:!0,get:function(){return n.isComment}}),Object.defineProperty(i,"isDocument",{enumerable:!0,get:function(){return n.isDocument}}),Object.defineProperty(i,"hasChildren",{enumerable:!0,get:function(){return n.hasChildren}})})(hp),function(i){var e=We&&We.__createBinding||(Object.create?function(v,E,I,C){C===void 0&&(C=I);var w=Object.getOwnPropertyDescriptor(E,I);(!w||("get"in w?!E.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return E[I]}}),Object.defineProperty(v,C,w)}:function(v,E,I,C){C===void 0&&(C=I),v[C]=E[I]}),t=We&&We.__setModuleDefault||(Object.create?function(v,E){Object.defineProperty(v,"default",{enumerable:!0,value:E})}:function(v,E){v.default=E}),n=We&&We.__importStar||function(v){if(v&&v.__esModule)return v;var E={};if(v!=null)for(var I in v)I!=="default"&&Object.prototype.hasOwnProperty.call(v,I)&&e(E,v,I);return t(E,v),E},r=We&&We.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomUtils=i.parseFeed=i.getFeed=i.ElementType=i.Tokenizer=i.createDomStream=i.parseDOM=i.parseDocument=i.DefaultHandler=i.DomHandler=i.Parser=void 0;var s=yf,o=yf;Object.defineProperty(i,"Parser",{enumerable:!0,get:function(){return o.Parser}});var a=no,l=no;Object.defineProperty(i,"DomHandler",{enumerable:!0,get:function(){return l.DomHandler}}),Object.defineProperty(i,"DefaultHandler",{enumerable:!0,get:function(){return l.DomHandler}});function u(v,E){var I=new a.DomHandler(void 0,E);return new s.Parser(I,E).end(v),I.root}i.parseDocument=u;function c(v,E){return u(v,E).children}i.parseDOM=c;function h(v,E,I){var C=new a.DomHandler(v,E,I);return new s.Parser(C,E)}i.createDomStream=h;var d=P_;Object.defineProperty(i,"Tokenizer",{enumerable:!0,get:function(){return r(d).default}}),i.ElementType=n(bc);var g=hp,A=hp;Object.defineProperty(i,"getFeed",{enumerable:!0,get:function(){return A.getFeed}});var p={xmlMode:!0};function y(v,E){return E===void 0&&(E=p),(0,g.getFeed)(c(v,E))}i.parseFeed=y,i.DomUtils=n(hp)}(YP);var RJ=i=>{if(typeof i!="string")throw new TypeError("Expected a string");return i.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},q_={};Object.defineProperty(q_,"__esModule",{value:!0});/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function RM(i){return Object.prototype.toString.call(i)==="[object Object]"}function LJ(i){var e,t;return RM(i)===!1?!1:(e=i.constructor,e===void 0?!0:(t=e.prototype,!(RM(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}q_.isPlainObject=LJ;var DJ=function(e){return kJ(e)&&!PJ(e)};function kJ(i){return!!i&&typeof i=="object"}function PJ(i){var e=Object.prototype.toString.call(i);return e==="[object RegExp]"||e==="[object Date]"||OJ(i)}var MJ=typeof Symbol=="function"&&Symbol.for,FJ=MJ?Symbol.for("react.element"):60103;function OJ(i){return i.$$typeof===FJ}function NJ(i){return Array.isArray(i)?[]:{}}function wf(i,e){return e.clone!==!1&&e.isMergeableObject(i)?Bc(NJ(i),i,e):i}function QJ(i,e,t){return i.concat(e).map(function(n){return wf(n,t)})}function UJ(i,e){if(!e.customMerge)return Bc;var t=e.customMerge(i);return typeof t=="function"?t:Bc}function GJ(i){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(i).filter(function(e){return Object.propertyIsEnumerable.call(i,e)}):[]}function LM(i){return Object.keys(i).concat(GJ(i))}function DM(i,e){try{return e in i}catch{return!1}}function HJ(i,e){return DM(i,e)&&!(Object.hasOwnProperty.call(i,e)&&Object.propertyIsEnumerable.call(i,e))}function zJ(i,e,t){var n={};return t.isMergeableObject(i)&&LM(i).forEach(function(r){n[r]=wf(i[r],t)}),LM(e).forEach(function(r){HJ(i,r)||(DM(i,r)&&t.isMergeableObject(e[r])?n[r]=UJ(r,t)(i[r],e[r],t):n[r]=wf(e[r],t))}),n}function Bc(i,e,t){t=t||{},t.arrayMerge=t.arrayMerge||QJ,t.isMergeableObject=t.isMergeableObject||DJ,t.cloneUnlessOtherwiseSpecified=wf;var n=Array.isArray(e),r=Array.isArray(i),s=n===r;return s?n?t.arrayMerge(i,e,t):zJ(i,e,t):wf(e,t)}Bc.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,r){return Bc(n,r,t)},{})};var VJ=Bc,qJ=VJ,kM={exports:{}};(function(i){(function(e,t){i.exports?i.exports=t():e.parseSrcset=t()})(We,function(){return function(e){function t(C){return C===" "||C==="	"||C===`
`||C==="\f"||C==="\r"}function n(C){var w,S=C.exec(e.substring(y));if(S)return w=S[0],y+=w.length,w}for(var r=e.length,s=/^[ \t\n\r\u000c]+/,o=/^[, \t\n\r\u000c]+/,a=/^[^ \t\n\r\u000c]+/,l=/[,]+$/,u=/^\d+$/,c=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,h,d,g,A,p,y=0,v=[];;){if(n(o),y>=r)return v;h=n(a),d=[],h.slice(-1)===","?(h=h.replace(l,""),I()):E()}function E(){for(n(s),g="",A="in descriptor";;){if(p=e.charAt(y),A==="in descriptor")if(t(p))g&&(d.push(g),g="",A="after descriptor");else if(p===","){y+=1,g&&d.push(g),I();return}else if(p==="(")g=g+p,A="in parens";else if(p===""){g&&d.push(g),I();return}else g=g+p;else if(A==="in parens")if(p===")")g=g+p,A="in descriptor";else if(p===""){d.push(g),I();return}else g=g+p;else if(A==="after descriptor"&&!t(p))if(p===""){I();return}else A="in descriptor",y-=1;y+=1}}function I(){var C=!1,w,S,x,T,Q={},M,R,z,q,X;for(T=0;T<d.length;T++)M=d[T],R=M[M.length-1],z=M.substring(0,M.length-1),q=parseInt(z,10),X=parseFloat(z),u.test(z)&&R==="w"?((w||S)&&(C=!0),q===0?C=!0:w=q):c.test(z)&&R==="x"?((w||S||x)&&(C=!0),X<0?C=!0:S=X):u.test(z)&&R==="h"?((x||S)&&(C=!0),q===0?C=!0:x=q):C=!0;C?console&&console.log&&console.log("Invalid srcset descriptor found in '"+e+"' at '"+M+"'."):(Q.url=h,w&&(Q.w=w),S&&(Q.d=S),x&&(Q.h=x),v.push(Q))}}})})(kM);var $J=kM.exports,$_={exports:{}},jt=String,PM=function(){return{isColorSupported:!1,reset:jt,bold:jt,dim:jt,italic:jt,underline:jt,inverse:jt,hidden:jt,strikethrough:jt,black:jt,red:jt,green:jt,yellow:jt,blue:jt,magenta:jt,cyan:jt,white:jt,gray:jt,bgBlack:jt,bgRed:jt,bgGreen:jt,bgYellow:jt,bgBlue:jt,bgMagenta:jt,bgCyan:jt,bgWhite:jt}};$_.exports=PM(),$_.exports.createColors=PM;var jJ=$_.exports;const Nr=NH(hV);let MM=jJ,FM=Nr,j_=class o5 extends Error{constructor(e,t,n,r,s,o){super(e),this.name="CssSyntaxError",this.reason=e,s&&(this.file=s),r&&(this.source=r),o&&(this.plugin=o),typeof t<"u"&&typeof n<"u"&&(typeof t=="number"?(this.line=t,this.column=n):(this.line=t.line,this.column=t.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,o5)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){if(!this.source)return"";let t=this.source;e==null&&(e=MM.isColorSupported),FM&&e&&(t=FM(t));let n=t.split(/\r?\n/),r=Math.max(this.line-3,0),s=Math.min(this.line+2,n.length),o=String(s).length,a,l;if(e){let{bold:u,gray:c,red:h}=MM.createColors(!0);a=d=>u(h(d)),l=d=>c(d)}else a=l=u=>u;return n.slice(r,s).map((u,c)=>{let h=r+1+c,d=" "+(" "+h).slice(-o)+" | ";if(h===this.line){let g=l(d.replace(/\d/g," "))+u.slice(0,this.column-1).replace(/[^\t]/g," ");return a(">")+l(d)+u+`
 `+g+a("^")}return" "+l(d)+u}).join(`
`)}toString(){let e=this.showSourceCode();return e&&(e=`

`+e+`
`),this.name+": "+this.message+e}};var W_=j_;j_.default=j_;var xf={};xf.isClean=Symbol("isClean"),xf.my=Symbol("my");const OM={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function WJ(i){return i[0].toUpperCase()+i.slice(1)}let K_=class{constructor(e){this.builder=e}atrule(e,t){let n="@"+e.name,r=e.params?this.rawValue(e,"params"):"";if(typeof e.raws.afterName<"u"?n+=e.raws.afterName:r&&(n+=" "),e.nodes)this.block(e,n+r);else{let s=(e.raws.between||"")+(t?";":"");this.builder(n+r+s,e)}}beforeAfter(e,t){let n;e.type==="decl"?n=this.raw(e,null,"beforeDecl"):e.type==="comment"?n=this.raw(e,null,"beforeComment"):t==="before"?n=this.raw(e,null,"beforeRule"):n=this.raw(e,null,"beforeClose");let r=e.parent,s=0;for(;r&&r.type!=="root";)s+=1,r=r.parent;if(n.includes(`
`)){let o=this.raw(e,null,"indent");if(o.length)for(let a=0;a<s;a++)n+=o}return n}block(e,t){let n=this.raw(e,"between","beforeOpen");this.builder(t+n+"{",e,"start");let r;e.nodes&&e.nodes.length?(this.body(e),r=this.raw(e,"after")):r=this.raw(e,"after","emptyBody"),r&&this.builder(r),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&e.nodes[t].type==="comment";)t-=1;let n=this.raw(e,"semicolon");for(let r=0;r<e.nodes.length;r++){let s=e.nodes[r],o=this.raw(s,"before");o&&this.builder(o),this.stringify(s,t!==r||n)}}comment(e){let t=this.raw(e,"left","commentLeft"),n=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+n+"*/",e)}decl(e,t){let n=this.raw(e,"between","colon"),r=e.prop+n+this.rawValue(e,"value");e.important&&(r+=e.raws.important||" !important"),t&&(r+=";"),this.builder(r,e)}document(e){this.body(e)}raw(e,t,n){let r;if(n||(n=t),t&&(r=e.raws[t],typeof r<"u"))return r;let s=e.parent;if(n==="before"&&(!s||s.type==="root"&&s.first===e||s&&s.type==="document"))return"";if(!s)return OM[n];let o=e.root();if(o.rawCache||(o.rawCache={}),typeof o.rawCache[n]<"u")return o.rawCache[n];if(n==="before"||n==="after")return this.beforeAfter(e,n);{let a="raw"+WJ(n);this[a]?r=this[a](o,e):o.walk(l=>{if(r=l.raws[t],typeof r<"u")return!1})}return typeof r>"u"&&(r=OM[n]),o.rawCache[n]=r,r}rawBeforeClose(e){let t;return e.walk(n=>{if(n.nodes&&n.nodes.length>0&&typeof n.raws.after<"u")return t=n.raws.after,t.includes(`
`)&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let n;return e.walkComments(r=>{if(typeof r.raws.before<"u")return n=r.raws.before,n.includes(`
`)&&(n=n.replace(/[^\n]+$/,"")),!1}),typeof n>"u"?n=this.raw(t,null,"beforeDecl"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeDecl(e,t){let n;return e.walkDecls(r=>{if(typeof r.raws.before<"u")return n=r.raws.before,n.includes(`
`)&&(n=n.replace(/[^\n]+$/,"")),!1}),typeof n>"u"?n=this.raw(t,null,"beforeRule"):n&&(n=n.replace(/\S/g,"")),n}rawBeforeOpen(e){let t;return e.walk(n=>{if(n.type!=="decl"&&(t=n.raws.between,typeof t<"u"))return!1}),t}rawBeforeRule(e){let t;return e.walk(n=>{if(n.nodes&&(n.parent!==e||e.first!==n)&&typeof n.raws.before<"u")return t=n.raws.before,t.includes(`
`)&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(n=>{if(typeof n.raws.between<"u")return t=n.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(n=>{if(n.nodes&&n.nodes.length===0&&(t=n.raws.after,typeof t<"u"))return!1}),t}rawIndent(e){if(e.raws.indent)return e.raws.indent;let t;return e.walk(n=>{let r=n.parent;if(r&&r!==e&&r.parent&&r.parent===e&&typeof n.raws.before<"u"){let s=n.raws.before.split(`
`);return t=s[s.length-1],t=t.replace(/\S/g,""),!1}}),t}rawSemicolon(e){let t;return e.walk(n=>{if(n.nodes&&n.nodes.length&&n.last.type==="decl"&&(t=n.raws.semicolon,typeof t<"u"))return!1}),t}rawValue(e,t){let n=e[t],r=e.raws[t];return r&&r.value===n?r.raw:n}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw new Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};var NM=K_;K_.default=K_;let KJ=NM;function Y_(i,e){new KJ(e).stringify(i)}var _p=Y_;Y_.default=Y_;let{isClean:Cp,my:YJ}=xf,ZJ=W_,XJ=NM,JJ=_p;function Z_(i,e){let t=new i.constructor;for(let n in i){if(!Object.prototype.hasOwnProperty.call(i,n)||n==="proxyCache")continue;let r=i[n],s=typeof r;n==="parent"&&s==="object"?e&&(t[n]=e):n==="source"?t[n]=r:Array.isArray(r)?t[n]=r.map(o=>Z_(o,t)):(s==="object"&&r!==null&&(r=Z_(r)),t[n]=r)}return t}let X_=class{constructor(e={}){this.raws={},this[Cp]=!1,this[YJ]=!0;for(let t in e)if(t==="nodes"){this.nodes=[];for(let n of e[t])typeof n.clone=="function"?this.append(n.clone()):this.append(n)}else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=Z_(this);for(let n in e)t[n]=e[n];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:n,start:r}=this.rangeBy(t);return this.source.input.error(e,{column:r.column,line:r.line},{column:n.column,line:n.line},t)}return new ZJ(e)}getProxyProcessor(){return{get(e,t){return t==="proxyOf"?e:t==="root"?()=>e.root().toProxy():e[t]},set(e,t,n){return e[t]===n||(e[t]=n,(t==="prop"||t==="value"||t==="name"||t==="params"||t==="important"||t==="text")&&e.markDirty()),!0}}}markDirty(){if(this[Cp]){this[Cp]=!1;let e=this;for(;e=e.parent;)e[Cp]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let n=this.source.start;if(e.index)n=this.positionInside(e.index,t);else if(e.word){t=this.toString();let r=t.indexOf(e.word);r!==-1&&(n=this.positionInside(r,t))}return n}positionInside(e,t){let n=t||this.toString(),r=this.source.start.column,s=this.source.start.line;for(let o=0;o<e;o++)n[o]===`
`?(r=1,s+=1):r+=1;return{column:r,line:s}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let r=this.toString(),s=r.indexOf(e.word);s!==-1&&(t=this.positionInside(s,r),n=this.positionInside(s+e.word.length,r))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?n={column:e.end.column,line:e.end.line}:typeof e.endIndex=="number"?n=this.positionInside(e.endIndex):e.index&&(n=this.positionInside(e.index+1));return(n.line<t.line||n.line===t.line&&n.column<=t.column)&&(n={column:t.column+1,line:t.line}),{end:n,start:t}}raw(e,t){return new XJ().raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,n=!1;for(let r of e)r===this?n=!0:n?(this.parent.insertAfter(t,r),t=r):this.parent.insertBefore(t,r);n||this.remove()}return this}root(){let e=this;for(;e.parent&&e.parent.type!=="document";)e=e.parent;return e}toJSON(e,t){let n={},r=t==null;t=t||new Map;let s=0;for(let o in this){if(!Object.prototype.hasOwnProperty.call(this,o)||o==="parent"||o==="proxyCache")continue;let a=this[o];if(Array.isArray(a))n[o]=a.map(l=>typeof l=="object"&&l.toJSON?l.toJSON(null,t):l);else if(typeof a=="object"&&a.toJSON)n[o]=a.toJSON(null,t);else if(o==="source"){let l=t.get(a.input);l==null&&(l=s,t.set(a.input,s),s++),n[o]={end:a.end,inputId:l,start:a.start}}else n[o]=a}return r&&(n.inputs=[...t.keys()].map(o=>o.toJSON())),n}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=JJ){e.stringify&&(e=e.stringify);let t="";return e(this,n=>{t+=n}),t}warn(e,t,n){let r={node:this};for(let s in n)r[s]=n[s];return e.warn(t,r)}get proxyOf(){return this}};var wp=X_;X_.default=X_;let eee=wp,J_=class extends eee{constructor(e){e&&typeof e.value<"u"&&typeof e.value!="string"&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}};var xp=J_;J_.default=J_;let tee="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var iee={nanoid:(i=21)=>{let e="",t=i;for(;t--;)e+=tee[Math.random()*64|0];return e},customAlphabet:(i,e=21)=>(t=e)=>{let n="",r=t;for(;r--;)n+=i[Math.random()*i.length|0];return n}};let{SourceMapConsumer:QM,SourceMapGenerator:UM}=Nr,{existsSync:nee,readFileSync:ree}=Nr,{dirname:eC,join:see}=Nr;function oee(i){return Buffer?Buffer.from(i,"base64").toString():window.atob(i)}let tC=class{constructor(e,t){if(t.map===!1)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let n=t.map?t.map.prev:void 0,r=this.loadMap(t.from,n);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=eC(this.mapFile)),r&&(this.text=r)}consumer(){return this.consumerCache||(this.consumerCache=new QM(this.text)),this.consumerCache}decodeInline(e){let t=/^data:application\/json;charset=utf-?8;base64,/,n=/^data:application\/json;base64,/,r=/^data:application\/json;charset=utf-?8,/,s=/^data:application\/json,/;if(r.test(e)||s.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(t.test(e)||n.test(e))return oee(e.substr(RegExp.lastMatch.length));let o=e.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+o)}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return typeof e!="object"?!1:typeof e.mappings=="string"||typeof e._mappings=="string"||Array.isArray(e.sections)}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let n=e.lastIndexOf(t.pop()),r=e.indexOf("*/",n);n>-1&&r>-1&&(this.annotation=this.getAnnotationURL(e.substring(n,r)))}loadFile(e){if(this.root=eC(e),nee(e))return this.mapFile=e,ree(e,"utf-8").toString().trim()}loadMap(e,t){if(t===!1)return!1;if(t){if(typeof t=="string")return t;if(typeof t=="function"){let n=t(e);if(n){let r=this.loadFile(n);if(!r)throw new Error("Unable to load previous source map: "+n.toString());return r}}else{if(t instanceof QM)return UM.fromSourceMap(t).toString();if(t instanceof UM)return t.toString();if(this.isMap(t))return JSON.stringify(t);throw new Error("Unsupported previous source map format: "+t.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let n=this.annotation;return e&&(n=see(eC(e),n)),this.loadFile(n)}}}startWith(e,t){return e?e.substr(0,t.length)===t:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};var GM=tC;tC.default=tC;let{SourceMapConsumer:aee,SourceMapGenerator:lee}=Nr,{fileURLToPath:HM,pathToFileURL:bp}=Nr,{isAbsolute:iC,resolve:nC}=Nr,{nanoid:uee}=iee,rC=Nr,zM=W_,cee=GM,sC=Symbol("fromOffsetCache"),hee=!!(aee&&lee),VM=!!(nC&&iC),Sp=class{constructor(e,t={}){if(e===null||typeof e>"u"||typeof e=="object"&&!e.toString)throw new Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),this.css[0]==="\uFEFF"||this.css[0]==="￾"?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!VM||/^\w+:\/\//.test(t.from)||iC(t.from)?this.file=t.from:this.file=nC(t.from)),VM&&hee){let n=new cee(this.css,t);if(n.text){this.map=n;let r=n.consumer().file;!this.file&&r&&(this.file=this.mapResolve(r))}}this.file||(this.id="<input css "+uee(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,n,r={}){let s,o,a;if(t&&typeof t=="object"){let u=t,c=n;if(typeof u.offset=="number"){let h=this.fromOffset(u.offset);t=h.line,n=h.col}else t=u.line,n=u.column;if(typeof c.offset=="number"){let h=this.fromOffset(c.offset);o=h.line,a=h.col}else o=c.line,a=c.column}else if(!n){let u=this.fromOffset(t);t=u.line,n=u.col}let l=this.origin(t,n,o,a);return l?s=new zM(e,l.endLine===void 0?l.line:{column:l.column,line:l.line},l.endLine===void 0?l.column:{column:l.endColumn,line:l.endLine},l.source,l.file,r.plugin):s=new zM(e,o===void 0?t:{column:n,line:t},o===void 0?n:{column:a,line:o},this.css,this.file,r.plugin),s.input={column:n,endColumn:a,endLine:o,line:t,source:this.css},this.file&&(bp&&(s.input.url=bp(this.file).toString()),s.input.file=this.file),s}fromOffset(e){let t,n;if(this[sC])n=this[sC];else{let s=this.css.split(`
`);n=new Array(s.length);let o=0;for(let a=0,l=s.length;a<l;a++)n[a]=o,o+=s[a].length+1;this[sC]=n}t=n[n.length-1];let r=0;if(e>=t)r=n.length-1;else{let s=n.length-2,o;for(;r<s;)if(o=r+(s-r>>1),e<n[o])s=o-1;else if(e>=n[o+1])r=o+1;else{r=o;break}}return{col:e-n[r]+1,line:r+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:nC(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,n,r){if(!this.map)return!1;let s=this.map.consumer(),o=s.originalPositionFor({column:t,line:e});if(!o.source)return!1;let a;typeof n=="number"&&(a=s.originalPositionFor({column:r,line:n}));let l;iC(o.source)?l=bp(o.source):l=new URL(o.source,this.map.consumer().sourceRoot||bp(this.map.mapFile));let u={column:o.column,endColumn:a&&a.column,endLine:a&&a.line,line:o.line,url:l.toString()};if(l.protocol==="file:")if(HM)u.file=HM(l);else throw new Error("file: protocol is not available in this PostCSS build");let c=s.sourceContentFor(o.source);return c&&(u.source=c),u}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])this[t]!=null&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}};var Tp=Sp;Sp.default=Sp,rC&&rC.registerInput&&rC.registerInput(Sp);let{SourceMapConsumer:qM,SourceMapGenerator:Bp}=Nr,{dirname:Rp,relative:$M,resolve:jM,sep:WM}=Nr,{pathToFileURL:KM}=Nr,dee=Tp,fee=!!(qM&&Bp),gee=!!(Rp&&jM&&$M&&WM);var YM=class{constructor(e,t,n,r){this.stringify=e,this.mapOpts=n.map||{},this.root=t,this.opts=n,this.css=r,this.originalCSS=r,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;this.isInline()?e="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?e=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?e=this.mapOpts.annotation(this.opts.to,this.root):e=this.outputFile()+".map";let t=`
`;this.css.includes(`\r
`)&&(t=`\r
`),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t=this.toUrl(this.path(e.file)),n=e.root||Rp(e.file),r;this.mapOpts.sourcesContent===!1?(r=new qM(e.text),r.sourcesContent&&(r.sourcesContent=null)):r=e.consumer(),this.map.applySourceMap(r,t,this.toUrl(this.path(n)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)e=this.root.nodes[t],e.type==="comment"&&e.text.indexOf("# sourceMappingURL=")===0&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),gee&&fee&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=Bp.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new Bp({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new Bp({file:this.outputFile(),ignoreInvalidMapping:!0});let e=1,t=1,n="<no source>",r={generated:{column:0,line:0},original:{column:0,line:0},source:""},s,o;this.stringify(this.root,(a,l,u)=>{if(this.css+=a,l&&u!=="end"&&(r.generated.line=e,r.generated.column=t-1,l.source&&l.source.start?(r.source=this.sourcePath(l),r.original.line=l.source.start.line,r.original.column=l.source.start.column-1,this.map.addMapping(r)):(r.source=n,r.original.line=1,r.original.column=0,this.map.addMapping(r))),s=a.match(/\n/g),s?(e+=s.length,o=a.lastIndexOf(`
`),t=a.length-o):t+=a.length,l&&u!=="start"){let c=l.parent||{raws:{}};(!(l.type==="decl"||l.type==="atrule"&&!l.nodes)||l!==c.last||c.raws.semicolon)&&(l.source&&l.source.end?(r.source=this.sourcePath(l),r.original.line=l.source.end.line,r.original.column=l.source.end.column-1,r.generated.line=e,r.generated.column=t-2,this.map.addMapping(r)):(r.source=n,r.original.line=1,r.original.column=0,r.generated.line=e,r.generated.column=t-1,this.map.addMapping(r)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(e=>e.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let e=this.mapOpts.annotation;return typeof e<"u"&&e!==!0?!1:this.previous().length?this.previous().some(t=>t.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(e=>e.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute||e.charCodeAt(0)===60||/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let n=this.opts.to?Rp(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(n=Rp(jM(n,this.mapOpts.annotation)));let r=$M(n,e);return this.memoizedPaths.set(e,r),r}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new dee(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let n=t.source.input.from;if(n&&!e[n]){e[n]=!0;let r=this.usesFileUrls?this.toFileUrl(n):this.toUrl(this.path(n));this.map.setSourceContent(r,t.source.input.css)}}});else if(this.css){let t=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(t,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return Buffer?Buffer.from(e).toString("base64"):window.btoa(unescape(encodeURIComponent(e)))}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(KM){let n=KM(e).toString();return this.memoizedFileURLs.set(e,n),n}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;WM==="\\"&&(e=e.replace(/\\/g,"/"));let n=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,n),n}};let Aee=wp,oC=class extends Aee{constructor(e){super(e),this.type="comment"}};var Lp=oC;oC.default=oC;let{isClean:ZM,my:XM}=xf,JM=xp,e3=Lp,pee=wp,t3,aC,lC,i3;function n3(i){return i.map(e=>(e.nodes&&(e.nodes=n3(e.nodes)),delete e.source,e))}function r3(i){if(i[ZM]=!1,i.proxyOf.nodes)for(let e of i.proxyOf.nodes)r3(e)}let so=class a5 extends pee{append(...e){for(let t of e){let n=this.normalize(t,this.last);for(let r of n)this.proxyOf.nodes.push(r)}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let t=this.getIterator(),n,r;for(;this.indexes[t]<this.proxyOf.nodes.length&&(n=this.indexes[t],r=e(this.proxyOf.nodes[n],n),r!==!1);)this.indexes[t]+=1;return delete this.indexes[t],r}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get(e,t){return t==="proxyOf"?e:e[t]?t==="each"||typeof t=="string"&&t.startsWith("walk")?(...n)=>e[t](...n.map(r=>typeof r=="function"?(s,o)=>r(s.toProxy(),o):r)):t==="every"||t==="some"?n=>e[t]((r,...s)=>n(r.toProxy(),...s)):t==="root"?()=>e.root().toProxy():t==="nodes"?e.nodes.map(n=>n.toProxy()):t==="first"||t==="last"?e[t].toProxy():e[t]:e[t]},set(e,t,n){return e[t]===n||(e[t]=n,(t==="name"||t==="params"||t==="selector")&&e.markDirty()),!0}}}index(e){return typeof e=="number"?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let n=this.index(e),r=this.normalize(t,this.proxyOf.nodes[n]).reverse();n=this.index(e);for(let o of r)this.proxyOf.nodes.splice(n+1,0,o);let s;for(let o in this.indexes)s=this.indexes[o],n<s&&(this.indexes[o]=s+r.length);return this.markDirty(),this}insertBefore(e,t){let n=this.index(e),r=n===0?"prepend":!1,s=this.normalize(t,this.proxyOf.nodes[n],r).reverse();n=this.index(e);for(let a of s)this.proxyOf.nodes.splice(n,0,a);let o;for(let a in this.indexes)o=this.indexes[a],n<=o&&(this.indexes[a]=o+s.length);return this.markDirty(),this}normalize(e,t){if(typeof e=="string")e=n3(t3(e).nodes);else if(typeof e>"u")e=[];else if(Array.isArray(e)){e=e.slice(0);for(let r of e)r.parent&&r.parent.removeChild(r,"ignore")}else if(e.type==="root"&&this.type!=="document"){e=e.nodes.slice(0);for(let r of e)r.parent&&r.parent.removeChild(r,"ignore")}else if(e.type)e=[e];else if(e.prop){if(typeof e.value>"u")throw new Error("Value field is missed in node creation");typeof e.value!="string"&&(e.value=String(e.value)),e=[new JM(e)]}else if(e.selector)e=[new aC(e)];else if(e.name)e=[new lC(e)];else if(e.text)e=[new e3(e)];else throw new Error("Unknown node type in node creation");return e.map(r=>(r[XM]||a5.rebuild(r),r=r.proxyOf,r.parent&&r.parent.removeChild(r),r[ZM]&&r3(r),typeof r.raws.before>"u"&&t&&typeof t.raws.before<"u"&&(r.raws.before=t.raws.before.replace(/\S/g,"")),r.parent=this.proxyOf,r))}prepend(...e){e=e.reverse();for(let t of e){let n=this.normalize(t,this.first,"prepend").reverse();for(let r of n)this.proxyOf.nodes.unshift(r);for(let r in this.indexes)this.indexes[r]=this.indexes[r]+n.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);let t;for(let n in this.indexes)t=this.indexes[n],t>=e&&(this.indexes[n]=t-1);return this.markDirty(),this}replaceValues(e,t,n){return n||(n=t,t={}),this.walkDecls(r=>{t.props&&!t.props.includes(r.prop)||t.fast&&!r.value.includes(t.fast)||(r.value=r.value.replace(e,n))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,n)=>{let r;try{r=e(t,n)}catch(s){throw t.addToError(s)}return r!==!1&&t.walk&&(r=t.walk(e)),r})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if(n.type==="atrule"&&e.test(n.name))return t(n,r)}):this.walk((n,r)=>{if(n.type==="atrule"&&n.name===e)return t(n,r)}):(t=e,this.walk((n,r)=>{if(n.type==="atrule")return t(n,r)}))}walkComments(e){return this.walk((t,n)=>{if(t.type==="comment")return e(t,n)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if(n.type==="decl"&&e.test(n.prop))return t(n,r)}):this.walk((n,r)=>{if(n.type==="decl"&&n.prop===e)return t(n,r)}):(t=e,this.walk((n,r)=>{if(n.type==="decl")return t(n,r)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((n,r)=>{if(n.type==="rule"&&e.test(n.selector))return t(n,r)}):this.walk((n,r)=>{if(n.type==="rule"&&n.selector===e)return t(n,r)}):(t=e,this.walk((n,r)=>{if(n.type==="rule")return t(n,r)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};so.registerParse=i=>{t3=i},so.registerRule=i=>{aC=i},so.registerAtRule=i=>{lC=i},so.registerRoot=i=>{i3=i};var Tl=so;so.default=so,so.rebuild=i=>{i.type==="atrule"?Object.setPrototypeOf(i,lC.prototype):i.type==="rule"?Object.setPrototypeOf(i,aC.prototype):i.type==="decl"?Object.setPrototypeOf(i,JM.prototype):i.type==="comment"?Object.setPrototypeOf(i,e3.prototype):i.type==="root"&&Object.setPrototypeOf(i,i3.prototype),i[XM]=!0,i.nodes&&i.nodes.forEach(e=>{so.rebuild(e)})};let mee=Tl,s3,o3,bf=class extends mee{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new s3(new o3,this,e).stringify()}};bf.registerLazyResult=i=>{s3=i},bf.registerProcessor=i=>{o3=i};var uC=bf;bf.default=bf;let cC=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let n=t.node.rangeBy(t);this.line=n.start.line,this.column=n.start.column,this.endLine=n.end.line,this.endColumn=n.end.column}for(let n in t)this[n]=t[n]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var a3=cC;cC.default=cC;let yee=a3,hC=class{constructor(e,t,n){this.processor=e,this.messages=[],this.root=t,this.opts=n,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){t.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let n=new yee(e,t);return this.messages.push(n),n}warnings(){return this.messages.filter(e=>e.type==="warning")}get content(){return this.css}};var dC=hC;hC.default=hC;const fC=39,l3=34,Dp=92,u3=47,kp=10,Sf=32,Pp=12,Mp=9,Fp=13,vee=91,Eee=93,Iee=40,_ee=41,Cee=123,wee=125,xee=59,bee=42,See=58,Tee=64,Op=/[\t\n\f\r "#'()/;[\\\]{}]/g,Np=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,Bee=/.[\r\n"'(/\\]/,c3=/[\da-f]/i;var Ree=function(e,t={}){let n=e.css.valueOf(),r=t.ignoreErrors,s,o,a,l,u,c,h,d,g,A,p=n.length,y=0,v=[],E=[];function I(){return y}function C(T){throw e.error("Unclosed "+T,y)}function w(){return E.length===0&&y>=p}function S(T){if(E.length)return E.pop();if(y>=p)return;let Q=T?T.ignoreUnclosed:!1;switch(s=n.charCodeAt(y),s){case kp:case Sf:case Mp:case Fp:case Pp:{o=y;do o+=1,s=n.charCodeAt(o);while(s===Sf||s===kp||s===Mp||s===Fp||s===Pp);A=["space",n.slice(y,o)],y=o-1;break}case vee:case Eee:case Cee:case wee:case See:case xee:case _ee:{let M=String.fromCharCode(s);A=[M,M,y];break}case Iee:{if(d=v.length?v.pop()[1]:"",g=n.charCodeAt(y+1),d==="url"&&g!==fC&&g!==l3&&g!==Sf&&g!==kp&&g!==Mp&&g!==Pp&&g!==Fp){o=y;do{if(c=!1,o=n.indexOf(")",o+1),o===-1)if(r||Q){o=y;break}else C("bracket");for(h=o;n.charCodeAt(h-1)===Dp;)h-=1,c=!c}while(c);A=["brackets",n.slice(y,o+1),y,o],y=o}else o=n.indexOf(")",y+1),l=n.slice(y,o+1),o===-1||Bee.test(l)?A=["(","(",y]:(A=["brackets",l,y,o],y=o);break}case fC:case l3:{a=s===fC?"'":'"',o=y;do{if(c=!1,o=n.indexOf(a,o+1),o===-1)if(r||Q){o=y+1;break}else C("string");for(h=o;n.charCodeAt(h-1)===Dp;)h-=1,c=!c}while(c);A=["string",n.slice(y,o+1),y,o],y=o;break}case Tee:{Op.lastIndex=y+1,Op.test(n),Op.lastIndex===0?o=n.length-1:o=Op.lastIndex-2,A=["at-word",n.slice(y,o+1),y,o],y=o;break}case Dp:{for(o=y,u=!0;n.charCodeAt(o+1)===Dp;)o+=1,u=!u;if(s=n.charCodeAt(o+1),u&&s!==u3&&s!==Sf&&s!==kp&&s!==Mp&&s!==Fp&&s!==Pp&&(o+=1,c3.test(n.charAt(o)))){for(;c3.test(n.charAt(o+1));)o+=1;n.charCodeAt(o+1)===Sf&&(o+=1)}A=["word",n.slice(y,o+1),y,o],y=o;break}default:{s===u3&&n.charCodeAt(y+1)===bee?(o=n.indexOf("*/",y+2)+1,o===0&&(r||Q?o=n.length:C("comment")),A=["comment",n.slice(y,o+1),y,o],y=o):(Np.lastIndex=y+1,Np.test(n),Np.lastIndex===0?o=n.length-1:o=Np.lastIndex-2,A=["word",n.slice(y,o+1),y,o],v.push(A),y=o);break}}return y++,A}function x(T){E.push(T)}return{back:x,endOfFile:w,nextToken:S,position:I}};let h3=Tl,Qp=class extends h3{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}};var gC=Qp;Qp.default=Qp,h3.registerAtRule(Qp);let d3=Tl,f3,g3,Rc=class extends d3{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,n){let r=super.normalize(e);if(t){if(n==="prepend")this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let s of r)s.raws.before=t.raws.before}return r}removeChild(e,t){let n=this.index(e);return!t&&n===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}toResult(e={}){return new f3(new g3,this,e).stringify()}};Rc.registerLazyResult=i=>{f3=i},Rc.registerProcessor=i=>{g3=i};var Tf=Rc;Rc.default=Rc,d3.registerRoot(Rc);let Bf={comma(i){return Bf.split(i,[","],!0)},space(i){let e=[" ",`
`,"	"];return Bf.split(i,e)},split(i,e,t){let n=[],r="",s=!1,o=0,a=!1,l="",u=!1;for(let c of i)u?u=!1:c==="\\"?u=!0:a?c===l&&(a=!1):c==='"'||c==="'"?(a=!0,l=c):c==="("?o+=1:c===")"?o>0&&(o-=1):o===0&&e.includes(c)&&(s=!0),s?(r!==""&&n.push(r.trim()),r="",s=!1):r+=c;return(t||r!=="")&&n.push(r.trim()),n}};var A3=Bf;Bf.default=Bf;let p3=Tl,Lee=A3,Up=class extends p3{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return Lee.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,n=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(n)}};var AC=Up;Up.default=Up,p3.registerRule(Up);let Dee=xp,kee=Ree,Pee=Lp,Mee=gC,Fee=Tf,m3=AC;const y3={empty:!0,space:!0};function Oee(i){for(let e=i.length-1;e>=0;e--){let t=i[e],n=t[3]||t[2];if(n)return n}}var Nee=class{constructor(e){this.input=e,this.root=new Fee,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t=new Mee;t.name=e[1].slice(1),t.name===""&&this.unnamedAtrule(t,e),this.init(t,e[2]);let n,r,s,o=!1,a=!1,l=[],u=[];for(;!this.tokenizer.endOfFile();){if(e=this.tokenizer.nextToken(),n=e[0],n==="("||n==="["?u.push(n==="("?")":"]"):n==="{"&&u.length>0?u.push("}"):n===u[u.length-1]&&u.pop(),u.length===0)if(n===";"){t.source.end=this.getPosition(e[2]),t.source.end.offset++,this.semicolon=!0;break}else if(n==="{"){a=!0;break}else if(n==="}"){if(l.length>0){for(s=l.length-1,r=l[s];r&&r[0]==="space";)r=l[--s];r&&(t.source.end=this.getPosition(r[3]||r[2]),t.source.end.offset++)}this.end(e);break}else l.push(e);else l.push(e);if(this.tokenizer.endOfFile()){o=!0;break}}t.raws.between=this.spacesAndCommentsFromEnd(l),l.length?(t.raws.afterName=this.spacesAndCommentsFromStart(l),this.raw(t,"params",l),o&&(e=l[l.length-1],t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++,this.spaces=t.raws.between,t.raws.between="")):(t.raws.afterName="",t.params=""),a&&(t.nodes=[],this.current=t)}checkMissedSemicolon(e){let t=this.colon(e);if(t===!1)return;let n=0,r;for(let s=t-1;s>=0&&(r=e[s],!(r[0]!=="space"&&(n+=1,n===2)));s--);throw this.input.error("Missed semicolon",r[0]==="word"?r[3]+1:r[2])}colon(e){let t=0,n,r,s;for(let[o,a]of e.entries()){if(n=a,r=n[0],r==="("&&(t+=1),r===")"&&(t-=1),t===0&&r===":")if(!s)this.doubleColon(n);else{if(s[0]==="word"&&s[1]==="progid")continue;return o}s=n}return!1}comment(e){let t=new Pee;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let n=e[1].slice(2,-2);if(/^\s*$/.test(n))t.text="",t.raws.left=n,t.raws.right="";else{let r=n.match(/^(\s*)([^]*\S)(\s*)$/);t.text=r[2],t.raws.left=r[1],t.raws.right=r[3]}}createTokenizer(){this.tokenizer=kee(this.input)}decl(e,t){let n=new Dee;this.init(n,e[0][2]);let r=e[e.length-1];for(r[0]===";"&&(this.semicolon=!0,e.pop()),n.source.end=this.getPosition(r[3]||r[2]||Oee(e)),n.source.end.offset++;e[0][0]!=="word";)e.length===1&&this.unknownWord(e),n.raws.before+=e.shift()[1];for(n.source.start=this.getPosition(e[0][2]),n.prop="";e.length;){let u=e[0][0];if(u===":"||u==="space"||u==="comment")break;n.prop+=e.shift()[1]}n.raws.between="";let s;for(;e.length;)if(s=e.shift(),s[0]===":"){n.raws.between+=s[1];break}else s[0]==="word"&&/\w/.test(s[1])&&this.unknownWord([s]),n.raws.between+=s[1];(n.prop[0]==="_"||n.prop[0]==="*")&&(n.raws.before+=n.prop[0],n.prop=n.prop.slice(1));let o=[],a;for(;e.length&&(a=e[0][0],!(a!=="space"&&a!=="comment"));)o.push(e.shift());this.precheckMissedSemicolon(e);for(let u=e.length-1;u>=0;u--){if(s=e[u],s[1].toLowerCase()==="!important"){n.important=!0;let c=this.stringFrom(e,u);c=this.spacesFromEnd(e)+c,c!==" !important"&&(n.raws.important=c);break}else if(s[1].toLowerCase()==="important"){let c=e.slice(0),h="";for(let d=u;d>0;d--){let g=c[d][0];if(h.trim().indexOf("!")===0&&g!=="space")break;h=c.pop()[1]+h}h.trim().indexOf("!")===0&&(n.important=!0,n.raws.important=h,e=c)}if(s[0]!=="space"&&s[0]!=="comment")break}e.some(u=>u[0]!=="space"&&u[0]!=="comment")&&(n.raws.between+=o.map(u=>u[1]).join(""),o=[]),this.raw(n,"value",o.concat(e),t),n.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new m3;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let t=this.current.nodes[this.current.nodes.length-1];t&&t.type==="rule"&&!t.raws.ownSemicolon&&(t.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="",e.type!=="comment"&&(this.semicolon=!1)}other(e){let t=!1,n=null,r=!1,s=null,o=[],a=e[1].startsWith("--"),l=[],u=e;for(;u;){if(n=u[0],l.push(u),n==="("||n==="[")s||(s=u),o.push(n==="("?")":"]");else if(a&&r&&n==="{")s||(s=u),o.push("}");else if(o.length===0)if(n===";")if(r){this.decl(l,a);return}else break;else if(n==="{"){this.rule(l);return}else if(n==="}"){this.tokenizer.back(l.pop()),t=!0;break}else n===":"&&(r=!0);else n===o[o.length-1]&&(o.pop(),o.length===0&&(s=null));u=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),o.length>0&&this.unclosedBracket(s),t&&r){if(!a)for(;l.length&&(u=l[l.length-1][0],!(u!=="space"&&u!=="comment"));)this.tokenizer.back(l.pop());this.decl(l,a)}else this.unknownWord(l)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch(e=this.tokenizer.nextToken(),e[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e);break}this.endFile()}precheckMissedSemicolon(){}raw(e,t,n,r){let s,o,a=n.length,l="",u=!0,c,h;for(let d=0;d<a;d+=1)s=n[d],o=s[0],o==="space"&&d===a-1&&!r?u=!1:o==="comment"?(h=n[d-1]?n[d-1][0]:"empty",c=n[d+1]?n[d+1][0]:"empty",!y3[h]&&!y3[c]?l.slice(-1)===","?u=!1:l+=s[1]:u=!1):l+=s[1];if(!u){let d=n.reduce((g,A)=>g+A[1],"");e.raws[t]={raw:d,value:l}}e[t]=l}rule(e){e.pop();let t=new m3;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],!(t!=="space"&&t!=="comment"));)n=e.pop()[1]+n;return n}spacesAndCommentsFromStart(e){let t,n="";for(;e.length&&(t=e[0][0],!(t!=="space"&&t!=="comment"));)n+=e.shift()[1];return n}spacesFromEnd(e){let t,n="";for(;e.length&&(t=e[e.length-1][0],t==="space");)n=e.pop()[1]+n;return n}stringFrom(e,t){let n="";for(let r=t;r<e.length;r++)n+=e[r][1];return e.splice(t,e.length-t),n}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}};let Qee=Tl,Uee=Nee,Gee=Tp;function Gp(i,e){let t=new Gee(i,e),n=new Uee(t);try{n.parse()}catch(r){throw r}return n.root}var pC=Gp;Gp.default=Gp,Qee.registerParse(Gp);let{isClean:cs,my:Hee}=xf,zee=YM,Vee=_p,qee=Tl,$ee=uC,v3=dC,jee=pC,Wee=Tf;const Kee={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},Yee={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},Zee={Once:!0,postcssPlugin:!0,prepare:!0},Lc=0;function Rf(i){return typeof i=="object"&&typeof i.then=="function"}function E3(i){let e=!1,t=Kee[i.type];return i.type==="decl"?e=i.prop.toLowerCase():i.type==="atrule"&&(e=i.name.toLowerCase()),e&&i.append?[t,t+"-"+e,Lc,t+"Exit",t+"Exit-"+e]:e?[t,t+"-"+e,t+"Exit",t+"Exit-"+e]:i.append?[t,Lc,t+"Exit"]:[t,t+"Exit"]}function I3(i){let e;return i.type==="document"?e=["Document",Lc,"DocumentExit"]:i.type==="root"?e=["Root",Lc,"RootExit"]:e=E3(i),{eventIndex:0,events:e,iterator:0,node:i,visitorIndex:0,visitors:[]}}function mC(i){return i[cs]=!1,i.nodes&&i.nodes.forEach(e=>mC(e)),i}let yC={},Dc=class l5{constructor(e,t,n){this.stringified=!1,this.processed=!1;let r;if(typeof t=="object"&&t!==null&&(t.type==="root"||t.type==="document"))r=mC(t);else if(t instanceof l5||t instanceof v3)r=mC(t.root),t.map&&(typeof n.map>"u"&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=t.map);else{let s=jee;n.syntax&&(s=n.syntax.parse),n.parser&&(s=n.parser),s.parse&&(s=s.parse);try{r=s(t,n)}catch(o){this.processed=!0,this.error=o}r&&!r[Hee]&&qee.rebuild(r)}this.result=new v3(e,r,n),this.helpers={...yC,postcss:yC,result:this.result},this.plugins=this.processor.plugins.map(s=>typeof s=="object"&&s.prepare?{...s,...s.prepare(this.result)}:s)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let n=this.result.lastPlugin;try{t&&t.addToError(e),this.error=e,e.name==="CssSyntaxError"&&!e.plugin?(e.plugin=n.postcssPlugin,e.setMessage()):n.postcssVersion}catch(r){console&&console.error&&console.error(r)}return e}prepareVisitors(){this.listeners={};let e=(t,n,r)=>{this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push([t,r])};for(let t of this.plugins)if(typeof t=="object")for(let n in t){if(!Yee[n]&&/^[A-Z]/.test(n))throw new Error(`Unknown event ${n} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!Zee[n])if(typeof t[n]=="object")for(let r in t[n])r==="*"?e(t,n,t[n][r]):e(t,n+"-"+r.toLowerCase(),t[n][r]);else typeof t[n]=="function"&&e(t,n,t[n])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],n=this.runOnRoot(t);if(Rf(n))try{await n}catch(r){throw this.handleError(r)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[cs];){e[cs]=!0;let t=[I3(e)];for(;t.length>0;){let n=this.visitTick(t);if(Rf(n))try{await n}catch(r){let s=t[t.length-1].node;throw this.handleError(r,s)}}}if(this.listeners.OnceExit)for(let[t,n]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if(e.type==="document"){let r=e.nodes.map(s=>n(s,this.helpers));await Promise.all(r)}else await n(e,this.helpers)}catch(r){throw this.handleError(r)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if(typeof e=="object"&&e.Once){if(this.result.root.type==="document"){let t=this.result.root.nodes.map(n=>e.Once(n,this.helpers));return Rf(t[0])?Promise.all(t):t}return e.Once(this.result.root,this.helpers)}else if(typeof e=="function")return e(this.result.root,this.result)}catch(t){throw this.handleError(t)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=Vee;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let r=new zee(t,this.result.root,this.result.opts).generate();return this.result.css=r[0],this.result.map=r[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins){let t=this.runOnRoot(e);if(Rf(t))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[cs];)e[cs]=!0,this.walkSync(e);if(this.listeners.OnceExit)if(e.type==="document")for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[n,r]of e){this.result.lastPlugin=n;let s;try{s=r(t,this.helpers)}catch(o){throw this.handleError(o,t.proxyOf)}if(t.type!=="root"&&t.type!=="document"&&!t.parent)return!0;if(Rf(s))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:n,visitors:r}=t;if(n.type!=="root"&&n.type!=="document"&&!n.parent){e.pop();return}if(r.length>0&&t.visitorIndex<r.length){let[o,a]=r[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===r.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=o;try{return a(n.toProxy(),this.helpers)}catch(l){throw this.handleError(l,n)}}if(t.iterator!==0){let o=t.iterator,a;for(;a=n.nodes[n.indexes[o]];)if(n.indexes[o]+=1,!a[cs]){a[cs]=!0,e.push(I3(a));return}t.iterator=0,delete n.indexes[o]}let s=t.events;for(;t.eventIndex<s.length;){let o=s[t.eventIndex];if(t.eventIndex+=1,o===Lc){n.nodes&&n.nodes.length&&(n[cs]=!0,t.iterator=n.getIterator());return}else if(this.listeners[o]){t.visitors=this.listeners[o];return}}e.pop()}walkSync(e){e[cs]=!0;let t=E3(e);for(let n of t)if(n===Lc)e.nodes&&e.each(r=>{r[cs]||this.walkSync(r)});else{let r=this.listeners[n];if(r&&this.visitSync(r,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};Dc.registerPostcss=i=>{yC=i};var _3=Dc;Dc.default=Dc,Wee.registerLazyResult(Dc),$ee.registerLazyResult(Dc);let Xee=YM,Jee=_p,ete=pC;const tte=dC;let vC=class{constructor(e,t,n){t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=n,this._map=void 0;let r,s=Jee;this.result=new tte(this._processor,r,this._opts),this.result.css=t;let o=this;Object.defineProperty(this.result,"root",{get(){return o.root}});let a=new Xee(s,r,this._opts,t);if(a.isMap()){let[l,u]=a.generate();l&&(this.result.css=l),u&&(this.result.map=u)}else a.clearAnnotation(),this.result.css=a.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let e,t=ete;try{e=t(this._css,this._opts)}catch(n){this.error=n}if(this.error)throw this.error;return this._root=e,e}get[Symbol.toStringTag](){return"NoWorkResult"}};var ite=vC;vC.default=vC;let nte=ite,rte=_3,ste=uC,ote=Tf,Lf=class{constructor(e=[]){this.version="8.4.38",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let n of e)if(n.postcss===!0?n=n():n.postcss&&(n=n.postcss),typeof n=="object"&&Array.isArray(n.plugins))t=t.concat(n.plugins);else if(typeof n=="object"&&n.postcssPlugin)t.push(n);else if(typeof n=="function")t.push(n);else if(!(typeof n=="object"&&(n.parse||n.stringify)))throw new Error(n+" is not a PostCSS plugin");return t}process(e,t={}){return!this.plugins.length&&!t.parser&&!t.stringifier&&!t.syntax?new nte(this,e,t):new rte(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};var ate=Lf;Lf.default=Lf,ote.registerProcessor(Lf),ste.registerProcessor(Lf);let lte=xp,ute=GM,cte=Lp,hte=gC,dte=Tp,fte=Tf,gte=AC;function Df(i,e){if(Array.isArray(i))return i.map(r=>Df(r));let{inputs:t,...n}=i;if(t){e=[];for(let r of t){let s={...r,__proto__:dte.prototype};s.map&&(s.map={...s.map,__proto__:ute.prototype}),e.push(s)}}if(n.nodes&&(n.nodes=i.nodes.map(r=>Df(r,e))),n.source){let{inputId:r,...s}=n.source;n.source=s,r!=null&&(n.source.input=e[r])}if(n.type==="root")return new fte(n);if(n.type==="decl")return new lte(n);if(n.type==="rule")return new gte(n);if(n.type==="comment")return new cte(n);if(n.type==="atrule")return new hte(n);throw new Error("Unknown node type: "+i.type)}var Ate=Df;Df.default=Df;let pte=W_,C3=xp,mte=_3,yte=Tl,EC=ate,vte=_p,Ete=Ate,w3=uC,Ite=a3,x3=Lp,b3=gC,_te=dC,Cte=Tp,wte=pC,xte=A3,S3=AC,T3=Tf,bte=wp;function Dt(...i){return i.length===1&&Array.isArray(i[0])&&(i=i[0]),new EC(i)}Dt.plugin=function(e,t){let n=!1;function r(...o){console&&console.warn&&!n&&(n=!0,console.warn(e+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),en&&en.startsWith("cn")&&console.warn(e+`: 里面 postcss.plugin 被弃用. 迁移指南:
https://www.w3ctech.com/topic/2226`));let a=t(...o);return a.postcssPlugin=e,a.postcssVersion=new EC().version,a}let s;return Object.defineProperty(r,"postcss",{get(){return s||(s=r()),s}}),r.process=function(o,a,l){return Dt([r(l)]).process(o,a)},r},Dt.stringify=vte,Dt.parse=wte,Dt.fromJSON=Ete,Dt.list=xte,Dt.comment=i=>new x3(i),Dt.atRule=i=>new b3(i),Dt.decl=i=>new C3(i),Dt.rule=i=>new S3(i),Dt.root=i=>new T3(i),Dt.document=i=>new w3(i),Dt.CssSyntaxError=pte,Dt.Declaration=C3,Dt.Container=yte,Dt.Processor=EC,Dt.Document=w3,Dt.Comment=x3,Dt.Warning=Ite,Dt.AtRule=b3,Dt.Result=_te,Dt.Input=Cte,Dt.Rule=S3,Dt.Root=T3,Dt.Node=bte,mte.registerPostcss(Dt);var Ste=Dt;Dt.default=Dt;const Tte=YP,B3=RJ,{isPlainObject:Bte}=q_,R3=qJ,Rte=$J,{parse:Lte}=Ste,Dte=["img","audio","video","picture","svg","object","map","iframe","embed"],kte=["script","style"];function kf(i,e){i&&Object.keys(i).forEach(function(t){e(i[t],t)})}function oo(i,e){return{}.hasOwnProperty.call(i,e)}function L3(i,e){const t=[];return kf(i,function(n){e(n)&&t.push(n)}),t}function Pte(i){for(const e in i)if(oo(i,e))return!1;return!0}function Mte(i){return i.map(function(e){if(!e.url)throw new Error("URL missing");return e.url+(e.w?` ${e.w}w`:"")+(e.h?` ${e.h}h`:"")+(e.d?` ${e.d}x`:"")}).join(", ")}var Fte=Pf;const Ote=/^[^\0\t\n\f\r /<=>]+$/;function Pf(i,e,t){if(i==null)return"";typeof i=="number"&&(i=i.toString());let n="",r="";function s(N,G){const j=this;this.tag=N,this.attribs=G||{},this.tagPosition=n.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(y.length){const V=y[y.length-1];V.text+=j.text}},this.updateParentNodeMediaChildren=function(){y.length&&Dte.includes(this.tag)&&y[y.length-1].mediaChildren.push(this.tag)}}e=Object.assign({},Pf.defaults,e),e.parser=Object.assign({},Nte,e.parser);const o=function(N){return e.allowedTags===!1||(e.allowedTags||[]).indexOf(N)>-1};kte.forEach(function(N){o(N)&&!e.allowVulnerableTags&&console.warn(`

⚠️ Your \`allowedTags\` option includes, \`${N}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});const a=e.nonTextTags||["script","style","textarea","option"];let l,u;e.allowedAttributes&&(l={},u={},kf(e.allowedAttributes,function(N,G){l[G]=[];const j=[];N.forEach(function(V){typeof V=="string"&&V.indexOf("*")>=0?j.push(B3(V).replace(/\\\*/g,".*")):l[G].push(V)}),j.length&&(u[G]=new RegExp("^("+j.join("|")+")$"))}));const c={},h={},d={};kf(e.allowedClasses,function(N,G){if(l&&(oo(l,G)||(l[G]=[]),l[G].push("class")),c[G]=N,Array.isArray(N)){const j=[];c[G]=[],d[G]=[],N.forEach(function(V){typeof V=="string"&&V.indexOf("*")>=0?j.push(B3(V).replace(/\\\*/g,".*")):V instanceof RegExp?d[G].push(V):c[G].push(V)}),j.length&&(h[G]=new RegExp("^("+j.join("|")+")$"))}});const g={};let A;kf(e.transformTags,function(N,G){let j;typeof N=="function"?j=N:typeof N=="string"&&(j=Pf.simpleTransform(N)),G==="*"?A=j:g[G]=j});let p,y,v,E,I,C,w=!1;x();const S=new Tte.Parser({onopentag:function(N,G){if(e.enforceHtmlBoundary&&N==="html"&&x(),I){C++;return}const j=new s(N,G);y.push(j);let V=!1;const Z=!!j.text;let Y;if(oo(g,N)&&(Y=g[N](N,G),j.attribs=G=Y.attribs,Y.text!==void 0&&(j.innerText=Y.text),N!==Y.tagName&&(j.name=N=Y.tagName,E[p]=Y.tagName)),A&&(Y=A(N,G),j.attribs=G=Y.attribs,N!==Y.tagName&&(j.name=N=Y.tagName,E[p]=Y.tagName)),(!o(N)||e.disallowedTagsMode==="recursiveEscape"&&!Pte(v)||e.nestingLimit!=null&&p>=e.nestingLimit)&&(V=!0,v[p]=!0,(e.disallowedTagsMode==="discard"||e.disallowedTagsMode==="completelyDiscard")&&a.indexOf(N)!==-1&&(I=!0,C=1),v[p]=!0),p++,V){if(e.disallowedTagsMode==="discard"||e.disallowedTagsMode==="completelyDiscard")return;r=n,n=""}n+="<"+N,N==="script"&&(e.allowedScriptHostnames||e.allowedScriptDomains)&&(j.innerText=""),(!l||oo(l,N)||l["*"])&&kf(G,function(te,J){if(!Ote.test(J)){delete j.attribs[J];return}if(te===""&&!e.allowedEmptyAttributes.includes(J)&&(e.nonBooleanAttributes.includes(J)||e.nonBooleanAttributes.includes("*"))){delete j.attribs[J];return}let ce=!1;if(!l||oo(l,N)&&l[N].indexOf(J)!==-1||l["*"]&&l["*"].indexOf(J)!==-1||oo(u,N)&&u[N].test(J)||u["*"]&&u["*"].test(J))ce=!0;else if(l&&l[N]){for(const ie of l[N])if(Bte(ie)&&ie.name&&ie.name===J){ce=!0;let ne="";if(ie.multiple===!0){const ue=te.split(" ");for(const fe of ue)ie.values.indexOf(fe)!==-1&&(ne===""?ne=fe:ne+=" "+fe)}else ie.values.indexOf(te)>=0&&(ne=te);te=ne}}if(ce){if(e.allowedSchemesAppliedToAttributes.indexOf(J)!==-1&&Q(N,te)){delete j.attribs[J];return}if(N==="script"&&J==="src"){let ie=!0;try{const ne=M(te);if(e.allowedScriptHostnames||e.allowedScriptDomains){const ue=(e.allowedScriptHostnames||[]).find(function(me){return me===ne.url.hostname}),fe=(e.allowedScriptDomains||[]).find(function(me){return ne.url.hostname===me||ne.url.hostname.endsWith(`.${me}`)});ie=ue||fe}}catch{ie=!1}if(!ie){delete j.attribs[J];return}}if(N==="iframe"&&J==="src"){let ie=!0;try{const ne=M(te);if(ne.isRelativeUrl)ie=oo(e,"allowIframeRelativeUrls")?e.allowIframeRelativeUrls:!e.allowedIframeHostnames&&!e.allowedIframeDomains;else if(e.allowedIframeHostnames||e.allowedIframeDomains){const ue=(e.allowedIframeHostnames||[]).find(function(me){return me===ne.url.hostname}),fe=(e.allowedIframeDomains||[]).find(function(me){return ne.url.hostname===me||ne.url.hostname.endsWith(`.${me}`)});ie=ue||fe}}catch{ie=!1}if(!ie){delete j.attribs[J];return}}if(J==="srcset")try{let ie=Rte(te);if(ie.forEach(function(ne){Q("srcset",ne.url)&&(ne.evil=!0)}),ie=L3(ie,function(ne){return!ne.evil}),ie.length)te=Mte(L3(ie,function(ne){return!ne.evil})),j.attribs[J]=te;else{delete j.attribs[J];return}}catch{delete j.attribs[J];return}if(J==="class"){const ie=c[N],ne=c["*"],ue=h[N],fe=d[N],me=h["*"],Pe=[ue,me].concat(fe).filter(function(Re){return Re});if(ie&&ne?te=X(te,R3(ie,ne),Pe):te=X(te,ie||ne,Pe),!te.length){delete j.attribs[J];return}}if(J==="style"){if(e.parseStyleAttributes)try{const ie=Lte(N+" {"+te+"}",{map:!1}),ne=R(ie,e.allowedStyles);if(te=z(ne),te.length===0){delete j.attribs[J];return}}catch{typeof window<"u"&&console.warn('Failed to parse "'+N+" {"+te+`}", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547`),delete j.attribs[J];return}else if(e.allowedStyles)throw new Error("allowedStyles option cannot be used together with parseStyleAttributes: false.")}n+=" "+J,te&&te.length?n+='="'+T(te,!0)+'"':e.allowedEmptyAttributes.includes(J)&&(n+='=""')}else delete j.attribs[J]}),e.selfClosing.indexOf(N)!==-1?n+=" />":(n+=">",j.innerText&&!Z&&!e.textFilter&&(n+=T(j.innerText),w=!0)),V&&(n=r+T(n),r="")},ontext:function(N){if(I)return;const G=y[y.length-1];let j;if(G&&(j=G.tag,N=G.innerText!==void 0?G.innerText:N),e.disallowedTagsMode==="completelyDiscard"&&!o(j))N="";else if((e.disallowedTagsMode==="discard"||e.disallowedTagsMode==="completelyDiscard")&&(j==="script"||j==="style"))n+=N;else{const V=T(N,!1);e.textFilter&&!w?n+=e.textFilter(V,j):w||(n+=V)}if(y.length){const V=y[y.length-1];V.text+=N}},onclosetag:function(N,G){if(I)if(C--,!C)I=!1;else return;const j=y.pop();if(!j)return;if(j.tag!==N){y.push(j);return}I=e.enforceHtmlBoundary?N==="html":!1,p--;const V=v[p];if(V){if(delete v[p],e.disallowedTagsMode==="discard"||e.disallowedTagsMode==="completelyDiscard"){j.updateParentNodeText();return}r=n,n=""}if(E[p]&&(N=E[p],delete E[p]),e.exclusiveFilter&&e.exclusiveFilter(j)){n=n.substr(0,j.tagPosition);return}if(j.updateParentNodeMediaChildren(),j.updateParentNodeText(),e.selfClosing.indexOf(N)!==-1||G&&!o(N)&&["escape","recursiveEscape"].indexOf(e.disallowedTagsMode)>=0){V&&(n=r,r="");return}n+="</"+N+">",V&&(n=r+T(n),r=""),w=!1}},e.parser);return S.write(i),S.end(),n;function x(){n="",p=0,y=[],v={},E={},I=!1,C=0}function T(N,G){return typeof N!="string"&&(N=N+""),e.parser.decodeEntities&&(N=N.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),G&&(N=N.replace(/"/g,"&quot;"))),N=N.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),G&&(N=N.replace(/"/g,"&quot;")),N}function Q(N,G){for(G=G.replace(/[\x00-\x20]+/g,"");;){const Z=G.indexOf("<!--");if(Z===-1)break;const Y=G.indexOf("-->",Z+4);if(Y===-1)break;G=G.substring(0,Z)+G.substring(Y+3)}const j=G.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!j)return G.match(/^[/\\]{2}/)?!e.allowProtocolRelative:!1;const V=j[1].toLowerCase();return oo(e.allowedSchemesByTag,N)?e.allowedSchemesByTag[N].indexOf(V)===-1:!e.allowedSchemes||e.allowedSchemes.indexOf(V)===-1}function M(N){if(N=N.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),N.startsWith("relative:"))throw new Error("relative: exploit attempt");let G="relative://relative-site";for(let Z=0;Z<100;Z++)G+=`/${Z}`;const j=new URL(N,G);return{isRelativeUrl:j&&j.hostname==="relative-site"&&j.protocol==="relative:",url:j}}function R(N,G){if(!G)return N;const j=N.nodes[0];let V;return G[j.selector]&&G["*"]?V=R3(G[j.selector],G["*"]):V=G[j.selector]||G["*"],V&&(N.nodes[0].nodes=j.nodes.reduce(q(V),[])),N}function z(N){return N.nodes[0].nodes.reduce(function(G,j){return G.push(`${j.prop}:${j.value}${j.important?" !important":""}`),G},[]).join(";")}function q(N){return function(G,j){return oo(N,j.prop)&&N[j.prop].some(function(Z){return Z.test(j.value)})&&G.push(j),G}}function X(N,G,j){return G?(N=N.split(/\s+/),N.filter(function(V){return G.indexOf(V)!==-1||j.some(function(Z){return Z.test(V)})}).join(" ")):N}}const Nte={decodeEntities:!0};Pf.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],nonBooleanAttributes:["abbr","accept","accept-charset","accesskey","action","allow","alt","as","autocapitalize","autocomplete","blocking","charset","cite","class","color","cols","colspan","content","contenteditable","coords","crossorigin","data","datetime","decoding","dir","dirname","download","draggable","enctype","enterkeyhint","fetchpriority","for","form","formaction","formenctype","formmethod","formtarget","headers","height","hidden","high","href","hreflang","http-equiv","id","imagesizes","imagesrcset","inputmode","integrity","is","itemid","itemprop","itemref","itemtype","kind","label","lang","list","loading","low","max","maxlength","media","method","min","minlength","name","nonce","optimum","pattern","ping","placeholder","popover","popovertarget","popovertargetaction","poster","preload","referrerpolicy","rel","rows","rowspan","sandbox","scope","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap","onauxclick","onafterprint","onbeforematch","onbeforeprint","onbeforeunload","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onlanguagechange","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmessageerror","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onoffline","ononline","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreset","onresize","onrejectionhandled","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","onunhandledrejection","onunload","onvolumechange","onwaiting","onwheel"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},allowedEmptyAttributes:["alt"],selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0},Pf.simpleTransform=function(i,e,t){return t=t===void 0?!0:t,e=e||{},function(n,r){let s;if(t)for(s in e)r[s]=e[s];else r=e;return{tagName:i,attribs:r}}};const Qte=jo(Fte);function Ute(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var D3={exports:{}};(function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var h=a.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");return h.path=a.normalizePath(h.path),a.buildURLFromParts(h)}var d=a.parseURL(u);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return c.alwaysNormalize?(d.path=a.normalizePath(d.path),a.buildURLFromParts(d)):u;var g=a.parseURL(l);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var A=r.exec(g.path);g.netLoc=A[1],g.path=A[2]}g.netLoc&&!g.path&&(g.path="/");var p={scheme:g.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(p.netLoc=g.netLoc,d.path[0]!=="/"))if(!d.path)p.path=g.path,d.params||(p.params=g.params,d.query||(p.query=g.query));else{var y=g.path,v=y.substring(0,y.lastIndexOf("/")+1)+d.path;p.path=a.normalizePath(v)}return p.path===null&&(p.path=c.alwaysNormalize?a.normalizePath(d.path):d.path),a.buildURLFromParts(p)},parseURL:function(l){var u=n.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};i.exports=a})()})(D3);var IC=D3.exports;function k3(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Di(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?k3(Object(t),!0).forEach(function(n){zte(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):k3(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Gte(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Hte(i){var e=Gte(i,"string");return typeof e=="symbol"?e:String(e)}function zte(i,e,t){return e=Hte(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function fi(){return fi=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},fi.apply(this,arguments)}const ke=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},Vte=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=qte},qte=Number.MAX_SAFE_INTEGER||9007199254740991;let U=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i}({}),Ke=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),de=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.UNKNOWN="unknown",i}({});const Bl=function(){},_C={trace:Bl,debug:Bl,log:Bl,warn:Bl,info:Bl,error:Bl};let Mf=_C;function $te(i){const e=self.console[i];return e?e.bind(self.console,`[${i}] >`):Bl}function jte(i,...e){e.forEach(function(t){Mf[t]=i[t]?i[t].bind(i):$te(t)})}function Wte(i,e){if(typeof console=="object"&&i===!0||typeof i=="object"){jte(i,"debug","log","info","warn","error");try{Mf.log(`Debug logs enabled for "${e}" in hls.js version 1.5.11`)}catch{Mf=_C}}else Mf=_C}const se=Mf,Kte=/^(\d+)x(\d+)$/,P3=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ii{constructor(e){typeof e=="string"&&(e=ii.parseAttrList(e)),fi(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=Kte.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},r='"';for(P3.lastIndex=0;(t=P3.exec(e))!==null;){let s=t[2];s.indexOf(r)===0&&s.lastIndexOf(r)===s.length-1&&(s=s.slice(1,-1));const o=t[1].trim();n[o]=s}return n}}function Yte(i){return i!=="ID"&&i!=="CLASS"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function Zte(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"}class M3{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const r in n)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==n[r]){se.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=fi(new ii({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);ke(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(ke(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&ke(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Hp{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var kt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class F3{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[kt.AUDIO]:null,[kt.VIDEO]:null,[kt.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=(t==null?void 0:t.byteRangeEndOffset)||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=IC.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class CC extends F3{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Hp,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!ke(this.programDateTime))return null;const e=ke(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,s,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:s,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[kt.AUDIO]=null,e[kt.VIDEO]=null,e[kt.AUDIOVIDEO]=null}}class Xte extends F3{constructor(e,t,n,r,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Hp,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const Jte=10;class eie{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?ke(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Jte}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function wC(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function tie(i){const e=xC(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function iie(i){const e=function(n,r,s){const o=n[r];n[r]=n[s],n[s]=o};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function nie(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const s=r[0]==="base64",o=r[1];s?(n.splice(-1,1),t=wC(o)):t=tie(o)}}return t}function xC(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}const kc=typeof self<"u"?self:void 0;var Kt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Fn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function O3(i){switch(i){case Fn.FAIRPLAY:return Kt.FAIRPLAY;case Fn.PLAYREADY:return Kt.PLAYREADY;case Fn.WIDEVINE:return Kt.WIDEVINE;case Fn.CLEARKEY:return Kt.CLEARKEY}}var N3={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function rie(i){if(i===N3.WIDEVINE)return Kt.WIDEVINE}function Q3(i){switch(i){case Kt.FAIRPLAY:return Fn.FAIRPLAY;case Kt.PLAYREADY:return Fn.PLAYREADY;case Kt.WIDEVINE:return Fn.WIDEVINE;case Kt.CLEARKEY:return Fn.CLEARKEY}}function bC(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Kt.FAIRPLAY,Kt.WIDEVINE,Kt.PLAYREADY,Kt.CLEARKEY].filter(r=>!!e[r]):[];return!n[Kt.WIDEVINE]&&t&&n.push(Kt.WIDEVINE),n}const U3=function(i){return kc!=null&&(i=kc.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function sie(i,e,t,n){let r;switch(i){case Kt.FAIRPLAY:r=["cenc","sinf"];break;case Kt.WIDEVINE:case Kt.PLAYREADY:r=["cenc"];break;case Kt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return oie(r,e,t,n)}function oie(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function Rl(i,e,t){return Uint8Array.prototype.slice?i.slice(e,t):new Uint8Array(Array.prototype.slice.call(i,e,t))}const SC=(i,e)=>e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,G3=(i,e)=>e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,Ff=(i,e)=>{const t=e;let n=0;for(;SC(i,e);){n+=10;const r=zp(i,e+6);n+=r,G3(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)},zp=(i,e)=>{let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t},aie=(i,e)=>SC(i,e)&&zp(i,e+6)+10<=i.length-e,TC=i=>{const e=z3(i);for(let t=0;t<e.length;t++){const n=e[t];if(H3(n))return fie(n)}},H3=i=>i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp",lie=i=>{const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=zp(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}},z3=i=>{let e=0;const t=[];for(;SC(i,e);){const n=zp(i,e+6);e+=10;const r=e+n;for(;e+8<r;){const s=lie(i.subarray(e)),o=uie(s);o&&t.push(o),e+=s.size+10}G3(i,e)&&(e+=10)}return t},uie=i=>i.type==="PRIV"?cie(i):i.type[0]==="W"?die(i):hie(i),cie=i=>{if(i.size<2)return;const e=hs(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}},hie=i=>{if(i.size<2)return;if(i.type==="TXXX"){let t=1;const n=hs(i.data.subarray(t),!0);t+=n.length+1;const r=hs(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=hs(i.data.subarray(1));return{key:i.type,data:e}},die=i=>{if(i.type==="WXXX"){if(i.size<2)return;let t=1;const n=hs(i.data.subarray(t),!0);t+=n.length+1;const r=hs(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=hs(i.data);return{key:i.type,data:e}},fie=i=>{if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},hs=(i,e=!1)=>{const t=gie();if(t){const u=t.decode(i);if(e){const c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}const n=i.length;let r,s,o,a="",l=0;for(;l<n;){if(r=i[l++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:s=i[l++],a+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=i[l++],o=i[l++],a+=String.fromCharCode((r&15)<<12|(s&63)<<6|(o&63)<<0);break}}return a};let BC;function gie(){if(!navigator.userAgent.includes("PlayStation 4"))return!BC&&typeof self.TextDecoder<"u"&&(BC=new self.TextDecoder("utf-8")),BC}const ds={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},Vp=Math.pow(2,32)-1,Aie=[].push,V3={video:1,audio:2,id3:3,text:4};function _i(i){return String.fromCharCode.apply(null,i)}function q3(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function Ve(i,e){const t=j3(i,e);return t<0?4294967296+t:t}function $3(i,e){let t=Ve(i,e);return t*=Math.pow(2,32),t+=Ve(i,e+4),t}function j3(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function RC(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function pie(i){const e=i.byteLength;for(let t=0;t<e;){const n=Ve(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function et(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let r=0;r<n;){const s=Ve(i,r),o=_i(i.subarray(r+4,r+8)),a=s>1?r+s:n;if(o===e[0])if(e.length===1)t.push(i.subarray(r+8,a));else{const l=et(i.subarray(r+8,a),e.slice(1));l.length&&Aie.apply(t,l)}r=a}return t}function mie(i){const e=[],t=i[0];let n=8;const r=Ve(i,n);n+=4;let s=0,o=0;t===0?(s=Ve(i,n),o=Ve(i,n+4),n+=8):(s=$3(i,n),o=$3(i,n+8),n+=16),n+=2;let a=i.length+o;const l=q3(i,n);n+=2;for(let u=0;u<l;u++){let c=n;const h=Ve(i,c);c+=4;const d=h&2147483647;if((h&2147483648)>>>31===1)return se.warn("SIDX has hierarchical references (not supported)"),null;const A=Ve(i,c);c+=4,e.push({referenceSize:d,subsegmentDuration:A,info:{duration:A/r,start:a,end:a+d-1}}),a+=d,c+=4,n=c}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:l,references:e}}function W3(i){const e=[],t=et(i,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],o=et(s,["tkhd"])[0];if(o){let a=o[0];const l=Ve(o,a===0?12:20),u=et(s,["mdia","mdhd"])[0];if(u){a=u[0];const c=Ve(u,a===0?12:20),h=et(s,["mdia","hdlr"])[0];if(h){const d=_i(h.subarray(8,12)),g={soun:kt.AUDIO,vide:kt.VIDEO}[d];if(g){const A=et(s,["mdia","minf","stbl","stsd"])[0],p=yie(A);e[l]={timescale:c,type:g},e[g]=Di({timescale:c,id:l},p)}}}}}return et(i,["moov","mvex","trex"]).forEach(r=>{const s=Ve(r,4),o=e[s];o&&(o.default={duration:Ve(r,12),flags:Ve(r,20)})}),e}function yie(i){const e=i.subarray(8),t=e.subarray(86),n=_i(e.subarray(4,8));let r=n;const s=n==="enca"||n==="encv";if(s){const a=et(e,[n])[0].subarray(n==="enca"?28:78);et(a,["sinf"]).forEach(u=>{const c=et(u,["schm"])[0];if(c){const h=_i(c.subarray(4,8));if(h==="cbcs"||h==="cenc"){const d=et(u,["frma"])[0];d&&(r=_i(d))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const o=et(t,["avcC"])[0];r+="."+qp(o[1])+qp(o[2])+qp(o[3]);break}case"mp4a":{const o=et(e,[n])[0],a=et(o.subarray(28),["esds"])[0];if(a&&a.length>12){let l=4;if(a[l++]!==3)break;l=LC(a,l),l+=2;const u=a[l++];if(u&128&&(l+=2),u&64&&(l+=a[l++]),a[l++]!==4)break;l=LC(a,l);const c=a[l++];if(c===64)r+="."+qp(c);else break;if(l+=12,a[l++]!==5)break;l=LC(a,l);const h=a[l++];let d=(h&248)>>3;d===31&&(d+=1+((h&7)<<3)+((a[l]&224)>>5)),r+="."+d}break}case"hvc1":case"hev1":{const o=et(t,["hvcC"])[0],a=o[1],l=["","A","B","C"][a>>6],u=a&31,c=Ve(o,2),h=(a&32)>>5?"H":"L",d=o[12],g=o.subarray(6,12);r+="."+l+u,r+="."+c.toString(16).toUpperCase(),r+="."+h+d;let A="";for(let p=g.length;p--;){const y=g[p];(y||A)&&(A="."+y.toString(16).toUpperCase()+A)}r+=A;break}case"dvh1":case"dvhe":{const o=et(t,["dvcC"])[0],a=o[2]>>1&127,l=o[2]<<5&32|o[3]>>3&31;r+="."+fs(a)+"."+fs(l);break}case"vp09":{const o=et(t,["vpcC"])[0],a=o[4],l=o[5],u=o[6]>>4&15;r+="."+fs(a)+"."+fs(l)+"."+fs(u);break}case"av01":{const o=et(t,["av1C"])[0],a=o[1]>>>5,l=o[1]&31,u=o[2]>>>7?"H":"M",c=(o[2]&64)>>6,h=(o[2]&32)>>5,d=a===2&&c?h?12:10:c?10:8,g=(o[2]&16)>>4,A=(o[2]&8)>>3,p=(o[2]&4)>>2,y=o[2]&3;r+="."+a+"."+fs(l)+u+"."+fs(d)+"."+g+"."+A+p+y+"."+fs(1)+"."+fs(1)+"."+fs(1)+"."+0;break}}return{codec:r,encrypted:s}}function LC(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function qp(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function fs(i){return(i<10?"0":"")+i}function vie(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&et(i,["moov","trak"]).forEach(r=>{const o=et(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=et(o,["enca"]);const l=a.length>0;l||(a=et(o,["encv"])),a.forEach(u=>{const c=l?u.subarray(28):u.subarray(78);et(c,["sinf"]).forEach(d=>{const g=K3(d);if(g){const A=g.subarray(8,24);A.some(p=>p!==0)||(se.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${ds.hexDump(A)} -> ${ds.hexDump(t)}`),g.set(t,8))}})})}),i}function K3(i){const e=et(i,["schm"])[0];if(e){const t=_i(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return et(i,["schi","tenc"])[0]}return se.error("[eme] missing 'schm' box"),null}function Eie(i,e){return et(e,["moof","traf"]).reduce((t,n)=>{const r=et(n,["tfdt"])[0],s=r[0],o=et(n,["tfhd"]).reduce((a,l)=>{const u=Ve(l,4),c=i[u];if(c){let h=Ve(r,4);if(s===1){if(h===Vp)return se.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;h*=Vp+1,h+=Ve(r,8)}const d=c.timescale||9e4,g=h/d;if(ke(g)&&(a===null||g<a))return g}return a},null);return o!==null&&ke(o)&&(t===null||o<t)?o:t},null)}function Iie(i,e){let t=0,n=0,r=0;const s=et(i,["moof","traf"]);for(let o=0;o<s.length;o++){const a=s[o],l=et(a,["tfhd"])[0],u=Ve(l,4),c=e[u];if(!c)continue;const h=c.default,d=Ve(l,0)|(h==null?void 0:h.flags);let g=h==null?void 0:h.duration;d&8&&(d&2?g=Ve(l,12):g=Ve(l,8));const A=c.timescale||9e4,p=et(a,["trun"]);for(let y=0;y<p.length;y++){if(t=_ie(p[y]),!t&&g){const v=Ve(p[y],4);t=g*v}c.type===kt.VIDEO?n+=t/A:c.type===kt.AUDIO&&(r+=t/A)}}if(n===0&&r===0){let o=1/0,a=0,l=0;const u=et(i,["sidx"]);for(let c=0;c<u.length;c++){const h=mie(u[c]);if(h!=null&&h.references){o=Math.min(o,h.earliestPresentationTime/h.timescale);const d=h.references.reduce((g,A)=>g+A.info.duration||0,0);a=Math.max(a,d+h.earliestPresentationTime/h.timescale),l=a-o}}if(l&&ke(l))return l}return n||r}function _ie(i){const e=Ve(i,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const r=Ve(i,4);for(let s=0;s<r;s++){if(e&256){const o=Ve(i,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function Cie(i,e,t){et(e,["moof","traf"]).forEach(n=>{et(n,["tfhd"]).forEach(r=>{const s=Ve(r,4),o=i[s];if(!o)return;const a=o.timescale||9e4;et(n,["tfdt"]).forEach(l=>{const u=l[0],c=t*a;if(c){let h=Ve(l,4);if(u===0)h-=c,h=Math.max(h,0),RC(l,4,h);else{h*=Math.pow(2,32),h+=Ve(l,8),h-=c,h=Math.max(h,0);const d=Math.floor(h/(Vp+1)),g=Math.floor(h%(Vp+1));RC(l,4,d),RC(l,8,g)}}})})})}function wie(i){const e={valid:null,remainder:null},t=et(i,["moof"]);if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=Rl(i,0,n.byteOffset-8),e.remainder=Rl(i,n.byteOffset-8),e}function dr(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function Y3(i,e){const t=[],n=e.samples,r=e.timescale,s=e.id;let o=!1;return et(n,["moof"]).map(l=>{const u=l.byteOffset-8;et(l,["traf"]).map(h=>{const d=et(h,["tfdt"]).map(g=>{const A=g[0];let p=Ve(g,4);return A===1&&(p*=Math.pow(2,32),p+=Ve(g,8)),p/r})[0];return d!==void 0&&(i=d),et(h,["tfhd"]).map(g=>{const A=Ve(g,4),p=Ve(g,0)&16777215,y=(p&1)!==0,v=(p&2)!==0,E=(p&8)!==0;let I=0;const C=(p&16)!==0;let w=0;const S=(p&32)!==0;let x=8;A===s&&(y&&(x+=8),v&&(x+=4),E&&(I=Ve(g,x),x+=4),C&&(w=Ve(g,x),x+=4),S&&(x+=4),e.type==="video"&&(o=xie(e.codec)),et(h,["trun"]).map(T=>{const Q=T[0],M=Ve(T,0)&16777215,R=(M&1)!==0;let z=0;const q=(M&4)!==0,X=(M&256)!==0;let N=0;const G=(M&512)!==0;let j=0;const V=(M&1024)!==0,Z=(M&2048)!==0;let Y=0;const te=Ve(T,4);let J=8;R&&(z=Ve(T,J),J+=4),q&&(J+=4);let ce=z+u;for(let ie=0;ie<te;ie++){if(X?(N=Ve(T,J),J+=4):N=I,G?(j=Ve(T,J),J+=4):j=w,V&&(J+=4),Z&&(Q===0?Y=Ve(T,J):Y=j3(T,J),J+=4),e.type===kt.VIDEO){let ne=0;for(;ne<j;){const ue=Ve(n,ce);if(ce+=4,bie(o,n[ce])){const fe=n.subarray(ce,ce+ue);Z3(fe,o?2:1,i+Y/r,t)}ce+=ue,ne+=ue+4}}i+=N/r}}))})})}),t}function xie(i){if(!i)return!1;const e=i.indexOf("."),t=e<0?i:i.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function bie(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Z3(i,e,t,n){const r=X3(i);let s=0;s+=e;let o=0,a=0,l=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(l===255);a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(l===255);const u=r.length-s;let c=s;if(a<u)s+=a;else if(a>u){se.error(`Malformed SEI payload. ${a} is too small, only ${u} bytes left to parse.`);break}if(o===4){if(r[c++]===181){const d=q3(r,c);if(c+=2,d===49){const g=Ve(r,c);if(c+=4,g===1195456820){const A=r[c++];if(A===3){const p=r[c++],y=31&p,v=64&p,E=v?2+y*3:0,I=new Uint8Array(E);if(v){I[0]=p;for(let C=1;C<E;C++)I[C]=r[c++]}n.push({type:A,payloadType:o,pts:t,bytes:I})}}}}}else if(o===5&&a>16){const h=[];for(let A=0;A<16;A++){const p=r[c++].toString(16);h.push(p.length==1?"0"+p:p),(A===3||A===5||A===7||A===9)&&h.push("-")}const d=a-16,g=new Uint8Array(d);for(let A=0;A<d;A++)g[A]=r[c++];n.push({payloadType:o,pts:t,uuid:h.join(""),userData:hs(g),userDataBytes:g})}}}function X3(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;const r=e-t.length,s=new Uint8Array(r);let o=0;for(n=0;n<r;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=i[o];return s}function Sie(i){const e=i[0];let t="",n="",r=0,s=0,o=0,a=0,l=0,u=0;if(e===0){for(;_i(i.subarray(u,u+1))!=="\0";)t+=_i(i.subarray(u,u+1)),u+=1;for(t+=_i(i.subarray(u,u+1)),u+=1;_i(i.subarray(u,u+1))!=="\0";)n+=_i(i.subarray(u,u+1)),u+=1;n+=_i(i.subarray(u,u+1)),u+=1,r=Ve(i,12),s=Ve(i,16),a=Ve(i,20),l=Ve(i,24),u=28}else if(e===1){u+=4,r=Ve(i,u),u+=4;const h=Ve(i,u);u+=4;const d=Ve(i,u);for(u+=4,o=2**32*h+d,Vte(o)||(o=Number.MAX_SAFE_INTEGER,se.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=Ve(i,u),u+=4,l=Ve(i,u),u+=4;_i(i.subarray(u,u+1))!=="\0";)t+=_i(i.subarray(u,u+1)),u+=1;for(t+=_i(i.subarray(u,u+1)),u+=1;_i(i.subarray(u,u+1))!=="\0";)n+=_i(i.subarray(u,u+1)),u+=1;n+=_i(i.subarray(u,u+1)),u+=1}const c=i.subarray(u,i.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:c}}function Tie(i,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(i,4),r=0,n=8;r<t;r++)s.set(e[r],n),n+=e[r].byteLength;return s}function Bie(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),Tie([112,115,115,104],new Uint8Array([n,0,0,0]),i,s,r,o,t||new Uint8Array)}function Rie(i){if(!(i instanceof ArrayBuffer)||i.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(i),n=t.getUint32(0);if(i.byteLength!==n&&n>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=ds.hexDump(new Uint8Array(i,12,16));const s=t.getUint32(28);if(e.version===0){if(n-32<s)return null;e.data=new Uint8Array(i,32,s)}else if(e.version===1){e.kids=[];for(let o=0;o<s;o++)e.kids.push(new Uint8Array(i,32+o*16,16))}return e}let $p={};class Of{static clearKeyUriToKeyIdMap(){$p={}}constructor(e,t,n,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Fn.FAIRPLAY:case Fn.WIDEVINE:case Fn.PLAYREADY:case Fn.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&se.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=Lie(e);return new Of(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=nie(this.uri);if(t)switch(this.keyFormat){case Fn.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Fn.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Bie(n,null,t);const r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(r)),o=s.substring(s.indexOf("<"),s.length),u=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(u){const c=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(c){const h=wC(c).subarray(0,16);iie(h),this.keyId=h}}break}default:{let n=t.subarray(0,16);if(n.length!==16){const r=new Uint8Array(16);r.set(n,16-n.length),n=r}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=$p[this.uri];if(!n){const r=Object.keys($p).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,r),$p[this.uri]=n}this.keyId=n}return this}}function Lie(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const J3=/\{\$([a-zA-Z0-9-_]+)\}/g;function eF(i){return J3.test(i)}function On(i,e,t){if(i.variableList!==null||i.hasVariableRefs)for(let n=t.length;n--;){const r=t[n],s=e[r];s&&(e[r]=DC(i,s))}}function DC(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(J3,n=>{const r=n.substring(2,n.length-1),s=t==null?void 0:t[r];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):s})}return e}function tF(i,e,t){let n=i.variableList;n||(i.variableList=n={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(r))s=o.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(o){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=s||""}function Die(i,e,t){const n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function Ll(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function kie(i){return typeof self<"u"&&i===self.ManagedMediaSource}const jp={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Pie(i,e){const t=jp[e];return!!t&&!!t[i.slice(0,4)]}function kC(i,e,t=!0){return!i.split(",").some(n=>!iF(n,e,t))}function iF(i,e,t=!0){var n;const r=Ll(t);return(n=r==null?void 0:r.isTypeSupported(Nf(i,e)))!=null?n:!1}function Nf(i,e){return`${e}/mp4;codecs="${i}"`}function nF(i){if(i){const e=i.substring(0,4);return jp.video[e]}return 2}function Wp(i){return i.split(",").reduce((e,t)=>{const n=jp.video[t];return n?(n*2+e)/(e?3:2):(jp.audio[t]+e)/(e?2:1)},0)}const PC={};function Mie(i,e=!0){if(PC[i])return PC[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[i];for(let n=0;n<t.length;n++)if(iF(t[n],"audio",e))return PC[i]=t[n],t[n];return i}const Fie=/flac|opus/i;function Kp(i,e=!0){return i.replace(Fie,t=>Mie(t.toLowerCase(),e))}function rF(i,e){return i&&i!=="mp4a"?i:e&&e.split(",")[0]}function Oie(i){const e=i.split(".");if(e.length>2){let t=e.shift()+".";return t+=parseInt(e.shift()).toString(16),t+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t}return i}const sF=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,oF=/#EXT-X-MEDIA:(.*)/g,Nie=/^#EXT(?:INF|-X-TARGETDURATION):/m,aF=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Qie=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class gs{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return IC.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Nie.test(e)}static parseMasterPlaylist(e,t){const n=eF(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];sF.lastIndex=0;let o;for(;(o=sF.exec(e))!=null;)if(o[1]){var a;const u=new ii(o[1]);On(r,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const c=DC(r,o[2]),h={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:gs.resolve(c,t)},d=u.decimalResolution("RESOLUTION");d&&(h.width=d.width,h.height=d.height),Uie(u.CODECS,h),(a=h.unknownCodecs)!=null&&a.length||s.push(h),r.levels.push(h)}else if(o[3]){const u=o[3],c=o[4];switch(u){case"SESSION-DATA":{const h=new ii(c);On(r,h,["DATA-ID","LANGUAGE","VALUE","URI"]);const d=h["DATA-ID"];d&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[d]=h);break}case"SESSION-KEY":{const h=lF(c,t,r);h.encrypted&&h.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(h)):se.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const h=new ii(c);On(r,h,["NAME","VALUE","QUERYPARAM"]),tF(r,h,t)}break}case"CONTENT-STEERING":{const h=new ii(c);On(r,h,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:gs.resolve(h["SERVER-URI"],t),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=uF(c);break}}}const l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const s={},o=n.levels,a={AUDIO:o.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:o.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(oF.lastIndex=0;(r=oF.exec(e))!==null;){const u=new ii(r[1]),c=u.TYPE;if(c){const h=a[c],d=s[c]||[];s[c]=d,On(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const g=u.LANGUAGE,A=u["ASSOC-LANGUAGE"],p=u.CHANNELS,y=u.CHARACTERISTICS,v=u["INSTREAM-ID"],E={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||g||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:g,url:u.URI?gs.resolve(u.URI,t):""};if(A&&(E.assocLang=A),p&&(E.channels=p),y&&(E.characteristics=y),v&&(E.instreamId=v),h!=null&&h.length){const I=gs.findGroup(h,E.groupId)||h[0];cF(E,I,"audioCodec"),cF(E,I,"textCodec")}d.push(E)}}return s}static parseLevelPlaylist(e,t,n,r,s,o){const a=new eie(t),l=a.fragments;let u=null,c=0,h=0,d=0,g=0,A=null,p=new CC(r,t),y,v,E,I=-1,C=!1,w=null;for(aF.lastIndex=0,a.m3u8=e,a.hasVariableRefs=eF(e);(y=aF.exec(e))!==null;){C&&(C=!1,p=new CC(r,t),p.start=d,p.sn=c,p.cc=g,p.level=n,u&&(p.initSegment=u,p.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null,w&&(p.setByteRange(w),w=null)));const Q=y[1];if(Q){p.duration=parseFloat(Q);const M=(" "+y[2]).slice(1);p.title=M||null,p.tagList.push(M?["INF",Q,M]:["INF",Q])}else if(y[3]){if(ke(p.duration)){p.start=d,E&&fF(p,E,a),p.sn=c,p.level=n,p.cc=g,l.push(p);const M=(" "+y[3]).slice(1);p.relurl=DC(a,M),hF(p,A),A=p,d+=p.duration,c++,h=0,C=!0}}else if(y[4]){const M=(" "+y[4]).slice(1);A?p.setByteRange(M,A):p.setByteRange(M)}else if(y[5])p.rawProgramDateTime=(" "+y[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),I===-1&&(I=l.length);else{if(y=y[0].match(Qie),!y){se.warn("No matches on slow regex match for level playlist!");continue}for(v=1;v<y.length&&!(typeof y[v]<"u");v++);const M=(" "+y[v]).slice(1),R=(" "+y[v+1]).slice(1),z=y[v+2]?(" "+y[v+2]).slice(1):"";switch(M){case"PLAYLIST-TYPE":a.type=R.toUpperCase();break;case"MEDIA-SEQUENCE":c=a.startSN=parseInt(R);break;case"SKIP":{const q=new ii(R);On(a,q,["RECENTLY-REMOVED-DATERANGES"]);const X=q.decimalInteger("SKIPPED-SEGMENTS");if(ke(X)){a.skippedSegments=X;for(let G=X;G--;)l.unshift(null);c+=X}const N=q.enumeratedString("RECENTLY-REMOVED-DATERANGES");N&&(a.recentlyRemovedDateranges=N.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(R),1);break;case"VERSION":a.version=parseInt(R);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(R||z)&&p.tagList.push(z?[R,z]:[R]);break;case"DISCONTINUITY":g++,p.tagList.push(["DIS"]);break;case"GAP":p.gap=!0,p.tagList.push([M]);break;case"BITRATE":p.tagList.push([M,R]);break;case"DATERANGE":{const q=new ii(R);On(a,q,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),On(a,q,q.clientAttrs);const X=new M3(q,a.dateRanges[q.ID]);X.isValid||a.skippedSegments?a.dateRanges[X.id]=X:se.warn(`Ignoring invalid DATERANGE tag: "${R}"`),p.tagList.push(["EXT-X-DATERANGE",R]);break}case"DEFINE":{{const q=new ii(R);On(a,q,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in q?Die(a,q,o):tF(a,q,t)}break}case"DISCONTINUITY-SEQUENCE":g=parseInt(R);break;case"KEY":{const q=lF(R,t,a);if(q.isSupported()){if(q.method==="NONE"){E=void 0;break}E||(E={}),E[q.keyFormat]&&(E=fi({},E)),E[q.keyFormat]=q}else se.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${R}"`);break}case"START":a.startTimeOffset=uF(R);break;case"MAP":{const q=new ii(R);if(On(a,q,["BYTERANGE","URI"]),p.duration){const X=new CC(r,t);dF(X,q,n,E),u=X,p.initSegment=u,u.rawProgramDateTime&&!p.rawProgramDateTime&&(p.rawProgramDateTime=u.rawProgramDateTime)}else{const X=p.byteRangeEndOffset;if(X){const N=p.byteRangeStartOffset;w=`${X-N}@${N}`}else w=null;dF(p,q,n,E),u=p,C=!0}break}case"SERVER-CONTROL":{const q=new ii(R);a.canBlockReload=q.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=q.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&q.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=q.optionalFloat("PART-HOLD-BACK",0),a.holdBack=q.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const q=new ii(R);a.partTarget=q.decimalFloatingPoint("PART-TARGET");break}case"PART":{let q=a.partList;q||(q=a.partList=[]);const X=h>0?q[q.length-1]:void 0,N=h++,G=new ii(R);On(a,G,["BYTERANGE","URI"]);const j=new Xte(G,p,t,N,X);q.push(j),p.duration+=j.duration;break}case"PRELOAD-HINT":{const q=new ii(R);On(a,q,["URI"]),a.preloadHint=q;break}case"RENDITION-REPORT":{const q=new ii(R);On(a,q,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(q);break}default:se.warn(`line parsed but not handled: ${y}`);break}}}A&&!A.relurl?(l.pop(),d-=A.duration,a.partList&&(a.fragmentHint=A)):a.partList&&(hF(p,A),p.cc=g,a.fragmentHint=p,E&&fF(p,E,a));const S=l.length,x=l[0],T=l[S-1];if(d+=a.skippedSegments*a.targetduration,d>0&&S&&T){a.averagetargetduration=d/S;const Q=T.sn;a.endSN=Q!=="initSegment"?Q:0,a.live||(T.endList=!0),x&&(a.startCC=x.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(d+=a.fragmentHint.duration),a.totalduration=d,a.endCC=g,I>0&&Gie(l,I),a}}function lF(i,e,t){var n,r;const s=new ii(i);On(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(n=s.METHOD)!=null?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=(r=s.KEYFORMAT)!=null?r:"identity";a&&s.IV&&!l&&se.error(`Invalid IV: ${s.IV}`);const h=a?gs.resolve(a,e):"",d=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Of(o,h,c,d,l)}function uF(i){const t=new ii(i).decimalFloatingPoint("TIME-OFFSET");return ke(t)?t:null}function Uie(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(s=>Pie(s,n));r.length&&(e[`${n}Codec`]=r.join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function cF(i,e,t){const n=e[t];n&&(i[t]=n)}function Gie(i,e){let t=i[e];for(let n=e;n--;){const r=i[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function hF(i,e){i.rawProgramDateTime?i.programDateTime=Date.parse(i.rawProgramDateTime):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime),ke(i.programDateTime)||(i.programDateTime=null,i.rawProgramDateTime=null)}function dF(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function fF(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}var mt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},qe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function gF(i){const{type:e}=i;switch(e){case mt.AUDIO_TRACK:return qe.AUDIO;case mt.SUBTITLE_TRACK:return qe.SUBTITLE;default:return qe.MAIN}}function MC(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Hie{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(U.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_LOADING,this.onLevelLoading,this),e.off(U.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(U.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,s=n||r,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:mt.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:s,url:o,deliveryDirectives:a}=t;this.load({id:n,level:r,pathwayId:s,responseType:"text",type:mt.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:mt.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:mt.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=r.context;if(u&&u.url===e.url&&u.level===e.level){se.trace("[playlist-loader]: playlist request ongoing");return}se.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===mt.MANIFEST?s=n.manifestLoadPolicy.default:s=fi({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),ke((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===mt.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===mt.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===mt.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const c=u.partTarget,h=u.targetduration;if(c&&h){const d=Math.max(c*3,h*.8)*1e3;s=fi({},s,{maxTimeToFirstByteMs:Math.min(d,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(d,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(u,c,h,d)=>{const g=this.getInternalLoader(h);this.resetInternalLoader(h.type);const A=u.data;if(A.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,h,new Error("no EXTM3U delimiter"),d||null,c);return}c.parsing.start=performance.now(),gs.isMediaPlaylist(A)?this.handleTrackOrLevelPlaylist(u,c,h,d||null,g):this.handleMasterPlaylist(u,c,h,d)},onError:(u,c,h,d)=>{this.handleNetworkError(c,h,!1,u,d)},onTimeout:(u,c,h)=>{this.handleNetworkError(c,h,!0,void 0,u)}};r.load(e,a,l)}handleMasterPlaylist(e,t,n,r){const s=this.hls,o=e.data,a=MC(e,n),l=gs.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,r,t);return}const{contentSteering:u,levels:c,sessionData:h,sessionKeys:d,startTimeOffset:g,variableList:A}=l;this.variableList=A;const{AUDIO:p=[],SUBTITLES:y,"CLOSED-CAPTIONS":v}=gs.parseMasterPlaylistMedia(o,a,l);p.length&&!p.some(I=>!I.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(se.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ii({}),bitrate:0,url:""})),s.trigger(U.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:y,captions:v,contentSteering:u,url:a,stats:t,networkDetails:r,sessionData:h,sessionKeys:d,startTimeOffset:g,variableList:A})}handleTrackOrLevelPlaylist(e,t,n,r,s){const o=this.hls,{id:a,level:l,type:u}=n,c=MC(e,n),h=0,d=ke(l)?l:ke(a)?a:0,g=gF(n),A=gs.parseLevelPlaylist(e.data,c,d,g,h,this.variableList);if(u===mt.MANIFEST){const p={attrs:new ii({}),bitrate:0,details:A,name:"",url:c};o.trigger(U.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:c,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=A,this.handlePlaylistLoaded(A,e,t,n,r,s)}handleManifestParsingError(e,t,n,r,s){this.hls.trigger(U.ERROR,{type:Ke.NETWORK_ERROR,details:de.MANIFEST_PARSING_ERROR,fatal:t.type===mt.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,n=!1,r,s){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===mt.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===mt.AUDIO_TRACK||e.type===mt.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);se.warn(`[playlist-loader]: ${o}`);let l=de.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case mt.MANIFEST:l=n?de.MANIFEST_LOAD_TIMEOUT:de.MANIFEST_LOAD_ERROR,u=!0;break;case mt.LEVEL:l=n?de.LEVEL_LOAD_TIMEOUT:de.LEVEL_LOAD_ERROR,u=!1;break;case mt.AUDIO_TRACK:l=n?de.AUDIO_TRACK_LOAD_TIMEOUT:de.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case mt.SUBTITLE_TRACK:l=n?de.SUBTITLE_TRACK_LOAD_TIMEOUT:de.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const h={type:Ke.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:s};if(r){const d=(t==null?void 0:t.url)||e.url;h.response=Di({url:d,data:void 0},r)}this.hls.trigger(U.ERROR,h)}handlePlaylistLoaded(e,t,n,r,s,o){const a=this.hls,{type:l,level:u,id:c,groupId:h,deliveryDirectives:d}=r,g=MC(t,r),A=gF(r),p=typeof r.level=="number"&&A===qe.MAIN?u:void 0;if(!e.fragments.length){const v=new Error("No Segments found in Playlist");a.trigger(U.ERROR,{type:Ke.NETWORK_ERROR,details:de.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:v,reason:v.message,response:t,context:r,level:p,parent:A,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const y=e.playlistParsingError;if(y){a.trigger(U.ERROR,{type:Ke.NETWORK_ERROR,details:de.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:y,reason:y.message,response:t,context:r,level:p,parent:A,networkDetails:s,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case mt.MANIFEST:case mt.LEVEL:a.trigger(U.LEVEL_LOADED,{details:e,level:p||0,id:c||0,stats:n,networkDetails:s,deliveryDirectives:d});break;case mt.AUDIO_TRACK:a.trigger(U.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:h||"",stats:n,networkDetails:s,deliveryDirectives:d});break;case mt.SUBTITLE_TRACK:a.trigger(U.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:h||"",stats:n,networkDetails:s,deliveryDirectives:d});break}}}function AF(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function pF(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){se.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){se.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(i.mode=t)}function Pc(i){const e=i.mode;if(e==="disabled"&&(i.mode="hidden"),i.cues)for(let t=i.cues.length;t--;)i.removeCue(i.cues[t]);e==="disabled"&&(i.mode=e)}function FC(i,e,t,n){const r=i.mode;if(r==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=Vie(i.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&i.removeCue(s[o])}r==="disabled"&&(i.mode=r)}function zie(i,e){if(e<i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t;for(;n<=r;){const s=Math.floor((r+n)/2);if(e<i[s].startTime)r=s-1;else if(e>i[s].startTime&&n<t)n=s+1;else return s}return i[n].startTime-e<e-i[r].startTime?n:r}function Vie(i,e,t){const n=[],r=zie(i,e);if(r>-1)for(let s=r,o=i.length;s<o;s++){const a=i[s];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function Yp(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}var Qr={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const qie=.25;function OC(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function mF(i,e,t,n,r){let s=new i(e,t,"");try{s.value=n,r&&(s.type=r)}catch{s=new i(e,t,JSON.stringify(r?Di({type:r},n):n))}return s}const Zp=(()=>{const i=OC();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function NC(i,e){return i.getTime()/1e3-e}function $ie(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class jie{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Pc(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return AF(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=OC();if(o)for(let a=0;a<s.length;a++){const l=s[a].type;if(l===Qr.emsg&&!n||!r)continue;const u=z3(s[a].data);if(u){const c=s[a].pts;let h=c+s[a].duration;h>Zp&&(h=Zp),h-c<=0&&(h=c+qie);for(let g=0;g<u.length;g++){const A=u[g];if(!H3(A)){this.updateId3CueEnds(c,l);const p=mF(o,c,h,A,l);p&&this.id3Track.addCue(p)}}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let s=r.length;s--;){const o=r[s];o.type===t&&o.startTime<e&&o.endTime===Zp&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let u;r==="audio"?u=c=>c.type===Qr.audioId3&&l:r==="video"?u=c=>c.type===Qr.emsg&&a:u=c=>c.type===Qr.audioId3&&l||c.type===Qr.emsg&&a,FC(s,t,n,u)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:s}=t,o=Object.keys(s);if(r){const c=Object.keys(n).filter(h=>!o.includes(h));for(let h=c.length;h--;){const d=c[h];Object.keys(n[d].cues).forEach(g=>{r.removeCue(n[d].cues[g])}),delete n[d]}}const a=t.fragments[t.fragments.length-1];if(o.length===0||!ke(a==null?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=a.programDateTime/1e3-a.start,u=OC();for(let c=0;c<o.length;c++){const h=o[c],d=s[h],g=NC(d.startDate,l),A=n[h],p=(A==null?void 0:A.cues)||{};let y=(A==null?void 0:A.durationKnown)||!1,v=Zp;const E=d.endDate;if(E)v=NC(E,l),y=!0;else if(d.endOnNext&&!y){const C=o.reduce((w,S)=>{if(S!==d.id){const x=s[S];if(x.class===d.class&&x.startDate>d.startDate&&(!w||d.startDate<w.startDate))return x}return w},null);C&&(v=NC(C.startDate,l),y=!0)}const I=Object.keys(d.attr);for(let C=0;C<I.length;C++){const w=I[C];if(!Yte(w))continue;const S=p[w];if(S)y&&!A.durationKnown&&(S.endTime=v);else if(u){let x=d.attr[w];Zte(w)&&(x=$ie(x));const T=mF(u,g,v,{key:w,data:x},Qr.dateRange);T&&(T.id=h,this.id3Track.addCue(T),p[w]=T)}}n[h]={cues:p,dateRange:d,durationKnown:y}}}}class Wie{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let u=a&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:o*r);const c=r;return u+Math.min(this.stallCount*1,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const r=n.edge,s=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,s),a)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(U.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(U.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(U.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(U.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===de.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&se.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||s===1||!t.live)return;const o=this.targetLatency;if(o===null)return;const a=n-o,l=Math.min(this.maxLatency,o+t.targetduration);if(a<l&&a>.05&&this.forwardBufferLength>1){const c=Math.min(2,Math.max(1,s)),h=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(c,Math.max(1,h))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const QC=["NONE","TYPE-0","TYPE-1",null];function Kie(i){return QC.indexOf(i)>-1}const Xp=["SDR","PQ","HLG"];function Yie(i){return!!i&&Xp.indexOf(i)>-1}var Jp={No:"",Yes:"YES",v2:"v2"};function yF(i){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,r=n<e/2;return e&&r?t?Jp.v2:Jp.Yes:Jp.No}class vF{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Mc{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return EF(this._audioGroups,e)}hasSubtitleGroup(e){return EF(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function EF(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function UC(i,e){const t=e.startPTS;if(ke(t)){let n=0,r;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&(r.duration=n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration:e.start=Math.max(i.start-e.duration,0)}function IF(i,e,t,n,r,s){n-t<=0&&(se.warn("Fragment should have a positive duration",e),n=t+e.duration,s=r+e.duration);let a=t,l=n;const u=e.startPTS,c=e.endPTS;if(ke(u)){const y=Math.abs(u-t);ke(e.deltaPTS)?e.deltaPTS=Math.max(y,e.deltaPTS):e.deltaPTS=y,a=Math.max(t,u),t=Math.min(t,u),r=Math.min(r,e.startDTS),l=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const h=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=r,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const d=e.sn;if(!i||d<i.startSN||d>i.endSN)return 0;let g;const A=d-i.startSN,p=i.fragments;for(p[A]=e,g=A;g>0;g--)UC(p[g],p[g-1]);for(g=A;g<p.length-1;g++)UC(p[g],p[g+1]);return i.fragmentHint&&UC(p[p.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,h}function Zie(i,e){let t=null;const n=i.fragments;for(let l=n.length-1;l>=0;l--){const u=n[l].initSegment;if(u){t=u;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let r=0,s;if(ene(i,e,(l,u)=>{l.relurl&&(r=l.cc-u.cc),ke(l.startPTS)&&ke(l.endPTS)&&(u.start=u.startPTS=l.startPTS,u.startDTS=l.startDTS,u.maxStartPTS=l.maxStartPTS,u.endPTS=l.endPTS,u.endDTS=l.endDTS,u.minEndPTS=l.minEndPTS,u.duration=l.endPTS-l.startPTS,u.duration&&(s=u),e.PTSKnown=e.alignedSliding=!0),u.elementaryStreams=l.elementaryStreams,u.loader=l.loader,u.stats=l.stats,l.initSegment&&(u.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(u=>{var c;u&&(!u.initSegment||u.initSegment.relurl===((c=t)==null?void 0:c.relurl))&&(u.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){se.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=Xie(i.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(r){se.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<o.length;l++)o[l].cc+=r}e.skippedSegments&&(e.startCC=e.fragments[0].cc),Jie(i.partList,e.partList,(l,u)=>{u.elementaryStreams=l.elementaryStreams,u.stats=l.stats}),s?IF(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):_F(i,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function Xie(i,e,t){const n=fi({},i);return t&&t.forEach(r=>{delete n[r]}),Object.keys(e).forEach(r=>{const s=new M3(e[r].attr,n[r]);s.isValid?n[r]=s:se.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),n}function Jie(i,e,t){if(i&&e){let n=0;for(let r=0,s=i.length;r<=s;r++){const o=i[r],a=e[r+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function ene(i,e,t){const n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,o=e.startSN-i.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let u=r;u<=s;u++){const c=l[o+u];let h=a[u];n&&!h&&u<n&&(h=e.fragments[u]=c),c&&h&&t(c,h)}}function _F(i,e){const t=e.startSN+e.skippedSegments-i.startSN,n=i.fragments;t<0||t>=n.length||GC(e,n[t].start)}function GC(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function tne(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&t*4>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function ine(i,e,t){if(!(i!=null&&i.details))return null;const n=i.details;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function CF(i,e,t){var n;return i!=null&&i.details?wF((n=i.details)==null?void 0:n.partList,e,t):null}function wF(i,e,t){if(i)for(let n=i.length;n--;){const r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function xF(i){i.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(r=>{r.level=t})})}function em(i){switch(i.details){case de.FRAG_LOAD_TIMEOUT:case de.KEY_LOAD_TIMEOUT:case de.LEVEL_LOAD_TIMEOUT:case de.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function bF(i,e){const t=em(e);return i.default[`${t?"timeout":"error"}Retry`]}function HC(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function SF(i){return Di(Di({},i),{errorRetry:null,timeoutRetry:null})}function tm(i,e,t,n){if(!i)return!1;const r=n==null?void 0:n.code,s=e<i.maxNumRetry&&(nne(r)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,s):s}function nne(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}const TF={search:function(i,e){let t=0,n=i.length-1,r=null,s=null;for(;t<=n;){r=(t+n)/2|0,s=i[r];const o=e(s);if(o>0)t=r+1;else if(o<0)n=r-1;else return s}return null}};function rne(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!ke(e))return null;const n=i[0].programDateTime;if(e<(n||0))return null;const r=i[i.length-1].endProgramDateTime;if(e>=(r||0))return null;t=t||0;for(let s=0;s<i.length;++s){const o=i[s];if(one(e,t,o))return o}return null}function im(i,e,t=0,n=0,r=.005){let s=null;if(i){s=e[i.sn-e[0].sn+1]||null;const a=i.endDTS-t;a>0&&a<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&zC(t,n,s)===0||sne(s,i,Math.min(r,n))))return s;const o=TF.search(e,zC.bind(null,t,n));return o&&(o!==i||!s)?o:s}function sne(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return i.start<=n}return!1}function zC(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function one(i,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function ane(i,e){return TF.search(i,t=>t.cc<e?1:t.cc>e?-1:0)}var $i={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Ur={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class lne{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=se.log.bind(se,"[info]:"),this.warn=se.warn.bind(se,"[warning]:"),this.error=se.error.bind(se,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(U.ERROR,this.onError,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(U.ERROR,this.onError,this),e.off(U.ERROR,this.onErrorOut,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===qe.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;const s=this.hls,o=t.context;switch(t.details){case de.FRAG_LOAD_ERROR:case de.FRAG_LOAD_TIMEOUT:case de.KEY_LOAD_ERROR:case de.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case de.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:$i.DoNothing,flags:Ur.None};return}case de.FRAG_GAP:case de.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=$i.SendAlternateToPenaltyBox;return}case de.LEVEL_EMPTY_ERROR:case de.LEVEL_PARSING_ERROR:{var a,l;const u=t.parent===qe.MAIN?t.level:s.loadLevel;t.details===de.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(l=a.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case de.LEVEL_LOAD_ERROR:case de.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case de.AUDIO_TRACK_LOAD_ERROR:case de.AUDIO_TRACK_LOAD_TIMEOUT:case de.SUBTITLE_LOAD_ERROR:case de.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const u=s.levels[s.loadLevel];if(u&&(o.type===mt.AUDIO_TRACK&&u.hasAudioGroup(o.groupId)||o.type===mt.SUBTITLE_TRACK&&u.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=$i.SendAlternateToPenaltyBox,t.errorAction.flags=Ur.MoveAllAlternatesMatchingHost;return}}return;case de.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],c=u==null?void 0:u.attrs["HDCP-LEVEL"];c?t.errorAction={action:$i.SendAlternateToPenaltyBox,flags:Ur.MoveAllAlternatesMatchingHDCP,hdcpLevel:c}:this.keySystemError(t)}return;case de.BUFFER_ADD_CODEC_ERROR:case de.REMUX_ALLOC_ERROR:case de.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case de.INTERNAL_EXCEPTION:case de.BUFFER_APPENDING_ERROR:case de.BUFFER_FULL_ERROR:case de.LEVEL_SWITCH_ERROR:case de.BUFFER_STALLED_ERROR:case de.BUFFER_SEEK_OVER_HOLE:case de.BUFFER_NUDGE_ON_STALL:t.errorAction={action:$i.DoNothing,flags:Ur.None};return}t.type===Ke.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=bF(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(tm(r,s,em(e),e.response))return{action:$i.RetryRequest,flags:Ur.None,retryConfig:r,retryCount:s};const a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=s),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=bF(e.details.startsWith("key")?o:s,e),l=t.levels.reduce((c,h)=>c+h.fragmentError,0);if(r&&(e.details!==de.FRAG_GAP&&r.fragmentError++,tm(a,l,em(e),e.response)))return{action:$i.RetryRequest,flags:Ur.None,retryConfig:a,retryCount:l};const u=this.getLevelSwitchAction(e,n);return a&&(u.retryConfig=a,u.retryCount=l),u}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var s,o;const u=e.details;r.loadError++,u===de.BUFFER_APPEND_ERROR&&r.fragmentError++;let c=-1;const{levels:h,loadLevel:d,minAutoLevel:g,maxAutoLevel:A}=n;n.autoLevelEnabled||(n.loadLevel=-1);const p=(s=e.frag)==null?void 0:s.type,v=(p===qe.AUDIO&&u===de.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===de.BUFFER_ADD_CODEC_ERROR||u===de.BUFFER_APPEND_ERROR))&&h.some(({audioCodec:S})=>r.audioCodec!==S),I=e.sourceBufferName==="video"&&(u===de.BUFFER_ADD_CODEC_ERROR||u===de.BUFFER_APPEND_ERROR)&&h.some(({codecSet:S,audioCodec:x})=>r.codecSet!==S&&r.audioCodec===x),{type:C,groupId:w}=(o=e.context)!=null?o:{};for(let S=h.length;S--;){const x=(S+d)%h.length;if(x!==d&&x>=g&&x<=A&&h[x].loadError===0){var a,l;const T=h[x];if(u===de.FRAG_GAP&&p===qe.MAIN&&e.frag){const Q=h[x].details;if(Q){const M=im(e.frag,Q.fragments,e.frag.start);if(M!=null&&M.gap)continue}}else{if(C===mt.AUDIO_TRACK&&T.hasAudioGroup(w)||C===mt.SUBTITLE_TRACK&&T.hasSubtitleGroup(w))continue;if(p===qe.AUDIO&&(a=r.audioGroups)!=null&&a.some(Q=>T.hasAudioGroup(Q))||p===qe.SUBTITLE&&(l=r.subtitleGroups)!=null&&l.some(Q=>T.hasSubtitleGroup(Q))||v&&r.audioCodec===T.audioCodec||!v&&r.audioCodec!==T.audioCodec||I&&r.codecSet===T.codecSet)continue}c=x;break}}if(c>-1&&n.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:$i.SendAlternateToPenaltyBox,flags:Ur.None,nextAutoLevel:c}}return{action:$i.SendAlternateToPenaltyBox,flags:Ur.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case $i.DoNothing:break;case $i.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==de.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r,hdcpLevel:s,nextAutoLevel:o}=n;switch(r){case Ur.None:this.switchLevel(e,o);break;case Ur.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=QC[QC.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class VC{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=se.log.bind(se,`${t}:`),this.warn=se.warn.bind(se,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t==null?void 0:t.renditionReports;if(r){let s=-1;for(let o=0;o<r.length;o++){const a=r[o];let l;try{l=new self.URL(a.URI,t.url).href}catch(u){se.warn(`Could not construct new URL for Rendition Report: ${u}`),l=a.URI||""}if(l===e){s=o;break}else l===e.substring(0,l.length)&&(s=o)}if(s!==-1){const o=r[s],a=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const c=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&c>t.partTarget&&(l+=1)}const u=n&&yF(n);return new vF(a,l>=0?l:void 0,u)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:r,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;if(r.advancedDateTime=Date.now()-a,r.live||n!=null&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),n&&r.fragments.length>0&&Zie(n,r),!this.canLoad||!r.live)return;let l,u,c;if(r.canBlockReload&&r.endSN&&r.advanced){const y=this.hls.config.lowLatencyMode,v=r.lastPartSn,E=r.endSN,I=r.lastPartIndex,C=I!==-1,w=v===E,S=y?0:I;C?(u=w?E+1:v,c=w?S:I+1):u=E+1;const x=r.age,T=x+r.ageHeader;let Q=Math.min(T-r.partTarget,r.targetduration*1.5);if(Q>0){if(n&&Q>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${Q} with playlist age: ${r.age}`),Q=0;else{const M=Math.floor(Q/r.targetduration);if(u+=M,c!==void 0){const R=Math.round(Q%r.targetduration/r.partTarget);c+=R}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${x.toFixed(2)}s goal: ${Q} skip sn ${M} to part ${c}`)}r.tuneInGoal=Q}if(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,c),y||!w){this.loadPlaylist(l);return}}else(r.canBlockReload||r.canSkipUntil)&&(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,c));const h=this.hls.mainForwardBufferInfo,d=h?h.end-h.len:0,g=(r.edge-d)*1e3,A=tne(r,g);r.updated&&o>this.requestScheduled+A&&(this.requestScheduled=s.loading.start),u!==void 0&&r.canBlockReload?this.requestScheduled=s.loading.first+A-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+A<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=A);let p=this.requestScheduled-o;p=Math.max(0,p),this.log(`reload live playlist ${e} in ${Math.round(p)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),p)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let s=yF(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,s=Jp.No),new vF(n,r,s)}checkRetry(e){const t=e.details,n=em(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=r||{},l=!!r&&!!a&&(s===$i.RetryRequest||!r.resolved&&s===$i.SendAlternateToPenaltyBox);if(l){var u;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const c=HC(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${c}ms`)}e.levelRetry=!0,r.resolved=!0}return l}}class Fc{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class une{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Fc(e),this.fast_=new Fc(t),this.defaultTTFB_=r,this.ttfb_=new Fc(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new Fc(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Fc(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Fc(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,s=n/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const BF={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},RF={};function cne(i,e,t,n,r,s){const o=i.audioCodec?i.audioGroups:null,a=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):a?1/0:2;let c=null;if(o!=null&&o.length)try{o.length===1&&o[0]?c=e.groups[o[0]].channels:c=o.reduce((h,d)=>{if(d){const g=e.groups[d];if(!g)throw new Error(`Audio track group ${d} not found`);Object.keys(g.channels).forEach(A=>{h[A]=(h[A]||0)+g.channels[A]})}return h},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(r,8e6))||!!c&&ke(u)&&Object.keys(c).some(h=>parseInt(h)>u)}function hne(i,e,t){const n=i.videoCodec,r=i.audioCodec;if(!n||!r||!t)return Promise.resolve(BF);const s={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},o=i.videoRange;o!=="SDR"&&(s.transferFunction=o.toLowerCase());const a=n.split(",").map(l=>({type:"media-source",video:Di(Di({},s),{},{contentType:Nf(l,"video")})}));return r&&i.audioGroups&&i.audioGroups.forEach(l=>{var u;l&&((u=e.groups[l])==null||u.tracks.forEach(c=>{if(c.groupId===l){const h=c.channels||"",d=parseFloat(h);ke(d)&&d>2&&a.push.apply(a,r.split(",").map(g=>({type:"media-source",audio:{contentType:Nf(g,"audio"),channels:""+d}})))}}))}),Promise.all(a.map(l=>{const u=dne(l);return RF[u]||(RF[u]=t.decodingInfo(l))})).then(l=>({supported:!l.some(u=>!u.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function dne(i){const{audio:e,video:t}=i,n=t||e;if(n){const r=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${r}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${r}`}return""}function fne(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function gne(i,e){let t=!1,n=[];return i&&(t=i!=="SDR",n=[i]),e&&(n=e.allowedVideoRanges||Xp.slice(0),t=e.preferHDR!==void 0?e.preferHDR:fne(),t?n=n.filter(r=>r!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function Ane(i,e,t,n,r){const s=Object.keys(i),o=n==null?void 0:n.channels,a=n==null?void 0:n.audioCodec,l=o&&parseInt(o)===2;let u=!0,c=!1,h=1/0,d=1/0,g=1/0,A=0,p=[];const{preferHDR:y,allowedVideoRanges:v}=gne(e,r);for(let w=s.length;w--;){const S=i[s[w]];u=S.channels[2]>0,h=Math.min(h,S.minHeight),d=Math.min(d,S.minFramerate),g=Math.min(g,S.minBitrate);const x=v.filter(T=>S.videoRanges[T]>0);x.length>0&&(c=!0,p=x)}h=ke(h)?h:0,d=ke(d)?d:0;const E=Math.max(1080,h),I=Math.max(30,d);return g=ke(g)?g:t,t=Math.max(g,t),c||(e=void 0,p=[]),{codecSet:s.reduce((w,S)=>{const x=i[S];if(S===w)return w;if(x.minBitrate>t)return ao(S,`min bitrate of ${x.minBitrate} > current estimate of ${t}`),w;if(!x.hasDefaultAudio)return ao(S,"no renditions with default or auto-select sound found"),w;if(a&&S.indexOf(a.substring(0,4))%5!==0)return ao(S,`audio codec preference "${a}" not found`),w;if(o&&!l){if(!x.channels[o])return ao(S,`no renditions with ${o} channel sound found (channels options: ${Object.keys(x.channels)})`),w}else if((!a||l)&&u&&x.channels[2]===0)return ao(S,"no renditions with stereo sound found"),w;return x.minHeight>E?(ao(S,`min resolution of ${x.minHeight} > maximum of ${E}`),w):x.minFramerate>I?(ao(S,`min framerate of ${x.minFramerate} > maximum of ${I}`),w):p.some(T=>x.videoRanges[T]>0)?x.maxScore<A?(ao(S,`max score of ${x.maxScore} < selected max of ${A}`),w):w&&(Wp(S)>=Wp(w)||x.fragmentError>i[w].fragmentError)?w:(A=x.maxScore,S):(ao(S,`no variants with VIDEO-RANGE of ${JSON.stringify(p)} found`),w)},void 0),videoRanges:p,preferHDR:y,minFramerate:d,minBitrate:g}}function ao(i,e){se.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function pne(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function mne(i,e,t,n){return i.slice(t,n+1).reduce((r,s)=>{if(!s.codecSet)return r;const o=s.audioGroups;let a=r[s.codecSet];a||(r[s.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,s.bitrate);const l=Math.min(s.height,s.width);return a.minHeight=Math.min(a.minHeight,l),a.minFramerate=Math.min(a.minFramerate,s.frameRate),a.maxScore=Math.max(a.maxScore,s.score),a.fragmentError+=s.fragmentError,a.videoRanges[s.videoRange]=(a.videoRanges[s.videoRange]||0)+1,o&&o.forEach(u=>{if(!u)return;const c=e.groups[u];c&&(a.hasDefaultAudio=a.hasDefaultAudio||e.hasDefaultAudio?c.hasDefault:c.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(c.channels).forEach(h=>{a.channels[h]=(a.channels[h]||0)+c.channels[h]}))}),r},{})}function As(i,e,t){if("attrs"in i){const n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(Oc(i,r,t))return n}return-1}function Oc(i,e,t){const{groupId:n,name:r,lang:s,assocLang:o,characteristics:a,default:l}=i,u=i.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(u===void 0||e.forced===u)&&(a===void 0||yne(a,e.characteristics))&&(t===void 0||t(i,e))}function yne(i,e=""){const t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function Nc(i,e){const{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function vne(i,e,t,n,r){const s=e[n],a=e.reduce((d,g,A)=>{const p=g.uri;return(d[p]||(d[p]=[])).push(A),d},{})[s.uri];a.length>1&&(n=Math.max.apply(Math,a));const l=s.videoRange,u=s.frameRate,c=s.codecSet.substring(0,4),h=LF(e,n,d=>{if(d.videoRange!==l||d.frameRate!==u||d.codecSet.substring(0,4)!==c)return!1;const g=d.audioGroups,A=t.filter(p=>!g||g.indexOf(p.groupId)!==-1);return As(i,A,r)>-1});return h>-1?h:LF(e,n,d=>{const g=d.audioGroups,A=t.filter(p=>!g||g.indexOf(p.groupId)!==-1);return As(i,A,r)>-1})}function LF(i,e,t){for(let n=e;n;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}class Ene{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:r}=this,{autoLevelEnabled:s,media:o}=r;if(!t||!o)return;const a=performance.now(),l=n?n.stats:t.stats,u=n?n.duration:t.duration,c=a-l.loading.start,h=r.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=h){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||o.paused||!o.playbackRate||!o.readyState)return;const d=r.mainForwardBufferInfo;if(d===null)return;const g=this.bwEstimator.getEstimateTTFB(),A=Math.abs(o.playbackRate);if(c<=Math.max(g,1e3*(u/(A*2))))return;const p=d.len/A,y=l.loading.first?l.loading.first-l.loading.start:-1,v=l.loaded&&y>-1,E=this.getBwEstimate(),I=r.levels,C=I[t.level],w=l.total||Math.max(l.loaded,Math.round(u*C.averageBitrate/8));let S=v?c-y:c;S<1&&v&&(S=Math.min(c,l.loaded*8/E));const x=v?l.loaded*1e3/S:0,T=x?(w-l.loaded)/x:w*8/E+g/1e3;if(T<=p)return;const Q=x?x*8:E;let M=Number.POSITIVE_INFINITY,R;for(R=t.level-1;R>h;R--){const q=I[R].maxBitrate;if(M=this.getTimeToLoadFrag(g/1e3,Q,u*q,!I[R].details),M<p)break}if(M>=T||M>u*10)return;r.nextLoadLevel=r.nextAutoLevel=R,v?this.bwEstimator.sample(c-Math.min(g,y),l.loaded):this.bwEstimator.sampleTTFB(c);const z=I[R].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>z&&this.resetEstimator(z),this.clearTimer(),se.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${p.toFixed(3)} s
      Estimated load time for current fragment: ${T.toFixed(3)} s
      Estimated load time for down switch fragment: ${M.toFixed(3)} s
      TTFB estimate: ${y|0} ms
      Current BW estimate: ${ke(E)?E|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${R} @ ${z|0} bps`),r.trigger(U.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(se.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new une(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.FRAG_LOADING,this.onFragLoading,this),e.on(U.FRAG_LOADED,this.onFragLoaded,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this),e.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.FRAG_LOADING,this.onFragLoading,this),e.off(U.FRAG_LOADED,this.onFragLoaded,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this),e.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(U.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case de.BUFFER_ADD_CODEC_ERROR:case de.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case de.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:s}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const o=performance.now(),a=s?s.stats:n.stats,l=o-a.loading.start,u=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&u>-1){const h=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(h,u),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,r){const s=e+n/t,o=r?this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,s=r.end-r.start;ke(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===qe.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+r.loaded,l=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const s={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(U.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==qe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,t,e,0,r,1,1);if(s>-1)return s;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return se.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:s,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let c=s.abrBandWidthFactor,h=s.abrBandWidthUpFactor;if(u){const y=this.findBestLevel(l,o,r,u,0,c,h);if(y>=0)return y}let d=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const y=this.bitrateTestDelay;y&&(d=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-y,se.info(`[abr] bitrate test took ${Math.round(1e3*y)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),c=h=1)}const g=this.findBestLevel(l,o,r,u,d,c,h);if(se.info(`[abr] ${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${g}`),g>-1)return g;const A=n.levels[o],p=n.levels[n.loadLevel];return(A==null?void 0:A.bitrate)<(p==null?void 0:p.bitrate)?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,o,a){var l;const u=r+s,c=this.lastLoadedFragLevel,h=c===-1?this.hls.firstLevel:c,{fragCurrent:d,partCurrent:g}=this,{levels:A,allAudioTracks:p,loadLevel:y,config:v}=this.hls;if(A.length===1)return 0;const E=A[h],I=!!(E!=null&&(l=E.details)!=null&&l.live),C=y===-1||c===-1;let w,S="SDR",x=(E==null?void 0:E.frameRate)||0;const{audioPreference:T,videoPreference:Q}=v,M=this.audioTracksByGroup||(this.audioTracksByGroup=pne(p));if(C){if(this.firstSelection!==-1)return this.firstSelection;const N=this.codecTiers||(this.codecTiers=mne(A,M,t,n)),G=Ane(N,S,e,T,Q),{codecSet:j,videoRanges:V,minFramerate:Z,minBitrate:Y,preferHDR:te}=G;w=j,S=te?V[V.length-1]:V[0],x=Z,e=Math.max(e,Y),se.log(`[abr] picked start tier ${JSON.stringify(G)}`)}else w=E==null?void 0:E.codecSet,S=E==null?void 0:E.videoRange;const R=g?g.duration:d?d.duration:0,z=this.bwEstimator.getEstimateTTFB()/1e3,q=[];for(let N=n;N>=t;N--){var X;const G=A[N],j=N>h;if(!G)continue;if(v.useMediaCapabilities&&!G.supportedResult&&!G.supportedPromise){const ie=navigator.mediaCapabilities;typeof(ie==null?void 0:ie.decodingInfo)=="function"&&cne(G,M,S,x,e,T)?(G.supportedPromise=hne(G,M,ie),G.supportedPromise.then(ne=>{if(!this.hls)return;G.supportedResult=ne;const ue=this.hls.levels,fe=ue.indexOf(G);ne.error?se.warn(`[abr] MediaCapabilities decodingInfo error: "${ne.error}" for level ${fe} ${JSON.stringify(ne)}`):ne.supported||(se.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${fe} ${JSON.stringify(ne)}`),fe>-1&&ue.length>1&&(se.log(`[abr] Removing unsupported level ${fe}`),this.hls.removeLevel(fe)))})):G.supportedResult=BF}if(w&&G.codecSet!==w||S&&G.videoRange!==S||j&&x>G.frameRate||!j&&x>0&&x<G.frameRate||G.supportedResult&&!((X=G.supportedResult.decodingInfoResults)!=null&&X[0].smooth)){q.push(N);continue}const V=G.details,Z=(g?V==null?void 0:V.partTarget:V==null?void 0:V.averagetargetduration)||R;let Y;j?Y=a*e:Y=o*e;const te=R&&r>=R*2&&s===0?A[N].averageBitrate:A[N].maxBitrate,J=this.getTimeToLoadFrag(z,Y,te*Z,V===void 0);if(Y>=te&&(N===c||G.loadError===0&&G.fragmentError===0)&&(J<=z||!ke(J)||I&&!this.bitrateTestDelay||J<u)){const ie=this.forcedAutoLevel;return N!==y&&(ie===-1||ie!==y)&&(q.length&&se.trace(`[abr] Skipped level(s) ${q.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${A[q[0]].codecs}" ${A[q[0]].videoRange}; not compatible with "${E.codecs}" ${S}`),se.info(`[abr] switch candidate:${h}->${N} adjustedbw(${Math.round(Y)})-bitrate=${Math.round(Y-te)} ttfb:${z.toFixed(1)} avgDuration:${Z.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${J.toFixed(1)} firstSelection:${C} codecSet:${w} videoRange:${S} hls.loadLevel:${y}`)),C&&(this.firstSelection=N),N}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,r=Math.min(Math.max(e,n),t);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}}class Ine{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var ki={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class _ne{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(U.BUFFER_APPENDED,this.onBufferAppended,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this),e.on(U.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.BUFFER_APPENDED,this.onBufferAppended,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this),e.off(U.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const s=n[r];if(!s)break;const o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,r=Object.keys(n);for(let s=r.length;s--;){const o=n[r[s]];if((o==null?void 0:o.body.type)===t&&o.buffered){const a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a||s>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}const l=a.range[e];l&&l.time.some(u=>{const c=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return c&&this.removeFragment(a.body),c})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:r}=e;if(!t||n.sn==="initSegment")return;const s=Qc(n),o=this.fragments[s];if(!o||o.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach(l=>{const u=n.elementaryStreams[l];if(!u)return;const c=t[l],h=a||u.partial===!0;o.range[l]=this.getBufferedTimes(n,r,h,c)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),nm(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=Qc(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const s={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,u=e.maxStartPTS||o;for(let c=0;c<r.length;c++){const h=r.start(c)-this.bufferPadding,d=r.end(c)+this.bufferPadding;if(u>=h&&l<=d){s.time.push({startPTS:Math.max(o,r.start(c)),endPTS:Math.min(a,r.end(c))});break}else if(o<d&&a>h){const g=Math.max(o,r.start(c)),A=Math.min(a,r.end(c));A>g&&(s.partial=!0,s.time.push({startPTS:g,endPTS:A}))}else if(a<=h)break}return s}getPartialFragment(e){let t=null,n,r,s,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(u=>{const c=l[u];c&&nm(c)&&(r=c.body.start-a,s=c.body.end+a,e>=r&&e<=s&&(n=Math.min(e-r,s-e),o<=n&&(t=c.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||nm(t))}getState(e){const t=Qc(e),n=this.fragments[t];return n?n.buffered?nm(n)?ki.PARTIAL:ki.OK:ki.APPENDING:ki.NOT_LOADED}isTimeBuffered(e,t,n){let r,s;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:r}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const s=r?null:t,o=Qc(n);this.fragments[o]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:s}=t;if(n.sn==="initSegment")return;const o=n.type;if(r){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(r)}this.timeRanges=s,Object.keys(s).forEach(a=>{const l=s[a];this.detectEvictedFragments(a,l,o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Qc(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==n||r&&!l.gap||l.start<t&&l.end>e&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=Qc(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function nm(i){var e,t,n;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((n=i.range.audiovideo)==null?void 0:n.partial))}function Qc(i){return`${i.type}_${i.level}_${i.sn}`}const Cne={length:0,start:()=>0,end:()=>0};class Ht{static isBuffered(e,t){try{if(e){const n=Ht.getBuffered(e);for(let r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const r=Ht.getBuffered(e),s=[];let o;for(o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(u,c){const h=u.start-c.start;return h||c.end-u.end});let r=[];if(n)for(let u=0;u<e.length;u++){const c=r.length;if(c){const h=r[c-1].end;e[u].start-h<n?e[u].end>h&&(r[c-1].end=e[u].end):r.push(e[u])}else r.push(e[u])}else r=e;let s=0,o,a=t,l=t;for(let u=0;u<r.length;u++){const c=r[u].start,h=r[u].end;if(t+n>=c&&t<h)a=c,l=h,s=l-t;else if(t+n<c){o=c;break}}return{len:s,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return se.log("failed to get media.buffered",t),Cne}}}class qC{constructor(e,t,n,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=rm(),this.buffering={audio:rm(),video:rm(),audiovideo:rm()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=s,this.partial=o}}function rm(){return{start:0,executeStart:0,executeEnd:0,end:0}}function sm(i,e){for(let n=0,r=i.length;n<r;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function wne(i,e,t){return!!(e&&(t.endCC>t.startCC||i&&i.cc<t.startCC))}function xne(i,e){const t=i.fragments,n=e.fragments;if(!n.length||!t.length){se.log("No fragments to align");return}const r=sm(t,n[0].cc);if(!r||r&&!r.startPTS){se.log("No frag in previous level to align on");return}return r}function DF(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function kF(i,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)DF(t[n],i);e.fragmentHint&&DF(e.fragmentHint,i),e.alignedSliding=!0}function bne(i,e,t){e&&(Sne(i,t,e),!t.alignedSliding&&e&&om(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&_F(e,t))}function Sne(i,e,t){if(wne(i,t,e)){const n=xne(t,e);n&&ke(n.start)&&(se.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),kF(n.start,e))}}function om(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,s;const o=Math.min(e.endCC,i.endCC);e.startCC<o&&i.startCC<o&&(r=sm(n,o),s=sm(t,o)),(!r||!s)&&(r=n[Math.floor(n.length/2)],s=sm(t,r.cc)||t[Math.floor(t.length/2)]);const a=r.programDateTime,l=s.programDateTime;if(!a||!l)return;const u=(l-a)/1e3-(s.start-r.start);kF(u,i)}const PF=Math.pow(2,17);class Tne{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new lo({type:Ke.NETWORK_ERROR,details:de.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(g=>g[0]==="GAP")){l(FF(e));return}else e.gap=!1;const u=this.loader=e.loader=s?new s(r):new o(r),c=MF(e),h=SF(r.fragLoadPolicy.default),d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:PF};e.stats=u.stats,u.load(c,d,{onSuccess:(g,A,p,y)=>{this.resetLoader(e,u);let v=g.data;p.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(v.slice(0,16)),v=v.slice(16)),a({frag:e,part:null,payload:v,networkDetails:y})},onError:(g,A,p,y)=>{this.resetLoader(e,u),l(new lo({type:Ke.NETWORK_ERROR,details:de.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Di({url:n,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:p,stats:y}))},onAbort:(g,A,p)=>{this.resetLoader(e,u),l(new lo({type:Ke.NETWORK_ERROR,details:de.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:p,stats:g}))},onTimeout:(g,A,p)=>{this.resetLoader(e,u),l(new lo({type:Ke.NETWORK_ERROR,details:de.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:p,stats:g}))},onProgress:(g,A,p,y)=>{t&&t({frag:e,part:null,payload:p,networkDetails:y})}})})}loadPart(e,t,n){this.abort();const r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(FF(e,t));return}const u=this.loader=e.loader=s?new s(r):new o(r),c=MF(e,t),h=SF(r.fragLoadPolicy.default),d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:PF};t.stats=u.stats,u.load(c,d,{onSuccess:(g,A,p,y)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const v={frag:e,part:t,payload:g.data,networkDetails:y};n(v),a(v)},onError:(g,A,p,y)=>{this.resetLoader(e,u),l(new lo({type:Ke.NETWORK_ERROR,details:de.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Di({url:c.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:p,stats:y}))},onAbort:(g,A,p)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new lo({type:Ke.NETWORK_ERROR,details:de.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:p,stats:g}))},onTimeout:(g,A,p)=>{this.resetLoader(e,u),l(new lo({type:Ke.NETWORK_ERROR,details:de.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:p,stats:g}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,s=r.total;if(n.loaded+=r.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(n.loaded/s),l),h=(l-u)*Math.round(n.loaded/u);n.total=n.loaded+h}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function MF(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(ke(r)&&ke(s)){var o;let a=r,l=s;if(i.sn==="initSegment"&&((o=i.decryptdata)==null?void 0:o.method)==="AES-128"){const u=s-r;u%16&&(l=s+(16-u%16)),r!==0&&(n.resetIV=!0,a=r-16)}n.rangeStart=a,n.rangeEnd=l}return n}function FF(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:Ke.MEDIA_ERROR,details:de.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new lo(n)}class lo extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Bne{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class Rne{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Lne(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?Rl(i,0,e-t):i}class Dne{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],s=n[1],o=n[2],a=n[3],l=this.invSubMix,u=l[0],c=l[1],h=l[2],d=l[3],g=new Uint32Array(256);let A=0,p=0,y=0;for(y=0;y<256;y++)y<128?g[y]=y<<1:g[y]=y<<1^283;for(y=0;y<256;y++){let v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^v&255^99,e[A]=v,t[v]=A;const E=g[A],I=g[E],C=g[I];let w=g[v]*257^v*16843008;r[A]=w<<24|w>>>8,s[A]=w<<16|w>>>16,o[A]=w<<8|w>>>24,a[A]=w,w=C*16843009^I*65537^E*257^A*16843008,u[v]=w<<24|w>>>8,c[v]=w<<16|w>>>16,h[v]=w<<8|w>>>24,d[v]=w,A?(A=E^g[g[g[C^E]]],p^=g[g[p]]):A=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let a,l;const u=this.keySchedule=new Uint32Array(o),c=this.invKeySchedule=new Uint32Array(o),h=this.sBox,d=this.rcon,g=this.invSubMix,A=g[0],p=g[1],y=g[2],v=g[3];let E,I;for(a=0;a<o;a++){if(a<s){E=u[a]=t[a];continue}I=E,a%s===0?(I=I<<8|I>>>24,I=h[I>>>24]<<24|h[I>>>16&255]<<16|h[I>>>8&255]<<8|h[I&255],I^=d[a/s|0]<<24):s>6&&a%s===4&&(I=h[I>>>24]<<24|h[I>>>16&255]<<16|h[I>>>8&255]<<8|h[I&255]),u[a]=E=(u[a-s]^I)>>>0}for(l=0;l<o;l++)a=o-l,l&3?I=u[a]:I=u[a-4],l<4||a<=4?c[l]=I:c[l]=A[h[I>>>24]]^p[h[I>>>16&255]]^y[h[I>>>8&255]]^v[h[I&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],u=a[1],c=a[2],h=a[3],d=this.uint8ArrayToUint32Array_(n);let g=d[0],A=d[1],p=d[2],y=d[3];const v=new Int32Array(e),E=new Int32Array(v.length);let I,C,w,S,x,T,Q,M,R,z,q,X,N,G;const j=this.networkToHostOrderSwap;for(;t<v.length;){for(R=j(v[t]),z=j(v[t+1]),q=j(v[t+2]),X=j(v[t+3]),x=R^s[0],T=X^s[1],Q=q^s[2],M=z^s[3],N=4,G=1;G<r;G++)I=l[x>>>24]^u[T>>16&255]^c[Q>>8&255]^h[M&255]^s[N],C=l[T>>>24]^u[Q>>16&255]^c[M>>8&255]^h[x&255]^s[N+1],w=l[Q>>>24]^u[M>>16&255]^c[x>>8&255]^h[T&255]^s[N+2],S=l[M>>>24]^u[x>>16&255]^c[T>>8&255]^h[Q&255]^s[N+3],x=I,T=C,Q=w,M=S,N=N+4;I=o[x>>>24]<<24^o[T>>16&255]<<16^o[Q>>8&255]<<8^o[M&255]^s[N],C=o[T>>>24]<<24^o[Q>>16&255]<<16^o[M>>8&255]<<8^o[x&255]^s[N+1],w=o[Q>>>24]<<24^o[M>>16&255]<<16^o[x>>8&255]<<8^o[T&255]^s[N+2],S=o[M>>>24]<<24^o[x>>16&255]<<16^o[T>>8&255]<<8^o[Q&255]^s[N+3],E[t]=j(I^g),E[t+1]=j(S^A),E[t+2]=j(w^p),E[t+3]=j(C^y),g=R,A=z,p=q,y=X,t=t+4}return E.buffer}}const kne=16;class $C{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Lne(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:r,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=dr(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new Dne),l.expandKey(t);const u=s;return this.currentResult=l.decrypt(a.buffer,0,n),this.currentIV=Rl(a,-16).buffer,u||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new Rne(this.subtle,t)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Bne(this.subtle,new Uint8Array(n)).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(se.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%kne;return n!==e.length&&(t=Rl(e,0,n),this.remainderData=Rl(e,n)),t}logOnce(e){this.logEnabled&&(se.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Pne={toString:function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},ye={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class jC extends Ine{constructor(e,t,n,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ye.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=se.log.bind(se,`${r}:`),this.warn=se.warn.bind(se,`${r}:`),this.hls=e,this.fragmentLoader=new Tne(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new $C(e.config),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ye.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const s=n[n.length-1];return Ht.isBuffered(this.media,s.start+s.duration/2)}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===ye.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,o=n?n.currentTime:0,a=Ht.bufferInfo(r||n,o,e.maxBufferHole);if(this.log(`media seeking to ${ke(o)?o.toFixed(3):o}, state: ${s}`),this.state===ye.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,u=t.start-l,c=t.start+t.duration+l;if(!a.len||c<a.start||u>a.end){const h=o>c;(o<u||h)&&(h&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=ye.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,r).then(s=>{if(!s)return;const o=this.state;if(this.fragContextChanged(e)){(o===ye.FRAG_LOADING||!this.fragCurrent&&o===ye.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=ye.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(U.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===ye.STOPPED||this.state===ye.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===ki.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===ki.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(U.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{payload:s}=n,o=e.decryptdata;if(s&&s.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(l=>{throw r.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const u=self.performance.now();return r.trigger(U.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:u}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===ye.STOPPED||this.state===ye.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=ye.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,r,s,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===qe.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((r=e.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${a?Pne.toString(Ht.getBuffered(a)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==qe.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(h=>!!c[h])){this.state=ye.IDLE;return}}const u=(l=this.levels)==null?void 0:l[e.level];u!=null&&u.fragmentError&&(this.log(`Resetting level fragment error count of ${u.fragmentError} on frag buffered`),u.fragmentError=0)}this.state=ye.IDLE,a&&(!this.loadedmetadata&&e.type==qe.MAIN&&a.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:s}=e,o=!s||s.length===0||s.some(l=>!l),a=new qC(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=ye.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(c=>{if(!this.fragContextChanged(c.frag))return this.hls.trigger(U.KEY_LOADED,c),this.state===ye.KEY_LOADING&&(this.state=ye.IDLE),c}),this.hls.trigger(U.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const c=o.partList;if(c&&r){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const h=this.getNextPart(c,e,n);if(h>-1){const d=c[h];this.log(`Loading part sn: ${e.sn} p: ${d.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${h}-${c.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=d.start+d.duration,this.state=ye.FRAG_LOADING;let g;return a?g=a.then(A=>!A||this.fragContextChanged(A.frag)?null:this.doFragPartsLoad(e,d,t,r)).catch(A=>this.handleFragLoadError(A)):g=this.doFragPartsLoad(e,d,t,r).catch(A=>this.handleFragLoadError(A)),this.hls.trigger(U.FRAG_LOADING,{frag:e,part:d,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):g}else if(!e.url||this.loadedEndOfParts(c,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),ke(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ye.FRAG_LOADING;const l=this.config.progressive;let u;return l&&a?u=a.then(c=>!c||this.fragContextChanged(c==null?void 0:c.frag)?null:this.fragmentLoader.load(e,r)).catch(c=>this.handleFragLoadError(c)):u=Promise.all([this.fragmentLoader.load(e,l?r:void 0),a]).then(([c])=>(!l&&c&&r&&r(c),c)).catch(c=>this.handleFragLoadError(c)),this.hls.trigger(U.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,n,r){return new Promise((s,o)=>{var a;const l=[],u=(a=n.details)==null?void 0:a.partList,c=h=>{this.fragmentLoader.loadPart(e,h,r).then(d=>{l[h.index]=d;const g=d.part;this.hls.trigger(U.FRAG_LOADED,d);const A=CF(n,e.sn,h.index+1)||wF(u,e.sn,h.index+1);if(A)c(A);else return s({frag:e,part:g,partsLoaded:l})}).catch(o)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===de.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(U.ERROR,t)}else this.hls.trigger(U.ERROR,{type:Ke.OTHER_ERROR,details:de.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ye.PARSING){!this.fragCurrent&&this.state!==ye.STOPPED&&this.state!==ye.ERROR&&(this.state=ye.IDLE);return}const{frag:n,part:r,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:s,part:o}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const a=t[r],l=o>-1?CF(a,s,o):null,u=l?l.fragment:ine(a,s,n);return u?(n&&n!==u&&(u.stats=n.stats),{frag:u,part:l,level:a}):null}bufferFragmentData(e,t,n,r,s){var o;if(!e||this.state!==ye.PARSING)return;const{data1:a,data2:l}=e;let u=a;if(a&&l&&(u=dr(a,l)),!((o=u)!=null&&o.length))return;const c={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:u};if(this.hls.trigger(U.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ht.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=Ht.bufferInfo(t,n,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return ke(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:r}}=this,s=Ht.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&s.nextStart<o.end)return Ht.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,n=e||t.maxBufferLength,r=t.maxMaxBufferLength/2;return r>=n?(t.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(e,t=qe.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,qe.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:s}=this,o=n[0].start;let a;if(t.live){const l=s.initialLiveManifestSize;if(r<l)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===ki.OK||n===ki.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,s){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,s=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const u=e[a];if(o=o&&!u.independent,r>-1&&n<u.start)break;const c=u.loaded;c?r=-1:(s||u.independent||o)&&u.fragment===t&&(r=a),s=c}return r}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=rne(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];n.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=ane(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:u}=r,c=n.partList,h=!!(r.lowLatencyMode&&c!=null&&c.length&&l);h&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let d;if(e<t){const g=e>t-u?0:u;d=im(s,o,e,g)}else d=o[o.length-1];if(d){const g=d.sn-n.startSN,A=this.fragmentTracker.getState(d);if((A===ki.OK||A===ki.PARTIAL&&d.gap)&&(s=d),s&&d.sn===s.sn&&(!h||c[0].fragment.sn>d.sn)&&s&&d.level===s.level){const y=o[g+1];d.sn<a&&this.fragmentTracker.getState(y)!==ki.OK?d=y:d=null}}return d}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,s=n.currentTime,o=e.fragments[0].start,a=e.edge,l=s>=o-t.maxFragLookUpTolerance&&s<=a;if(r!==null&&n.duration>r&&(s<r||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<a-u)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,o=!t,a=e.alignedSliding&&ke(s);if(o||!a&&!s){const{fragPrevious:l}=this;bne(l,n,e);const u=e.fragments[0].start;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${r}`),u}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const r=this.startTimeOffset!==null,s=r?this.startTimeOffset:e.startTimeOffset;s!==null&&ke(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ye.FRAG_LOADING_WAITING_RETRY)&&(this.state=ye.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const c=this.getCurrentContext(t.chunkMeta);c&&(t.frag=c.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var r;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const s=t.details===de.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:l=0,retryConfig:u}=o||{};if(o&&a===$i.RetryRequest&&u){this.resetStartWhenNotLoaded(this.levelLastLoaded);const c=HC(u,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${c}ms`),o.resolved=!0,this.retryDate=self.performance.now()+c,this.state=ye.FRAG_LOADING_WAITING_RETRY}else if(u&&o)if(this.resetFragmentErrors(e),l<u.maxNumRetry)!s&&a!==$i.RemoveAlternatePermanently&&(o.resolved=!0);else{se.warn(`${t.details} reached or exceeded max retry (${l})`);return}else(o==null?void 0:o.action)===$i.SendAlternateToPenaltyBox?this.state=ye.WAITING_LEVEL:this.state=ye.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===ye.PARSING||this.state===ye.PARSED){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),r=n&&n.len>.5;r&&this.reduceMaxBufferLength(n.len);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===qe.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==ye.STOPPED&&(this.state=ye.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=Ht.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===ye.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=ye.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var s;const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const c=e.elementaryStreams[u];if(c){const h=c.endPTS-c.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${h})`),l||!1;const d=r?0:IF(o,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(U.LEVEL_PTS_UPDATED,{details:o,level:n,drift:d,type:u,frag:e,start:c.startPTS,end:c.endPTS}),!0}return l},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=ye.PARSED,this.hls.trigger(U.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class OF{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=Mne(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function Mne(i,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<i.length;r++){const s=i[r];t.set(s,n),n+=s.length}return t}function Fne(){return typeof __HLS_WORKER_BUNDLE__=="function"}function One(){const i=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(i);return{worker:new self.Worker(e),objectURL:e}}function Nne(i){const e=new self.URL(i,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function ps(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class WC{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=dr(this.cachedData,e),this.cachedData=null);let n=Ff(e,0),r=n?n.length:0,s;const o=this._audioTrack,a=this._id3Track,l=n?TC(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&ke(l))&&(this.basePTS=Qne(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Qr.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const c=this.appendFrame(o,e,r);c?(this.frameIndex++,this.lastPTS=c.sample.pts,r+=c.length,s=r):r=u}else aie(e,r)?(n=Ff(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Qr.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,s=r):r++;if(r===u&&s!==u){const c=Rl(e,s);this.cachedData?this.cachedData=dr(this.cachedData,c):this.cachedData=c}}return{audioTrack:o,videoTrack:ps(),id3Track:a,textTrack:ps()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:ps(),id3Track:this._id3Track,textTrack:ps()}}destroy(){}}const Qne=(i,e,t)=>{if(ke(i))return i*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function Une(i,e,t,n){let r,s,o,a;const l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((e[t+2]&192)>>>6)+1;const h=(e[t+2]&60)>>>2;if(h>c.length-1){const d=new Error(`invalid ADTS sampling index:${h}`);i.emit(U.ERROR,U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_PARSING_ERROR,fatal:!0,error:d,reason:d.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,se.log(`manifest codec:${n}, ADTS type:${r}, samplingIndex:${h}`),/firefox/i.test(l)?h>=6?(r=5,a=new Array(4),s=h-3):(r=2,a=new Array(2),s=h):l.indexOf("android")!==-1?(r=2,a=new Array(2),s=h):(r=5,a=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&h>=6?s=h-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(h>=6&&o===1||/vivaldi/i.test(l))||!n&&o===1)&&(r=2,a=new Array(2)),s=h)),a[0]=r<<3,a[0]|=(h&14)>>1,a[1]|=(h&1)<<7,a[1]|=o<<3,r===5&&(a[1]|=(s&14)>>1,a[2]=(s&1)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:c[h],channelCount:o,codec:"mp4a.40."+r,manifestCodec:u}}function NF(i,e){return i[e]===255&&(i[e+1]&246)===240}function QF(i,e){return i[e+1]&1?7:9}function KC(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function Gne(i,e){return e+5<i.length}function am(i,e){return e+1<i.length&&NF(i,e)}function Hne(i,e){return Gne(i,e)&&NF(i,e)&&KC(i,e)<=i.length-e}function zne(i,e){if(am(i,e)){const t=QF(i,e);if(e+t>=i.length)return!1;const n=KC(i,e);if(n<=t)return!1;const r=e+n;return r===i.length||am(i,r)}return!1}function UF(i,e,t,n,r){if(!i.samplerate){const s=Une(e,t,n,r);if(!s)return;i.config=s.config,i.samplerate=s.samplerate,i.channelCount=s.channelCount,i.codec=s.codec,i.manifestCodec=s.manifestCodec,se.log(`parsed codec:${i.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function GF(i){return 1024*9e4/i}function Vne(i,e){const t=QF(i,e);if(e+t<=i.length){const n=KC(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function HF(i,e,t,n,r){const s=GF(i.samplerate),o=n+r*s,a=Vne(e,t);let l;if(a){const{frameLength:h,headerLength:d}=a,g=d+h,A=Math.max(0,t+g-e.length);A?(l=new Uint8Array(g-d),l.set(e.subarray(t+d,e.length),0)):l=e.subarray(t+d,t+g);const p={unit:l,pts:o};return A||i.samples.push(p),{sample:p,length:g,missing:A}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:u,missing:-1}}let lm=null;const qne=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],$ne=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],jne=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Wne=[0,1,1,4];function zF(i,e,t,n,r){if(t+24>e.length)return;const s=VF(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,a=n+r*o,l={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function VF(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const o=i[e+2]>>1&1,a=i[e+3]>>6,l=t===3?3-n:n===3?3:4,u=qne[l*14+r-1]*1e3,h=$ne[(t===3?0:t===2?1:2)*3+s],d=a===3?1:2,g=jne[t][n],A=Wne[n],p=g*8*A,y=Math.floor(g*u/h+o)*A;if(lm===null){const I=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);lm=I?parseInt(I[1]):0}return!!lm&&lm<=87&&n===2&&u>=224e3&&a===0&&(i[e+3]=i[e+3]|128),{sampleRate:h,channelCount:d,frameLength:y,samplesPerFrame:p}}}function YC(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function qF(i,e){return e+1<i.length&&YC(i,e)}function Kne(i,e){return YC(i,e)&&4<=i.length-e}function $F(i,e){if(e+1<i.length&&YC(i,e)){const n=VF(i,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const s=e+r;return s===i.length||qF(i,s)}return!1}class Yne extends WC{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Ff(e,0);let n=(t==null?void 0:t.length)||0;if($F(e,n))return!1;for(let r=e.length;n<r;n++)if(zne(e,n))return se.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return Hne(e,t)}appendFrame(e,t,n){UF(e,this.observer,t,n,e.manifestCodec);const r=HF(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const Zne=/\/emsg[-/]ID3/i;class Xne{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const s=this.videoTrack=ps("video",1),o=this.audioTrack=ps("audio",1),a=this.txtTrack=ps("text",1);if(this.id3Track=ps("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=W3(e);if(l.video){const{id:u,timescale:c,codec:h}=l.video;s.id=u,s.timescale=a.timescale=c,s.codec=h}if(l.audio){const{id:u,timescale:c,codec:h}=l.audio;o.id=u,o.timescale=c,o.codec=h}a.id=V3.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return pie(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=dr(this.remainderData,e));const a=wie(n);this.remainderData=a.remainder,r.samples=a.valid||new Uint8Array}else r.samples=n;const o=this.extractID3Track(r,t);return s.samples=Y3(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=Y3(e,t),{videoTrack:t,audioTrack:ps(),id3Track:r,textTrack:ps()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=et(e.samples,["emsg"]);r&&r.forEach(s=>{const o=Sie(s);if(Zne.test(o.schemeIdUri)){const a=ke(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=o.payload;n.samples.push({data:u,len:u.byteLength,dts:a,pts:a,type:Qr.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const jF=(i,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=i[e];const a=Math.min(n,8),l=8-a;s[0]=4278190080>>>24+l<<l,r[0]=(o[0]&s[0])>>l,t=t?t<<a|r[0]:r[0],e+=1,n-=a}return t};class Jne extends WC{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=WF(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=Ff(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&TC(t)!==void 0&&jF(e,n)<16}}function WF(i,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],l=e[t+4]&63,c=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+c>e.length)return-1;const h=e[t+6]>>5;let d=0;h===2?d+=2:(h&1&&h!==1&&(d+=2),h&4&&(d+=2));const g=(e[t+6]<<8|e[t+7])>>12-d&1,p=[2,1,2,3,3,4,4,5][h]+g,y=e[t+5]>>3,v=e[t+5]&7,E=new Uint8Array([s<<6|y<<1|v>>2,(v&3)<<6|h<<3|g<<2|l>>4,l<<4&224]),I=1536/a*9e4,C=n+r*I,w=e.subarray(t,t+c);return i.config=E,i.channelCount=p,i.samplerate=a,i.samples.push({unit:w,pts:C}),c}class ere{constructor(){this.VideoSample=null}createVideoSample(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const s=n[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&se.log(e.pts+"/"+e.dts+":"+e.debug)}}class KF{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(n,n+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&se.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,r;for(let s=0;s<e;s++)n!==0&&(r=this.readEG(),n=(t+r+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,r=0,s,o,a;const l=this.readUByte.bind(this),u=this.readBits.bind(this),c=this.readUEG.bind(this),h=this.readBoolean.bind(this),d=this.skipBits.bind(this),g=this.skipEG.bind(this),A=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);l();const y=l();if(u(5),d(3),l(),A(),y===100||y===110||y===122||y===244||y===44||y===83||y===86||y===118||y===128){const S=c();if(S===3&&d(1),A(),A(),d(1),h())for(o=S!==3?8:12,a=0;a<o;a++)h()&&(a<6?p(16):p(64))}A();const v=c();if(v===0)c();else if(v===1)for(d(1),g(),g(),s=c(),a=0;a<s;a++)g();A(),d(1);const E=c(),I=c(),C=u(1);C===0&&d(1),d(1),h()&&(e=c(),t=c(),n=c(),r=c());let w=[1,1];if(h()&&h())switch(l()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:{w=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((E+1)*16-e*2-t*2),height:(2-C)*(I+1)*16-(C?2:4)*(n+r),pixelRatio:w}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class tre extends ere{parseAVCPES(e,t,n,r,s){const o=this.parseAVCNALu(e,n.data);let a=this.VideoSample,l,u=!1;n.data=null,a&&o.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),o.forEach(c=>{var h;switch(c.type){case 1:{let p=!1;l=!0;const y=c.data;if(u&&y.length>4){const v=new KF(y).readSliceType();(v===2||v===4||v===7||v===9)&&(p=!0)}if(p){var d;(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.frame=!0,a.key=p;break}case 5:l=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{l=!0,Z3(c.data,1,n.pts,t.samples);break}case 7:{var g,A;l=!0,u=!0;const p=c.data,v=new KF(p).readSPS();if(!e.sps||e.width!==v.width||e.height!==v.height||((g=e.pixelRatio)==null?void 0:g[0])!==v.pixelRatio[0]||((A=e.pixelRatio)==null?void 0:A[1])!==v.pixelRatio[1]){e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.sps=[p],e.duration=s;const E=p.subarray(1,4);let I="avc1.";for(let C=0;C<3;C++){let w=E[C].toString(16);w.length<2&&(w="0"+w),I+=w}e.codec=I}break}case 8:l=!0,e.pps=[c.data];break;case 9:l=!0,e.audFound=!0,a&&this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,a&&(a.debug+="unknown NAL "+c.type+" ");break}a&&l&&a.units.push(c)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let r=e.naluState||0;const s=r,o=[];let a=0,l,u,c,h=-1,d=0;for(r===-1&&(h=0,d=t[0]&31,r=0,a=1);a<n;){if(l=t[a++],!r){r=l?0:1;continue}if(r===1){r=l?0:2;continue}if(!l)r=3;else if(l===1){if(u=a-r-1,h>=0){const g={data:t.subarray(h,u),type:d};o.push(g)}else{const g=this.getLastNalUnit(e.samples);g&&(s&&a<=4-s&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-s)),u>0&&(g.data=dr(g.data,t.subarray(0,u)),g.state=0))}a<n?(c=t[a]&31,h=a,d=c,r=0):r=-1}else r=0}if(h>=0&&r>=0){const g={data:t.subarray(h,n),type:d,state:r};o.push(g)}if(o.length===0){const g=this.getLastNalUnit(e.samples);g&&(g.data=dr(g.data,t))}return e.naluState=r,o}}class ire{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new $C(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)n.set(e.subarray(s,s+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(n.subarray(r,r+16),s);return e}decryptAvcSample(e,t,n,r,s){const o=X3(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(n>=s.length);n++){const o=s[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,r,o),!this.decrypter.isSync()))return}}}}const Pi=188;class Ca{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new tre}static probe(e){const t=Ca.syncOffset(e);return t>0&&se.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Pi*5,t-Pi)+1,r=0;for(;r<n;){let s=!1,o=-1,a=0;for(let l=r;l<t;l+=Pi)if(e[l]===71&&(t-l===Pi||e[l+Pi]===71)){if(a++,o===-1&&(o=l,o!==0&&(n=Math.min(o+Pi*99,e.length-Pi)+1)),s||(s=ZC(e,l)===0),s&&a>1&&(o===0&&a>2||l+Pi>n))return o}else{if(a)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:V3[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Ca.createTrack("video"),this._audioTrack=Ca.createTrack("audio",r),this._id3Track=Ca.createTrack("id3"),this._txtTrack=Ca.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let s;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,u=this._txtTrack;let c=o.pid,h=o.pesData,d=a.pid,g=l.pid,A=a.pesData,p=l.pesData,y=null,v=this.pmtParsed,E=this._pmtId,I=e.length;if(this.remainderData&&(e=dr(this.remainderData,e),I=e.length,this.remainderData=null),I<Pi&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:u};const C=Math.max(0,Ca.syncOffset(e));I-=(I-C)%Pi,I<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,I,e.buffer.byteLength-I));let w=0;for(let x=C;x<I;x+=Pi)if(e[x]===71){const T=!!(e[x+1]&64),Q=ZC(e,x),M=(e[x+3]&48)>>4;let R;if(M>1){if(R=x+5+e[x+4],R===x+Pi)continue}else R=x+4;switch(Q){case c:T&&(h&&(s=Uc(h))&&this.videoParser.parseAVCPES(o,u,s,!1,this._duration),h={data:[],size:0}),h&&(h.data.push(e.subarray(R,x+Pi)),h.size+=x+Pi-R);break;case d:if(T){if(A&&(s=Uc(A)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s);break}A={data:[],size:0}}A&&(A.data.push(e.subarray(R,x+Pi)),A.size+=x+Pi-R);break;case g:T&&(p&&(s=Uc(p))&&this.parseID3PES(l,s),p={data:[],size:0}),p&&(p.data.push(e.subarray(R,x+Pi)),p.size+=x+Pi-R);break;case 0:T&&(R+=e[R]+1),E=this._pmtId=nre(e,R);break;case E:{T&&(R+=e[R]+1);const z=rre(e,R,this.typeSupported,n,this.observer);c=z.videoPid,c>0&&(o.pid=c,o.segmentCodec=z.segmentVideoCodec),d=z.audioPid,d>0&&(a.pid=d,a.segmentCodec=z.segmentAudioCodec),g=z.id3Pid,g>0&&(l.pid=g),y!==null&&!v&&(se.warn(`MPEG-TS PMT found at ${x} after unknown PID '${y}'. Backtracking to sync byte @${C} to parse all TS packets.`),y=null,x=C-188),v=this.pmtParsed=!0;break}case 17:case 8191:break;default:y=Q;break}}else w++;w>0&&um(this.observer,new Error(`Found ${w} TS packet/s that do not start with 0x47`)),o.pesData=h,a.pesData=A,l.pesData=p;const S={audioTrack:a,videoTrack:o,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:s}=e,o=n.pesData,a=t.pesData,l=r.pesData;let u;if(o&&(u=Uc(o))?(this.videoParser.parseAVCPES(n,s,u,!0,this._duration),n.pesData=null):n.pesData=o,a&&(u=Uc(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else a!=null&&a.size&&se.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(u=Uc(l))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=l}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new ire(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const h=r.missing,d=r.sample.unit.byteLength;if(h===-1)s=dr(r.sample.unit,s);else{const g=d-h;r.sample.unit.set(s.subarray(0,h),g),e.samples.push(r.sample),n=r.missing}}let o,a;for(o=n,a=s.length;o<a-1&&!am(s,o);o++);if(o!==n){let h;const d=o<a-1;if(d?h=`AAC PES did not start with ADTS header,offset:${o}`:h="No ADTS header found in AAC PES",um(this.observer,new Error(h),d),!d)return}UF(e,this.observer,s,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(r){const h=GF(e.samplerate);l=r.sample.pts+h}else{se.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;o<a;)if(c=HF(e,s,o,l,u),o+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;o<a-1&&!am(s,o);o++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let s=0,o=0;const a=t.pts;if(a===void 0){se.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<r;)if(qF(n,o)){const l=zF(e,n,o,a,s);if(l)o+=l.length,s++;else break}else o++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){se.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=n.length;let o=0,a=0,l;for(;a<s&&(l=WF(e,n,a,r,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){se.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=fi({},t,{type:this._videoTrack?Qr.emsg:Qr.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function ZC(i,e){return((i[e+1]&31)<<8)+i[e+2]}function nre(i,e){return(i[e+10]&31)<<8|i[e+11]}function rre(i,e,t,n,r){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(i[e+1]&15)<<8|i[e+2],a=e+3+o-4,l=(i[e+10]&15)<<8|i[e+11];for(e+=12+l;e<a;){const u=ZC(i,e),c=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){XC("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=u);break;case 21:s.id3Pid===-1&&(s.id3Pid=u);break;case 219:if(!n){XC("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=u,s.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?se.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="mp3");break;case 193:if(!n){XC("AC-3");break}case 129:t.ac3?s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="ac3"):se.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&c>0){let h=e+5,d=c;for(;d>2;){switch(i[h]){case 106:t.ac3!==!0?se.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=u,s.segmentAudioCodec="ac3");break}const A=i[h+1]+2;h+=A,d-=A}}break;case 194:case 135:return um(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return um(r,new Error("Unsupported HEVC in M2TS found")),s}e+=c+5}return s}function um(i,e,t){se.warn(`parsing error: ${e.message}`),i.emit(U.ERROR,U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function XC(i){se.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function Uc(i){let e=0,t,n,r,s,o;const a=i.data;if(!i||i.size===0)return null;for(;a[0].length<19&&a.length>1;)a[0]=dr(a[0],a[1]),a.splice(1,1);if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>i.size-6)return null;const u=t[7];u&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,u&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-o>60*9e4&&(se.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),r=t[8];let c=r+9;if(i.size<=c)return null;i.size-=c;const h=new Uint8Array(i.size);for(let d=0,g=a.length;d<g;d++){t=a[d];let A=t.byteLength;if(c)if(c>A){c-=A;continue}else t=t.subarray(c),A-=c,c=0;h.set(t,e),e+=A}return n&&(n-=r+3),{data:h,pts:s,dts:o,len:n}}return null}class sre extends WC{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Ff(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&TC(t)!==void 0&&jF(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if($F(e,n))return se.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Kne(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return zF(e,t,n,this.basePTS,this.frameIndex)}}class YF{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const wa=Math.pow(2,32)-1;class le{static init(){le.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in le.types)le.types.hasOwnProperty(e)&&(le.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);le.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);le.STTS=le.STSC=le.STCO=s,le.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),le.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),le.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),le.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);le.FTYP=le.box(le.types.ftyp,o,l,o,a),le.DINF=le.box(le.types.dinf,le.box(le.types.dref,r))}static box(e,...t){let n=8,r=t.length;const s=r;for(;r--;)n+=t[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),r=0,n=8;r<s;r++)o.set(t[r],n),n+=t[r].byteLength;return o}static hdlr(e){return le.box(le.types.hdlr,le.HDLR_TYPES[e])}static mdat(e){return le.box(le.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(wa+1)),r=Math.floor(t%(wa+1));return le.box(le.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return le.box(le.types.mdia,le.mdhd(e.timescale,e.duration),le.hdlr(e.type),le.minf(e))}static mfhd(e){return le.box(le.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?le.box(le.types.minf,le.box(le.types.smhd,le.SMHD),le.DINF,le.stbl(e)):le.box(le.types.minf,le.box(le.types.vmhd,le.VMHD),le.DINF,le.stbl(e))}static moof(e,t,n){return le.box(le.types.moof,le.mfhd(e),le.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=le.trak(e[t]);return le.box.apply(null,[le.types.moov,le.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(le.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=le.trex(e[t]);return le.box.apply(null,[le.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(wa+1)),r=Math.floor(t%(wa+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return le.box(le.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,n[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return le.box(le.types.sdtp,n)}static stbl(e){return le.box(le.types.stbl,le.stsd(e),le.box(le.types.stts,le.STTS),le.box(le.types.stsc,le.STSC),le.box(le.types.stsz,le.STSZ),le.box(le.types.stco,le.STCO))}static avc1(e){let t=[],n=[],r,s,o;for(r=0;r<e.sps.length;r++)s=e.sps[r],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],o=s.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(s));const a=le.box(le.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,u=e.height,c=e.pixelRatio[0],h=e.pixelRatio[1];return le.box(le.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,le.box(le.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),le.box(le.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return le.box(le.types.mp4a,le.audioStsd(e),le.box(le.types.esds,le.esds(e)))}static mp3(e){return le.box(le.types[".mp3"],le.audioStsd(e))}static ac3(e){return le.box(le.types["ac-3"],le.audioStsd(e),le.box(le.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?le.box(le.types.stsd,le.STSD,le.mp3(e)):e.segmentCodec==="ac3"?le.box(le.types.stsd,le.STSD,le.ac3(e)):le.box(le.types.stsd,le.STSD,le.mp4a(e)):le.box(le.types.stsd,le.STSD,le.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,r=e.width,s=e.height,o=Math.floor(n/(wa+1)),a=Math.floor(n%(wa+1));return le.box(le.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=le.sdtp(e),r=e.id,s=Math.floor(t/(wa+1)),o=Math.floor(t%(wa+1));return le.box(le.types.traf,le.box(le.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),le.box(le.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),le.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,le.box(le.types.trak,le.tkhd(e),le.mdia(e))}static trex(e){const t=e.id;return le.box(le.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,s=12+16*r,o=new Uint8Array(s);let a,l,u,c,h,d;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<r;a++)l=n[a],u=l.duration,c=l.size,h=l.flags,d=l.cts,o.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&61440,h.degradPrio&15,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*a);return le.box(le.types.trun,o)}static initSegment(e){le.types||le.init();const t=le.moov(e);return dr(le.FTYP,t)}}le.types=void 0,le.HDLR_TYPES=void 0,le.STTS=void 0,le.STSC=void 0,le.STCO=void 0,le.STSZ=void 0,le.VMHD=void 0,le.SMHD=void 0,le.STSD=void 0,le.FTYP=void 0,le.DINF=void 0;const ZF=9e4;function JC(i,e,t=1,n=!1){const r=i*e*t;return n?Math.round(r):r}function ore(i,e,t=1,n=!1){return JC(i,e,1/t,n)}function Qf(i,e=!1){return JC(i,1e3,1/ZF,e)}function are(i,e=1){return JC(i,ZF,1/e)}const lre=10*1e3,XF=1024,ure=1152,cre=1536;let Gc=null,ew=null;class cm{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Gc===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Gc=o?parseInt(o[1]):0}if(ew===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);ew=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){se.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){se.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){se.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e.reduce((r,s)=>{const o=s.pts-r;return o<-4294967296?(t=!0,fr(r,s.pts)):o>0?r:s.pts},e[0].pts);return t&&se.debug("PTS rollover detected"),n}remux(e,t,n,r,s,o,a,l){let u,c,h,d,g,A,p=s,y=s;const v=e.pid>-1,E=t.pid>-1,I=t.samples.length,C=e.samples.length>0,w=a&&I>0||I>1;if((!v||C)&&(!E||w)||this.ISGenerated||a){if(this.ISGenerated){var x,T,Q,M;const X=this.videoTrackConfig;X&&(t.width!==X.width||t.height!==X.height||((x=t.pixelRatio)==null?void 0:x[0])!==((T=X.pixelRatio)==null?void 0:T[0])||((Q=t.pixelRatio)==null?void 0:Q[1])!==((M=X.pixelRatio)==null?void 0:M[1]))&&this.resetInitSegment()}else h=this.generateIS(e,t,s,o);const R=this.isVideoContiguous;let z=-1,q;if(w&&(z=hre(t.samples),!R&&this.config.forceKeyFrameOnDiscontinuity))if(A=!0,z>0){se.warn(`[mp4-remuxer]: Dropped ${z} out of ${I} video samples due to a missing keyframe`);const X=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(z),t.dropped+=z,y+=(t.samples[0].pts-X)/t.inputTimeScale,q=y}else z===-1&&(se.warn(`[mp4-remuxer]: No keyframe found out of ${I} video samples`),A=!1);if(this.ISGenerated){if(C&&w){const X=this.getVideoStartPts(t.samples),G=(fr(e.samples[0].pts,X)-X)/t.inputTimeScale;p+=Math.max(0,G),y+=Math.max(0,-G)}if(C){if(e.samplerate||(se.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(e,t,s,o)),c=this.remuxAudio(e,p,this.isAudioContiguous,o,E||w||l===qe.AUDIO?y:void 0),w){const X=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(se.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(e,t,s,o)),u=this.remuxVideo(t,y,R,X)}}else w&&(u=this.remuxVideo(t,y,R,0));u&&(u.firstKeyFrame=z,u.independent=z!==-1,u.firstKeyFramePTS=q)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(g=JF(n,s,this._initPTS,this._initDTS)),r.samples.length&&(d=eO(r,s,this._initPTS))),{audio:c,video:u,initSegment:h,independent:A,text:d,id3:g}}generateIS(e,t,n,r){const s=e.samples,o=t.samples,a=this.typeSupported,l={},u=this._initPTS;let c=!u||r,h="audio/mp4",d,g,A;if(c&&(d=g=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(h="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:h,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):le.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(A=e.inputTimeScale,!u||A!==u.timescale?d=g=s[0].pts-Math.round(A*n):c=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:le.initSegment([t]),metadata:{width:t.width,height:t.height}},c)if(A=t.inputTimeScale,!u||A!==u.timescale){const p=this.getVideoStartPts(o),y=Math.round(A*n);g=Math.min(g,fr(o[0].dts,p)-y),d=Math.min(d,p-y)}else c=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:d,timescale:A},this._initDTS={baseTime:g,timescale:A}):d=A=void 0,{tracks:l,initPTS:d,timescale:A}}remuxVideo(e,t,n,r){const s=e.inputTimeScale,o=e.samples,a=[],l=o.length,u=this._initPTS;let c=this.nextAvcDts,h=8,d=this.videoSampleDuration,g,A,p=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,v=!1;if(!n||c===null){const Z=t*s,Y=o[0].pts-fr(o[0].dts,o[0].pts);Gc&&c!==null&&Math.abs(Z-Y-c)<15e3?n=!0:c=Z-Y}const E=u.baseTime*s/u.timescale;for(let Z=0;Z<l;Z++){const Y=o[Z];Y.pts=fr(Y.pts-E,c),Y.dts=fr(Y.dts-E,c),Y.dts<o[Z>0?Z-1:Z].dts&&(v=!0)}v&&o.sort(function(Z,Y){const te=Z.dts-Y.dts,J=Z.pts-Y.pts;return te||J}),g=o[0].dts,A=o[o.length-1].dts;const I=A-g,C=I?Math.round(I/(l-1)):d||e.inputTimeScale/30;if(n){const Z=g-c,Y=Z>C,te=Z<-1;if((Y||te)&&(Y?se.warn(`AVC: ${Qf(Z,!0)} ms (${Z}dts) hole between fragments detected at ${t.toFixed(3)}`):se.warn(`AVC: ${Qf(-Z,!0)} ms (${Z}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!te||c>=o[0].pts||Gc)){g=c;const J=o[0].pts-Z;if(Y)o[0].dts=g,o[0].pts=J;else for(let ce=0;ce<o.length&&!(o[ce].dts>J);ce++)o[ce].dts-=Z,o[ce].pts-=Z;se.log(`Video: Initial PTS/DTS adjusted: ${Qf(J,!0)}/${Qf(g,!0)}, delta: ${Qf(Z,!0)} ms`)}}g=Math.max(0,g);let w=0,S=0,x=g;for(let Z=0;Z<l;Z++){const Y=o[Z],te=Y.units,J=te.length;let ce=0;for(let ie=0;ie<J;ie++)ce+=te[ie].data.length;S+=ce,w+=J,Y.length=ce,Y.dts<x?(Y.dts=x,x+=C/4|0||1):x=Y.dts,p=Math.min(Y.pts,p),y=Math.max(Y.pts,y)}A=o[l-1].dts;const T=S+4*w+8;let Q;try{Q=new Uint8Array(T)}catch(Z){this.observer.emit(U.ERROR,U.ERROR,{type:Ke.MUX_ERROR,details:de.REMUX_ALLOC_ERROR,fatal:!1,error:Z,bytes:T,reason:`fail allocating video mdat ${T}`});return}const M=new DataView(Q.buffer);M.setUint32(0,T),Q.set(le.types.mdat,4);let R=!1,z=Number.POSITIVE_INFINITY,q=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(let Z=0;Z<l;Z++){const Y=o[Z],te=Y.units;let J=0;for(let ne=0,ue=te.length;ne<ue;ne++){const fe=te[ne],me=fe.data,Pe=fe.data.byteLength;M.setUint32(h,Pe),h+=4,Q.set(me,h),h+=Pe,J+=4+Pe}let ce;if(Z<l-1)d=o[Z+1].dts-Y.dts,ce=o[Z+1].pts-Y.pts;else{const ne=this.config,ue=Z>0?Y.dts-o[Z-1].dts:C;if(ce=Z>0?Y.pts-o[Z-1].pts:C,ne.stretchShortVideoTrack&&this.nextAudioPts!==null){const fe=Math.floor(ne.maxBufferHole*s),me=(r?p+r*s:this.nextAudioPts)-Y.pts;me>fe?(d=me-ue,d<0?d=ue:R=!0,se.log(`[mp4-remuxer]: It is approximately ${me/90} ms to the next segment; using duration ${d/90} ms for the last video frame.`)):d=ue}else d=ue}const ie=Math.round(Y.pts-Y.dts);z=Math.min(z,d),X=Math.max(X,d),q=Math.min(q,ce),N=Math.max(N,ce),a.push(new tO(Y.key,d,J,ie))}if(a.length){if(Gc){if(Gc<70){const Z=a[0].flags;Z.dependsOn=2,Z.isNonSync=0}}else if(ew&&N-q<X-z&&C/X<.025&&a[0].cts===0){se.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Z=g;for(let Y=0,te=a.length;Y<te;Y++){const J=Z+a[Y].duration,ce=Z+a[Y].cts;if(Y<te-1){const ie=J+a[Y+1].cts;a[Y].duration=ie-ce}else a[Y].duration=Y?a[Y-1].duration:C;a[Y].cts=0,Z=J}}}d=R||!d?C:d,this.nextAvcDts=c=A+d,this.videoSampleDuration=d,this.isVideoContiguous=!0;const V={data1:le.moof(e.sequenceNumber++,g,fi({},e,{samples:a})),data2:Q,startPTS:p/s,endPTS:(y+d)/s,startDTS:g/s,endDTS:c/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,V}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return ure;case"ac3":return cre;default:return XF}}remuxAudio(e,t,n,r,s){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,u=this.getSamplesPerFrame(e),c=u*l,h=this._initPTS,d=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],A=s!==void 0;let p=e.samples,y=d?0:8,v=this.nextAudioPts||-1;const E=t*o,I=h.baseTime*o/h.timescale;if(this.isAudioContiguous=n=n||p.length&&v>0&&(r&&Math.abs(E-v)<9e3||Math.abs(fr(p[0].pts-I,E)-v)<20*c),p.forEach(function(G){G.pts=fr(G.pts-I,E)}),!n||v<0){if(p=p.filter(G=>G.pts>=0),!p.length)return;s===0?v=0:r&&!A?v=Math.max(0,E):v=p[0].pts}if(e.segmentCodec==="aac"){const G=this.config.maxAudioFramesDrift;for(let j=0,V=v;j<p.length;j++){const Z=p[j],Y=Z.pts,te=Y-V,J=Math.abs(1e3*te/o);if(te<=-G*c&&A)j===0&&(se.warn(`Audio frame @ ${(Y/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*te/o)} ms.`),this.nextAudioPts=v=V=Y);else if(te>=G*c&&J<lre&&A){let ce=Math.round(te/c);V=Y-ce*c,V<0&&(ce--,V+=c),j===0&&(this.nextAudioPts=v=V),se.warn(`[mp4-remuxer]: Injecting ${ce} audio frame @ ${(V/o).toFixed(3)}s due to ${Math.round(1e3*te/o)} ms gap.`);for(let ie=0;ie<ce;ie++){const ne=Math.max(V,0);let ue=YF.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);ue||(se.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),ue=Z.unit.subarray()),p.splice(j,0,{unit:ue,pts:ne}),V+=c,j++}}Z.pts=V,V+=c}}let C=null,w=null,S,x=0,T=p.length;for(;T--;)x+=p[T].unit.byteLength;for(let G=0,j=p.length;G<j;G++){const V=p[G],Z=V.unit;let Y=V.pts;if(w!==null){const J=g[G-1];J.duration=Math.round((Y-w)/l)}else if(n&&e.segmentCodec==="aac"&&(Y=v),C=Y,x>0){x+=y;try{S=new Uint8Array(x)}catch(J){this.observer.emit(U.ERROR,U.ERROR,{type:Ke.MUX_ERROR,details:de.REMUX_ALLOC_ERROR,fatal:!1,error:J,bytes:x,reason:`fail allocating audio mdat ${x}`});return}d||(new DataView(S.buffer).setUint32(0,x),S.set(le.types.mdat,4))}else return;S.set(Z,y);const te=Z.byteLength;y+=te,g.push(new tO(!0,u,te,0)),w=Y}const Q=g.length;if(!Q)return;const M=g[g.length-1];this.nextAudioPts=v=w+l*M.duration;const R=d?new Uint8Array(0):le.moof(e.sequenceNumber++,C/l,fi({},e,{samples:g}));e.samples=[];const z=C/o,q=v/o,N={data1:R,data2:S,startPTS:z,endPTS:q,startDTS:z,endDTS:q,type:"audio",hasAudio:!0,hasVideo:!1,nb:Q};return this.isAudioContiguous=!0,N}remuxEmptyAudio(e,t,n,r){const s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,a=s/o,l=this.nextAudioPts,u=this._initDTS,c=u.baseTime*9e4/u.timescale,h=(l!==null?l:r.startDTS*s)+c,d=r.endDTS*s+c,g=a*XF,A=Math.ceil((d-h)/g),p=YF.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(se.warn("[mp4-remuxer]: remux empty Audio"),!p){se.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const y=[];for(let v=0;v<A;v++){const E=h+v*g;y.push({unit:p,pts:E,dts:E})}return e.samples=y,this.remuxAudio(e,t,n,!1)}}function fr(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function hre(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function JF(i,e,t,n){const r=i.samples.length;if(!r)return;const s=i.inputTimeScale;for(let a=0;a<r;a++){const l=i.samples[a];l.pts=fr(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=fr(l.dts-n.baseTime*s/n.timescale,e*s)/s}const o=i.samples;return i.samples=[],{samples:o}}function eO(i,e,t){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let o=0;o<n;o++){const a=i.samples[o];a.pts=fr(a.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((o,a)=>o.pts-a.pts);const s=i.samples;return i.samples=[],{samples:s}}class tO{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class dre{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(vie(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=W3(e);r.audio&&(t=iO(r.audio,kt.AUDIO)),r.video&&(n=iO(r.video,kt.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:se.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,r,s,o){var a,l;let{initPTS:u,lastEndTime:c}=this;const h={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};ke(c)||(c=this.lastEndTime=s||0);const d=t.samples;if(!(d!=null&&d.length))return h;const g={initPTS:void 0,timescale:1};let A=this.initData;if((a=A)!=null&&a.length||(this.generateInitSegment(d),A=this.initData),!((l=A)!=null&&l.length))return se.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const p=Iie(d,A),y=Eie(A,d),v=y===null?s:y;(fre(u,v,s,p)||g.timescale!==u.timescale&&o)&&(g.initPTS=v-s,u&&u.timescale===1&&se.warn(`Adjusting initPTS by ${g.initPTS-u.baseTime}`),this.initPTS=u={baseTime:g.initPTS,timescale:1});const E=e?v-u.baseTime/u.timescale:c,I=E+p;Cie(A,d,u.baseTime/u.timescale),p>0?this.lastEndTime=I:(se.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const C=!!A.audio,w=!!A.video;let S="";C&&(S+="audio"),w&&(S+="video");const x={data1:d,startPTS:E,startDTS:E,endPTS:I,endDTS:I,type:S,hasAudio:C,hasVideo:w,nb:1,dropped:0};return h.audio=x.type==="audio"?x:void 0,h.video=x.type!=="audio"?x:void 0,h.initSegment=g,h.id3=JF(n,s,u,u),r.samples.length&&(h.text=eO(r,s,u)),h}}function fre(i,e,t,n){if(i===null)return!0;const r=Math.max(n,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>r}function iO(i,e){const t=i==null?void 0:i.codec;if(t&&t.length>4)return t;if(e===kt.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return Kp(t,!1);const n="mp4a.40.5";return se.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return se.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let uo;try{uo=self.performance.now.bind(self.performance)}catch{se.debug("Unable to use Performance API on this environment"),uo=kc==null?void 0:kc.Date.now}const hm=[{demux:Xne,remux:dre},{demux:Ca,remux:cm},{demux:Yne,remux:cm},{demux:sre,remux:cm}];hm.splice(2,0,{demux:Jne,remux:cm});class nO{constructor(e,t,n,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const s=n.transmuxing;s.executeStart=uo();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:c,trackSwitch:h,accurateTimeOffset:d,timeOffset:g,initSegmentChange:A}=r||a,{audioCodec:p,videoCodec:y,defaultInitPts:v,duration:E,initSegmentData:I}=l,C=gre(o,t);if(C&&C.method==="AES-128"){const T=this.getDecrypter();if(T.isSync()){let Q=T.softwareDecrypt(o,C.key.buffer,C.iv.buffer);if(n.part>-1&&(Q=T.flush()),!Q)return s.executeEnd=uo(),tw(n);o=new Uint8Array(Q)}else return this.decryptionPromise=T.webCryptoDecrypt(o,C.key.buffer,C.iv.buffer).then(Q=>{const M=this.push(Q,null,n);return this.decryptionPromise=null,M}),this.decryptionPromise}const w=this.needsProbing(c,h);if(w){const T=this.configureTransmuxer(o);if(T)return se.warn(`[transmuxer] ${T.message}`),this.observer.emit(U.ERROR,U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_PARSING_ERROR,fatal:!1,error:T,reason:T.message}),s.executeEnd=uo(),tw(n)}(c||h||A||w)&&this.resetInitSegment(I,p,y,E,t),(c||A||w)&&this.resetInitialTimestamp(v),u||this.resetContiguity();const S=this.transmux(o,C,g,d,n),x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,s.executeEnd=uo(),S}flush(e){const t=e.transmuxing;t.executeStart=uo();const{decrypter:n,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:a}=r;if(n){const h=n.flush();h&&o.push(this.push(h,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u)return t.executeEnd=uo(),[tw(e)];const c=l.flush(a);return dm(c)?c.then(h=>(this.flushRemux(o,h,e),o)):(this.flushRemux(o,c,e),o)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;se.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(r,s,o,a,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=uo()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,r),a.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,r,s):o=this.transmuxUnencrypted(e,n,r,s),o}transmuxUnencrypted(e,t,n,r){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r,vendor:s}=this;let o;for(let d=0,g=hm.length;d<g;d++){var a;if((a=hm[d].demux)!=null&&a.probe(e)){o=hm[d];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,c=o.remux,h=o.demux;(!u||!(u instanceof c))&&(this.remuxer=new c(n,t,r,s)),(!l||!(l instanceof h))&&(this.demuxer=new h(n,t,r),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new $C(this.config)),e}}function gre(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const tw=i=>({remuxResult:{},chunkMeta:i});function dm(i){return"then"in i&&i.then instanceof Function}class Are{constructor(e,t,n,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=s||null}}class pre{constructor(e,t,n,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}}var rO={exports:{}};(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var g=new r(c,h||l,d),A=t?t+u:u;return l._events[A]?l._events[A].fn?l._events[A]=[l._events[A],g]:l._events[A].push(g):(l._events[A]=g,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)e.call(c,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=t?t+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,g=h.length,A=new Array(g);d<g;d++)A[d]=h[d].fn;return A},a.prototype.listenerCount=function(u){var c=t?t+u:u,h=this._events[c];return h?h.fn?1:h.length:0},a.prototype.emit=function(u,c,h,d,g,A){var p=t?t+u:u;if(!this._events[p])return!1;var y=this._events[p],v=arguments.length,E,I;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,c),!0;case 3:return y.fn.call(y.context,c,h),!0;case 4:return y.fn.call(y.context,c,h,d),!0;case 5:return y.fn.call(y.context,c,h,d,g),!0;case 6:return y.fn.call(y.context,c,h,d,g,A),!0}for(I=1,E=new Array(v-1);I<v;I++)E[I-1]=arguments[I];y.fn.apply(y.context,E)}else{var C=y.length,w;for(I=0;I<C;I++)switch(y[I].once&&this.removeListener(u,y[I].fn,void 0,!0),v){case 1:y[I].fn.call(y[I].context);break;case 2:y[I].fn.call(y[I].context,c);break;case 3:y[I].fn.call(y[I].context,c,h);break;case 4:y[I].fn.call(y[I].context,c,h,d);break;default:if(!E)for(w=1,E=new Array(v-1);w<v;w++)E[w-1]=arguments[w];y[I].fn.apply(y[I].context,E)}}return!0},a.prototype.on=function(u,c,h){return s(this,u,c,h,!1)},a.prototype.once=function(u,c,h){return s(this,u,c,h,!0)},a.prototype.removeListener=function(u,c,h,d){var g=t?t+u:u;if(!this._events[g])return this;if(!c)return o(this,g),this;var A=this._events[g];if(A.fn)A.fn===c&&(!d||A.once)&&(!h||A.context===h)&&o(this,g);else{for(var p=0,y=[],v=A.length;p<v;p++)(A[p].fn!==c||d&&!A[p].once||h&&A[p].context!==h)&&y.push(A[p]);y.length?this._events[g]=y.length===1?y[0]:y:o(this,g)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a})(rO);var mre=rO.exports,iw=Ute(mre);class sO{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const o=(u,c)=>{c=c||{},c.frag=this.frag,c.id=this.id,u===U.ERROR&&(this.error=c.error),this.hls.trigger(u,c)};this.observer=new iw,this.observer.on(U.FRAG_DECRYPTED,o),this.observer.on(U.ERROR,o);const a=Ll(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||Fne())){try{s.workerPath?(se.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=Nne(s.workerPath)):(se.log(`injecting Web Worker for "${t}"`),this.workerContext=One()),this.onwmsg=h=>this.onWorkerMessage(h);const{worker:c}=this.workerContext;c.addEventListener("message",this.onwmsg),c.onerror=h=>{const d=new Error(`${h.message}  (${h.filename}:${h.lineno})`);s.enableWorker=!1,se.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(U.ERROR,{type:Ke.OTHER_ERROR,details:de.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})},c.postMessage({cmd:"init",typeSupported:l,vendor:"",id:t,config:JSON.stringify(s)})}catch(c){se.warn(`Error setting up "${t}" Web Worker, fallback to inline`,c),this.resetWorker(),this.error=null,this.transmuxer=new nO(this.observer,l,s,"",t)}return}this.transmuxer=new nO(this.observer,l,s,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,s,o,a,l,u,c){var h,d;u.transmuxing.start=self.performance.now();const{transmuxer:g}=this,A=o?o.start:s.start,p=s.decryptdata,y=this.frag,v=!(y&&s.cc===y.cc),E=!(y&&u.level===y.level),I=y?u.sn-y.sn:-1,C=this.part?u.part-this.part.index:-1,w=I===0&&u.id>1&&u.id===(y==null?void 0:y.stats.chunkCount),S=!E&&(I===1||I===0&&(C===1||w&&C<=0)),x=self.performance.now();(E||I||s.stats.parsing.start===0)&&(s.stats.parsing.start=x),o&&(C||!S)&&(o.stats.parsing.start=x);const T=!(y&&((h=s.initSegment)==null?void 0:h.url)===((d=y.initSegment)==null?void 0:d.url)),Q=new pre(v,S,l,E,A,T);if(!S||v||T){se.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${v}
        trackSwitch: ${E}
        contiguous: ${S}
        accurateTimeOffset: ${l}
        timeOffset: ${A}
        initSegmentChange: ${T}`);const M=new Are(n,r,t,a,c);this.configureTransmuxer(M)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:u,state:Q},e instanceof ArrayBuffer?[e]:[]);else if(g){const M=g.push(e,p,u,Q);dm(M)?(g.async=!0,M.then(R=>{this.handleTransmuxComplete(R)}).catch(R=>{this.transmuxerError(R,u,"transmuxer-interface push error")})):(g.async=!1,this.handleTransmuxComplete(M))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);dm(n)||t.async?(dm(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){se.warn(`worker message received with no ${t?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(t.event){case"init":{var r;const s=(r=this.workerContext)==null?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":se[t.data.logType]&&se[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function oO(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Hc(i[t].attrs,e[t].attrs))return!1;return!0}function Hc(i,e,t){const n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>i[r]!==e[r])}function nw(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}const aO=100;class yre extends jC{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",qe.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(U.ERROR,this.onError,this),e.on(U.BUFFER_RESET,this.onBufferReset,this),e.on(U.BUFFER_CREATED,this.onBufferCreated,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(U.ERROR,this.onError,this),e.off(U.BUFFER_RESET,this.onBufferReset,this),e.off(U.BUFFER_CREATED,this.onBufferCreated,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){if(n==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${r}`),this.videoTrackCC=o,this.state===ye.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=ye.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(aO),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=ye.IDLE):(this.loadedmetadata=!1,this.state=ye.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case ye.IDLE:this.doTickIdle();break;case ye.WAITING_TRACK:{var e;const{levels:n,trackId:r}=this,s=n==null||(e=n[r])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=ye.WAITING_INIT_PTS}break}case ye.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),r=this.retryDate;if(!r||n>=r||(t=this.media)!=null&&t.seeking){const{levels:s,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[o])||null),this.state=ye.IDLE}break}case ye.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:r,part:s,cache:o,complete:a}=n;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=ye.FRAG_LOADING;const l=o.flush(),u={frag:r,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),a&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),u=Ht.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);zC(u.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=ye.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=ye.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:r}=this,s=e.config;if(!n&&(this.startFragRequested||!s.startFragPrefetch)||!(t!=null&&t[r]))return;const o=t[r],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a)){this.state=ye.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,kt.AUDIO,qe.AUDIO));const u=this.getFwdBufferInfo(l,qe.AUDIO);if(u===null)return;const{bufferedTrack:c,switchingTrack:h}=this;if(!h&&this._streamEnded(u,a)){e.trigger(U.BUFFER_EOS,{type:"audio"}),this.state=ye.ENDED;return}const d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,qe.MAIN),g=u.len,A=this.getMaxBufferLength(d==null?void 0:d.len),p=a.fragments,y=p[0].start;let v=this.flushing?this.getLoadPosition():u.end;if(h&&n){const w=this.getLoadPosition();c&&!Hc(h.attrs,c.attrs)&&(v=w),a.PTSKnown&&w<y&&(u.end>y||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=y+.05)}if(g>=A&&!h&&v<p[p.length-1].start)return;let E=this.getNextFragment(v,a),I=!1;if(E&&this.isLoopLoading(E,v)&&(I=!!E.gap,E=this.getNextFragmentLoopLoading(E,a,u,qe.MAIN,A)),!E){this.bufferFlushed=!0;return}const C=d&&E.start>d.end+a.targetduration;if(C||!(d!=null&&d.len)&&u.len){const w=this.getAppendedFrag(E.start,qe.MAIN);if(w===null||(I||(I=!!w.gap||!!C&&d.len===0),C&&!I||I&&u.nextStart&&u.nextStart<w.end))return}this.loadFragment(E,o,v)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Mc(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(aO):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=ye.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=ye.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(U.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:r}=this,{details:s,id:o}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const a=r[o];let l=0;if(s.live||(n=a.details)!=null&&n.live){this.checkLiveUpdate(s);const c=this.mainDetails;if(s.deltaUpdateFailed||!c)return;if(!a.details&&s.hasProgramDateTime&&c.hasProgramDateTime)om(s,c),l=s.fragments[0].start;else{var u;l=this.alignPlaylists(s,a.details,(u=this.levelLastLoaded)==null?void 0:u.details)}}a.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,l),this.state===ye.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=ye.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[a];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const h=o.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new sO(this.hls,qe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[n.cc],A=(t=n.initSegment)==null?void 0:t.data;if(g!==void 0){const y=r?r.index:-1,v=y!==-1,E=new qC(n.level,n.sn,n.stats.chunkCount,s.byteLength,y,v);d.push(s,A,h,"",n,r,c.totalduration,!1,E,g)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${a}`);const{cache:p}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new OF,complete:!1};p.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=ye.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==qe.AUDIO){if(!this.loadedmetadata&&n.type===qe.MAIN){const s=this.videoBuffer||this.media;s&&Ht.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(U.AUDIO_TRACK_SWITCHED,Di({},s)))}this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=ye.ERROR;return}switch(t.details){case de.FRAG_GAP:case de.FRAG_PARSING_ERROR:case de.FRAG_DECRYPT_ERROR:case de.FRAG_LOAD_ERROR:case de.FRAG_LOAD_TIMEOUT:case de.KEY_LOAD_ERROR:case de.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(qe.AUDIO,t);break;case de.AUDIO_TRACK_LOAD_ERROR:case de.AUDIO_TRACK_LOAD_TIMEOUT:case de.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ye.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===mt.AUDIO_TRACK&&(this.state=ye.IDLE);break;case de.BUFFER_APPEND_ERROR:case de.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===de.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case de.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==kt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==kt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ye.ENDED&&(this.state=ye.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,qe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:u,level:c}=a,{details:h}=c,{audio:d,text:g,id3:A,initSegment:p}=s;if(this.fragContextChanged(l)||!h){this.fragmentTracker.removeFragment(l);return}if(this.state=ye.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),p!=null&&p.tracks){const y=l.initSegment||l;this._bufferInitSegment(c,p.tracks,y,o),r.trigger(U.FRAG_PARSING_INIT_SEGMENT,{frag:y,id:n,tracks:p.tracks})}if(d){const{startPTS:y,endPTS:v,startDTS:E,endDTS:I}=d;u&&(u.elementaryStreams[kt.AUDIO]={startPTS:y,endPTS:v,startDTS:E,endDTS:I}),l.setElementaryStreamInfo(kt.AUDIO,y,v,E,I),this.bufferFragmentData(d,l,u,o)}if(A!=null&&(t=A.samples)!=null&&t.length){const y=fi({id:n,frag:l,details:h},A);r.trigger(U.FRAG_PARSING_METADATA,y)}if(g){const y=fi({id:n,frag:l,details:h},g);r.trigger(U.FRAG_PARSING_USERDATA,y)}}_bufferInitSegment(e,t,n,r){if(this.state!==ye.PARSING)return;t.video&&delete t.video;const s=t.audio;if(!s)return;s.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(U.BUFFER_CODECS,t);const a=s.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:a};this.hls.trigger(U.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===ki.NOT_LOADED||r===ki.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ye.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&om(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:n}=this,r=n==null?void 0:n.attrs,s=e.attrs;t&&r&&(r.CHANNELS!==s.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(U.AUDIO_TRACK_SWITCHED,Di({},e))}}class vre extends VC{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVEL_LOADING,this.onLevelLoading,this),e.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(U.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||(r==null?void 0:r.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(r==null?void 0:r.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(d=>!n||n.indexOf(d.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(d=>d.default)&&(this.selectDefaultTrack=!1),a.forEach((d,g)=>{d.id=g});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!s&&l){const d=As(l,a,Nc);if(d>-1)s=a[d];else{const g=As(l,this.tracks);s=this.tracks[g]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const c={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(U.AUDIO_TRACKS_UPDATED,c);const h=this.trackId;if(u!==-1&&h===-1)this.setAudioTrack(u);else if(a.length&&h===-1){var o;const d=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(d.message),this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:d})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===mt.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&Oc(e,r,Nc))return r;const s=As(e,this.tracksInGroup,Nc);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(r){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=vne(e,t.levels,n,o,Nc);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=As(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===n&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(U.AUDIO_TRACK_SWITCHING,Di({},r)),s))return;const o=this.switchParams(r.url,n==null?void 0:n.details,r.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||Oc(e,r,Nc)))return n}if(e){const{name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l}=e;for(let u=0;u<t.length;u++){const c=t[u];if(Oc({name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l},c,Nc))return u}for(let u=0;u<t.length;u++){const c=t[u];if(Hc(e.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const c=t[u];if(Hc(e.attrs,c.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(U.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}}const lO=500;class Ere extends jC{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",qe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.ERROR,this.onError,this),e.on(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(U.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(U.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.ERROR,this.onError,this),e.off(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(U.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(U.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=ye.IDLE,this.setInterval(lO),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=ye.IDLE,!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=n.start;for(let u=0;u<s.length;u++)if(a>=s[u].start&&a<=s[u].end){o=s[u];break}const l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=s){o.shift();continue}else if(o[a].start<s)o[a].start=s;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,s,qe.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===qe.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===qe.SUBTITLE&&(t.details===de.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ye.STOPPED&&(this.state=ye.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&oO(this.levels,t)){this.levels=t.map(n=>new Mc(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new Mc(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,qe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(lO)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:s}=this,{details:o,id:a}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=s[a];if(a>=s.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(o.live||(n=l.details)!=null&&n.live){const h=this.mainDetails;if(o.deltaUpdateFailed||!h)return;const d=h.fragments[0];if(!l.details)o.hasProgramDateTime&&h.hasProgramDateTime?(om(o,h),u=o.fragments[0].start):d&&(u=d.start,GC(o,u));else{var c;u=this.alignPlaylists(o,l.details,(c=this.levelLastLoaded)==null?void 0:c.details),u===0&&d&&(u=d.start,GC(o,u))}}l.details=o,this.levelLastLoaded=l,a===r&&(!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,u),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===ye.IDLE&&(im(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&r.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(a=>{throw s.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();s.trigger(U.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=ye.IDLE})}}doTick(){if(!this.media){this.state=ye.IDLE;return}if(this.state===ye.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:r}=this,s=this.getLoadPosition(),o=Ht.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:a,len:l}=o,u=this.getFwdBufferInfo(this.media,qe.MAIN),c=n.details,h=this.getMaxBufferLength(u==null?void 0:u.len)+c.levelTargetDuration;if(l>h)return;const d=c.fragments,g=d.length,A=c.edge;let p=null;const y=this.fragPrevious;if(a<A){const v=r.maxFragLookUpTolerance,E=a>A-v?0:v;p=im(y,d,Math.max(d[0].start,a),E),!p&&y&&y.start<d[0].start&&(p=d[0])}else p=d[g-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),p.sn!=="initSegment"){const v=p.sn-c.startSN,E=d[v-1];E&&E.cc===p.cc&&this.fragmentTracker.getState(E)===ki.NOT_LOADED&&(p=E)}this.fragmentTracker.getState(p)===ki.NOT_LOADED&&this.loadFragment(p,n,a)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Ire(this.tracksBuffered[this.currentTrackId]||[])}}class Ire{constructor(e){this.buffered=void 0;const t=(n,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class _re extends VC{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=Yp(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")t=n[s];else if(n[s].mode==="showing"){t=n[s];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVEL_LOADING,this.onLevelLoading,this),e.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(U.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Yp(this.media.textTracks).forEach(t=>{Pc(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||(r==null?void 0:r.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(r==null?void 0:r.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(c=>!n||n.indexOf(c.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(c=>c.default)&&(this.selectDefaultTrack=!1),o.forEach((c,h)=>{c.id=h});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;const c=As(a,o);if(c>-1)s=o[c];else{const h=As(a,this.tracks);s=this.tracks[h]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(U.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const s=t[r];if(!(n&&!s.default||!n&&!e)&&(!e||Oc(s,e)))return r}if(e){for(let r=0;r<t.length;r++){const s=t[r];if(Hc(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const s=t[r];if(Hc(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(nw(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===mt.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Oc(e,n))return n;const r=As(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(n)return null;{const s=As(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(U.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Yp(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(s=>nw(n,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!ke(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(U.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:o,groupId:a="",name:l,type:u,url:c}=r;this.hls.trigger(U.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:u,url:c});const h=this.switchParams(r.url,n==null?void 0:n.details,r.details);this.loadPlaylist(h)}}class Cre{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(s=>{t=s}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(r){se.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${r}`),n.onError(r);const s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const uO=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class wre{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:r}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(U.MEDIA_ATTACHED,{media:n,mediaSource:r})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&se.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=kie(Ll(e.config.preferManagedMediaSource)),this.log=se.log.bind(se,t),this.warn=se.warn.bind(se,t),this.error=se.error.bind(se,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.BUFFER_RESET,this.onBufferReset,this),e.on(U.BUFFER_APPENDING,this.onBufferAppending,this),e.on(U.BUFFER_CODECS,this.onBufferCodecs,this),e.on(U.BUFFER_EOS,this.onBufferEos,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(U.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(U.FRAG_PARSED,this.onFragParsed,this),e.on(U.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.BUFFER_RESET,this.onBufferReset,this),e.off(U.BUFFER_APPENDING,this.onBufferAppending,this),e.off(U.BUFFER_CODECS,this.onBufferCodecs,this),e.off(U.BUFFER_EOS,this.onBufferEos,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(U.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(U.FRAG_PARSED,this.onFragParsed,this),e.off(U.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Cre(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,r=Ll(this.appendSource);if(n&&r){var s;const o=this.mediaSource=new r;this.log(`created media source: ${(s=o.constructor)==null?void 0:s.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming));const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&o instanceof l,cO(n),xre(n,a),n.load()}catch{n.src=a}else n.src=a;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(r){this.warn(`onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&cO(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(U.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(r){this.warn(`onBufferReset ${e}`,r)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,r=Object.keys(t);if(r.forEach(o=>{if(n){const l=this.tracks[o];if(l&&typeof l.buffer.changeType=="function"){var a;const{id:u,codec:c,levelCodec:h,container:d,metadata:g}=t[o],A=rF(l.codec,l.levelCodec),p=A==null?void 0:A.replace(uO,"$1");let y=rF(c,h);const v=(a=y)==null?void 0:a.replace(uO,"$1");if(y&&p!==v){o.slice(0,5)==="audio"&&(y=Kp(y,this.appendSource));const E=`${d};codecs=${y}`;this.appendChangeType(o,E),this.log(`switching codec ${A} to ${y}`),this.tracks[o]={buffer:l.buffer,codec:c,container:d,levelCodec:h,metadata:g,id:u}}}}else this.pendingTracks[o]=t[o]}),n)return;const s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};n.append(r,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:r,tracks:s}=this,{data:o,type:a,frag:l,part:u,chunkMeta:c}=t,h=c.buffering[a],d=self.performance.now();h.start=d;const g=l.stats.buffering,A=u?u.stats.buffering:null;g.start===0&&(g.start=d),A&&A.start===0&&(A.start=d);const p=s.audio;let y=!1;a==="audio"&&(p==null?void 0:p.container)==="audio/mpeg"&&(y=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const v=l.start,E={execute:()=>{if(h.executeStart=self.performance.now(),y){const I=this.sourceBuffer[a];if(I){const C=v-I.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${v} (delta: ${C}) sn: ${l.sn})`),I.timestampOffset=v)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const I=self.performance.now();h.executeEnd=h.end=I,g.first===0&&(g.first=I),A&&A.first===0&&(A.first=I);const{sourceBuffer:C}=this,w={};for(const S in C)w[S]=Ht.getBuffered(C[S]);this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(U.BUFFER_APPENDED,{type:a,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:w})},onError:I=>{const C={type:Ke.MEDIA_ERROR,parent:l.type,details:de.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:u,chunkMeta:c,error:I,err:I,fatal:!1};if(I.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=de.BUFFER_FULL_ERROR;else{const w=++this.appendErrors[a];C.details=de.BUFFER_APPEND_ERROR,this.warn(`Failed ${w}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),w>=n.config.appendErrorMaxRetry&&(C.fatal=!0)}n.trigger(U.ERROR,C)}};r.append(E,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:n}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(U.BUFFER_FLUSHED,{type:s})},onError:o=>{this.warn(`Failed to remove from ${s} SourceBuffer`,o)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(r(s),s)})}onFragParsed(e,t){const{frag:n,part:r}=t,s=[],o=r?r.elementaryStreams:n.elementaryStreams;o[kt.AUDIOVIDEO]?s.push("audiovideo"):(o[kt.AUDIO]&&s.push("audio"),o[kt.VIDEO]&&s.push("video"));const a=()=>{const l=self.performance.now();n.stats.buffering.end=l,r&&(r.stats.buffering.end=l);const u=r?r.stats:n.stats;this.hls.trigger(U.FRAG_BUFFERED,{frag:n,part:r,stats:u,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,s)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${s} sourceBuffer now EOS`))),r&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const s=e.config,o=n.currentTime,a=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(ke(l)&&l>0){const u=Math.max(l,a),c=Math.floor(o/a)*a-u;this.flushBackBuffer(o,a,c)}if(ke(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const u=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),c=Math.max(u,a),h=Math.floor(o/a)*a+c;this.flushFrontBuffer(o,a,h)}}flushBackBuffer(e,t,n){const{details:r,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(a=>{const l=s[a];if(l){const u=Ht.getBuffered(l);if(u.length>0&&n>u.start(0)){if(this.hls.trigger(U.BACK_BUFFER_REACHED,{bufferEnd:n}),r!=null&&r.live)this.hls.trigger(U.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&u.end(u.length-1)-e<t*2){this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(U.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:a})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(o=>{const a=r[o];if(a){const l=Ht.getBuffered(a),u=l.length;if(u<2)return;const c=l.start(u-1),h=l.end(u-1);if(n>c||e>=c&&e<=h)return;if(a.ended&&e-h<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(U.BUFFER_FLUSHING,{startOffset:c,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,o=n.duration,a=ke(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(e)):(s>a&&s>o||!ke(o))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,n[0].start),o=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${s}-${o}.`),t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&(!e||r===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(U.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){var r;const o=e[s];if(!o)throw Error(`source buffer exists for track ${s}, however track does not`);let a=((r=o.levelCodec)==null?void 0:r.indexOf(","))===-1?o.levelCodec:o.codec;a&&s.slice(0,5)==="audio"&&(a=Kp(a,this.appendSource));const l=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${l})`);try{const u=t[s]=n.addSourceBuffer(l),c=s;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(c,"bufferedchange",(h,d)=>{const g=d.removedRanges;g!=null&&g.length&&this.hls.trigger(U.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:u,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(u){this.error(`error while trying to add sourceBuffer: ${u.message}`),this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:s,mimeType:l})}}}get mediaSrc(){var e;const t=((e=this.media)==null?void 0:e.firstChild)||this.media;return t==null?void 0:t.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(r)}removeExecutor(e,t,n){const{media:r,mediaSource:s,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!r||!s||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const u=ke(r.duration)?r.duration:1/0,c=ke(s.duration)?s.duration:1/0,h=Math.max(0,t),d=Math.min(n,u,c);d>h&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${h},${d}] from the ${e} SourceBuffer`),l.remove(h,d)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,r=t.map(s=>n.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];o!=null&&o.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const r=this.sourceBuffer[e];if(!r)return;const s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function cO(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function xre(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}const bre={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},hO=i=>String.fromCharCode(bre[i]||i),Gr=15,co=100,Sre={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Tre={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Bre={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Rre={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Lre=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Dre{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;se.log(`${this.time} [${e}] ${n}`)}}}const Dl=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class dO{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class kre{constructor(){this.uchar=" ",this.penState=new dO}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Pre{constructor(e){this.chars=[],this.pos=0,this.currPenState=new dO,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<co;t++)this.chars.push(new kre);this.logger=e}equals(e){for(let t=0;t<co;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<co;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<co;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>co&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=co)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=hO(e);if(this.pos>=co){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<co;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<co;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class rw{constructor(e){this.rows=[],this.currRow=Gr-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Gr;t++)this.rows.push(new Pre(e));this.logger=e}reset(){for(let e=0;e<Gr;e++)this.rows[e].clear();this.currRow=Gr-1}equals(e){let t=!0;for(let n=0;n<Gr;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Gr;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Gr;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<Gr;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(o.rows[s+u])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let s=0;s<Gr;s++){const o=this.rows[s].getTextString();o&&(r=s+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class fO{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new rw(n),this.nonDisplayedMemory=new rw(n),this.lastOutputScreen=new rw(n),this.currRollUpRow=this.displayedMemory.rows[Gr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Gr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class gO{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Fre(),this.logger=void 0;const r=this.logger=new Dre;this.channels=[null,new fO(e,t,r),new fO(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,s=t[n+1]&127;let o=!1,a=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+Dl([t[n],t[n+1]])+"] -> ("+Dl([r,s])+")");const l=this.cmdHistory;if(r>=16&&r<=31){if(Mre(r,s,l)){fm(null,null,l),this.logger.log(3,()=>"Repeated command ("+Dl([r,s])+") is dropped");continue}fm(r,s,this.cmdHistory),o=this.parseCmd(r,s),o||(o=this.parseMidrow(r,s)),o||(o=this.parsePAC(r,s)),o||(o=this.parseBackgroundAttributes(r,s))}else fm(null,null,l);if(!o&&(a=this.parseChars(r,s),a)){const c=this.currentChannel;c&&c>0?this.channels[c].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Dl([r,s])+" orig: "+Dl([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Dl([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?Sre[e]:Bre[e]:n=o===1?Tre[e]:Rre[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+hO(o)+"' in channel "+n),r=[o]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+Dl(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=Lre[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}fm(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function fm(i,e,t){t.a=i,t.b=e}function Mre(i,e,t){return t.a===i&&t.b===e}function Fre(){return{a:null,b:null}}class gm{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var sw=function(){if(kc!=null&&kc.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const u=l.toLowerCase();return~a.indexOf(u)?u:!1}function n(a){return t(i,a)}function r(a){return t(e,a)}function s(a,...l){let u=1;for(;u<arguments.length;u++){const c=arguments[u];for(const h in c)a[h]=c[h]}return a}function o(a,l,u){const c=this,h={enumerable:!0};c.hasBeenReset=!1;let d="",g=!1,A=a,p=l,y=u,v=null,E="",I=!0,C="auto",w="start",S=50,x="middle",T=50,Q="middle";Object.defineProperty(c,"id",s({},h,{get:function(){return d},set:function(M){d=""+M}})),Object.defineProperty(c,"pauseOnExit",s({},h,{get:function(){return g},set:function(M){g=!!M}})),Object.defineProperty(c,"startTime",s({},h,{get:function(){return A},set:function(M){if(typeof M!="number")throw new TypeError("Start time must be set to a number.");A=M,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},h,{get:function(){return p},set:function(M){if(typeof M!="number")throw new TypeError("End time must be set to a number.");p=M,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},h,{get:function(){return y},set:function(M){y=""+M,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},h,{get:function(){return v},set:function(M){v=M,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},h,{get:function(){return E},set:function(M){const R=n(M);if(R===!1)throw new SyntaxError("An invalid or illegal string was specified.");E=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},h,{get:function(){return I},set:function(M){I=!!M,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},h,{get:function(){return C},set:function(M){if(typeof M!="number"&&M!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=M,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},h,{get:function(){return w},set:function(M){const R=r(M);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");w=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},h,{get:function(){return S},set:function(M){if(M<0||M>100)throw new Error("Position must be between 0 and 100.");S=M,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},h,{get:function(){return x},set:function(M){const R=r(M);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");x=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},h,{get:function(){return T},set:function(M){if(M<0||M>100)throw new Error("Size must be between 0 and 100.");T=M,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},h,{get:function(){return Q},set:function(M){const R=r(M);if(!R)throw new SyntaxError("An invalid or illegal string was specified.");Q=R,this.hasBeenReset=!0}})),c.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class Ore{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function AO(i){function e(n,r,s,o){return(n|0)*3600+(r|0)*60+(s|0)+parseFloat(o||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Nre{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function pO(i,e,t,n){const r=n?i.split(n):[i];for(const s in r){if(typeof r[s]!="string")continue;const o=r[s].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const ow=new sw(0,0,""),Am=ow.align==="middle"?"middle":"center";function Qre(i,e,t){const n=i;function r(){const a=AO(i);if(a===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,l){const u=new Nre;pO(a,function(d,g){let A;switch(d){case"region":for(let p=t.length-1;p>=0;p--)if(t[p].id===g){u.set(d,t[p].region);break}break;case"vertical":u.alt(d,g,["rl","lr"]);break;case"line":A=g.split(","),u.integer(d,A[0]),u.percent(d,A[0])&&u.set("snapToLines",!1),u.alt(d,A[0],["auto"]),A.length===2&&u.alt("lineAlign",A[1],["start",Am,"end"]);break;case"position":A=g.split(","),u.percent(d,A[0]),A.length===2&&u.alt("positionAlign",A[1],["start",Am,"end","line-left","line-right","auto"]);break;case"size":u.percent(d,g);break;case"align":u.alt(d,g,["start",Am,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&ow.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",Am);let h=u.get("position","auto");h==="auto"&&ow.position===50&&(h=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=h}function o(){i=i.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),o(),e.endTime=r(),o(),s(i,e)}function mO(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class Ure{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Ore,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,o=0;for(s=mO(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function r(s){pO(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const a=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new sw(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Qre(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Gre=/\r\n|\n\r|\n|\r/g,aw=function(e,t,n=0){return e.slice(n,n+t.length)===t},Hre=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!ke(t)||!ke(n)||!ke(r)||!ke(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=60*60*1e3*s,t},lw=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function uw(i,e,t){return lw(i.toString())+lw(e.toString())+lw(t)}const zre=function(e,t,n){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=n};function Vre(i,e,t,n,r,s,o){const a=new Ure,l=hs(new Uint8Array(i)).trim().replace(Gre,`
`).split(`
`),u=[],c=e?are(e.baseTime,e.timescale):0;let h="00:00.000",d=0,g=0,A,p=!0;a.oncue=function(y){const v=t[n];let E=t.ccOffset;const I=(d-c)/9e4;if(v!=null&&v.new&&(g!==void 0?E=t.ccOffset=v.start:zre(t,n,I)),I){if(!e){A=new Error("Missing initPTS for VTT MPEGTS");return}E=I-t.presentationOffset}const C=y.endTime-y.startTime,w=fr((y.startTime+E-g)*9e4,r*9e4)/9e4;y.startTime=Math.max(w,0),y.endTime=Math.max(w+C,0);const S=y.text.trim();y.text=decodeURIComponent(encodeURIComponent(S)),y.id||(y.id=uw(y.startTime,y.endTime,S)),y.endTime>0&&u.push(y)},a.onparsingerror=function(y){A=y},a.onflush=function(){if(A){o(A);return}s(u)},l.forEach(y=>{if(p)if(aw(y,"X-TIMESTAMP-MAP=")){p=!1,y.slice(16).split(",").forEach(v=>{aw(v,"LOCAL:")?h=v.slice(6):aw(v,"MPEGTS:")&&(d=parseInt(v.slice(7)))});try{g=Hre(h)/1e3}catch(v){A=v}return}else y===""&&(p=!1);a.parse(y+`
`)}),a.flush()}const cw="stpp.ttml.im1t",yO=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,vO=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,qre={left:"start",center:"center",right:"end",start:"start",end:"end"};function EO(i,e,t,n){const r=et(new Uint8Array(i),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(a=>hs(a)),o=ore(e.baseTime,1,e.timescale);try{s.forEach(a=>t($re(a,o)))}catch(a){n(a)}}function $re(i,e){const r=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((h,d)=>(h[d]=r.getAttribute(`ttp:${d}`)||s[d],h),{}),a=r.getAttribute("xml:space")!=="preserve",l=IO(hw(r,"styling","style")),u=IO(hw(r,"layout","region")),c=hw(r,"body","[begin]");return[].map.call(c,h=>{const d=_O(h,a);if(!d||!h.hasAttribute("begin"))return null;const g=fw(h.getAttribute("begin"),o),A=fw(h.getAttribute("dur"),o);let p=fw(h.getAttribute("end"),o);if(g===null)throw CO(h);if(p===null){if(A===null)throw CO(h);p=g+A}const y=new sw(g-e,p-e,d);y.id=uw(y.startTime,y.endTime,y.text);const v=u[h.getAttribute("region")],E=l[h.getAttribute("style")],I=jre(v,E,l),{textAlign:C}=I;if(C){const w=qre[C];w&&(y.lineAlign=w),y.align=C}return fi(y,I),y}).filter(h=>h!==null)}function hw(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function IO(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function _O(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var s;return n.nodeName==="br"&&r?t+`
`:(s=n.childNodes)!=null&&s.length?_O(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function jre(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),s.reduce((a,l)=>{const u=dw(e,n,l)||dw(i,n,l)||dw(r,n,l);return u&&(a[l]=u),a},{})}function dw(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function CO(i){return new Error(`Could not parse ttml timestamp ${i}`)}function fw(i,e){if(!i)return null;let t=AO(i);return t===null&&(yO.test(i)?t=Wre(i,e):vO.test(i)&&(t=Kre(i,e))),t}function Wre(i,e){const t=yO.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function Kre(i,e){const t=vO.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class Yre{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=bO(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(U.FRAG_LOADING,this.onFragLoading,this),e.on(U.FRAG_LOADED,this.onFragLoaded,this),e.on(U.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(U.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(U.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(U.FRAG_LOADING,this.onFragLoading,this),e.off(U.FRAG_LOADED,this.onFragLoaded,this),e.off(U.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(U.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(U.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(U.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new gm(this,"textTrack1"),t=new gm(this,"textTrack2"),n=new gm(this,"textTrack3"),r=new gm(this,"textTrack4");this.cea608Parser1=new gO(1,e,t),this.cea608Parser2=new gO(3,n,r)}}addCues(e,t,n,r,s){let o=!1;for(let a=s.length;a--;){const l=s[a],u=Zre(l[0],l[1],t,n);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,u/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,n,r)}else{const a=this.Cues.newCue(null,t,n,r);this.hls.trigger(U.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){const{unparsedVttFrags:o}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(U.FRAG_LOADED,a)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const s=n.textTracks[r];if(xO(s,{name:e,lang:t,attrs:{}}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(s,o);if(a)n[e]=a,Pc(n[e]),AF(n[e],r);else{const l=this.createTextTrack("captions",s,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(U.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Pc(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=bO(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Pc(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(s=>s.textCodec===cw);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(oO(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,a=o?Yp(o.textTracks):null;if(this.tracks.forEach((l,u)=>{let c;if(a){let h=null;for(let d=0;d<a.length;d++)if(a[d]&&xO(a[d],l)){h=a[d],a[d]=null;break}h&&(c=h)}if(c)Pc(c);else{const h=wO(l);c=this.createTextTrack(h,l.name,l.lang),c&&(c.mode="disabled")}c&&this.textTracks.push(c)}),a!=null&&a.length){const l=a.filter(u=>u!==null).map(u=>u.label);l.length&&se.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(U.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const s=`textTrack${r[1]}`,o=this.captionsProperties[s];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===qe.MAIN){var n,r;const{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:u}=t.frag,c=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;s&&o&&(u!==a+1||u===a&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===qe.SUBTITLE)if(r.byteLength){const s=n.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){const a=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===cw?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;EO(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{se.log(`Failed to parse IMSC1: ${r}`),n.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[n.cc]&&a===-1){o.push(e);return}const l=this.hls,u=(t=n.initSegment)!=null&&t.data?dr(n.initSegment.data,new Uint8Array(r)):r;Vre(u,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,c=>{this._appendCues(c,n.level),l.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},c=>{const h=c.message==="Missing initPTS for VTT MPEGTS";h?o.push(e):this._fallbackToIMSC1(n,r),se.log(`Failed to parse VTT cue: ${c}`),!(h&&a>n.cc)&&l.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:c})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||EO(t,this.initPTS[e.cc],()=>{n.textCodec=cw,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>pF(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;n.trigger(U.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===qe.SUBTITLE&&this.onFragLoaded(U.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;const{frag:s,samples:o}=t;if(!(s.type===qe.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let a=0;a<o.length;a++){const l=o[a].bytes;if(l){const u=this.extractCea608Data(l);n.addData(o[a].pts,u[0]),r.addData(o[a].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:s}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!s||s==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>FC(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>FC(a[l],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let s=0;s<n;s++){const o=e[r++],a=127&e[r++],l=127&e[r++];if(a===0&&l===0)continue;if((4&o)!==0){const c=3&o;(c===0||c===1)&&(t[c].push(a),t[c].push(l))}}return t}}function wO(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function xO(i,e){return!!i&&i.kind===wO(e)&&nw(e,i)}function Zre(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function bO(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class gw{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(U.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.BUFFER_CODECS,this.onBufferCodecs,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(U.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.BUFFER_CODECS,this.onBufferCodecs,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&ke(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&se.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,gw.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let s=e.length-1;const o=Math.max(t,n);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&r(l,e[a+1])){s=a;break}}return s}}class Xre{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/s,u=this.hls;if(u.trigger(U.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>u.config.fpsDroppedMonitoringThreshold*a){let c=u.currentLevel;se.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(U.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const pm="[eme]";class zc{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=zc.CDMCleanupPromise?[zc.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=se.debug.bind(se,pm),this.log=se.log.bind(se,pm),this.warn=se.warn.bind(se,pm),this.error=se.error.bind(se,pm),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(U.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(U.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(U.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(U.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===Kt.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,a,l)=>!!o&&l.indexOf(o)===a,r=t.map(o=>o.audioCodec).filter(n),s=t.map(o=>o.videoCodec).filter(n);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,a)=>{const l=u=>{const c=u.shift();this.getMediaKeysPromise(c,r,s).then(h=>o({keySystem:c,mediaKeys:h})).catch(h=>{u.length?l(u):h instanceof gr?a(h):a(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return U3===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){const r=sie(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let o=s==null?void 0:s.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),o=this.requestMediaKeySystemAccess(e,r);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),u.then(h=>h?this.setMediaKeysServerCertificate(c,e,h):c))),a.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),a.mediaKeys})}return o.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${ds.hexDump(e.keyId||[])}`);const r=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return ds.hexDump(e.keyId)}updateKeySession(e,t){var n;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${ds.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const r=bC(this.config),s=e.map(O3).filter(o=>!!o&&r.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:o})=>{const a=Q3(o);a?t(a):n(new Error(`Unable to find format for key-system "${o}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(o,a).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:o,mediaKeys:a,decryptdata:t});return this.generateRequestWithPreferredKeySession(l,"cenc",t.pssh,"playlist-key")}))),s.catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof gr?this.hls.trigger(U.ERROR,e.data):this.hls.trigger(U.ERROR,{type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=O3(e.keyFormat),s=r?[r]:bC(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=bC(this.config)),e.length===0)throw new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),n===null)return;let r,s;if(t==="sinf"&&this.config.drmSystems[Kt.FAIRPLAY]){const c=_i(new Uint8Array(n));try{const h=wC(JSON.parse(c).sinf),d=K3(new Uint8Array(h));if(!d)return;r=d.subarray(8,24),s=Kt.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const c=Rie(n);if(c===null)return;c.version===0&&c.systemId===N3.WIDEVINE&&c.data&&(r=c.data.subarray(8,24)),s=rie(c.systemId)}if(!s||!r)return;const o=ds.hexDump(r),{keyIdToKeySessionPromise:a,mediaKeySessions:l}=this;let u=a[o];for(let c=0;c<l.length;c++){const h=l[c],d=h.decryptdata;if(d.pssh||!d.keyId)continue;const g=ds.hexDump(d.keyId);if(o===g||d.uri.replace(/-/g,"").indexOf(o)!==-1){u=a[g],delete a[g],d.pssh=new Uint8Array(n),d.keyId=r,u=a[o]=u.then(()=>this.generateRequestWithPreferredKeySession(h,t,n,"encrypted-event-key-match"));break}}u||(u=a[o]=this.getKeySystemSelectionPromise([s]).then(({keySystem:c,mediaKeys:h})=>{var d;this.throwIfDestroyed();const g=new Of("ISO-23001-7",o,(d=Q3(c))!=null?d:"");return g.pssh=new Uint8Array(n),g.keyId=r,this.attemptSetMediaKeys(c,h).then(()=>{this.throwIfDestroyed();const A=this.createMediaKeySessionContext({decryptdata:g,keySystem:c,mediaKeys:h});return this.generateRequestWithPreferredKeySession(A,t,n,"encrypted-event-no-match")})})),u.catch(c=>this.handleError(c))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var s,o;const a=(s=this.config.drmSystems)==null||(o=s[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const A=a.call(this.hls,t,n,e);if(!A)throw new Error("Invalid response from configured generateRequest filter");t=A.initDataType,n=e.decryptdata.pssh=A.initData?new Uint8Array(A.initData):null}catch(A){var l;if(this.warn(A.message),(l=this.hls)!=null&&l.config.debug)throw A}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${u} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new iw,h=e._onmessage=A=>{const p=e.mediaKeysSession;if(!p){c.emit("error",new Error("invalid state"));return}const{messageType:y,message:v}=A;this.log(`"${y}" message event for session "${p.sessionId}" message size: ${v.byteLength}`),y==="license-request"||y==="license-renewal"?this.renewLicense(e,v).catch(E=>{this.handleError(E),c.emit("error",E)}):y==="license-release"?e.keySystem===Kt.FAIRPLAY&&(this.updateKeySession(e,xC("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${y}"`)},d=e._onkeystatuseschange=A=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const y=e.keyStatus;c.emit("keyStatus",y),y==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",h),e.mediaKeysSession.addEventListener("keystatuseschange",d);const g=new Promise((A,p)=>{c.on("error",p),c.on("keyStatus",y=>{y.startsWith("usable")?A():y==="output-restricted"?p(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):y==="internal-error"?p(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${y}"`)):y==="expired"?p(new Error("key expired while generating request")):this.warn(`unhandled key status change "${y}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var A;this.log(`Request generated for key-session "${(A=e.mediaKeysSession)==null?void 0:A.sessionId}" keyId: ${u}`)}).catch(A=>{throw new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_NO_SESSION,error:A,fatal:!1},`Error generating key-session request: ${A}`)}).then(()=>g).catch(A=>{throw c.removeAllListeners(),this.removeSession(e),A}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${ds.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${ds.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,g,A,p)=>{o(d.data)},onError:(d,g,A,p)=>{a(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:A,response:Di({url:l.url,data:void 0},d)},`"${e}" certificate request failed (${s}). Status: ${d.code} (${d.text})`))},onTimeout:(d,g,A)=>{a(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:A,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(d,g,A)=>{a(new Error("aborted"))}};r.load(l,c,h)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,s)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),r(e)}).catch(o=>{s(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let c;for(let h=0,d=s.length;h<d;h++){var o,a;c=s[h];const g=(o=c.querySelector("name"))==null?void 0:o.textContent,A=(a=c.querySelector("value"))==null?void 0:a.textContent;g&&A&&e.setRequestHeader(g,A)}}const l=r.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return xC(atob(u))}setupLicenseXHR(e,t,n,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,r)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,n,r)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,a,o,e)}catch(c){this.error(c)}r(l)}else{const l=n.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||a.status>=400&&a.status<500)s(new gr({type:Ke.KEY_SYSTEM_ERROR,details:de.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==Kt.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Of.clearKeyUriToKeyIdMap();const n=t.length;zc.CDMCleanupPromise=Promise.all(t.map(r=>this.removeSession(r)).concat(e==null?void 0:e.setMediaKeys(null).catch(r=>{this.log(`Could not clear media keys: ${r}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(r=>{this.log(`Could not close sessions and clear media keys: ${r}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}zc.CDMCleanupPromise=void 0;class gr extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var on;(function(i){i.MANIFEST="m",i.AUDIO="a",i.VIDEO="v",i.MUXED="av",i.INIT="i",i.CAPTION="c",i.TIMED_TEXT="tt",i.KEY="k",i.OTHER="o"})(on||(on={}));var Aw;(function(i){i.DASH="d",i.HLS="h",i.SMOOTH="s",i.OTHER="o"})(Aw||(Aw={}));var kl;(function(i){i.OBJECT="CMCD-Object",i.REQUEST="CMCD-Request",i.SESSION="CMCD-Session",i.STATUS="CMCD-Status"})(kl||(kl={}));const Jre={[kl.OBJECT]:["br","d","ot","tb"],[kl.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[kl.SESSION]:["cid","pr","sf","sid","st","v"],[kl.STATUS]:["bs","rtp"]};class Vc{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof Vc?n:new Vc(n))),this.value=e,this.params=t}}class SO{constructor(e){this.description=void 0,this.description=e}}const ese="Dict";function tse(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function ise(i,e,t,n){return new Error(`failed to ${i} "${tse(e)}" as ${t}`,{cause:n})}const TO="Bare Item",nse="Boolean",rse="Byte Sequence",sse="Decimal",ose="Integer";function ase(i){return i<-999999999999999||999999999999999<i}const lse=/[\x00-\x1f\x7f]+/,use="Token",cse="Key";function ms(i,e,t){return ise("serialize",i,e,t)}function hse(i){if(typeof i!="boolean")throw ms(i,nse);return i?"?1":"?0"}function dse(i){return btoa(String.fromCharCode(...i))}function fse(i){if(ArrayBuffer.isView(i)===!1)throw ms(i,rse);return`:${dse(i)}:`}function BO(i){if(ase(i))throw ms(i,ose);return i.toString()}function gse(i){return`@${BO(i.getTime()/1e3)}`}function RO(i,e){if(i<0)return-RO(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}function Ase(i){const e=RO(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw ms(i,sse);const t=e.toString();return t.includes(".")?t:`${t}.0`}const pse="String";function mse(i){if(lse.test(i))throw ms(i,pse);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function yse(i){return i.description||i.toString().slice(7,-1)}function LO(i){const e=yse(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw ms(e,use);return e}function pw(i){switch(typeof i){case"number":if(!ke(i))throw ms(i,TO);return Number.isInteger(i)?BO(i):Ase(i);case"string":return mse(i);case"symbol":return LO(i);case"boolean":return hse(i);case"object":if(i instanceof Date)return gse(i);if(i instanceof Uint8Array)return fse(i);if(i instanceof SO)return LO(i);default:throw ms(i,TO)}}function mw(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw ms(i,cse);return i}function yw(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${mw(e)}`:`;${mw(e)}=${pw(t)}`).join("")}function DO(i){return i instanceof Vc?`${pw(i.value)}${yw(i.params)}`:pw(i)}function vse(i){return`(${i.value.map(DO).join(" ")})${yw(i.params)}`}function Ese(i,e={whitespace:!0}){if(typeof i!="object")throw ms(i,ese);const t=i instanceof Map?i.entries():Object.entries(i),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof Vc||(s=new Vc(s));let o=mw(r);return s.value===!0?o+=yw(s.params):(o+="=",Array.isArray(s.value)?o+=vse(s):o+=DO(s)),o}).join(`,${n}`)}function Ise(i,e){return Ese(i,e)}const _se=i=>i==="ot"||i==="sf"||i==="st",Cse=i=>typeof i=="number"?ke(i):i!=null&&i!==""&&i!==!1;function wse(i,e){const t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;const r=t.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}function xse(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}const mm=i=>Math.round(i),bse=(i,e)=>(e!=null&&e.baseUrl&&(i=wse(i,e.baseUrl)),encodeURIComponent(i)),ym=i=>mm(i/100)*100,Sse={br:mm,d:mm,bl:ym,dl:ym,mtp:ym,nor:bse,rtp:ym,tb:mm};function Tse(i,e){const t={};if(i==null||typeof i!="object")return t;const n=Object.keys(i).sort(),r=fi({},Sse,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return n.forEach(o=>{if(s!=null&&s(o))return;let a=i[o];const l=r[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||Cse(a)&&(_se(o)&&typeof a=="string"&&(a=new SO(a)),t[o]=a))}),t}function kO(i,e={}){return i?Ise(Tse(i,e),fi({whitespace:!1},e)):""}function Bse(i,e={}){if(!i)return{};const t=Object.entries(i),n=Object.entries(Jre).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),r=t.reduce((s,o)=>{var a,l;const[u,c]=o,h=((a=n.find(d=>d[1].includes(u)))==null?void 0:a[0])||kl.REQUEST;return(l=s[h])!=null||(s[h]={}),s[h][u]=c,s},{});return Object.entries(r).reduce((s,[o,a])=>(s[o]=kO(a,e),s),{})}function Rse(i,e,t){return fi(i,Bse(e,t))}const Lse="CMCD";function Dse(i,e={}){if(!i)return"";const t=kO(i,e);return`${Lse}=${encodeURIComponent(t)}`}const PO=/CMCD=[^&#]+/;function kse(i,e,t){const n=Dse(e,t);if(!n)return i;if(PO.test(i))return i.replace(PO,n);const r=i.includes("?")?"&":"?";return`${i}${r}${n}`}class Pse{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:on.MANIFEST,su:!this.initialized})}catch(s){se.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,o=this.hls.levels[s.level],a=this.getObjectType(s),l={d:s.duration*1e3,ot:a};(a===on.VIDEO||a===on.AUDIO||a==on.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(r,l)}catch(s){se.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||xse(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHED,this.onMediaDetached,this),e.on(U.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHED,this.onMediaDetached,this),e.off(U.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:Aw.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){fi(t,this.createData());const n=t.ot===on.INIT||t.ot===on.VIDEO||t.ot===on.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((s,o)=>(r.includes(o)&&(s[o]=t[o]),s),{})),this.useHeaders?(e.headers||(e.headers={}),Rse(e.headers,t)):e.url=kse(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return on.TIMED_TEXT;if(e.sn==="initSegment")return on.INIT;if(t==="audio")return on.AUDIO;if(t==="main")return this.hls.audioTracks.length?on.VIDEO:on.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===on.AUDIO)n=r.audioTracks;else{const s=r.maxAutoLevel,o=s>-1?s+1:r.levels.length;n=r.levels.slice(0,o)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===on.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Ht.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}}const Mse=3e5;class Fse{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=se.log.bind(se,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===$i.SendAlternateToPenaltyBox&&n.flags===Ur.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this.pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:u}=t.context;a&&r?o=this.getPathwayForGroupId(a,u,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&r&&(s=r.reduce((a,l)=>(a.indexOf(l.pathwayId)===-1&&a.push(l.pathwayId),a),[])),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==o),n.resolved||se.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${r&&r.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(s=>{r-n[s]>Mse&&delete n[s]});for(let s=0;s<e.length;s++){const o=e[s];if(o in n)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,xF(t),this.hls.trigger(U.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[a];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===mt.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===mt.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(t.some(c=>c.pathwayId===o))return;const u=this.getLevelsForPathway(a).map(c=>{const h=new ii(c.attrs);h["PATHWAY-ID"]=o;const d=h.AUDIO&&`${h.AUDIO}_clone_${o}`,g=h.SUBTITLES&&`${h.SUBTITLES}_clone_${o}`;d&&(n[h.AUDIO]=d,h.AUDIO=d),g&&(r[h.SUBTITLES]=g,h.SUBTITLES=g);const A=FO(c.uri,h["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),p=new Mc({attrs:h,audioCodec:c.audioCodec,bitrate:c.bitrate,height:c.height,name:c.name,url:A,videoCodec:c.videoCodec,width:c.width});if(c.audioGroups)for(let y=1;y<c.audioGroups.length;y++)p.addGroupId("audio",`${c.audioGroups[y]}_clone_${o}`);if(c.subtitleGroups)for(let y=1;y<c.subtitleGroups.length;y++)p.addGroupId("text",`${c.subtitleGroups[y]}_clone_${o}`);return p});t.push(...u),MO(this.audioTracks,n,l,o),MO(this.subtitleTracks,r,l,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+c)}const s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(c,h,d,g)=>{this.log(`Loaded steering manifest: "${r}"`);const A=c.data;if(A.VERSION!==1){this.log(`Steering VERSION ${A.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=A.TTL;const{"RELOAD-URI":p,"PATHWAY-CLONES":y,"PATHWAY-PRIORITY":v}=A;if(p)try{this.uri=new self.URL(p,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${p}`);return}this.scheduleRefresh(this.uri||d.url),y&&this.clonePathways(y);const E={steeringManifest:A,url:r.toString()};this.hls.trigger(U.STEERING_MANIFEST_LOADED,E),v&&this.updatePathwayPriority(v)},onError:(c,h,d,g)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${h.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let A=this.timeToLoad*1e3;if(c.code===429){const p=this.loader;if(typeof(p==null?void 0:p.getResponseHeader)=="function"){const y=p.getResponseHeader("Retry-After");y&&(A=parseFloat(y)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,A)},onTimeout:(c,h,d)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function MO(i,e,t,n){i&&Object.keys(e).forEach(r=>{const s=i.filter(o=>o.groupId===r).map(o=>{const a=fi({},o);return a.details=void 0,a.attrs=new ii(a.attrs),a.url=a.attrs.URI=FO(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[r],a.attrs["PATHWAY-ID"]=n,a});i.push(...s)})}function FO(i,e,t,n){const{HOST:r,PARAMS:s,[t]:o}=n;let a;e&&(a=o==null?void 0:o[e],a&&(i=a));const l=new self.URL(i);return r&&!a&&(l.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}const Ose=/^age:\s*[\d.]+\s*$/im;class OO{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Hp,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),s(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(const a in r)e.setRequestHeader(a,r[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&ke(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,a=t.responseType!=="text";if(o>=200&&o<300&&(a&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=a?t.response:t.responseText,u=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=u,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const c=this.callbacks.onProgress;if(c&&c(n,e,l,t),!this.callbacks)return;const h={url:t.responseURL,data:l,code:o};this.callbacks.onSuccess(h,n,e,t)}else{const l=s.loadPolicy.errorRetry,u=n.retry,c={url:e.url,data:void 0,code:o};tm(l,u,!1,c)?this.retry(l):(se.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(tm(e,t,!0))this.retry(e);else{var n;se.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=HC(e,n.retry),n.retry++,se.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Ose.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function Nse(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const Qse=/(\d+)-(\d+)\/(\d+)/;class NO{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||zse,this.controller=new self.AbortController,this.stats=new Hp}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=Use(e,this.controller.signal),o=n.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&ke(u)?u:c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(h=>{this.response=this.loader=h;const d=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},c-(d-r.loading.start)),!h.ok){const{status:g,statusText:A}=h;throw new Vse(A||"fetch, bad network response",g,h)}return r.loading.first=d,r.total=Hse(h.headers)||r.total,o&&ke(t.highWaterMark)?this.loadProgressively(h,r,e,t.highWaterMark,o):a?h.arrayBuffer():e.responseType==="json"?h.json():h.text()}).then(h=>{const d=this.response;if(!d)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const g=h[l];g&&(r.loaded=r.total=g);const A={url:d.url,data:h,code:d.status};o&&!ke(t.highWaterMark)&&o(r,e,h,d),n.onSuccess(A,r,e,d)}).catch(h=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const d=h&&h.code||0,g=h?h.message:null;n.onError({code:d,text:g},e,h?h.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,s){const o=new OF,a=e.body.getReader(),l=()=>a.read().then(u=>{if(u.done)return o.dataLength&&s(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const c=u.value,h=c.length;return t.loaded+=h,h<r||o.dataLength?(o.push(c),o.dataLength>=r&&s(t,n,o.flush(),e)):s(t,n,c,e),l()}).catch(()=>Promise.reject());return l()}}function Use(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(fi({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function Gse(i){const e=Qse.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function Hse(i){const e=i.get("Content-Range");if(e){const n=Gse(e);if(ke(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}function zse(i,e){return new self.Request(i.url,e)}class Vse extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const qse=/\s/,$se={newCue(i,e,t,n){const r=[];let s,o,a,l,u;const c=self.VTTCue||self.TextTrackCue;for(let d=0;d<n.rows.length;d++)if(s=n.rows[d],a=!0,l=0,u="",!s.isEmpty()){var h;for(let p=0;p<s.chars.length;p++)qse.test(s.chars[p].uchar)&&a?l++:(u+=s.chars[p].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const g=mO(u.trim()),A=uw(e,t,g);i!=null&&(h=i.cues)!=null&&h.getCueById(A)||(o=new c(e,t,g),o.id=A,o.line=d+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(o))}return i&&r.length&&(r.sort((d,g)=>d.line==="auto"||g.line==="auto"?0:d.line>8&&g.line>8?g.line-d.line:d.line-g.line),r.forEach(d=>pF(i,d))),r}},jse={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},QO=Di(Di({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:OO,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Ene,bufferController:wre,capLevelController:gw,errorController:lne,fpsController:Xre,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:U3,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:jse},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Wse()),{},{subtitleStreamController:Ere,subtitleTrackController:_re,timelineController:Yre,audioStreamController:yre,audioTrackController:vre,emeController:zc,cmcdController:Pse,contentSteeringController:Fse});function Wse(){return{cueHandler:$se,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Kse(i,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=vw(i),n=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{const o=`${s==="level"?"playlist":s}LoadPolicy`,a=e[o]===void 0,l=[];r.forEach(u=>{const c=`${s}Loading${u}`,h=e[c];if(h!==void 0&&a){l.push(c);const d=t[o].default;switch(e[o]={default:d},u){case"TimeOut":d.maxLoadTimeMs=h,d.maxTimeToFirstByteMs=h;break;case"MaxRetry":d.errorRetry.maxNumRetry=h,d.timeoutRetry.maxNumRetry=h;break;case"RetryDelay":d.errorRetry.retryDelayMs=h,d.timeoutRetry.retryDelayMs=h;break;case"MaxRetryTimeout":d.errorRetry.maxRetryDelayMs=h,d.timeoutRetry.maxRetryDelayMs=h;break}}}),l.length&&se.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),Di(Di({},t),e)}function vw(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(vw):Object.keys(i).reduce((e,t)=>(e[t]=vw(i[t]),e),{}):i}function Yse(i){const e=i.loader;e!==NO&&e!==OO?(se.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):Nse()&&(i.loader=NO,i.progressive=!0,i.enableSoftwareAES=!0,se.log("[config]: Progressive streaming enabled, using FetchLoader"))}let Ew;class Zse extends VC{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this),e.on(U.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this),e.off(U.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],s={},o={};let a=!1,l=!1,u=!1;t.levels.forEach(c=>{var h,d;const g=c.attrs;let{audioCodec:A,videoCodec:p}=c;((h=A)==null?void 0:h.indexOf("mp4a.40.34"))!==-1&&(Ew||(Ew=/chrome|firefox/i.test(navigator.userAgent)),Ew&&(c.audioCodec=A=void 0)),A&&(c.audioCodec=A=Kp(A,n)),((d=p)==null?void 0:d.indexOf("avc1"))===0&&(p=c.videoCodec=Oie(p));const{width:y,height:v,unknownCodecs:E}=c;if(a||(a=!!(y&&v)),l||(l=!!p),u||(u=!!A),E!=null&&E.length||A&&!kC(A,"audio",n)||p&&!kC(p,"video",n))return;const{CODECS:I,"FRAME-RATE":C,"HDCP-LEVEL":w,"PATHWAY-ID":S,RESOLUTION:x,"VIDEO-RANGE":T}=g,M=`${`${S||"."}-`}${c.bitrate}-${x}-${C}-${I}-${T}-${w}`;if(s[M])if(s[M].uri!==c.url&&!c.attrs["PATHWAY-ID"]){const R=o[M]+=1;c.attrs["PATHWAY-ID"]=new Array(R+1).join(".");const z=new Mc(c);s[M]=z,r.push(z)}else s[M].addGroupId("audio",g.AUDIO),s[M].addGroupId("text",g.SUBTITLES);else{const R=new Mc(c);s[M]=R,o[M]=1,r.push(R)}}),this.filterAndSortMediaOptions(r,t,a,l,u)}filterAndSortMediaOptions(e,t,n,r,s){let o=[],a=[],l=e;if((n||r)&&s&&(l=l.filter(({videoCodec:A,videoRange:p,width:y,height:v})=>(!!A||!!(y&&v))&&Yie(p))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const A=new Error("no level with compatible codecs found in manifest");this.hls.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:A,reason:A.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:A}=this.hls.config;o=t.audioTracks.filter(p=>!p.audioCodec||kC(p.audioCodec,"audio",A)),UO(o)}t.subtitles&&(a=t.subtitles,UO(a));const u=l.slice(0);l.sort((A,p)=>{if(A.attrs["HDCP-LEVEL"]!==p.attrs["HDCP-LEVEL"])return(A.attrs["HDCP-LEVEL"]||"")>(p.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&A.height!==p.height)return A.height-p.height;if(A.frameRate!==p.frameRate)return A.frameRate-p.frameRate;if(A.videoRange!==p.videoRange)return Xp.indexOf(A.videoRange)-Xp.indexOf(p.videoRange);if(A.videoCodec!==p.videoCodec){const y=nF(A.videoCodec),v=nF(p.videoCodec);if(y!==v)return v-y}if(A.uri===p.uri&&A.codecSet!==p.codecSet){const y=Wp(A.codecSet),v=Wp(p.codecSet);if(y!==v)return v-y}return A.averageBitrate!==p.averageBitrate?A.averageBitrate-p.averageBitrate:0});let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let A=0;A<u.length;A++)if(u[A].pathwayId===l[0].pathwayId){c=u[A];break}}this._levels=l;for(let A=0;A<l.length;A++)if(l[A]===c){var h;this._firstLevel=A;const p=c.bitrate,y=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${p}`),((h=this.hls.userConfig)==null?void 0:h.abrEwmaDefaultEstimate)===void 0){const v=Math.min(p,this.hls.config.abrEwmaDefaultEstimateMax);v>y&&y===QO.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=v)}break}const d=s&&!r,g={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:!d&&o.some(A=>!!A.url)};this.hls.trigger(U.MANIFEST_PARSED,g),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const c=new Error("invalid level idx"),h=e<0;if(this.hls.trigger(U.ERROR,{type:Ke.OTHER_ERROR,details:de.LEVEL_SWITCH_ERROR,level:e,fatal:h,error:c,reason:c.message}),h)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&r&&s===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${s?" with Pathway "+s:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(U.LEVEL_SWITCHING,l);const u=o.details;if(!u||u.live){const c=this.switchParams(o.uri,r==null?void 0:r.details,u);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===mt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===qe.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:s}=t,o=this._levels[r];if(!o){var a;this.warn(`Invalid level index ${r}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let r=n.uri;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${r}`),this.clearTimer(),this.hls.trigger(U.LEVEL_LOADING,{url:r,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((r,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(o=>o.level=-1)),!1));xF(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(U.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(U.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function UO(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class Xse{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=de.KEY_LOAD_ERROR,n,r,s){return new lo({type:Ke.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:r}=e;for(let s=0;s<t.length;s++){const o=t[s];if(r<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,de.KEY_LOAD_ERROR,u))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,de.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return s.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((r=a)!=null&&r.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,de.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(n);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,s=new r(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,g,A,p)=>{const{frag:y,keyInfo:v,url:E}=A;if(!y.decryptdata||v!==this.keyUriToKeyInfo[E])return a(this.createKeyLoadError(y,de.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),p));v.decryptdata.key=y.decryptdata.key=new Uint8Array(d.data),y.keyLoader=null,v.loader=null,o({frag:y,keyInfo:v})},onError:(d,g,A,p)=>{this.resetLoader(g),a(this.createKeyLoadError(t,de.KEY_LOAD_ERROR,new Error(`HTTP Error ${d.code} loading key ${d.text}`),A,Di({url:l.url,data:void 0},d)))},onTimeout:(d,g,A)=>{this.resetLoader(g),a(this.createKeyLoadError(t,de.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),A))},onAbort:(d,g,A)=>{this.resetLoader(g),a(this.createKeyLoadError(t,de.INTERNAL_ABORTED,new Error("key loading aborted"),A))}};s.load(l,c,h)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}function GO(){return self.SourceBuffer||self.WebKitSourceBuffer}function HO(){if(!Ll())return!1;const e=GO();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function Jse(){if(!HO())return!1;const i=Ll();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(Nf(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(Nf(e,"audio"))))}function eoe(){var i;const e=GO();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const toe=250,vm=2,ioe=.1,noe=.05;class roe{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:r,stalled:s}=this;if(r===null)return;const{currentTime:o,seeking:a}=r,l=this.seeking&&!a,u=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),s!==null){if(this.stallReported){const y=self.performance.now()-s;se.warn(`playback not stuck anymore @${o}, after ${Math.round(y)}ms`),this.stallReported=!1}this.stalled=null}return}if(u||l){this.stalled=null;return}if(r.paused&&!a||r.ended||r.playbackRate===0||!Ht.getBuffered(r).length){this.nudgeRetry=0;return}const c=Ht.bufferInfo(r,o,0),h=c.nextStart||0;if(a){const y=c.len>vm,v=!h||t&&t.start<=o||h-o>vm&&!this.fragmentTracker.getPartialFragment(o);if(y||v)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var d;if(!(c.len>0)&&!h)return;const v=Math.max(h,c.start||0)-o,E=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,C=(E==null||(d=E.details)==null?void 0:d.live)?E.details.targetduration*2:vm,w=this.fragmentTracker.getPartialFragment(o);if(v>0&&(v<=C||w)){r.paused||this._trySkipBufferHole(w);return}}const g=self.performance.now();if(s===null){this.stalled=g;return}const A=g-s;if(!a&&A>=toe&&(this._reportStall(c),!this.media))return;const p=Ht.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(p,A)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:r,media:s}=this;if(s===null)return;const o=s.currentTime,a=r.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(se.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);se.warn(s.message),t.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:r}=this;if(r===null)return 0;const s=r.currentTime,o=Ht.bufferInfo(r,s,0),a=s<o.start?o.start:o.nextStart;if(a){const l=o.len<=t.maxBufferHole,u=o.len>0&&o.len<1&&r.readyState<3,c=a-s;if(c>0&&(l||u)){if(c>t.maxBufferHole){const{fragmentTracker:d}=this;let g=!1;if(s===0){const A=d.getAppendedFrag(0,qe.MAIN);A&&a<A.end&&(g=!0)}if(!g){const A=e||d.getAppendedFrag(s,qe.MAIN);if(A){let p=!1,y=A.end;for(;y<a;){const v=d.getPartialFragment(y);if(v)y+=v.duration;else{p=!0;break}}if(p)return 0}}}const h=Math.max(a+noe,s+ioe);if(se.warn(`skipping hole, adjusting currentTime from ${s} to ${h}`),this.moved=!0,this.stalled=null,r.currentTime=h,e&&!e.gap){const d=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${h}`);n.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:e})}return h}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:r}=this;if(n===null)return;const s=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=s+(r+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${s} to ${o}`);se.warn(a.message),n.currentTime=o,t.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);se.error(o.message),t.trigger(U.ERROR,{type:Ke.MEDIA_ERROR,details:de.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const soe=100;class ooe extends jC{constructor(e,t,n){super(e,t,n,"[stream-controller]",qe.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(U.MANIFEST_LOADING,this.onManifestLoading,this),e.on(U.MANIFEST_PARSED,this.onManifestParsed,this),e.on(U.LEVEL_LOADING,this.onLevelLoading,this),e.on(U.LEVEL_LOADED,this.onLevelLoaded,this),e.on(U.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(U.ERROR,this.onError,this),e.on(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(U.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(U.BUFFER_CREATED,this.onBufferCreated,this),e.on(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(U.MANIFEST_LOADING,this.onManifestLoading,this),e.off(U.MANIFEST_PARSED,this.onManifestParsed,this),e.off(U.LEVEL_LOADED,this.onLevelLoaded,this),e.off(U.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(U.ERROR,this.onError,this),e.off(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(U.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(U.BUFFER_CREATED,this.onBufferCreated,this),e.off(U.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(soe),this.level=-1,!this.startFragRequested){let r=n.startLevel;r===-1&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.firstAutoLevel),n.nextLoadLevel=r,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=ye.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=ye.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ye.WAITING_LEVEL:{const{levels:t,level:n}=this,r=t==null?void 0:t[n],s=r==null?void 0:r.details;if(s&&(!s.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(s))break;this.state=ye.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ye.IDLE;break}break}case ye.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:r,level:s}=this,o=r==null?void 0:r[s];this.resetStartWhenNotLoaded(o||null),this.state=ye.IDLE}}break}this.state===ye.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=e.nextLoadLevel;if(!(n!=null&&n[s]))return;const o=n[s],a=this.getMainFwdBufferInfo();if(a===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const p={};this.altAudio&&(p.type="video"),this.hls.trigger(U.BUFFER_EOS,p),this.state=ye.ENDED;return}e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=o.details;if(!u||this.state===ye.WAITING_LEVEL||u.live&&this.levelLastLoaded!==o){this.level=s,this.state=ye.WAITING_LEVEL;return}const c=a.len,h=this.getMaxBufferLength(o.maxBitrate);if(c>=h)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:a.end;let g=this.getNextFragment(d,u);if(this.couldBacktrack&&!this.fragPrevious&&g&&g.sn!=="initSegment"&&this.fragmentTracker.getState(g)!==ki.OK){var A;const y=((A=this.backtrackFragment)!=null?A:g).sn-u.startSN,v=u.fragments[y-1];v&&g.cc===v.cc&&(g=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,d)){if(!g.gap){const y=this.audioOnly&&!this.altAudio?kt.AUDIO:kt.VIDEO,v=(y===kt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,y,qe.MAIN)}g=this.getNextFragmentLoopLoading(g,u,a,qe.MAIN,h)}g&&(g.initSegment&&!g.initSegment.data&&!this.bitrateTest&&(g=g.initSegment),this.loadFragment(g,o,d))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===ki.NOT_LOADED||r===ki.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,qe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,u=a.duration,c=Math.max(o.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ye.KEY_LOADING:case ye.FRAG_LOADING:case ye.FRAG_LOADING_WAITING_RETRY:case ye.PARSING:case ye.PARSED:this.state=ye.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new roe(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;ke(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(U.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,r=!1;t.levels.forEach(s=>{const o=s.audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,r=r||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&r&&!eoe(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==ye.IDLE)return;const r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=ye.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r}=this,s=t.level,o=t.details,a=o.totalduration;if(!r){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const l=r[s],u=this.fragCurrent;u&&(this.state===ye.FRAG_LOADING||this.state===ye.FRAG_LOADING_WAITING_RETRY)&&u.level!==t.level&&u.loader&&this.abortCurrentFrag();let c=0;if(o.live||(n=l.details)!=null&&n.live){var h;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;c=this.alignPlaylists(o,l.details,(h=this.levelLastLoaded)==null?void 0:h.details)}if(l.details=o,this.levelLastLoaded=l,this.hls.trigger(U.LEVEL_UPDATED,{details:o,level:s}),this.state===ye.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=ye.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const a=o[n.level],l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=a.videoCodec,c=l.PTSKnown||!l.live,h=(t=n.initSegment)==null?void 0:t.data,d=this._getAudioCodec(a),g=this.transmuxer=this.transmuxer||new sO(this.hls,qe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),A=r?r.index:-1,p=A!==-1,y=new qC(n.level,n.sn,n.stats.chunkCount,s.byteLength,A,p),v=this.initPTS[n.cc];g.push(s,h,d,u,n,r,l.totalduration,c,y,v)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(U.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(U.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,r=!!this.hls.audioTracks[n].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,s,o=!1;for(const a in n){const l=n[a];if(l.id==="main"){if(s=a,r=l,a==="video"){const u=n[a];u&&(this.videoBuffer=u.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n&&n.type!==qe.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ye.PARSED&&(this.state=ye.IDLE);return}const s=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=ye.ERROR;return}switch(t.details){case de.FRAG_GAP:case de.FRAG_PARSING_ERROR:case de.FRAG_DECRYPT_ERROR:case de.FRAG_LOAD_ERROR:case de.FRAG_LOAD_TIMEOUT:case de.KEY_LOAD_ERROR:case de.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(qe.MAIN,t);break;case de.LEVEL_LOAD_ERROR:case de.LEVEL_LOAD_TIMEOUT:case de.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ye.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===mt.LEVEL&&(this.state=ye.IDLE);break;case de.BUFFER_APPEND_ERROR:case de.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===de.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case de.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Ht.getBuffered(e).length){const n=this.state!==ye.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=ye.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==kt.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===kt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,qe.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=Ht.getBuffered(e),o=(r.length?r.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=ye.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(U.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:u,level:c}=a,{video:h,text:d,id3:g,initSegment:A}=s,{details:p}=c,y=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=ye.PARSING,A){if(A!=null&&A.tracks){const I=l.initSegment||l;this._bufferInitSegment(c,A.tracks,I,o),r.trigger(U.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:n,tracks:A.tracks})}const v=A.initPTS,E=A.timescale;ke(v)&&(this.initPTS[l.cc]={baseTime:v,timescale:E},r.trigger(U.INIT_PTS_FOUND,{frag:l,id:n,initPTS:v,timescale:E}))}if(h&&p&&l.sn!=="initSegment"){const v=p.fragments[l.sn-1-p.startSN],E=l.sn===p.startSN,I=!v||l.cc>v.cc;if(s.independent!==!1){const{startPTS:C,endPTS:w,startDTS:S,endDTS:x}=h;if(u)u.elementaryStreams[h.type]={startPTS:C,endPTS:w,startDTS:S,endDTS:x};else if(h.firstKeyFrame&&h.independent&&o.id===1&&!I&&(this.couldBacktrack=!0),h.dropped&&h.independent){const T=this.getMainFwdBufferInfo(),Q=(T?T.end:this.getLoadPosition())+this.config.maxBufferHole,M=h.firstKeyFramePTS?h.firstKeyFramePTS:C;if(!E&&Q<M-this.config.maxBufferHole&&!I){this.backtrack(l);return}else I&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,w,l.start,x,!0)}else E&&C>vm&&(l.gap=!0);l.setElementaryStreamInfo(h.type,C,w,S,x),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,o,E||I)}else if(E||I)l.gap=!0;else{this.backtrack(l);return}}if(y){const{startPTS:v,endPTS:E,startDTS:I,endDTS:C}=y;u&&(u.elementaryStreams[kt.AUDIO]={startPTS:v,endPTS:E,startDTS:I,endDTS:C}),l.setElementaryStreamInfo(kt.AUDIO,v,E,I,C),this.bufferFragmentData(y,l,u,o)}if(p&&g!=null&&(t=g.samples)!=null&&t.length){const v={id:n,frag:l,details:p,samples:g.samples};r.trigger(U.FRAG_PARSING_METADATA,v)}if(p&&d){const v={id:n,frag:l,details:p,samples:d.samples};r.trigger(U.FRAG_PARSING_USERDATA,v)}}_bufferInitSegment(e,t,n,r){if(this.state!==ye.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:a}=t;if(s){let l=e.audioCodec;const u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const c=s.metadata;c&&"channelCount"in c&&(c.channelCount||1)!==1&&u.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(U.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const c=t[l].initSegment;c!=null&&c.byteLength&&this.hls.trigger(U.BUFFER_APPENDING,{type:l,data:c,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,qe.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ye.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Ht.isBuffered(e,n)?t=this.getAppendedFrag(n):Ht.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(U.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(U.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&ke(t)&&ke(n.programDateTime)){const r=n.programDateTime+(t-n.start)*1e3;return new Date(r)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class an{static get version(){return"1.5.11"}static isMSESupported(){return HO()}static isSupported(){return Jse()}static getMediaSource(){return Ll()}static get Events(){return U}static get ErrorTypes(){return Ke}static get ErrorDetails(){return de}static get DefaultConfig(){return an.defaultConfig?an.defaultConfig:QO}static set DefaultConfig(e){an.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new iw,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,Wte(e.debug||!1,"Hls instance");const t=this.config=Kse(an.DefaultConfig,e);this.userConfig=e,t.progressive&&Yse(t);const{abrController:n,bufferController:r,capLevelController:s,errorController:o,fpsController:a}=t,l=new o(this),u=this.abrController=new n(this),c=this.bufferController=new r(this),h=this.capLevelController=new s(this),d=new a(this),g=new Hie(this),A=new jie(this),p=t.contentSteeringController,y=p?new p(this):null,v=this.levelController=new Zse(this,y),E=new _ne(this),I=new Xse(this.config),C=this.streamController=new ooe(this,E,I);h.setStreamController(C),d.setStreamController(C);const w=[g,v,C];y&&w.splice(1,0,y),this.networkControllers=w;const S=[u,c,h,d,A,E];this.audioTrackController=this.createController(t.audioTrackController,w);const x=t.audioStreamController;x&&w.push(new x(this,E,I)),this.subtitleTrackController=this.createController(t.subtitleTrackController,w);const T=t.subtitleStreamController;T&&w.push(new T(this,E,I)),this.createController(t.timelineController,S),I.emeController=this.emeController=this.createController(t.emeController,S),this.cmcdController=this.createController(t.cmcdController,S),this.latencyController=this.createController(Wie,S),this.coreComponents=S,w.push(l);const Q=l.onErrorOut;typeof Q=="function"&&this.on(U.ERROR,Q,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(se.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===U.ERROR;this.trigger(U.ERROR,{type:Ke.OTHER_ERROR,details:de.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){se.log("destroy"),this.trigger(U.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){se.log("attachMedia"),this._media=e,this.trigger(U.MEDIA_ATTACHING,{media:e})}detachMedia(){se.log("detachMedia"),this.trigger(U.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,r=this.url=IC.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,se.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(U.MANIFEST_LOADING,{url:e})}startLoad(e=-1){se.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){se.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){se.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){se.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){se.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){se.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){se.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){se.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){se.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(se.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Kie(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let s=r;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=n)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}an.defaultConfig=void 0;function aoe(i,e=globalThis==null?void 0:globalThis.document){const t=ls(i);k.useEffect(()=>{const n=r=>{r.key==="Escape"&&t(r)};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)},[t,e])}const Iw="dismissableLayer.update",loe="dismissableLayer.pointerDownOutside",uoe="dismissableLayer.focusOutside";let zO;const coe=k.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),VO=k.forwardRef((i,e)=>{var t;const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:a,onDismiss:l,...u}=i,c=k.useContext(coe),[h,d]=k.useState(null),g=(t=h==null?void 0:h.ownerDocument)!==null&&t!==void 0?t:globalThis==null?void 0:globalThis.document,[,A]=k.useState({}),p=Gt(e,T=>d(T)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),E=y.indexOf(v),I=h?y.indexOf(h):-1,C=c.layersWithOutsidePointerEventsDisabled.size>0,w=I>=E,S=hoe(T=>{const Q=T.target,M=[...c.branches].some(R=>R.contains(Q));!w||M||(s==null||s(T),a==null||a(T),T.defaultPrevented||l==null||l())},g),x=doe(T=>{const Q=T.target;[...c.branches].some(R=>R.contains(Q))||(o==null||o(T),a==null||a(T),T.defaultPrevented||l==null||l())},g);return aoe(T=>{I===c.layers.size-1&&(r==null||r(T),!T.defaultPrevented&&l&&(T.preventDefault(),l()))},g),k.useEffect(()=>{if(h)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(zO=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(h)),c.layers.add(h),qO(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=zO)}},[h,g,n,c]),k.useEffect(()=>()=>{h&&(c.layers.delete(h),c.layersWithOutsidePointerEventsDisabled.delete(h),qO())},[h,c]),k.useEffect(()=>{const T=()=>A({});return document.addEventListener(Iw,T),()=>document.removeEventListener(Iw,T)},[]),k.createElement(ht.div,Be({},u,{ref:p,style:{pointerEvents:C?w?"auto":"none":void 0,...i.style},onFocusCapture:tt(i.onFocusCapture,x.onFocusCapture),onBlurCapture:tt(i.onBlurCapture,x.onBlurCapture),onPointerDownCapture:tt(i.onPointerDownCapture,S.onPointerDownCapture)}))});function hoe(i,e=globalThis==null?void 0:globalThis.document){const t=ls(i),n=k.useRef(!1),r=k.useRef(()=>{});return k.useEffect(()=>{const s=a=>{if(a.target&&!n.current){let u=function(){$O(loe,t,l,{discrete:!0})};const l={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=u,e.addEventListener("click",r.current,{once:!0})):u()}else e.removeEventListener("click",r.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function doe(i,e=globalThis==null?void 0:globalThis.document){const t=ls(i),n=k.useRef(!1);return k.useEffect(()=>{const r=s=>{s.target&&!n.current&&$O(uoe,t,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function qO(){const i=new CustomEvent(Iw);document.dispatchEvent(i)}function $O(i,e,t,{discrete:n}){const r=t.originalEvent.target,s=new CustomEvent(i,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(i,e,{once:!0}),n?JK(r,s):r.dispatchEvent(s)}let _w=0;function jO(){k.useEffect(()=>{var i,e;const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(i=t[0])!==null&&i!==void 0?i:WO()),document.body.insertAdjacentElement("beforeend",(e=t[1])!==null&&e!==void 0?e:WO()),_w++,()=>{_w===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),_w--}},[])}function WO(){const i=document.createElement("span");return i.setAttribute("data-radix-focus-guard",""),i.tabIndex=0,i.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",i}const Cw="focusScope.autoFocusOnMount",ww="focusScope.autoFocusOnUnmount",KO={bubbles:!1,cancelable:!0},YO=k.forwardRef((i,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:r,onUnmountAutoFocus:s,...o}=i,[a,l]=k.useState(null),u=ls(r),c=ls(s),h=k.useRef(null),d=Gt(e,p=>l(p)),g=k.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;k.useEffect(()=>{if(n){let p=function(I){if(g.paused||!a)return;const C=I.target;a.contains(C)?h.current=C:xa(h.current,{select:!0})},y=function(I){if(g.paused||!a)return;const C=I.relatedTarget;C!==null&&(a.contains(C)||xa(h.current,{select:!0}))},v=function(I){if(document.activeElement===document.body)for(const w of I)w.removedNodes.length>0&&xa(a)};document.addEventListener("focusin",p),document.addEventListener("focusout",y);const E=new MutationObserver(v);return a&&E.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",y),E.disconnect()}}},[n,a,g.paused]),k.useEffect(()=>{if(a){JO.add(g);const p=document.activeElement;if(!a.contains(p)){const v=new CustomEvent(Cw,KO);a.addEventListener(Cw,u),a.dispatchEvent(v),v.defaultPrevented||(foe(yoe(ZO(a)),{select:!0}),document.activeElement===p&&xa(a))}return()=>{a.removeEventListener(Cw,u),setTimeout(()=>{const v=new CustomEvent(ww,KO);a.addEventListener(ww,c),a.dispatchEvent(v),v.defaultPrevented||xa(p??document.body,{select:!0}),a.removeEventListener(ww,c),JO.remove(g)},0)}}},[a,u,c,g]);const A=k.useCallback(p=>{if(!t&&!n||g.paused)return;const y=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,v=document.activeElement;if(y&&v){const E=p.currentTarget,[I,C]=goe(E);I&&C?!p.shiftKey&&v===C?(p.preventDefault(),t&&xa(I,{select:!0})):p.shiftKey&&v===I&&(p.preventDefault(),t&&xa(C,{select:!0})):v===E&&p.preventDefault()}},[t,n,g.paused]);return k.createElement(ht.div,Be({tabIndex:-1},o,{ref:d,onKeyDown:A}))});function foe(i,{select:e=!1}={}){const t=document.activeElement;for(const n of i)if(xa(n,{select:e}),document.activeElement!==t)return}function goe(i){const e=ZO(i),t=XO(e,i),n=XO(e.reverse(),i);return[t,n]}function ZO(i){const e=[],t=document.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function XO(i,e){for(const t of i)if(!Aoe(t,{upTo:e}))return t}function Aoe(i,{upTo:e}){if(getComputedStyle(i).visibility==="hidden")return!0;for(;i;){if(e!==void 0&&i===e)return!1;if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}function poe(i){return i instanceof HTMLInputElement&&"select"in i}function xa(i,{select:e=!1}={}){if(i&&i.focus){const t=document.activeElement;i.focus({preventScroll:!0}),i!==t&&poe(i)&&e&&i.select()}}const JO=moe();function moe(){let i=[];return{add(e){const t=i[0];e!==t&&(t==null||t.pause()),i=eN(i,e),i.unshift(e)},remove(e){var t;i=eN(i,e),(t=i[0])===null||t===void 0||t.resume()}}}function eN(i,e){const t=[...i],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function yoe(i){return i.filter(e=>e.tagName!=="A")}const voe=["top","right","bottom","left"],ys=Math.min,Jn=Math.max,Em=Math.round,Im=Math.floor,ba=i=>({x:i,y:i}),Eoe={left:"right",right:"left",bottom:"top",top:"bottom"},Ioe={start:"end",end:"start"};function xw(i,e,t){return Jn(i,ys(e,t))}function ho(i,e){return typeof i=="function"?i(e):i}function fo(i){return i.split("-")[0]}function qc(i){return i.split("-")[1]}function bw(i){return i==="x"?"y":"x"}function Sw(i){return i==="y"?"height":"width"}function $c(i){return["top","bottom"].includes(fo(i))?"y":"x"}function Tw(i){return bw($c(i))}function _oe(i,e,t){t===void 0&&(t=!1);const n=qc(i),r=Tw(i),s=Sw(r);let o=r==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=_m(o)),[o,_m(o)]}function Coe(i){const e=_m(i);return[Bw(i),e,Bw(e)]}function Bw(i){return i.replace(/start|end/g,e=>Ioe[e])}function woe(i,e,t){const n=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(i){case"top":case"bottom":return t?e?r:n:e?n:r;case"left":case"right":return e?s:o;default:return[]}}function xoe(i,e,t,n){const r=qc(i);let s=woe(fo(i),t==="start",n);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(Bw)))),s}function _m(i){return i.replace(/left|right|bottom|top/g,e=>Eoe[e])}function boe(i){return{top:0,right:0,bottom:0,left:0,...i}}function tN(i){return typeof i!="number"?boe(i):{top:i,right:i,bottom:i,left:i}}function Cm(i){const{x:e,y:t,width:n,height:r}=i;return{width:n,height:r,top:t,left:e,right:e+n,bottom:t+r,x:e,y:t}}function iN(i,e,t){let{reference:n,floating:r}=i;const s=$c(e),o=Tw(e),a=Sw(o),l=fo(e),u=s==="y",c=n.x+n.width/2-r.width/2,h=n.y+n.height/2-r.height/2,d=n[a]/2-r[a]/2;let g;switch(l){case"top":g={x:c,y:n.y-r.height};break;case"bottom":g={x:c,y:n.y+n.height};break;case"right":g={x:n.x+n.width,y:h};break;case"left":g={x:n.x-r.width,y:h};break;default:g={x:n.x,y:n.y}}switch(qc(e)){case"start":g[o]-=d*(t&&u?-1:1);break;case"end":g[o]+=d*(t&&u?-1:1);break}return g}const Soe=async(i,e,t)=>{const{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:i,floating:e,strategy:r}),{x:c,y:h}=iN(u,n,l),d=n,g={},A=0;for(let p=0;p<a.length;p++){const{name:y,fn:v}=a[p],{x:E,y:I,data:C,reset:w}=await v({x:c,y:h,initialPlacement:n,placement:d,strategy:r,middlewareData:g,rects:u,platform:o,elements:{reference:i,floating:e}});c=E??c,h=I??h,g={...g,[y]:{...g[y],...C}},w&&A<=50&&(A++,typeof w=="object"&&(w.placement&&(d=w.placement),w.rects&&(u=w.rects===!0?await o.getElementRects({reference:i,floating:e,strategy:r}):w.rects),{x:c,y:h}=iN(u,d,l)),p=-1)}return{x:c,y:h,placement:d,strategy:r,middlewareData:g}};async function Uf(i,e){var t;e===void 0&&(e={});const{x:n,y:r,platform:s,rects:o,elements:a,strategy:l}=i,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:d=!1,padding:g=0}=ho(e,i),A=tN(g),y=a[d?h==="floating"?"reference":"floating":h],v=Cm(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(y)))==null||t?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),E=h==="floating"?{x:n,y:r,width:o.floating.width,height:o.floating.height}:o.reference,I=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),C=await(s.isElement==null?void 0:s.isElement(I))?await(s.getScale==null?void 0:s.getScale(I))||{x:1,y:1}:{x:1,y:1},w=Cm(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:E,offsetParent:I,strategy:l}):E);return{top:(v.top-w.top+A.top)/C.y,bottom:(w.bottom-v.bottom+A.bottom)/C.y,left:(v.left-w.left+A.left)/C.x,right:(w.right-v.right+A.right)/C.x}}const Toe=i=>({name:"arrow",options:i,async fn(e){const{x:t,y:n,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=ho(i,e)||{};if(u==null)return{};const h=tN(c),d={x:t,y:n},g=Tw(r),A=Sw(g),p=await o.getDimensions(u),y=g==="y",v=y?"top":"left",E=y?"bottom":"right",I=y?"clientHeight":"clientWidth",C=s.reference[A]+s.reference[g]-d[g]-s.floating[A],w=d[g]-s.reference[g],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let x=S?S[I]:0;(!x||!await(o.isElement==null?void 0:o.isElement(S)))&&(x=a.floating[I]||s.floating[A]);const T=C/2-w/2,Q=x/2-p[A]/2-1,M=ys(h[v],Q),R=ys(h[E],Q),z=M,q=x-p[A]-R,X=x/2-p[A]/2+T,N=xw(z,X,q),G=!l.arrow&&qc(r)!=null&&X!==N&&s.reference[A]/2-(X<z?M:R)-p[A]/2<0,j=G?X<z?X-z:X-q:0;return{[g]:d[g]+j,data:{[g]:N,centerOffset:X-N-j,...G&&{alignmentOffset:j}},reset:G}}}),Boe=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(e){var t,n;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:A="none",flipAlignment:p=!0,...y}=ho(i,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const v=fo(r),E=fo(a)===a,I=await(l.isRTL==null?void 0:l.isRTL(u.floating)),C=d||(E||!p?[_m(a)]:Coe(a));!d&&A!=="none"&&C.push(...xoe(a,p,A,I));const w=[a,...C],S=await Uf(e,y),x=[];let T=((n=s.flip)==null?void 0:n.overflows)||[];if(c&&x.push(S[v]),h){const z=_oe(r,o,I);x.push(S[z[0]],S[z[1]])}if(T=[...T,{placement:r,overflows:x}],!x.every(z=>z<=0)){var Q,M;const z=(((Q=s.flip)==null?void 0:Q.index)||0)+1,q=w[z];if(q)return{data:{index:z,overflows:T},reset:{placement:q}};let X=(M=T.filter(N=>N.overflows[0]<=0).sort((N,G)=>N.overflows[1]-G.overflows[1])[0])==null?void 0:M.placement;if(!X)switch(g){case"bestFit":{var R;const N=(R=T.map(G=>[G.placement,G.overflows.filter(j=>j>0).reduce((j,V)=>j+V,0)]).sort((G,j)=>G[1]-j[1])[0])==null?void 0:R[0];N&&(X=N);break}case"initialPlacement":X=a;break}if(r!==X)return{reset:{placement:X}}}return{}}}};function nN(i,e){return{top:i.top-e.height,right:i.right-e.width,bottom:i.bottom-e.height,left:i.left-e.width}}function rN(i){return voe.some(e=>i[e]>=0)}const Roe=function(i){return i===void 0&&(i={}),{name:"hide",options:i,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...r}=ho(i,e);switch(n){case"referenceHidden":{const s=await Uf(e,{...r,elementContext:"reference"}),o=nN(s,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:rN(o)}}}case"escaped":{const s=await Uf(e,{...r,altBoundary:!0}),o=nN(s,t.floating);return{data:{escapedOffsets:o,escaped:rN(o)}}}default:return{}}}}};async function Loe(i,e){const{placement:t,platform:n,elements:r}=i,s=await(n.isRTL==null?void 0:n.isRTL(r.floating)),o=fo(t),a=qc(t),l=$c(t)==="y",u=["left","top"].includes(o)?-1:1,c=s&&l?-1:1,h=ho(e,i);let{mainAxis:d,crossAxis:g,alignmentAxis:A}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return a&&typeof A=="number"&&(g=a==="end"?A*-1:A),l?{x:g*c,y:d*u}:{x:d*u,y:g*c}}const Doe=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(e){var t,n;const{x:r,y:s,placement:o,middlewareData:a}=e,l=await Loe(e,i);return o===((t=a.offset)==null?void 0:t.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},koe=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(e){const{x:t,y:n,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:v,y:E}=y;return{x:v,y:E}}},...l}=ho(i,e),u={x:t,y:n},c=await Uf(e,l),h=$c(fo(r)),d=bw(h);let g=u[d],A=u[h];if(s){const y=d==="y"?"top":"left",v=d==="y"?"bottom":"right",E=g+c[y],I=g-c[v];g=xw(E,g,I)}if(o){const y=h==="y"?"top":"left",v=h==="y"?"bottom":"right",E=A+c[y],I=A-c[v];A=xw(E,A,I)}const p=a.fn({...e,[d]:g,[h]:A});return{...p,data:{x:p.x-t,y:p.y-n}}}}},Poe=function(i){return i===void 0&&(i={}),{options:i,fn(e){const{x:t,y:n,placement:r,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=ho(i,e),c={x:t,y:n},h=$c(r),d=bw(h);let g=c[d],A=c[h];const p=ho(a,e),y=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const I=d==="y"?"height":"width",C=s.reference[d]-s.floating[I]+y.mainAxis,w=s.reference[d]+s.reference[I]-y.mainAxis;g<C?g=C:g>w&&(g=w)}if(u){var v,E;const I=d==="y"?"width":"height",C=["top","left"].includes(fo(r)),w=s.reference[h]-s.floating[I]+(C&&((v=o.offset)==null?void 0:v[h])||0)+(C?0:y.crossAxis),S=s.reference[h]+s.reference[I]+(C?0:((E=o.offset)==null?void 0:E[h])||0)-(C?y.crossAxis:0);A<w?A=w:A>S&&(A=S)}return{[d]:g,[h]:A}}}},Moe=function(i){return i===void 0&&(i={}),{name:"size",options:i,async fn(e){const{placement:t,rects:n,platform:r,elements:s}=e,{apply:o=()=>{},...a}=ho(i,e),l=await Uf(e,a),u=fo(t),c=qc(t),h=$c(t)==="y",{width:d,height:g}=n.floating;let A,p;u==="top"||u==="bottom"?(A=u,p=c===(await(r.isRTL==null?void 0:r.isRTL(s.floating))?"start":"end")?"left":"right"):(p=u,A=c==="end"?"top":"bottom");const y=g-l.top-l.bottom,v=d-l.left-l.right,E=ys(g-l[A],y),I=ys(d-l[p],v),C=!e.middlewareData.shift;let w=E,S=I;if(h?S=c||C?ys(I,v):v:w=c||C?ys(E,y):y,C&&!c){const T=Jn(l.left,0),Q=Jn(l.right,0),M=Jn(l.top,0),R=Jn(l.bottom,0);h?S=d-2*(T!==0||Q!==0?T+Q:Jn(l.left,l.right)):w=g-2*(M!==0||R!==0?M+R:Jn(l.top,l.bottom))}await o({...e,availableWidth:S,availableHeight:w});const x=await r.getDimensions(s.floating);return d!==x.width||g!==x.height?{reset:{rects:!0}}:{}}}};function jc(i){return sN(i)?(i.nodeName||"").toLowerCase():"#document"}function er(i){var e;return(i==null||(e=i.ownerDocument)==null?void 0:e.defaultView)||window}function go(i){var e;return(e=(sN(i)?i.ownerDocument:i.document)||window.document)==null?void 0:e.documentElement}function sN(i){return i instanceof Node||i instanceof er(i).Node}function vs(i){return i instanceof Element||i instanceof er(i).Element}function Es(i){return i instanceof HTMLElement||i instanceof er(i).HTMLElement}function oN(i){return typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof er(i).ShadowRoot}function Gf(i){const{overflow:e,overflowX:t,overflowY:n,display:r}=Hr(i);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(r)}function Foe(i){return["table","td","th"].includes(jc(i))}function Rw(i){const e=Lw(),t=Hr(i);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function Ooe(i){let e=Sa(i);for(;Es(e)&&!Wc(e);){if(Rw(e))return e;e=Sa(e)}return null}function Lw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Wc(i){return["html","body","#document"].includes(jc(i))}function Hr(i){return er(i).getComputedStyle(i)}function wm(i){return vs(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function Sa(i){if(jc(i)==="html")return i;const e=i.assignedSlot||i.parentNode||oN(i)&&i.host||go(i);return oN(e)?e.host:e}function aN(i){const e=Sa(i);return Wc(e)?i.ownerDocument?i.ownerDocument.body:i.body:Es(e)&&Gf(e)?e:aN(e)}function Hf(i,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=aN(i),s=r===((n=i.ownerDocument)==null?void 0:n.body),o=er(r);return s?e.concat(o,o.visualViewport||[],Gf(r)?r:[],o.frameElement&&t?Hf(o.frameElement):[]):e.concat(r,Hf(r,[],t))}function lN(i){const e=Hr(i);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=Es(i),s=r?i.offsetWidth:t,o=r?i.offsetHeight:n,a=Em(t)!==s||Em(n)!==o;return a&&(t=s,n=o),{width:t,height:n,$:a}}function Dw(i){return vs(i)?i:i.contextElement}function Kc(i){const e=Dw(i);if(!Es(e))return ba(1);const t=e.getBoundingClientRect(),{width:n,height:r,$:s}=lN(e);let o=(s?Em(t.width):t.width)/n,a=(s?Em(t.height):t.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Noe=ba(0);function uN(i){const e=er(i);return!Lw()||!e.visualViewport?Noe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Qoe(i,e,t){return e===void 0&&(e=!1),!t||e&&t!==er(i)?!1:e}function Pl(i,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=i.getBoundingClientRect(),s=Dw(i);let o=ba(1);e&&(n?vs(n)&&(o=Kc(n)):o=Kc(i));const a=Qoe(s,t,n)?uN(s):ba(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,c=r.width/o.x,h=r.height/o.y;if(s){const d=er(s),g=n&&vs(n)?er(n):n;let A=d,p=A.frameElement;for(;p&&n&&g!==A;){const y=Kc(p),v=p.getBoundingClientRect(),E=Hr(p),I=v.left+(p.clientLeft+parseFloat(E.paddingLeft))*y.x,C=v.top+(p.clientTop+parseFloat(E.paddingTop))*y.y;l*=y.x,u*=y.y,c*=y.x,h*=y.y,l+=I,u+=C,A=er(p),p=A.frameElement}}return Cm({width:c,height:h,x:l,y:u})}const Uoe=[":popover-open",":modal"];function kw(i){return Uoe.some(e=>{try{return i.matches(e)}catch{return!1}})}function Goe(i){let{elements:e,rect:t,offsetParent:n,strategy:r}=i;const s=r==="fixed",o=go(n),a=e?kw(e.floating):!1;if(n===o||a&&s)return t;let l={scrollLeft:0,scrollTop:0},u=ba(1);const c=ba(0),h=Es(n);if((h||!h&&!s)&&((jc(n)!=="body"||Gf(o))&&(l=wm(n)),Es(n))){const d=Pl(n);u=Kc(n),c.x=d.x+n.clientLeft,c.y=d.y+n.clientTop}return{width:t.width*u.x,height:t.height*u.y,x:t.x*u.x-l.scrollLeft*u.x+c.x,y:t.y*u.y-l.scrollTop*u.y+c.y}}function Hoe(i){return Array.from(i.getClientRects())}function cN(i){return Pl(go(i)).left+wm(i).scrollLeft}function zoe(i){const e=go(i),t=wm(i),n=i.ownerDocument.body,r=Jn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Jn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+cN(i);const a=-t.scrollTop;return Hr(n).direction==="rtl"&&(o+=Jn(e.clientWidth,n.clientWidth)-r),{width:r,height:s,x:o,y:a}}function Voe(i,e){const t=er(i),n=go(i),r=t.visualViewport;let s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const u=Lw();(!u||u&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}function qoe(i,e){const t=Pl(i,!0,e==="fixed"),n=t.top+i.clientTop,r=t.left+i.clientLeft,s=Es(i)?Kc(i):ba(1),o=i.clientWidth*s.x,a=i.clientHeight*s.y,l=r*s.x,u=n*s.y;return{width:o,height:a,x:l,y:u}}function hN(i,e,t){let n;if(e==="viewport")n=Voe(i,t);else if(e==="document")n=zoe(go(i));else if(vs(e))n=qoe(e,t);else{const r=uN(i);n={...e,x:e.x-r.x,y:e.y-r.y}}return Cm(n)}function dN(i,e){const t=Sa(i);return t===e||!vs(t)||Wc(t)?!1:Hr(t).position==="fixed"||dN(t,e)}function $oe(i,e){const t=e.get(i);if(t)return t;let n=Hf(i,[],!1).filter(a=>vs(a)&&jc(a)!=="body"),r=null;const s=Hr(i).position==="fixed";let o=s?Sa(i):i;for(;vs(o)&&!Wc(o);){const a=Hr(o),l=Rw(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Gf(o)&&!l&&dN(i,o))?n=n.filter(c=>c!==o):r=a,o=Sa(o)}return e.set(i,n),n}function joe(i){let{element:e,boundary:t,rootBoundary:n,strategy:r}=i;const o=[...t==="clippingAncestors"?kw(e)?[]:$oe(e,this._c):[].concat(t),n],a=o[0],l=o.reduce((u,c)=>{const h=hN(e,c,r);return u.top=Jn(h.top,u.top),u.right=ys(h.right,u.right),u.bottom=ys(h.bottom,u.bottom),u.left=Jn(h.left,u.left),u},hN(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Woe(i){const{width:e,height:t}=lN(i);return{width:e,height:t}}function Koe(i,e,t){const n=Es(e),r=go(e),s=t==="fixed",o=Pl(i,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=ba(0);if(n||!n&&!s)if((jc(e)!=="body"||Gf(r))&&(a=wm(e)),n){const h=Pl(e,!0,s,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else r&&(l.x=cN(r));const u=o.left+a.scrollLeft-l.x,c=o.top+a.scrollTop-l.y;return{x:u,y:c,width:o.width,height:o.height}}function Pw(i){return Hr(i).position==="static"}function fN(i,e){return!Es(i)||Hr(i).position==="fixed"?null:e?e(i):i.offsetParent}function gN(i,e){const t=er(i);if(kw(i))return t;if(!Es(i)){let r=Sa(i);for(;r&&!Wc(r);){if(vs(r)&&!Pw(r))return r;r=Sa(r)}return t}let n=fN(i,e);for(;n&&Foe(n)&&Pw(n);)n=fN(n,e);return n&&Wc(n)&&Pw(n)&&!Rw(n)?t:n||Ooe(i)||t}const Yoe=async function(i){const e=this.getOffsetParent||gN,t=this.getDimensions,n=await t(i.floating);return{reference:Koe(i.reference,await e(i.floating),i.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Zoe(i){return Hr(i).direction==="rtl"}const Xoe={convertOffsetParentRelativeRectToViewportRelativeRect:Goe,getDocumentElement:go,getClippingRect:joe,getOffsetParent:gN,getElementRects:Yoe,getClientRects:Hoe,getDimensions:Woe,getScale:Kc,isElement:vs,isRTL:Zoe};function Joe(i,e){let t=null,n;const r=go(i);function s(){var a;clearTimeout(n),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:h,height:d}=i.getBoundingClientRect();if(a||e(),!h||!d)return;const g=Im(c),A=Im(r.clientWidth-(u+h)),p=Im(r.clientHeight-(c+d)),y=Im(u),E={rootMargin:-g+"px "+-A+"px "+-p+"px "+-y+"px",threshold:Jn(0,ys(1,l))||1};let I=!0;function C(w){const S=w[0].intersectionRatio;if(S!==l){if(!I)return o();S?o(!1,S):n=setTimeout(()=>{o(!1,1e-7)},1e3)}I=!1}try{t=new IntersectionObserver(C,{...E,root:r.ownerDocument})}catch{t=new IntersectionObserver(C,E)}t.observe(i)}return o(!0),s}function eae(i,e,t,n){n===void 0&&(n={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=Dw(i),c=r||s?[...u?Hf(u):[],...Hf(e)]:[];c.forEach(v=>{r&&v.addEventListener("scroll",t,{passive:!0}),s&&v.addEventListener("resize",t)});const h=u&&a?Joe(u,t):null;let d=-1,g=null;o&&(g=new ResizeObserver(v=>{let[E]=v;E&&E.target===u&&g&&(g.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var I;(I=g)==null||I.observe(e)})),t()}),u&&!l&&g.observe(u),g.observe(e));let A,p=l?Pl(i):null;l&&y();function y(){const v=Pl(i);p&&(v.x!==p.x||v.y!==p.y||v.width!==p.width||v.height!==p.height)&&t(),p=v,A=requestAnimationFrame(y)}return t(),()=>{var v;c.forEach(E=>{r&&E.removeEventListener("scroll",t),s&&E.removeEventListener("resize",t)}),h==null||h(),(v=g)==null||v.disconnect(),g=null,l&&cancelAnimationFrame(A)}}const tae=Doe,iae=koe,nae=Boe,rae=Moe,sae=Roe,AN=Toe,oae=Poe,aae=(i,e,t)=>{const n=new Map,r={platform:Xoe,...t},s={...r.platform,_c:n};return Soe(i,e,{...r,platform:s})};var xm=typeof document<"u"?k.useLayoutEffect:k.useEffect;function bm(i,e){if(i===e)return!0;if(typeof i!=typeof e)return!1;if(typeof i=="function"&&i.toString()===e.toString())return!0;let t,n,r;if(i&&e&&typeof i=="object"){if(Array.isArray(i)){if(t=i.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!bm(i[n],e[n]))return!1;return!0}if(r=Object.keys(i),t=r.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,r[n]))return!1;for(n=t;n--!==0;){const s=r[n];if(!(s==="_owner"&&i.$$typeof)&&!bm(i[s],e[s]))return!1}return!0}return i!==i&&e!==e}function pN(i){return typeof window>"u"?1:(i.ownerDocument.defaultView||window).devicePixelRatio||1}function mN(i,e){const t=pN(i);return Math.round(e*t)/t}function yN(i){const e=k.useRef(i);return xm(()=>{e.current=i}),e}function lae(i){i===void 0&&(i={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:r,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=i,[c,h]=k.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[d,g]=k.useState(n);bm(d,n)||g(n);const[A,p]=k.useState(null),[y,v]=k.useState(null),E=k.useCallback(j=>{j!==S.current&&(S.current=j,p(j))},[]),I=k.useCallback(j=>{j!==x.current&&(x.current=j,v(j))},[]),C=s||A,w=o||y,S=k.useRef(null),x=k.useRef(null),T=k.useRef(c),Q=l!=null,M=yN(l),R=yN(r),z=k.useCallback(()=>{if(!S.current||!x.current)return;const j={placement:e,strategy:t,middleware:d};R.current&&(j.platform=R.current),aae(S.current,x.current,j).then(V=>{const Z={...V,isPositioned:!0};q.current&&!bm(T.current,Z)&&(T.current=Z,pl.flushSync(()=>{h(Z)}))})},[d,e,t,R]);xm(()=>{u===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,h(j=>({...j,isPositioned:!1})))},[u]);const q=k.useRef(!1);xm(()=>(q.current=!0,()=>{q.current=!1}),[]),xm(()=>{if(C&&(S.current=C),w&&(x.current=w),C&&w){if(M.current)return M.current(C,w,z);z()}},[C,w,z,M,Q]);const X=k.useMemo(()=>({reference:S,floating:x,setReference:E,setFloating:I}),[E,I]),N=k.useMemo(()=>({reference:C,floating:w}),[C,w]),G=k.useMemo(()=>{const j={position:t,left:0,top:0};if(!N.floating)return j;const V=mN(N.floating,c.x),Z=mN(N.floating,c.y);return a?{...j,transform:"translate("+V+"px, "+Z+"px)",...pN(N.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:V,top:Z}},[t,a,N.floating,c.x,c.y]);return k.useMemo(()=>({...c,update:z,refs:X,elements:N,floatingStyles:G}),[c,z,X,N,G])}const uae=i=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:i,fn(t){const{element:n,padding:r}=typeof i=="function"?i(t):i;return n&&e(n)?n.current!=null?AN({element:n.current,padding:r}).fn(t):{}:n?AN({element:n,padding:r}).fn(t):{}}}},cae=(i,e)=>({...tae(i),options:[i,e]}),hae=(i,e)=>({...iae(i),options:[i,e]}),dae=(i,e)=>({...oae(i),options:[i,e]}),fae=(i,e)=>({...nae(i),options:[i,e]}),gae=(i,e)=>({...rae(i),options:[i,e]}),Aae=(i,e)=>({...sae(i),options:[i,e]}),pae=(i,e)=>({...uae(i),options:[i,e]}),mae=k.forwardRef((i,e)=>{const{children:t,width:n=10,height:r=5,...s}=i;return k.createElement(ht.svg,Be({},s,{ref:e,width:n,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),i.asChild?t:k.createElement("polygon",{points:"0,0 30,0 15,10"}))}),vN="Popper",[EN,Sm]=Or(vN),[yae,IN]=EN(vN),vae=i=>{const{__scopePopper:e,children:t}=i,[n,r]=k.useState(null);return k.createElement(yae,{scope:e,anchor:n,onAnchorChange:r},t)},Eae="PopperAnchor",Iae=k.forwardRef((i,e)=>{const{__scopePopper:t,virtualRef:n,...r}=i,s=IN(Eae,t),o=k.useRef(null),a=Gt(e,o);return k.useEffect(()=>{s.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:k.createElement(ht.div,Be({},r,{ref:a}))}),_N="PopperContent",[_ae,Cae]=EN(_N),wae=k.forwardRef((i,e)=>{var t,n,r,s,o,a,l,u;const{__scopePopper:c,side:h="bottom",sideOffset:d=0,align:g="center",alignOffset:A=0,arrowPadding:p=0,avoidCollisions:y=!0,collisionBoundary:v=[],collisionPadding:E=0,sticky:I="partial",hideWhenDetached:C=!1,updatePositionStrategy:w="optimized",onPlaced:S,...x}=i,T=IN(_N,c),[Q,M]=k.useState(null),R=Gt(e,pt=>M(pt)),[z,q]=k.useState(null),X=T_(z),N=(t=X==null?void 0:X.width)!==null&&t!==void 0?t:0,G=(n=X==null?void 0:X.height)!==null&&n!==void 0?n:0,j=h+(g!=="center"?"-"+g:""),V=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},Z=Array.isArray(v)?v:[v],Y=Z.length>0,te={padding:V,boundary:Z.filter(bae),altBoundary:Y},{refs:J,floatingStyles:ce,placement:ie,isPositioned:ne,middlewareData:ue}=lae({strategy:"fixed",placement:j,whileElementsMounted:(...pt)=>eae(...pt,{animationFrame:w==="always"}),elements:{reference:T.anchor},middleware:[cae({mainAxis:d+G,alignmentAxis:A}),y&&hae({mainAxis:!0,crossAxis:!1,limiter:I==="partial"?dae():void 0,...te}),y&&fae({...te}),gae({...te,apply:({elements:pt,rects:at,availableWidth:D,availableHeight:W})=>{const{width:oe,height:ve}=at.reference,Ae=pt.floating.style;Ae.setProperty("--radix-popper-available-width",`${D}px`),Ae.setProperty("--radix-popper-available-height",`${W}px`),Ae.setProperty("--radix-popper-anchor-width",`${oe}px`),Ae.setProperty("--radix-popper-anchor-height",`${ve}px`)}}),z&&pae({element:z,padding:p}),Sae({arrowWidth:N,arrowHeight:G}),C&&Aae({strategy:"referenceHidden",...te})]}),[fe,me]=xN(ie),Pe=ls(S);pn(()=>{ne&&(Pe==null||Pe())},[ne,Pe]);const Re=(r=ue.arrow)===null||r===void 0?void 0:r.x,Qe=(s=ue.arrow)===null||s===void 0?void 0:s.y,Oe=((o=ue.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[wt,ft]=k.useState();return pn(()=>{Q&&ft(window.getComputedStyle(Q).zIndex)},[Q]),k.createElement("div",{ref:J.setFloating,"data-radix-popper-content-wrapper":"",style:{...ce,transform:ne?ce.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:wt,"--radix-popper-transform-origin":[(a=ue.transformOrigin)===null||a===void 0?void 0:a.x,(l=ue.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:i.dir},k.createElement(_ae,{scope:c,placedSide:fe,onArrowChange:q,arrowX:Re,arrowY:Qe,shouldHideArrow:Oe},k.createElement(ht.div,Be({"data-side":fe,"data-align":me},x,{ref:R,style:{...x.style,animation:ne?void 0:"none",opacity:(u=ue.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))}),CN="PopperArrow",xae={top:"bottom",right:"left",bottom:"top",left:"right"},wN=k.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,s=Cae(CN,n),o=xae[s.placedSide];return k.createElement("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0}},k.createElement(mae,Be({},r,{ref:t,style:{...r.style,display:"block"}})))});function bae(i){return i!==null}const Sae=i=>({name:"transformOrigin",options:i,fn(e){var t,n,r,s,o;const{placement:a,rects:l,middlewareData:u}=e,h=((t=u.arrow)===null||t===void 0?void 0:t.centerOffset)!==0,d=h?0:i.arrowWidth,g=h?0:i.arrowHeight,[A,p]=xN(a),y={start:"0%",center:"50%",end:"100%"}[p],v=((n=(r=u.arrow)===null||r===void 0?void 0:r.x)!==null&&n!==void 0?n:0)+d/2,E=((s=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&s!==void 0?s:0)+g/2;let I="",C="";return A==="bottom"?(I=h?y:`${v}px`,C=`${-g}px`):A==="top"?(I=h?y:`${v}px`,C=`${l.floating.height+g}px`):A==="right"?(I=`${-g}px`,C=h?y:`${E}px`):A==="left"&&(I=`${l.floating.width+g}px`,C=h?y:`${E}px`),{data:{x:I,y:C}}}});function xN(i){const[e,t="center"]=i.split("-");return[e,t]}const bN=vae,SN=Iae,TN=wae,Tae=wN,Bae=k.forwardRef((i,e)=>{var t;const{container:n=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...r}=i;return n?oW.createPortal(k.createElement(ht.div,Be({},r,{ref:e})),n):null});var Rae=function(i){if(typeof document>"u")return null;var e=Array.isArray(i)?i[0]:i;return e.ownerDocument.body},Yc=new WeakMap,Tm=new WeakMap,Bm={},Mw=0,BN=function(i){return i&&(i.host||BN(i.parentNode))},Lae=function(i,e){return e.map(function(t){if(i.contains(t))return t;var n=BN(t);return n&&i.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",i,". Doing nothing"),null)}).filter(function(t){return!!t})},Dae=function(i,e,t,n){var r=Lae(e,Array.isArray(i)?i:[i]);Bm[t]||(Bm[t]=new WeakMap);var s=Bm[t],o=[],a=new Set,l=new Set(r),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};r.forEach(u);var c=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(d){if(a.has(d))c(d);else try{var g=d.getAttribute(n),A=g!==null&&g!=="false",p=(Yc.get(d)||0)+1,y=(s.get(d)||0)+1;Yc.set(d,p),s.set(d,y),o.push(d),p===1&&A&&Tm.set(d,!0),y===1&&d.setAttribute(t,"true"),A||d.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",d,v)}})};return c(e),a.clear(),Mw++,function(){o.forEach(function(h){var d=Yc.get(h)-1,g=s.get(h)-1;Yc.set(h,d),s.set(h,g),d||(Tm.has(h)||h.removeAttribute(n),Tm.delete(h)),g||h.removeAttribute(t)}),Mw--,Mw||(Yc=new WeakMap,Yc=new WeakMap,Tm=new WeakMap,Bm={})}},RN=function(i,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(i)?i:[i]),r=Rae(i);return r?(n.push.apply(n,Array.from(r.querySelectorAll("[aria-live]"))),Dae(n,r,t,"aria-hidden")):function(){return null}},Is=function(){return Is=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Is.apply(this,arguments)};function LN(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(t[n[r]]=i[n[r]]);return t}function kae(i,e,t){if(t||arguments.length===2)for(var n=0,r=e.length,s;n<r;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return i.concat(s||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var Rm="right-scroll-bar-position",Lm="width-before-scroll-bar",Pae="with-scroll-bars-hidden",Mae="--removed-body-scroll-bar-size";function Fw(i,e){return typeof i=="function"?i(e):i&&(i.current=e),i}function Fae(i,e){var t=k.useState(function(){return{value:i,callback:e,facade:{get current(){return t.value},set current(n){var r=t.value;r!==n&&(t.value=n,t.callback(n,r))}}}})[0];return t.callback=e,t.facade}var Oae=typeof window<"u"?k.useLayoutEffect:k.useEffect,DN=new WeakMap;function Nae(i,e){var t=Fae(null,function(n){return i.forEach(function(r){return Fw(r,n)})});return Oae(function(){var n=DN.get(t);if(n){var r=new Set(n),s=new Set(i),o=t.current;r.forEach(function(a){s.has(a)||Fw(a,null)}),s.forEach(function(a){r.has(a)||Fw(a,o)})}DN.set(t,i)},[i]),t}function Qae(i){return i}function Uae(i,e){e===void 0&&(e=Qae);var t=[],n=!1,r={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:i},useMedium:function(s){var o=e(s,n);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(n=!0;t.length;){var o=t;t=[],o.forEach(s)}t={push:function(a){return s(a)},filter:function(){return t}}},assignMedium:function(s){n=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(s),o=t}var l=function(){var c=o;o=[],c.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),t={push:function(c){o.push(c),u()},filter:function(c){return o=o.filter(c),t}}}};return r}function Gae(i){i===void 0&&(i={});var e=Uae(null);return e.options=Is({async:!0,ssr:!1},i),e}var kN=function(i){var e=i.sideCar,t=LN(i,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return k.createElement(n,Is({},t))};kN.isSideCarExport=!0;function Hae(i,e){return i.useMedium(e),kN}var PN=Gae(),Ow=function(){},Dm=k.forwardRef(function(i,e){var t=k.useRef(null),n=k.useState({onScrollCapture:Ow,onWheelCapture:Ow,onTouchMoveCapture:Ow}),r=n[0],s=n[1],o=i.forwardProps,a=i.children,l=i.className,u=i.removeScrollBar,c=i.enabled,h=i.shards,d=i.sideCar,g=i.noIsolation,A=i.inert,p=i.allowPinchZoom,y=i.as,v=y===void 0?"div":y,E=LN(i,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),I=d,C=Nae([t,e]),w=Is(Is({},E),r);return k.createElement(k.Fragment,null,c&&k.createElement(I,{sideCar:PN,removeScrollBar:u,shards:h,noIsolation:g,inert:A,setCallbacks:s,allowPinchZoom:!!p,lockRef:t}),o?k.cloneElement(k.Children.only(a),Is(Is({},w),{ref:C})):k.createElement(v,Is({},w,{className:l,ref:C}),a))});Dm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Dm.classNames={fullWidth:Lm,zeroRight:Rm};var zae=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Vae(){if(!document)return null;var i=document.createElement("style");i.type="text/css";var e=zae();return e&&i.setAttribute("nonce",e),i}function qae(i,e){i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}function $ae(i){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(i)}var jae=function(){var i=0,e=null;return{add:function(t){i==0&&(e=Vae())&&(qae(e,t),$ae(e)),i++},remove:function(){i--,!i&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Wae=function(){var i=jae();return function(e,t){k.useEffect(function(){return i.add(e),function(){i.remove()}},[e&&t])}},MN=function(){var i=Wae(),e=function(t){var n=t.styles,r=t.dynamic;return i(n,r),null};return e},Kae={left:0,top:0,right:0,gap:0},Nw=function(i){return parseInt(i||"",10)||0},Yae=function(i){var e=window.getComputedStyle(document.body),t=e[i==="padding"?"paddingLeft":"marginLeft"],n=e[i==="padding"?"paddingTop":"marginTop"],r=e[i==="padding"?"paddingRight":"marginRight"];return[Nw(t),Nw(n),Nw(r)]},Zae=function(i){if(i===void 0&&(i="margin"),typeof window>"u")return Kae;var e=Yae(i),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},Xae=MN(),Zc="data-scroll-locked",Jae=function(i,e,t,n){var r=i.left,s=i.top,o=i.right,a=i.gap;return t===void 0&&(t="margin"),`
  .`.concat(Pae,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(Zc,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Rm,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Lm,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Rm," .").concat(Rm,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Lm," .").concat(Lm,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Zc,`] {
    `).concat(Mae,": ").concat(a,`px;
  }
`)},FN=function(){var i=parseInt(document.body.getAttribute(Zc)||"0",10);return isFinite(i)?i:0},ele=function(){k.useEffect(function(){return document.body.setAttribute(Zc,(FN()+1).toString()),function(){var i=FN()-1;i<=0?document.body.removeAttribute(Zc):document.body.setAttribute(Zc,i.toString())}},[])},tle=function(i){var e=i.noRelative,t=i.noImportant,n=i.gapMode,r=n===void 0?"margin":n;ele();var s=k.useMemo(function(){return Zae(r)},[r]);return k.createElement(Xae,{styles:Jae(s,!e,r,t?"":"!important")})},Qw=!1;if(typeof window<"u")try{var km=Object.defineProperty({},"passive",{get:function(){return Qw=!0,!0}});window.addEventListener("test",km,km),window.removeEventListener("test",km,km)}catch{Qw=!1}var Xc=Qw?{passive:!1}:!1,ile=function(i){return i.tagName==="TEXTAREA"},ON=function(i,e){var t=window.getComputedStyle(i);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!ile(i)&&t[e]==="visible")},nle=function(i){return ON(i,"overflowY")},rle=function(i){return ON(i,"overflowX")},NN=function(i,e){var t=e;do{typeof ShadowRoot<"u"&&t instanceof ShadowRoot&&(t=t.host);var n=QN(i,t);if(n){var r=UN(i,t),s=r[1],o=r[2];if(s>o)return!0}t=t.parentNode}while(t&&t!==document.body);return!1},sle=function(i){var e=i.scrollTop,t=i.scrollHeight,n=i.clientHeight;return[e,t,n]},ole=function(i){var e=i.scrollLeft,t=i.scrollWidth,n=i.clientWidth;return[e,t,n]},QN=function(i,e){return i==="v"?nle(e):rle(e)},UN=function(i,e){return i==="v"?sle(e):ole(e)},ale=function(i,e){return i==="h"&&e==="rtl"?-1:1},lle=function(i,e,t,n,r){var s=ale(i,window.getComputedStyle(e).direction),o=s*n,a=t.target,l=e.contains(a),u=!1,c=o>0,h=0,d=0;do{var g=UN(i,a),A=g[0],p=g[1],y=g[2],v=p-y-s*A;(A||v)&&QN(i,a)&&(h+=v,d+=A),a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(c&&(h===0||!r)||!c&&(d===0||!r))&&(u=!0),u},Pm=function(i){return"changedTouches"in i?[i.changedTouches[0].clientX,i.changedTouches[0].clientY]:[0,0]},GN=function(i){return[i.deltaX,i.deltaY]},HN=function(i){return i&&"current"in i?i.current:i},ule=function(i,e){return i[0]===e[0]&&i[1]===e[1]},cle=function(i){return`
  .block-interactivity-`.concat(i,` {pointer-events: none;}
  .allow-interactivity-`).concat(i,` {pointer-events: all;}
`)},hle=0,Jc=[];function dle(i){var e=k.useRef([]),t=k.useRef([0,0]),n=k.useRef(),r=k.useState(hle++)[0],s=k.useState(function(){return MN()})[0],o=k.useRef(i);k.useEffect(function(){o.current=i},[i]),k.useEffect(function(){if(i.inert){document.body.classList.add("block-interactivity-".concat(r));var p=kae([i.lockRef.current],(i.shards||[]).map(HN),!0).filter(Boolean);return p.forEach(function(y){return y.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),p.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(r))})}}},[i.inert,i.lockRef.current,i.shards]);var a=k.useCallback(function(p,y){if("touches"in p&&p.touches.length===2)return!o.current.allowPinchZoom;var v=Pm(p),E=t.current,I="deltaX"in p?p.deltaX:E[0]-v[0],C="deltaY"in p?p.deltaY:E[1]-v[1],w,S=p.target,x=Math.abs(I)>Math.abs(C)?"h":"v";if("touches"in p&&x==="h"&&S.type==="range")return!1;var T=NN(x,S);if(!T)return!0;if(T?w=x:(w=x==="v"?"h":"v",T=NN(x,S)),!T)return!1;if(!n.current&&"changedTouches"in p&&(I||C)&&(n.current=w),!w)return!0;var Q=n.current||w;return lle(Q,y,p,Q==="h"?I:C,!0)},[]),l=k.useCallback(function(p){var y=p;if(!(!Jc.length||Jc[Jc.length-1]!==s)){var v="deltaY"in y?GN(y):Pm(y),E=e.current.filter(function(w){return w.name===y.type&&w.target===y.target&&ule(w.delta,v)})[0];if(E&&E.should){y.cancelable&&y.preventDefault();return}if(!E){var I=(o.current.shards||[]).map(HN).filter(Boolean).filter(function(w){return w.contains(y.target)}),C=I.length>0?a(y,I[0]):!o.current.noIsolation;C&&y.cancelable&&y.preventDefault()}}},[]),u=k.useCallback(function(p,y,v,E){var I={name:p,delta:y,target:v,should:E};e.current.push(I),setTimeout(function(){e.current=e.current.filter(function(C){return C!==I})},1)},[]),c=k.useCallback(function(p){t.current=Pm(p),n.current=void 0},[]),h=k.useCallback(function(p){u(p.type,GN(p),p.target,a(p,i.lockRef.current))},[]),d=k.useCallback(function(p){u(p.type,Pm(p),p.target,a(p,i.lockRef.current))},[]);k.useEffect(function(){return Jc.push(s),i.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",l,Xc),document.addEventListener("touchmove",l,Xc),document.addEventListener("touchstart",c,Xc),function(){Jc=Jc.filter(function(p){return p!==s}),document.removeEventListener("wheel",l,Xc),document.removeEventListener("touchmove",l,Xc),document.removeEventListener("touchstart",c,Xc)}},[]);var g=i.removeScrollBar,A=i.inert;return k.createElement(k.Fragment,null,A?k.createElement(s,{styles:cle(r)}):null,g?k.createElement(tle,{gapMode:"margin"}):null)}const fle=Hae(PN,dle);var Uw=k.forwardRef(function(i,e){return k.createElement(Dm,Is({},i,{ref:e,sideCar:fle}))});Uw.classNames=Dm.classNames;const zN="Popover",[VN,Cye]=Or(zN,[Sm]),Mm=Sm(),[gle,eh]=VN(zN),Ale=i=>{const{__scopePopover:e,children:t,open:n,defaultOpen:r,onOpenChange:s,modal:o=!1}=i,a=Mm(e),l=k.useRef(null),[u,c]=k.useState(!1),[h=!1,d]=va({prop:n,defaultProp:r,onChange:s});return k.createElement(bN,a,k.createElement(gle,{scope:e,contentId:Ea(),triggerRef:l,open:h,onOpenChange:d,onOpenToggle:k.useCallback(()=>d(g=>!g),[d]),hasCustomAnchor:u,onCustomAnchorAdd:k.useCallback(()=>c(!0),[]),onCustomAnchorRemove:k.useCallback(()=>c(!1),[]),modal:o},t))},ple="PopoverTrigger",mle=k.forwardRef((i,e)=>{const{__scopePopover:t,...n}=i,r=eh(ple,t),s=Mm(t),o=Gt(e,r.triggerRef),a=k.createElement(ht.button,Be({type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":$N(r.open)},n,{ref:o,onClick:tt(i.onClick,r.onOpenToggle)}));return r.hasCustomAnchor?a:k.createElement(SN,Be({asChild:!0},s),a)}),yle="PopoverPortal",[wye,vle]=VN(yle,{forceMount:void 0}),zf="PopoverContent",Ele=k.forwardRef((i,e)=>{const t=vle(zf,i.__scopePopover),{forceMount:n=t.forceMount,...r}=i,s=eh(zf,i.__scopePopover);return k.createElement(tp,{present:n||s.open},s.modal?k.createElement(Ile,Be({},r,{ref:e})):k.createElement(_le,Be({},r,{ref:e})))}),Ile=k.forwardRef((i,e)=>{const t=eh(zf,i.__scopePopover),n=k.useRef(null),r=Gt(e,n),s=k.useRef(!1);return k.useEffect(()=>{const o=n.current;if(o)return RN(o)},[]),k.createElement(Uw,{as:Ec,allowPinchZoom:!0},k.createElement(qN,Be({},i,{ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:tt(i.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=t.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:tt(i.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,u=a.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:tt(i.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})))}),_le=k.forwardRef((i,e)=>{const t=eh(zf,i.__scopePopover),n=k.useRef(!1),r=k.useRef(!1);return k.createElement(qN,Be({},i,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o;if((o=i.onCloseAutoFocus)===null||o===void 0||o.call(i,s),!s.defaultPrevented){var a;n.current||(a=t.triggerRef.current)===null||a===void 0||a.focus(),s.preventDefault()}n.current=!1,r.current=!1},onInteractOutside:s=>{var o,a;(o=i.onInteractOutside)===null||o===void 0||o.call(i,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const l=s.target;((a=t.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}}))}),qN=k.forwardRef((i,e)=>{const{__scopePopover:t,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:c,...h}=i,d=eh(zf,t),g=Mm(t);return jO(),k.createElement(YO,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:s},k.createElement(VO,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:c,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>d.onOpenChange(!1)},k.createElement(TN,Be({"data-state":$N(d.open),role:"dialog",id:d.contentId},g,h,{ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))}),Cle="PopoverClose",wle=k.forwardRef((i,e)=>{const{__scopePopover:t,...n}=i,r=eh(Cle,t);return k.createElement(ht.button,Be({type:"button"},n,{ref:e,onClick:tt(i.onClick,()=>r.onOpenChange(!1))}))}),xle=k.forwardRef((i,e)=>{const{__scopePopover:t,...n}=i,r=Mm(t);return k.createElement(Tae,Be({},r,n,{ref:e}))});function $N(i){return i?"open":"closed"}const ble=Ale,Sle=mle,Tle=Ele,Ble=wle,Rle=xle;function jN(i,[e,t]){return Math.min(t,Math.max(e,i))}const Lle=k.forwardRef((i,e)=>k.createElement(ht.span,Be({},i,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...i.style}}))),Dle=[" ","Enter","ArrowUp","ArrowDown"],kle=[" ","Enter"],Fm="Select",[Om,Nm,Ple]=vP(Fm),[th,xye]=Or(Fm,[Ple,Sm]),Gw=Sm(),[Mle,Ml]=th(Fm),[Fle,Ole]=th(Fm),Nle=i=>{const{__scopeSelect:e,children:t,open:n,defaultOpen:r,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:u,name:c,autoComplete:h,disabled:d,required:g}=i,A=Gw(e),[p,y]=k.useState(null),[v,E]=k.useState(null),[I,C]=k.useState(!1),w=rp(u),[S=!1,x]=va({prop:n,defaultProp:r,onChange:s}),[T,Q]=va({prop:o,defaultProp:a,onChange:l}),M=k.useRef(null),R=p?!!p.closest("form"):!0,[z,q]=k.useState(new Set),X=Array.from(z).map(N=>N.props.value).join(";");return k.createElement(bN,A,k.createElement(Mle,{required:g,scope:e,trigger:p,onTriggerChange:y,valueNode:v,onValueNodeChange:E,valueNodeHasChildren:I,onValueNodeHasChildrenChange:C,contentId:Ea(),value:T,onValueChange:Q,open:S,onOpenChange:x,dir:w,triggerPointerDownPosRef:M,disabled:d},k.createElement(Om.Provider,{scope:e},k.createElement(Fle,{scope:i.__scopeSelect,onNativeOptionAdd:k.useCallback(N=>{q(G=>new Set(G).add(N))},[]),onNativeOptionRemove:k.useCallback(N=>{q(G=>{const j=new Set(G);return j.delete(N),j})},[])},t)),R?k.createElement(iQ,{key:X,"aria-hidden":!0,required:g,tabIndex:-1,name:c,autoComplete:h,value:T,onChange:N=>Q(N.target.value),disabled:d},T===void 0?k.createElement("option",{value:""}):null,Array.from(z)):null))},Qle="SelectTrigger",Ule=k.forwardRef((i,e)=>{const{__scopeSelect:t,disabled:n=!1,...r}=i,s=Gw(t),o=Ml(Qle,t),a=o.disabled||n,l=Gt(e,o.onTriggerChange),u=Nm(t),[c,h,d]=nQ(A=>{const p=u().filter(E=>!E.disabled),y=p.find(E=>E.value===o.value),v=rQ(p,A,y);v!==void 0&&o.onValueChange(v.value)}),g=()=>{a||(o.onOpenChange(!0),d())};return k.createElement(SN,Be({asChild:!0},s),k.createElement(ht.button,Be({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":tQ(o.value)?"":void 0},r,{ref:l,onClick:tt(r.onClick,A=>{A.currentTarget.focus()}),onPointerDown:tt(r.onPointerDown,A=>{const p=A.target;p.hasPointerCapture(A.pointerId)&&p.releasePointerCapture(A.pointerId),A.button===0&&A.ctrlKey===!1&&(g(),o.triggerPointerDownPosRef.current={x:Math.round(A.pageX),y:Math.round(A.pageY)},A.preventDefault())}),onKeyDown:tt(r.onKeyDown,A=>{const p=c.current!=="";!(A.ctrlKey||A.altKey||A.metaKey)&&A.key.length===1&&h(A.key),!(p&&A.key===" ")&&Dle.includes(A.key)&&(g(),A.preventDefault())})})))}),Gle="SelectValue",Hle=k.forwardRef((i,e)=>{const{__scopeSelect:t,className:n,style:r,children:s,placeholder:o="",...a}=i,l=Ml(Gle,t),{onValueNodeHasChildrenChange:u}=l,c=s!==void 0,h=Gt(e,l.onValueNodeChange);return pn(()=>{u(c)},[u,c]),k.createElement(ht.span,Be({},a,{ref:h,style:{pointerEvents:"none"}}),tQ(l.value)?k.createElement(k.Fragment,null,o):s)}),zle=k.forwardRef((i,e)=>{const{__scopeSelect:t,children:n,...r}=i;return k.createElement(ht.span,Be({"aria-hidden":!0},r,{ref:e}),n||"▼")}),Vle=i=>k.createElement(Bae,Be({asChild:!0},i)),ih="SelectContent",qle=k.forwardRef((i,e)=>{const t=Ml(ih,i.__scopeSelect),[n,r]=k.useState();if(pn(()=>{r(new DocumentFragment)},[]),!t.open){const s=n;return s?pl.createPortal(k.createElement(WN,{scope:i.__scopeSelect},k.createElement(Om.Slot,{scope:i.__scopeSelect},k.createElement("div",null,i.children))),s):null}return k.createElement($le,Be({},i,{ref:e}))}),Ao=10,[WN,Fl]=th(ih),$le=k.forwardRef((i,e)=>{const{__scopeSelect:t,position:n="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:h,collisionBoundary:d,collisionPadding:g,sticky:A,hideWhenDetached:p,avoidCollisions:y,...v}=i,E=Ml(ih,t),[I,C]=k.useState(null),[w,S]=k.useState(null),x=Gt(e,fe=>C(fe)),[T,Q]=k.useState(null),[M,R]=k.useState(null),z=Nm(t),[q,X]=k.useState(!1),N=k.useRef(!1);k.useEffect(()=>{if(I)return RN(I)},[I]),jO();const G=k.useCallback(fe=>{const[me,...Pe]=z().map(Oe=>Oe.ref.current),[Re]=Pe.slice(-1),Qe=document.activeElement;for(const Oe of fe)if(Oe===Qe||(Oe==null||Oe.scrollIntoView({block:"nearest"}),Oe===me&&w&&(w.scrollTop=0),Oe===Re&&w&&(w.scrollTop=w.scrollHeight),Oe==null||Oe.focus(),document.activeElement!==Qe))return},[z,w]),j=k.useCallback(()=>G([T,I]),[G,T,I]);k.useEffect(()=>{q&&j()},[q,j]);const{onOpenChange:V,triggerPointerDownPosRef:Z}=E;k.useEffect(()=>{if(I){let fe={x:0,y:0};const me=Re=>{var Qe,Oe,wt,ft;fe={x:Math.abs(Math.round(Re.pageX)-((Qe=(Oe=Z.current)===null||Oe===void 0?void 0:Oe.x)!==null&&Qe!==void 0?Qe:0)),y:Math.abs(Math.round(Re.pageY)-((wt=(ft=Z.current)===null||ft===void 0?void 0:ft.y)!==null&&wt!==void 0?wt:0))}},Pe=Re=>{fe.x<=10&&fe.y<=10?Re.preventDefault():I.contains(Re.target)||V(!1),document.removeEventListener("pointermove",me),Z.current=null};return Z.current!==null&&(document.addEventListener("pointermove",me),document.addEventListener("pointerup",Pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",me),document.removeEventListener("pointerup",Pe,{capture:!0})}}},[I,V,Z]),k.useEffect(()=>{const fe=()=>V(!1);return window.addEventListener("blur",fe),window.addEventListener("resize",fe),()=>{window.removeEventListener("blur",fe),window.removeEventListener("resize",fe)}},[V]);const[Y,te]=nQ(fe=>{const me=z().filter(Qe=>!Qe.disabled),Pe=me.find(Qe=>Qe.ref.current===document.activeElement),Re=rQ(me,fe,Pe);Re&&setTimeout(()=>Re.ref.current.focus())}),J=k.useCallback((fe,me,Pe)=>{const Re=!N.current&&!Pe;(E.value!==void 0&&E.value===me||Re)&&(Q(fe),Re&&(N.current=!0))},[E.value]),ce=k.useCallback(()=>I==null?void 0:I.focus(),[I]),ie=k.useCallback((fe,me,Pe)=>{const Re=!N.current&&!Pe;(E.value!==void 0&&E.value===me||Re)&&R(fe)},[E.value]),ne=n==="popper"?KN:jle,ue=ne===KN?{side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:h,collisionBoundary:d,collisionPadding:g,sticky:A,hideWhenDetached:p,avoidCollisions:y}:{};return k.createElement(WN,{scope:t,content:I,viewport:w,onViewportChange:S,itemRefCallback:J,selectedItem:T,onItemLeave:ce,itemTextRefCallback:ie,focusSelectedItem:j,selectedItemText:M,position:n,isPositioned:q,searchRef:Y},k.createElement(Uw,{as:Ec,allowPinchZoom:!0},k.createElement(YO,{asChild:!0,trapped:E.open,onMountAutoFocus:fe=>{fe.preventDefault()},onUnmountAutoFocus:tt(r,fe=>{var me;(me=E.trigger)===null||me===void 0||me.focus({preventScroll:!0}),fe.preventDefault()})},k.createElement(VO,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:fe=>fe.preventDefault(),onDismiss:()=>E.onOpenChange(!1)},k.createElement(ne,Be({role:"listbox",id:E.contentId,"data-state":E.open?"open":"closed",dir:E.dir,onContextMenu:fe=>fe.preventDefault()},v,ue,{onPlaced:()=>X(!0),ref:x,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:tt(v.onKeyDown,fe=>{const me=fe.ctrlKey||fe.altKey||fe.metaKey;if(fe.key==="Tab"&&fe.preventDefault(),!me&&fe.key.length===1&&te(fe.key),["ArrowUp","ArrowDown","Home","End"].includes(fe.key)){let Re=z().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(fe.key)&&(Re=Re.slice().reverse()),["ArrowUp","ArrowDown"].includes(fe.key)){const Qe=fe.target,Oe=Re.indexOf(Qe);Re=Re.slice(Oe+1)}setTimeout(()=>G(Re)),fe.preventDefault()}})}))))))}),jle=k.forwardRef((i,e)=>{const{__scopeSelect:t,onPlaced:n,...r}=i,s=Ml(ih,t),o=Fl(ih,t),[a,l]=k.useState(null),[u,c]=k.useState(null),h=Gt(e,x=>c(x)),d=Nm(t),g=k.useRef(!1),A=k.useRef(!0),{viewport:p,selectedItem:y,selectedItemText:v,focusSelectedItem:E}=o,I=k.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&u&&p&&y&&v){const x=s.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),Q=s.valueNode.getBoundingClientRect(),M=v.getBoundingClientRect();if(s.dir!=="rtl"){const Qe=M.left-T.left,Oe=Q.left-Qe,wt=x.left-Oe,ft=x.width+wt,pt=Math.max(ft,T.width),at=window.innerWidth-Ao,D=jN(Oe,[Ao,at-pt]);a.style.minWidth=ft+"px",a.style.left=D+"px"}else{const Qe=T.right-M.right,Oe=window.innerWidth-Q.right-Qe,wt=window.innerWidth-x.right-Oe,ft=x.width+wt,pt=Math.max(ft,T.width),at=window.innerWidth-Ao,D=jN(Oe,[Ao,at-pt]);a.style.minWidth=ft+"px",a.style.right=D+"px"}const R=d(),z=window.innerHeight-Ao*2,q=p.scrollHeight,X=window.getComputedStyle(u),N=parseInt(X.borderTopWidth,10),G=parseInt(X.paddingTop,10),j=parseInt(X.borderBottomWidth,10),V=parseInt(X.paddingBottom,10),Z=N+G+q+V+j,Y=Math.min(y.offsetHeight*5,Z),te=window.getComputedStyle(p),J=parseInt(te.paddingTop,10),ce=parseInt(te.paddingBottom,10),ie=x.top+x.height/2-Ao,ne=z-ie,ue=y.offsetHeight/2,fe=y.offsetTop+ue,me=N+G+fe,Pe=Z-me;if(me<=ie){const Qe=y===R[R.length-1].ref.current;a.style.bottom="0px";const Oe=u.clientHeight-p.offsetTop-p.offsetHeight,wt=Math.max(ne,ue+(Qe?ce:0)+Oe+j),ft=me+wt;a.style.height=ft+"px"}else{const Qe=y===R[0].ref.current;a.style.top="0px";const wt=Math.max(ie,N+p.offsetTop+(Qe?J:0)+ue)+Pe;a.style.height=wt+"px",p.scrollTop=me-ie+p.offsetTop}a.style.margin=`${Ao}px 0`,a.style.minHeight=Y+"px",a.style.maxHeight=z+"px",n==null||n(),requestAnimationFrame(()=>g.current=!0)}},[d,s.trigger,s.valueNode,a,u,p,y,v,s.dir,n]);pn(()=>I(),[I]);const[C,w]=k.useState();pn(()=>{u&&w(window.getComputedStyle(u).zIndex)},[u]);const S=k.useCallback(x=>{x&&A.current===!0&&(I(),E==null||E(),A.current=!1)},[I,E]);return k.createElement(Wle,{scope:t,contentWrapper:a,shouldExpandOnScrollRef:g,onScrollButtonChange:S},k.createElement("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C}},k.createElement(ht.div,Be({},r,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}}))))}),KN=k.forwardRef((i,e)=>{const{__scopeSelect:t,align:n="start",collisionPadding:r=Ao,...s}=i,o=Gw(t);return k.createElement(TN,Be({},o,s,{ref:e,align:n,collisionPadding:r,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[Wle,Hw]=th(ih,{}),YN="SelectViewport",Kle=k.forwardRef((i,e)=>{const{__scopeSelect:t,...n}=i,r=Fl(YN,t),s=Hw(YN,t),o=Gt(e,r.onViewportChange),a=k.useRef(0);return k.createElement(k.Fragment,null,k.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),k.createElement(Om.Slot,{scope:t},k.createElement(ht.div,Be({"data-radix-select-viewport":"",role:"presentation"},n,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...n.style},onScroll:tt(n.onScroll,l=>{const u=l.currentTarget,{contentWrapper:c,shouldExpandOnScrollRef:h}=s;if(h!=null&&h.current&&c){const d=Math.abs(a.current-u.scrollTop);if(d>0){const g=window.innerHeight-Ao*2,A=parseFloat(c.style.minHeight),p=parseFloat(c.style.height),y=Math.max(A,p);if(y<g){const v=y+d,E=Math.min(g,v),I=v-E;c.style.height=E+"px",c.style.bottom==="0px"&&(u.scrollTop=I>0?I:0,c.style.justifyContent="flex-end")}}}a.current=u.scrollTop})}))))}),Yle="SelectGroup",[Zle,Xle]=th(Yle),Jle=k.forwardRef((i,e)=>{const{__scopeSelect:t,...n}=i,r=Ea();return k.createElement(Zle,{scope:t,id:r},k.createElement(ht.div,Be({role:"group","aria-labelledby":r},n,{ref:e})))}),eue="SelectLabel",tue=k.forwardRef((i,e)=>{const{__scopeSelect:t,...n}=i,r=Xle(eue,t);return k.createElement(ht.div,Be({id:r.id},n,{ref:e}))}),zw="SelectItem",[iue,ZN]=th(zw),nue=k.forwardRef((i,e)=>{const{__scopeSelect:t,value:n,disabled:r=!1,textValue:s,...o}=i,a=Ml(zw,t),l=Fl(zw,t),u=a.value===n,[c,h]=k.useState(s??""),[d,g]=k.useState(!1),A=Gt(e,v=>{var E;return(E=l.itemRefCallback)===null||E===void 0?void 0:E.call(l,v,n,r)}),p=Ea(),y=()=>{r||(a.onValueChange(n),a.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return k.createElement(iue,{scope:t,value:n,disabled:r,textId:p,isSelected:u,onItemTextChange:k.useCallback(v=>{h(E=>{var I;return E||((I=v==null?void 0:v.textContent)!==null&&I!==void 0?I:"").trim()})},[])},k.createElement(Om.ItemSlot,{scope:t,value:n,disabled:r,textValue:c},k.createElement(ht.div,Be({role:"option","aria-labelledby":p,"data-highlighted":d?"":void 0,"aria-selected":u&&d,"data-state":u?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1},o,{ref:A,onFocus:tt(o.onFocus,()=>g(!0)),onBlur:tt(o.onBlur,()=>g(!1)),onPointerUp:tt(o.onPointerUp,y),onPointerMove:tt(o.onPointerMove,v=>{if(r){var E;(E=l.onItemLeave)===null||E===void 0||E.call(l)}else v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:tt(o.onPointerLeave,v=>{if(v.currentTarget===document.activeElement){var E;(E=l.onItemLeave)===null||E===void 0||E.call(l)}}),onKeyDown:tt(o.onKeyDown,v=>{var E;((E=l.searchRef)===null||E===void 0?void 0:E.current)!==""&&v.key===" "||(kle.includes(v.key)&&y(),v.key===" "&&v.preventDefault())})}))))}),Qm="SelectItemText",rue=k.forwardRef((i,e)=>{const{__scopeSelect:t,className:n,style:r,...s}=i,o=Ml(Qm,t),a=Fl(Qm,t),l=ZN(Qm,t),u=Ole(Qm,t),[c,h]=k.useState(null),d=Gt(e,v=>h(v),l.onItemTextChange,v=>{var E;return(E=a.itemTextRefCallback)===null||E===void 0?void 0:E.call(a,v,l.value,l.disabled)}),g=c==null?void 0:c.textContent,A=k.useMemo(()=>k.createElement("option",{key:l.value,value:l.value,disabled:l.disabled},g),[l.disabled,l.value,g]),{onNativeOptionAdd:p,onNativeOptionRemove:y}=u;return pn(()=>(p(A),()=>y(A)),[p,y,A]),k.createElement(k.Fragment,null,k.createElement(ht.span,Be({id:l.textId},s,{ref:d})),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?pl.createPortal(s.children,o.valueNode):null)}),sue="SelectItemIndicator",oue=k.forwardRef((i,e)=>{const{__scopeSelect:t,...n}=i;return ZN(sue,t).isSelected?k.createElement(ht.span,Be({"aria-hidden":!0},n,{ref:e})):null}),XN="SelectScrollUpButton",aue=k.forwardRef((i,e)=>{const t=Fl(XN,i.__scopeSelect),n=Hw(XN,i.__scopeSelect),[r,s]=k.useState(!1),o=Gt(e,n.onScrollButtonChange);return pn(()=>{if(t.viewport&&t.isPositioned){let l=function(){const u=a.scrollTop>0;s(u)};const a=t.viewport;return l(),a.addEventListener("scroll",l),()=>a.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),r?k.createElement(eQ,Be({},i,{ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}})):null}),JN="SelectScrollDownButton",lue=k.forwardRef((i,e)=>{const t=Fl(JN,i.__scopeSelect),n=Hw(JN,i.__scopeSelect),[r,s]=k.useState(!1),o=Gt(e,n.onScrollButtonChange);return pn(()=>{if(t.viewport&&t.isPositioned){let l=function(){const u=a.scrollHeight-a.clientHeight,c=Math.ceil(a.scrollTop)<u;s(c)};const a=t.viewport;return l(),a.addEventListener("scroll",l),()=>a.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),r?k.createElement(eQ,Be({},i,{ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}})):null}),eQ=k.forwardRef((i,e)=>{const{__scopeSelect:t,onAutoScroll:n,...r}=i,s=Fl("SelectScrollButton",t),o=k.useRef(null),a=Nm(t),l=k.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return k.useEffect(()=>()=>l(),[l]),pn(()=>{var u;const c=a().find(h=>h.ref.current===document.activeElement);c==null||(u=c.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[a]),k.createElement(ht.div,Be({"aria-hidden":!0},r,{ref:e,style:{flexShrink:0,...r.style},onPointerDown:tt(r.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:tt(r.onPointerMove,()=>{var u;(u=s.onItemLeave)===null||u===void 0||u.call(s),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:tt(r.onPointerLeave,()=>{l()})}))});function tQ(i){return i===""||i===void 0}const iQ=k.forwardRef((i,e)=>{const{value:t,...n}=i,r=k.useRef(null),s=Gt(e,r),o=B_(t);return k.useEffect(()=>{const a=r.current,l=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==t&&c){const h=new Event("change",{bubbles:!0});c.call(a,t),a.dispatchEvent(h)}},[o,t]),k.createElement(Lle,{asChild:!0},k.createElement("select",Be({},n,{ref:s,defaultValue:t})))});iQ.displayName="BubbleSelect";function nQ(i){const e=ls(i),t=k.useRef(""),n=k.useRef(0),r=k.useCallback(o=>{const a=t.current+o;e(a),function l(u){t.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=k.useCallback(()=>{t.current="",window.clearTimeout(n.current)},[]);return k.useEffect(()=>()=>window.clearTimeout(n.current),[]),[t,r,s]}function rQ(i,e,t){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=t?i.indexOf(t):-1;let o=uue(i,Math.max(s,0));r.length===1&&(o=o.filter(u=>u!==t));const l=o.find(u=>u.textValue.toLowerCase().startsWith(r.toLowerCase()));return l!==t?l:void 0}function uue(i,e){return i.map((t,n)=>i[(e+n)%i.length])}const cue=Nle,hue=Ule,due=qle,fue=tue,gue=nue,sQ="Switch",[Aue,bye]=Or(sQ),[pue,mue]=Aue(sQ),yue=k.forwardRef((i,e)=>{const{__scopeSwitch:t,name:n,checked:r,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:u,...c}=i,[h,d]=k.useState(null),g=Gt(e,E=>d(E)),A=k.useRef(!1),p=h?!!h.closest("form"):!0,[y=!1,v]=va({prop:r,defaultProp:s,onChange:u});return k.createElement(pue,{scope:t,checked:y,disabled:a},k.createElement(ht.button,Be({type:"button",role:"switch","aria-checked":y,"aria-required":o,"data-state":oQ(y),"data-disabled":a?"":void 0,disabled:a,value:l},c,{ref:g,onClick:tt(i.onClick,E=>{v(I=>!I),p&&(A.current=E.isPropagationStopped(),A.current||E.stopPropagation())})})),p&&k.createElement(Iue,{control:h,bubbles:!A.current,name:n,value:l,checked:y,required:o,disabled:a,style:{transform:"translateX(-100%)"}}))}),vue="SwitchThumb",Eue=k.forwardRef((i,e)=>{const{__scopeSwitch:t,...n}=i,r=mue(vue,t);return k.createElement(ht.span,Be({"data-state":oQ(r.checked),"data-disabled":r.disabled?"":void 0},n,{ref:e}))}),Iue=i=>{const{control:e,checked:t,bubbles:n=!0,...r}=i,s=k.useRef(null),o=B_(t),a=T_(e);return k.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==t&&h){const d=new Event("click",{bubbles:n});h.call(l,t),l.dispatchEvent(d)}},[o,t,n]),k.createElement("input",Be({type:"checkbox","aria-hidden":!0,defaultChecked:t},r,{tabIndex:-1,ref:s,style:{...i.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function oQ(i){return i?"checked":"unchecked"}const _ue=yue,Cue=Eue,wue=i=>{const e=i.toString().split(":"),t=Math.ceil(parseInt(e[0])),n=Math.ceil(parseInt(e[1])),r=bue(Math.ceil(parseInt(e[2])),2);let s=`${t!==0&&n<10?(n+"").padStart(2,"0"):n}:${r}`;return t!==0&&(s=`${t}:${s}`),s},aQ=i=>{const e=new Date(i*1e3).toISOString().substr(11,8);return wue(e)},lQ=(i,e)=>{if(typeof i!="object"||i===null)return e;for(const t in e)typeof e[t]=="object"&&e[t]!==null&&!Array.isArray(e[t])?(i[t]||(i[t]={}),i[t]=lQ(i[t],e[t])):i[t]=e[t];return i},xue=i=>i.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0),uQ=(i,e)=>Object.hasOwn(i,e)?i[e].toString():void 0,bue=(i,e)=>String(i).padStart(e,"0"),Sue={behavior:"smooth",block:"center"},nh={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:Sue}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1,localeText:{contentSearch:{tabLabel:"Search Results",formPlaceholder:"Enter search words",noSearchResults:"No search results",loading:"Loading...",moreResults:"more results"}}};function cQ(i){let e={...nh.informationPanel.vtt.autoScroll};return typeof i=="object"&&(e="enabled"in i?i:{enabled:!0,settings:i}),i===!1&&(e.enabled=!1),Tue(e.settings),e}function Tue({behavior:i,block:e}){const t=["auto","instant","smooth"],n=["center","end","nearest","start"];if(!t.includes(i))throw TypeError(`'${i}' not in ${t.join(" | ")}`);if(!n.includes(e))throw TypeError(`'${e}' not in ${n.join(" | ")}`)}var hQ,dQ;const Bue=cQ((dQ=(hQ=nh==null?void 0:nh.informationPanel)==null?void 0:hQ.vtt)==null?void 0:dQ.autoScroll);var fQ;const Um={activeCanvas:"",activeManifest:"",OSDImageLoaded:!1,collection:{},configOptions:nh,customDisplays:[],plugins:[],isAutoScrollEnabled:Bue.enabled,isAutoScrolling:!1,isInformationOpen:(fQ=nh==null?void 0:nh.informationPanel)==null?void 0:fQ.open,isLoaded:!1,isUserScrolling:void 0,vault:new Af,contentSearchVault:new Af,openSeadragonViewer:null,viewerId:vc()},gQ=P.createContext(Um),AQ=P.createContext(Um);function Rue(i,e){switch(e.type){case"updateActiveCanvas":return e.canvasId||(e.canvasId=""),{...i,activeCanvas:e.canvasId};case"updateActiveManifest":return{...i,activeManifest:e.manifestId};case"updateOSDImageLoaded":return{...i,OSDImageLoaded:e.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...i,isAutoScrollEnabled:e.isAutoScrollEnabled};case"updateAutoScrolling":return{...i,isAutoScrolling:e.isAutoScrolling};case"updateCollection":return{...i,collection:e.collection};case"updateConfigOptions":return{...i,configOptions:lQ(i.configOptions,e.configOptions)};case"updateInformationOpen":return{...i,isInformationOpen:e.isInformationOpen};case"updateIsLoaded":return{...i,isLoaded:e.isLoaded};case"updateUserScrolling":return{...i,isUserScrolling:e.isUserScrolling};case"updateOpenSeadragonViewer":return{...i,openSeadragonViewer:e.openSeadragonViewer};case"updateViewerId":return{...i,viewerId:e.viewerId};default:throw new Error(`Unhandled action type: ${e.type}`)}}const Lue=({initialState:i=Um,children:e})=>{const[t,n]=k.useReducer(Rue,i);return P.createElement(gQ.Provider,{value:t},P.createElement(AQ.Provider,{value:n},e))};function ni(){const i=P.useContext(gQ);if(i===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return i}function Ar(){const i=P.useContext(AQ);if(i===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return i}const Due=async(i,e)=>{const t=i.get({id:e,type:"Canvas"});if(!(t!=null&&t.annotations)||!t.annotations[0])return[];const n=i.get(t.annotations).filter(s=>s.items?s:!1),r=[];for(const s of n)if(s.items.length>0){const o=s.label||{none:["Annotations"]};r.push({...s,label:o})}else{let o={};try{o=await i.load(s.id)}catch(a){console.log(a)}if(o.items&&o.items.length>0){const a=o.label||{none:["Annotations"]};r.push({...o,label:a})}}return r},pQ=async(i,e,t,n)=>{if(n==null||n.q==null)return{label:{none:[t]}};const r=`${e}?q=${n.q.trim()}`;let s;try{s=await i.load(r)}catch{return console.log("Could not load content search."),{}}return s.label==null&&(s.label={none:[t]}),s},mQ=(i,e,t,n)=>{var r,s;const o={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},a=l=>{if(l){if(!l.body||!l.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",l);return}let u=l.body;Array.isArray(u)&&(u=u[0]);const c=i.get(u.id);if(!c)return;switch(t){case"painting":return l.target===e.id&&l.motivation&&l.motivation[0]==="painting"&&n.includes(c.type)&&(l.body=c),!!l;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};if(o.canvas=i.get(e),o.canvas&&(o.annotationPage=i.get(o.canvas.items[0]),o.accompanyingCanvas=(r=o.canvas)!=null&&r.accompanyingCanvas?i.get((s=o.canvas)==null?void 0:s.accompanyingCanvas):void 0),o.annotationPage){const l=i.get(o.annotationPage.items).map(c=>({body:i.get(c.body[0].id),motivation:c.motivation,type:"Annotation"})),u=[];l.forEach(c=>{c.body.type==="Choice"?c.body.items.forEach(h=>u.push({...c,id:h.id,body:i.get(h.id)})):u.push(c)}),o.annotations=u.filter(a)}return o},rh=(i,e="en")=>{if(!i)return"";if(!i[e]){const t=Object.getOwnPropertyNames(i);if(t.length>0)return i[t[0]]}return i[e]},Gm=(i,e)=>{const t=mQ(i,{id:e,type:"Canvas"},"painting",["Image","Sound","Video"]);if(t.annotations.length!==0&&t.annotations&&t.annotations)return t.annotations.map(n=>n==null?void 0:n.body)},kue=(i,e,t,n)=>{const r=[];if(e.canvas&&e.canvas.thumbnail.length>0){const s=i.get(e.canvas.thumbnail[0]);r.push(s)}if(e.annotations[0]){if(e.annotations[0].thumbnail&&e.annotations[0].thumbnail.length>0){const o=i.get(e.annotations[0].thumbnail[0]);r.push(o)}if(!e.annotations[0].body)return;const s=e.annotations[0].body;s.type==="Image"&&r.push(s)}return r.length===0?void 0:{id:r[0].id,format:r[0].format,type:r[0].type,width:t,height:n}};let Ol=window.OpenSeadragon;if(!Ol&&(Ol=Ic,!Ol))throw new Error("OpenSeadragon is missing.");const yQ="http://www.w3.org/2000/svg";Ol.Viewer&&(Ol.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo?this._svgOverlayInfo:(this._svgOverlayInfo=new Vw(this),this._svgOverlayInfo)});const Vw=function(i){const e=this;this._viewer=i,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(yQ,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(yQ,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){e.resize()}),this._viewer.addHandler("open",function(){e.resize()}),this._viewer.addHandler("rotate",function(){e.resize()}),this._viewer.addHandler("flip",function(){e.resize()}),this._viewer.addHandler("resize",function(){e.resize()}),this.resize()};Vw.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));const i=this._viewer.viewport.pixelFromPoint(new Ol.Point(0,0),!0),e=this._viewer.viewport.getZoom(!0),t=this._viewer.viewport.getRotation(),n=this._viewer.viewport.getFlip(),r=this._viewer.viewport._containerInnerSize.x;let s=r*e;const o=s;n&&(s=-s,i.x=-i.x+r),this._node.setAttribute("transform","translate("+i.x+","+i.y+") scale("+s+","+o+") rotate("+t+")")},onClick:function(i,e){new Ol.MouseTracker({element:i,clickHandler:e}).setTracking(!0)}};const Pue=i=>new Vw(i),vQ=i=>{var e,t,n,r,s;let o={id:typeof i=="string"?i:i.source};if(typeof i=="string"){if(i.includes("#xywh=")){const a=i.split("#xywh=");if(a&&a[1]){const[l,u,c,h]=a[1].split(",").map(d=>Number(d));o={id:a[0],rect:{x:l,y:u,w:c,h}}}}else if(i.includes("#t=")){const a=i.split("#t=");a&&a[1]&&(o={id:a[0],t:a[1]})}}else if(typeof i=="object"){if(((e=i.selector)==null?void 0:e.type)==="PointSelector")o={id:i.source,point:{x:i.selector.x,y:i.selector.y}};else if(((t=i.selector)==null?void 0:t.type)==="SvgSelector")o={id:i.source,svg:i.selector.value};else if(((n=i.selector)==null?void 0:n.type)==="FragmentSelector"&&(r=i.selector)!=null&&r.value.includes("xywh=")&&i.source.type=="Canvas"&&i.source.id){const a=(s=i.selector)==null?void 0:s.value.split("xywh=");if(a&&a[1]){const[l,u,c,h]=a[1].split(",").map(d=>Number(d));o={id:i.source.id,rect:{x:l,y:u,w:c,h}}}}}return o},Mue=i=>fetch(`${i.replace(/\/$/,"")}/info.json`).then(e=>e.json()).then(e=>e).catch(e=>{console.error(`The IIIF tilesource ${i.replace(/\/$/,"")}/info.json failed to load: ${e}`)}),Fue=i=>{let e,t;if(Array.isArray(i)&&(e=i[0],e)){let n;"@id"in e?n=e["@id"]:n=e.id,t=n}return t},qw=i=>{var e;let t,n;if(Uue(i))t=i,n={};else{const r=JSON.parse(AY(i));switch(r==null?void 0:r.type){case"SpecificResource":case"Range":case"Annotation":t=r==null?void 0:r.target.partOf[0].id,n={manifest:t,canvas:r==null?void 0:r.target.id};break;case"Canvas":t=r==null?void 0:r.partOf[0].id,n={manifest:t,canvas:r==null?void 0:r.id};break;case"Manifest":t=r==null?void 0:r.id,n={collection:(e=r==null?void 0:r.partOf[0])==null?void 0:e.id,manifest:r==null?void 0:r.id};break;case"Collection":t=r==null?void 0:r.id,n={collection:t};break}}return{resourceId:t,active:n}},Oue=i=>{const{resourceId:e,active:t}=qw(i);return t.collection||t.manifest||e},Nue=(i,e)=>{const t=e.items.map(s=>s.id),{active:n}=qw(i),r=n.canvas;return t.includes(r)?r:t[0]},Que=(i,e)=>{const{active:t}=qw(i),n=t.manifest,r=e.items.filter(s=>s.type==="Manifest").map(s=>s.id);return r.length==0?null:r.includes(n)?n:r[0]},Uue=i=>{try{new URL(i)}catch{return!1}return!0};var Vf=(i=>(i.TiledImage="tiledImage",i.SimpleImage="simpleImage",i))(Vf||{});function EQ(i,e,t,n,r){if(!i)return;const s=1/e.width;n.forEach(o=>{if(!o.target)return;const a=vQ(o.target),{point:l,rect:u,svg:c}=a;if(u){const{x:h,y:d,w:g,h:A}=u;Hue(i,h*s,d*s,g*s,A*s,t,r)}if(l){const{x:h,y:d}=l,g=`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${h}" cy="${d}" r="20" />
        </svg>
      `;IQ(i,g,t,s,r)}c&&IQ(i,c,t,s,r)})}function Gue(i,e,t){let n,r,s=40,o=40;e.rect&&(n=e.rect.x,r=e.rect.y,s=e.rect.w,o=e.rect.h),e.point&&(n=e.point.x,r=e.point.y);const a=1/i.width;return new Ic.Rect(n*a-s*a/2*(t-1),r*a-o*a/2*(t-1),s*a*t,o*a*t)}function Hue(i,e,t,n,r,s,o){const a=new Ic.Rect(e,t,n,r),l=document.createElement("div");if(s){const{backgroundColor:u,opacity:c,borderType:h,borderColor:d,borderWidth:g}=s;l.style.backgroundColor=u,l.style.opacity=c,l.style.border=`${h} ${g} ${d}`,l.className=o}i.addOverlay(l,a)}function zue(i){if(!i)return null;const e=document.createElement("template");return e.innerHTML=i.trim(),e.content.children[0]}function IQ(i,e,t,n,r){const s=zue(e);if(s)for(const o of s.children)_Q(i,o,t,n,r)}function _Q(i,e,t,n,r){var s;if(e.nodeName==="#text")que(e);else{const o=Vue(e,t,n),a=Pue(i);a.node().append(o),(s=a._svg)==null||s.setAttribute("class",r),e.childNodes.forEach(l=>{_Q(i,l,t,n,r)})}}function Vue(i,e,t){let n=!1,r=!1,s=!1,o=!1;const a=document.createElementNS("http://www.w3.org/2000/svg",i.nodeName);if(i.attributes.length>0)for(let l=0;l<i.attributes.length;l++){const u=i.attributes[l];switch(u.name){case"fill":s=!0;break;case"stroke":n=!0;break;case"stroke-width":r=!0;break;case"fill-opacity":o=!0;break}a.setAttribute(u.name,u.textContent)}return n||(a.style.stroke=e==null?void 0:e.borderColor),r||(a.style.strokeWidth=e==null?void 0:e.borderWidth),s||(a.style.fill=e==null?void 0:e.backgroundColor),o||(a.style.fillOpacity=e==null?void 0:e.opacity),a.setAttribute("transform",`scale(${t})`),a}function que(i){i.textContent&&(i.textContent.includes(`
`)||console.log("nodeName:",i.nodeName,", textContent:",i.textContent,", childNodes.length",i.childNodes.length))}const $ue=i=>{const e=Array.isArray(i==null?void 0:i.service)&&(i==null?void 0:i.service.length)>0,t=e?Fue(i==null?void 0:i.service):i==null?void 0:i.id,n=e?Vf.TiledImage:Vf.SimpleImage;return{uri:t,imageType:n}},jue=(i,e)=>{const t=e?Vf.TiledImage:Vf.SimpleImage;return{uri:i,imageType:t}};function CQ(i,e){if(!i)return;e.startsWith(".")||(e="."+e);const t=document.querySelectorAll(e);t&&t.forEach(n=>i.removeOverlay(n))}function $w(i,e,t,n){const r=vQ(t),{point:s,rect:o,svg:a}=r;if(s||o||a){const l=Gue(n,r,e);i==null||i.viewport.fitBounds(l)}}function Wue(i,e,t,n,r){var s;if(!(e!=null&&e.items)||(e==null?void 0:e.items.length)===0)return;const o=[];e.items.forEach(a=>{const l=i.get(a.id);typeof l.target=="string"&&l.target.startsWith(n.id)&&o.push(l)}),t&&(s=r.contentSearch)!=null&&s.overlays&&EQ(t,n,r.contentSearch.overlays,o,"content-search-overlay")}const jw=209,Kue={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${jw} 100% 38.2%)`,accentMuted:`hsl(${jw} 80% 61.8%)`,accentAlt:`hsl(${jw} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},Ww={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:we,css:Sye,keyframes:Kw,createTheme:Tye}=C_({theme:Kue,media:Ww}),Yue=we("div",{display:"flex",flexDirection:"column",alignItems:"center"}),Zue=we("p",{fontWeight:"bold",fontSize:"x-large"}),Xue=we("span",{fontSize:"medium"}),Yw=({error:i})=>{const{message:e}=i;return P.createElement(Yue,{role:"alert"},P.createElement(Zue,{"data-testid":"headline"},"Something went wrong"),e&&P.createElement(Xue,null,`Error message: ${e}`," "))},wQ=we("div",{position:"relative",zIndex:"0"}),xQ=we("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden","@sm":{flexDirection:"column"}}),bQ=we("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),SQ=we(dY,{display:"none",border:"none",padding:"0",transition:"$all",opacity:"1",background:"#6663",margin:"1rem 0",borderRadius:"6px","&[data-information-panel='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",fontSize:"0.8333em",justifyContent:"center",padding:"0.5rem",fontFamily:"inherit"}}}),TQ=we(fY,{width:"100%",display:"flex"}),Jue=we("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),ece=we("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${xQ}`]:{flexGrow:"1"},[`& ${bQ}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${wQ}`]:{display:"none"},[`& ${SQ}`]:{margin:"1rem"},[`& ${TQ}`]:{height:"100%"}}}}),tce=we(mZ,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),ice=we(yZ,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),Hm=we(vZ,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),zm=we(EZ,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),nce=({handleScroll:i,children:e,className:t})=>P.createElement("div",{className:t,onScroll:i},e),rce=we(nce,{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),BQ={position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none"},RQ=we("button",{textAlign:"left","&:hover":{color:"$accent"}}),sce=we("div",{display:"flex",flexDirection:"column",width:"100%"}),oce=we("div",{...BQ}),ace=we("div",{"&:hover":{color:"$accent"}}),LQ=({value:i,handleClick:e})=>P.createElement(RQ,{onClick:e},i),lce=({value:i,handleClick:e})=>P.createElement(ace,{dangerouslySetInnerHTML:{__html:i},onClick:e}),uce=()=>{function i(r){return r.map(s=>{const o=s.identifier||vc();return{...s,identifier:o}})}function e(r){var s;const o=[],a=[],l=i(r);for(const u of l){for(;a.length>0&&a[a.length-1].end<=u.start;)a.pop();a.length>0?(a[a.length-1].children||(a[a.length-1].children=[]),(s=a[a.length-1].children)==null||s.push(u),a.push(u)):(o.push(u),a.push(u))}return o}function t(r,s=[]){return s.some(o=>r.start>=o.start&&r.end<=o.end)}function n(r=[]){return r.sort((s,o)=>s.start-o.start)}return{addIdentifiersToParsedCues:i,createNestedCues:e,isChild:t,orderCuesByTime:n}},DQ=Kw({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),cce=we(DP,{display:"flex",flexDirection:"column",width:"100%"}),kQ=we(kP,{...BQ,"@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:DQ,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:DQ,boxSizing:"content-box","@sm":{content:"unset"}}}}),hce=750,dce=i=>{for(;i&&i!==document.body;){const e=window.getComputedStyle(i).overflowY;if(e!=="visible"&&e!=="hidden"&&i.scrollHeight>i.clientHeight)return i;i=i.parentNode}return null},fce=({label:i,start:e,end:t})=>{var n,r;const s=Ar(),{configOptions:o,isAutoScrollEnabled:a,isUserScrolling:l}=ni(),u=(r=(n=o==null?void 0:o.informationPanel)==null?void 0:n.vtt)==null?void 0:r.autoScroll,[c,h]=k.useState(!1),d=k.useRef(null),g=document.getElementById("clover-iiif-video");k.useEffect(()=>(g==null||g.addEventListener("timeupdate",()=>{const{currentTime:p}=g;h(e<=p&&p<t)}),()=>document.removeEventListener("timeupdate",()=>{})),[t,e,g]),k.useEffect(()=>{var p;const y=v=>{s({type:"updateAutoScrolling",isAutoScrolling:!0}),v(),setTimeout(()=>s({type:"updateAutoScrolling",isAutoScrolling:!1}),hce)};if(a&&c&&d.current&&!l){const v=d.current;if(v&&v instanceof HTMLElement){const E=dce(v);if(E&&E instanceof HTMLElement){let I;switch((p=u==null?void 0:u.settings)==null?void 0:p.block){case"center":const C=E.getBoundingClientRect();I=v.offsetTop+v.offsetHeight-Math.floor((C.bottom-C.top)/2);break;case"end":I=v.offsetTop+v.offsetHeight-(E.clientHeight-v.clientHeight)+2;break;default:I=v.offsetTop-2;break}y(()=>{var C;return E.scrollTo({top:I,left:0,behavior:(C=u==null?void 0:u.settings)==null?void 0:C.behavior})})}}}},[u,c,l,a,s]);const A=()=>{g&&(g.pause(),g.currentTime=e,g.play())};return P.createElement(kQ,{ref:d,"aria-checked":c,"data-testid":"information-panel-cue",onClick:A,value:i},i,P.createElement("strong",null,aQ(e)))},gce=we("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${kQ}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),PQ=({items:i})=>P.createElement(gce,null,i.map(e=>{const{text:t,start:n,end:r,children:s,identifier:o}=e;return P.createElement("li",{key:o},P.createElement(fce,{label:t,start:n,end:r}),s&&P.createElement(PQ,{items:s}))})),Ace=({label:i,vttUri:e})=>{const[t,n]=P.useState([]),{createNestedCues:r,orderCuesByTime:s}=uce(),[o,a]=P.useState();return k.useEffect(()=>{e&&fetch(e,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(l=>l.text()).then(l=>{const u=sX.parse(l).cues,c=s(u),h=r(c);n(h)}).catch(l=>{console.error(e,l.toString()),a(l)})},[e]),P.createElement(cce,{"data-testid":"annotation-item-vtt","aria-label":`navigate ${rh(i,"en")}`},o&&P.createElement("div",{"data-testid":"error-message"},"Network Error: ",o.toString()),P.createElement(PQ,{items:t}))},pce=({caption:i,handleClick:e,imageUri:t})=>P.createElement(RQ,{onClick:e},P.createElement("img",{src:t,alt:`A visual annotation for ${i}`}),P.createElement("span",null,i)),mce=({annotation:i})=>{var e,t;const{target:n}=i,r=ni(),{openSeadragonViewer:s,vault:o,activeCanvas:a,configOptions:l}=r,u=i.body.map(p=>o.get(p.id)),c=((e=u.find(p=>p.format))==null?void 0:e.format)||"",h=((t=u.find(p=>p.value))==null?void 0:t.value)||"",d=o.get({id:a,type:"Canvas"});function g(){var p;if(!n)return;const y=((p=l.annotationOverlays)==null?void 0:p.zoomLevel)||1;$w(s,y,n,d)}function A(){var p,y;switch(c){case"text/plain":return P.createElement(LQ,{value:h,handleClick:g});case"text/html":return P.createElement(lce,{value:h,handleClick:g});case"text/vtt":return P.createElement(Ace,{label:u[0].label,vttUri:u[0].id||""});case((p=c.match(/^image\//))==null?void 0:p.input):const v=((y=u.find(E=>{var I;return!((I=E.id)!=null&&I.includes("vault://"))}))==null?void 0:y.id)||"";return P.createElement(pce,{caption:h,handleClick:g,imageUri:v});default:return P.createElement(LQ,{value:h,handleClick:g})}}return P.createElement(oce,null,A())},yce=({annotationPage:i})=>{var e;const t=ni(),{vault:n}=t;if(!i||!i.items||((e=i.items)==null?void 0:e.length)===0)return P.createElement(P.Fragment,null);const r=i.items.map(s=>n.get(s.id));return r?P.createElement(sce,{"data-testid":"annotation-page"},r==null?void 0:r.map(s=>P.createElement(mce,{key:s.id,annotation:s}))):P.createElement(P.Fragment,null)},vce=we("button",{textAlign:"left","&:hover":{color:"$accent"}}),Ece=we("li",{margin:"0.25rem 0"}),Ice=we("ol",{listStyleType:"auto",marginBottom:"1rem",listStylePosition:"inside"}),_ce=we("div",{margin:"0.5rem 1.618rem"}),Cce=we("div",{fontWeight:"bold"}),wce=we("div",{marginBottom:"1rem"}),xce=({value:i,handleClick:e,target:t,canvas:n})=>P.createElement(vce,{onClick:e,"data-target":t,"data-canvas":n},i),bce=({annotation:i,activeContentSearchTarget:e,setActiveContentSearchTarget:t})=>{var n,r,s;const o=Ar(),a=ni(),{openSeadragonViewer:l,vault:u,contentSearchVault:c,activeCanvas:h,configOptions:d,OSDImageLoaded:g}=a,A=u.get({id:h,type:"Canvas"}),p=((n=i.body.map(w=>c.get(w.id)).find(w=>w.value))==null?void 0:n.value)||"";let y;i.target&&typeof i.target=="string"&&(y=i.target);let v;if(y){const w=y.split("#xywh");w.length>1&&(v=w[0])}const E=((s=(r=d.contentSearch)==null?void 0:r.overlays)==null?void 0:s.zoomLevel)||1;k.useEffect(()=>{g&&l&&i.target&&i.target==e&&$w(l,E,y,A)},[l,g]);function I(w){if(!l)return;const S=JSON.parse(w.target.dataset.target),x=w.target.dataset.canvas;h===x?$w(l,E,y,A):(o({type:"updateOSDImageLoaded",OSDImageLoaded:!1}),o({type:"updateActiveCanvas",canvasId:x}),t(S))}const C=JSON.stringify(y);return P.createElement(Ece,null,P.createElement(xce,{target:C,canvas:v,value:p,handleClick:I}))},Sce=({annotationPage:i})=>{var e,t,n;const r=ni(),{contentSearchVault:s,configOptions:o}=r,[a,l]=k.useState(),u=(e=o.contentSearch)==null?void 0:e.searchResultsLimit,c=(t=o.localeText)==null?void 0:t.contentSearch;function h(A){const p={};return A.items.forEach(y=>{const v=s.get(y.id);let E="";if(v.label){const I=rh(v.label);I&&(E=I[0])}p[E]==null&&(p[E]=[]),p[E].push(v)}),p}function d(A){return(u?A.slice(0,u):A).map((p,y)=>P.createElement(bce,{key:y,annotation:p,activeContentSearchTarget:a,setActiveContentSearchTarget:l}))}function g(A){if(u){const p=A.length-u;if(p>0)return P.createElement(wce,null,p," ",c==null?void 0:c.moreResults)}}return!i||!i.items||((n=i.items)==null?void 0:n.length)===0?P.createElement("p",null,c==null?void 0:c.noSearchResults):P.createElement(P.Fragment,null,Object.entries(h(i)).map(([A,p],y)=>P.createElement("div",{key:y},P.createElement(Cce,{className:"content-search-results-title"},A),P.createElement(Ice,{className:"content-search-results"},d(p)),g(p))))},Tce=we("div",{".content-search-form":{display:"flex",marginBottom:"1rem"},input:{padding:".25rem",marginRight:"1rem"}}),Bce=we("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Rce=({searchServiceUrl:i,setContentSearchResource:e,setLoading:t})=>{var n;const[r,s]=k.useState(),o=ni(),{contentSearchVault:a,openSeadragonViewer:l,configOptions:u}=o,c=(n=u.localeText)==null?void 0:n.contentSearch;async function h(g){g.preventDefault();const A=c==null?void 0:c.tabLabel;if(l&&i){if(!r||r.trim()===""){e({label:{none:[A]}});return}t(!0),pQ(a,i,A,{q:r}).then(p=>{e(p),t(!1)})}}const d=g=>{g.preventDefault(),s(g.target.value)};return P.createElement(Tce,null,P.createElement(_X,{onSubmit:h,className:"content-search-form"},P.createElement(CX,{className:"FormField",name:"searchTerms",onChange:d},P.createElement(wX,{placeholder:c==null?void 0:c.formPlaceholder})),P.createElement(xX,{asChild:!0},P.createElement(Bce,{type:"submit"},P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},P.createElement("title",null,"Search"),P.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"}))))))},Lce=({searchServiceUrl:i,setContentSearchResource:e,activeCanvas:t,annotationPage:n})=>{const[r,s]=k.useState(!1);return P.createElement(_ce,null,P.createElement(Rce,{searchServiceUrl:i,setContentSearchResource:e,activeCanvas:t,setLoading:s}),!r&&P.createElement(Sce,{annotationPage:n}),r&&P.createElement("span",null,"Loading..."))},Dce=we("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),kce=we("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),MQ=(i,e="none")=>{if(!i)return null;if(typeof i=="string")return[i];if(!i[e]){const t=Object.getOwnPropertyNames(i);if(t.length>0)return i[t[0]]}return!i[e]||!Array.isArray(i[e])?null:i[e]},zr=(i,e="none",t=", ")=>{const n=MQ(i,e);return Array.isArray(n)?n.join(`${t}`):n};function Pce(i){return{__html:Mce(i)}}function _s(i,e){const t=Object.keys(i).filter(r=>e.includes(r)?null:r),n=new Object;return t.forEach(r=>{n[r]=i[r]}),n}function Mce(i){return Qte(i,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const Fce=we("span",{}),Ta=i=>{const{as:e,label:t}=i,n=_s(i,["as","label"]);return P.createElement(Fce,{as:e,...n},zr(t,n.lang))},Oce=(i,e="200,",t="full")=>{Array.isArray(i)&&(i=i[0]);const{id:n,service:r}=i;let s;if(!r)return n;if(Array.isArray(i.service)&&i.service.length>0&&(s=r[0]),s){if(s["@id"])return`${s["@id"]}/${t}/${e}/0/default.jpg`;if(s.id)return`${s.id}/${t}/${e}/0/default.jpg`}},FQ=we("img",{objectFit:"cover"}),Nce=i=>{const e=k.useRef(null),{contentResource:t,altAsLabel:n,region:r="full"}=i;let s;n&&(s=zr(n));const o=_s(i,["contentResource","altAsLabel"]),{type:a,id:l,width:u=200,height:c=200,duration:h}=t;k.useEffect(()=>{if(!l&&!e.current||["Image"].includes(a)||!l.includes("m3u8"))return;const A=new an;return e.current&&(A.attachMedia(e.current),A.on(an.Events.MEDIA_ATTACHED,function(){A.loadSource(l)})),A.on(an.Events.ERROR,function(p,y){if(y.fatal)switch(y.type){case an.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${p} network error encountered, try to recover`),A.startLoad();break;case an.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${p} media error encountered, try to recover`),A.recoverMediaError();break;default:A.destroy();break}}),()=>{A&&(A.detachMedia(),A.destroy())}},[l,a]);const d=k.useCallback(()=>{if(!e.current)return;let A=0,p=30;if(h&&(p=h),!l.split("#t=")&&h&&(A=h*.1),l.split("#t=").pop()){const v=l.split("#t=").pop();v&&(A=parseInt(v.split(",")[0]))}const y=e.current;y.autoplay=!0,y.currentTime=A,setTimeout(()=>d(),p*1e3)},[h,l]);k.useEffect(()=>d(),[d]);const g=Oce(t,`${u},${c}`,r);switch(a){case"Image":return P.createElement(FQ,{as:"img",alt:s,css:{width:u,height:c},key:l,src:g,...o});case"Video":return P.createElement(FQ,{as:"video",css:{width:u,height:c},disablePictureInPicture:!0,key:l,loop:!0,muted:!0,onPause:d,ref:e,src:l});default:return console.warn(`Resource type: ${a} is not valid or not yet supported in Primitives.`),P.createElement(P.Fragment,null)}},Qce=we("a",{}),Uce=i=>{const{children:e,homepage:t}=i,n=_s(i,["children","homepage"]);return P.createElement(P.Fragment,null,t&&t.map(r=>{const s=zr(r.label,n.lang);return P.createElement(Qce,{"aria-label":e?s:void 0,href:r.id,key:r.id,...n},e||s)}))},Gce={delimiter:", "},Zw=k.createContext(void 0),OQ=()=>{const i=k.useContext(Zw);if(i===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return i},Xw=({children:i,initialState:e=Gce})=>{const t=Hce(e,"delimiter");return P.createElement(Zw.Provider,{value:{delimiter:t}},i)},Hce=(i,e)=>Object.hasOwn(i,e)?i[e].toString():void 0,zce=we("span",{}),NQ=i=>{const{as:e,markup:t}=i,{delimiter:n}=OQ();if(!t)return P.createElement(P.Fragment,null);const r=_s(i,["as","markup"]),s=Pce(zr(t,r.lang,n));return P.createElement(zce,{as:e,...r,dangerouslySetInnerHTML:s})},QQ=i=>P.useContext(Zw)?P.createElement(NQ,{...i}):P.createElement(Xw,null,P.createElement(NQ,{...i})),Vce=({as:i="dd",lang:e,value:t})=>P.createElement(QQ,{markup:t,as:i,lang:e}),qce=we("span",{}),$ce=({as:i="dd",customValueContent:e,lang:t,value:n})=>{var r;const{delimiter:s}=OQ(),o=(r=MQ(n,t))==null?void 0:r.map(a=>k.cloneElement(e,{value:a}));return P.createElement(qce,{as:i,lang:t},o==null?void 0:o.map((a,l)=>[l>0&&`${s}`,P.createElement(k.Fragment,{key:l},a)]))},UQ=i=>{var e;const{item:t,lang:n,customValueContent:r}=i,{label:s,value:o}=t,a=(e=zr(s))==null?void 0:e.replace(" ","-").toLowerCase();return P.createElement("div",{role:"group","data-label":a},P.createElement(Ta,{as:"dt",label:s,lang:n}),r?P.createElement($ce,{as:"dd",customValueContent:r,value:o,lang:n}):P.createElement(Vce,{as:"dd",value:o,lang:n}))};function jce(i,e){const t=e.filter(n=>{const{matchingLabel:r}=n,s=Object.keys(n.matchingLabel)[0],o=zr(r,s);if(zr(i,s)===o)return!0}).map(n=>n.Content);if(Array.isArray(t))return t[0]}const Wce=we("dl",{}),Kce=i=>{const{as:e,customValueContent:t,metadata:n}=i;if(!Array.isArray(n))return P.createElement(P.Fragment,null);const r=uQ(i,"customValueDelimiter"),s=_s(i,["as","customValueContent","customValueDelimiter","metadata"]);return P.createElement(Xw,{...typeof r=="string"?{initialState:{delimiter:r}}:void 0},n.length>0&&P.createElement(Wce,{as:e,...s},n.map((o,a)=>{const l=t?jce(o.label,t):void 0;return P.createElement(UQ,{customValueContent:l,item:o,key:a,lang:s==null?void 0:s.lang})})))};we("li",{}),we("ul",{});const Yce=we("li",{}),Zce=we("ul",{}),Xce=i=>{const{as:e,rendering:t}=i,n=_s(i,["as","rendering"]);return P.createElement(Zce,{as:e},t&&t.map(r=>{const s=zr(r.label,n.lang);return P.createElement(Yce,{key:r.id},P.createElement("a",{href:r.id,...n,target:"_blank"},s||r.id))}))},Jce=we("dl",{}),ehe=i=>{const{as:e,requiredStatement:t}=i;if(!t)return P.createElement(P.Fragment,null);const n=uQ(i,"customValueDelimiter"),r=_s(i,["as","customValueDelimiter","requiredStatement"]);return P.createElement(Xw,{...typeof n=="string"?{initialState:{delimiter:n}}:void 0},P.createElement(Jce,{as:e,...r},P.createElement(UQ,{item:t,lang:r.lang})))},the=we("li",{}),ihe=we("ul",{}),nhe=i=>{const{as:e,seeAlso:t}=i,n=_s(i,["as","seeAlso"]);return P.createElement(ihe,{as:e},t&&t.map(r=>{const s=zr(r.label,n.lang);return P.createElement(the,{key:r.id},P.createElement("a",{href:r.id,...n},s||r.id))}))},rhe=i=>{const{as:e,summary:t}=i,n=_s(i,["as","customValueDelimiter","summary"]);return P.createElement(QQ,{as:e,markup:t,...n})},GQ=i=>{const{thumbnail:e,region:t}=i,n=_s(i,["thumbnail"]);return P.createElement(P.Fragment,null,e&&e.map(r=>P.createElement(Nce,{contentResource:r,key:r.id,region:t,...n})))},she=({homepage:i})=>(i==null?void 0:i.length)===0?P.createElement(P.Fragment,null):P.createElement(P.Fragment,null,P.createElement("span",{className:"manifest-property-title"},"Homepage"),P.createElement(Uce,{homepage:i})),ohe=({id:i,htmlLabel:e,parent:t="manifest"})=>P.createElement(P.Fragment,null,P.createElement("span",{className:"manifest-property-title"},e),P.createElement("a",{href:i,target:"_blank",id:`iiif-${t}-id`},i)),ahe=({metadata:i,parent:e="manifest"})=>i?P.createElement(P.Fragment,null,P.createElement(Kce,{metadata:i,id:`iiif-${e}-metadata`})):P.createElement(P.Fragment,null),lhe=({rendering:i})=>(i==null?void 0:i.length)===0?P.createElement(P.Fragment,null):P.createElement(P.Fragment,null,P.createElement("span",{className:"manifest-property-title"},"Alternate formats"),P.createElement(Xce,{rendering:i})),uhe=({requiredStatement:i,parent:e="manifest"})=>i?P.createElement(P.Fragment,null,P.createElement(ehe,{requiredStatement:i,id:`iiif-${e}-required-statement`})):P.createElement(P.Fragment,null),che=({rights:i})=>i?P.createElement(P.Fragment,null,P.createElement("span",{className:"manifest-property-title"},"Rights"),P.createElement("a",{href:i,target:"_blank"},i)):P.createElement(P.Fragment,null),hhe=({seeAlso:i})=>(i==null?void 0:i.length)===0?P.createElement(P.Fragment,null):P.createElement(P.Fragment,null,P.createElement("span",{className:"manifest-property-title"},"See Also"),P.createElement(nhe,{seeAlso:i})),dhe=({summary:i,parent:e="manifest"})=>i?P.createElement(P.Fragment,null,P.createElement(rhe,{summary:i,as:"p",id:`iiif-${e}-summary`})):P.createElement(P.Fragment,null),fhe=({label:i,thumbnail:e})=>(e==null?void 0:e.length)===0?P.createElement(P.Fragment,null):P.createElement(P.Fragment,null,P.createElement(GQ,{altAsLabel:i||{none:["resource"]},thumbnail:e,style:{backgroundColor:"#6663",objectFit:"cover"}})),ghe=()=>{const i=ni(),{activeManifest:e,vault:t}=i,[n,r]=k.useState(),[s,o]=k.useState([]),[a,l]=k.useState([]),[u,c]=k.useState([]),[h,d]=k.useState([]);return k.useEffect(()=>{var g,A,p,y;const v=t.get(e);r(v),((g=v.homepage)==null?void 0:g.length)>0&&o(t.get(v.homepage)),((A=v.seeAlso)==null?void 0:A.length)>0&&l(t.get(v.seeAlso)),((p=v.rendering)==null?void 0:p.length)>0&&c(t.get(v.rendering)),((y=v.thumbnail)==null?void 0:y.length)>0&&d(t.get(v.thumbnail))},[e,t]),n?P.createElement(kce,null,P.createElement(Dce,null,P.createElement(fhe,{thumbnail:h,label:n.label}),P.createElement(dhe,{summary:n.summary}),P.createElement(ahe,{metadata:n.metadata}),P.createElement(uhe,{requiredStatement:n.requiredStatement}),P.createElement(che,{rights:n.rights}),P.createElement(she,{homepage:s}),P.createElement(hhe,{seeAlso:a}),P.createElement(lhe,{rendering:u}),P.createElement(ohe,{id:n.id,htmlLabel:"IIIF Manifest"}))):P.createElement(P.Fragment,null)};function Ahe(i){const e=[];return i.forEach(t=>{var n;(n=t.informationPanel)!=null&&n.component&&e.push(t)}),{pluginsWithInfoPanel:e}}const phe=1500,mhe=({activeCanvas:i,annotationResources:e,searchServiceUrl:t,setContentSearchResource:n,contentSearchResource:r})=>{const s=Ar(),o=ni(),{isAutoScrolling:a,isUserScrolling:l,vault:u,configOptions:c,plugins:h}=o,{informationPanel:d}=c,[g,A]=k.useState(),p=d==null?void 0:d.renderAbout,y=d==null?void 0:d.renderAnnotation,v=u.get({id:i,type:"Canvas"}),E=d==null?void 0:d.renderContentSearch,{pluginsWithInfoPanel:I}=Ahe(h);function C(x,T){var Q,M;const R=(Q=x==null?void 0:x.informationPanel)==null?void 0:Q.component;return R===void 0?P.createElement(P.Fragment,null):P.createElement(zm,{key:T,value:x.id},P.createElement(np,{FallbackComponent:Yw},P.createElement(R,{...(M=x==null?void 0:x.informationPanel)==null?void 0:M.componentProps,canvas:v,useViewerDispatch:Ar,useViewerState:ni})))}k.useEffect(()=>{if(!g)if(d!=null&&d.defaultTab){const x=["manifest-about","manifest-content-search"];v.annotations.length>0&&v.annotations.forEach(T=>x.push(T.id)),x.includes(d==null?void 0:d.defaultTab)?A(d.defaultTab):A("manifest-about")}else p?A("manifest-about"):E?A("manifest-content-search"):e&&(e==null?void 0:e.length)>0?A(e[0].id):h.length>0&&A(h[0].id)},[d==null?void 0:d.defaultTab,i,g,p,E,e,r,v==null?void 0:v.annotations,h]);function w(){if(!a){clearTimeout(l);const x=setTimeout(()=>{s({type:"updateUserScrolling",isUserScrolling:void 0})},phe);s({type:"updateUserScrolling",isUserScrolling:x})}}const S=x=>{A(x)};return P.createElement(tce,{"data-testid":"information-panel",defaultValue:g,onValueChange:S,orientation:"horizontal",value:g,className:"clover-viewer-information-panel"},P.createElement(ice,{"aria-label":"select chapter","data-testid":"information-panel-list"},p&&P.createElement(Hm,{value:"manifest-about"},"About"),E&&r&&P.createElement(Hm,{value:"manifest-content-search"},P.createElement(Ta,{label:r.label})),y&&e&&e.map((x,T)=>P.createElement(Hm,{key:T,value:x.id},P.createElement(Ta,{label:x.label}))),I&&I.map((x,T)=>{var Q;return P.createElement(Hm,{key:T,value:x.id},P.createElement(Ta,{label:(Q=x.informationPanel)==null?void 0:Q.label}))})),P.createElement(rce,{handleScroll:w},p&&P.createElement(zm,{value:"manifest-about"},P.createElement(ghe,null)),E&&r&&P.createElement(zm,{value:"manifest-content-search"},P.createElement(Lce,{searchServiceUrl:t,setContentSearchResource:n,activeCanvas:i,annotationPage:r})),y&&e&&e.map(x=>P.createElement(zm,{key:x.id,value:x.id},P.createElement(yce,{annotationPage:x}))),I&&I.map((x,T)=>C(x,T))))},HQ=we("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),yhe=we("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),Jw=we("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),vhe=we("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),Ehe=we("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${HQ}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),Ihe=(i,e)=>{k.useEffect(()=>{function t(n){n.key===i&&e()}return window.addEventListener("keyup",t),()=>window.removeEventListener("keyup",t)},[])},_he=()=>P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},P.createElement("title",null,"Arrow Back"),P.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),Che=()=>P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},P.createElement("title",null,"Arrow Forward"),P.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),whe=()=>P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},P.createElement("title",null,"Close"),P.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),xhe=()=>P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},P.createElement("title",null,"Search"),P.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),bhe=({handleCanvasToggle:i,handleFilter:e,activeIndex:t,canvasLength:n})=>{const[r,s]=k.useState(!1),[o,a]=k.useState(!1),[l,u]=k.useState(!1);k.useEffect(()=>{u(t===0),t===n-1?a(!0):a(!1)},[t,n]),Ihe("Escape",()=>{s(!1),e("")});const c=()=>{s(d=>!d),e("")},h=d=>e(d.target.value);return P.createElement(Ehe,{isToggle:r},P.createElement(HQ,null,r&&P.createElement(yhe,{autoFocus:!0,onChange:h,placeholder:"Search"}),!r&&P.createElement(vhe,null,P.createElement(Jw,{onClick:()=>i(-1),disabled:l,type:"button"},P.createElement(_he,null)),P.createElement("span",null,t+1," of ",n),P.createElement(Jw,{onClick:()=>i(1),disabled:o,type:"button"},P.createElement(Che,null))),P.createElement(Jw,{onClick:c,type:"button"},r?P.createElement(whe,null):P.createElement(xhe,null))))},She=we(DP,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"}),The=()=>P.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),Bhe=()=>P.createElement(P.Fragment,null,P.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),P.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),P.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),Rhe=()=>P.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),Lhe=()=>P.createElement(P.Fragment,null,P.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),P.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),Dhe=()=>P.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),khe=()=>P.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"}),zQ=we("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),Phe=({children:i})=>P.createElement("title",null,i),ln=i=>P.createElement(zQ,{...i,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},i.children);ln.Title=Phe,ln.Add=The,ln.Audio=Bhe,ln.Close=Rhe,ln.Download=Lhe,ln.Image=Dhe,ln.Video=khe;const Mhe=Kw({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),Fhe=Kw({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),VQ=we(Rle,{fill:"$secondaryAlt"}),Ohe=we(Ble,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),Nhe=we(Tle,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:Fhe},'&[data-side="bottom"]':{animationName:Mhe},'&[data-align="end"]':{[`& ${VQ}`]:{margin:"0 0.7rem"}}}),Qhe=we(Sle,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),Uhe=we(ble,{boxSizing:"content-box"}),Ghe=i=>P.createElement(Qhe,{...i},i.children),Hhe=i=>P.createElement(Nhe,{...i},P.createElement(VQ,null),P.createElement(Ohe,null,P.createElement(ln,{isSmall:!0},P.createElement(ln.Close,null))),i.children),Nl=({children:i})=>P.createElement(Uhe,null,i);Nl.Trigger=Ghe,Nl.Content=Hhe;const ex=we("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"5px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${zQ}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),tx=we("span",{display:"flex"}),zhe=we("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),Vhe=we("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),qhe=we(kP,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${tx}`]:{position:"absolute",right:"0",bottom:"0",[`& ${ex}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${tx}`]:{[`& ${ex}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700"}}}),$he=({type:i})=>{switch(i){case"Sound":return P.createElement(ln.Audio,null);case"Image":return P.createElement(ln.Image,null);case"Video":return P.createElement(ln.Video,null);default:return P.createElement(ln.Image,null)}},jhe=({canvas:i,canvasIndex:e,isActive:t,thumbnail:n,type:r,handleChange:s})=>P.createElement(qhe,{"aria-checked":t,"data-testid":"media-thumbnail","data-canvas":e,onClick:()=>s(i.id),value:i.id},P.createElement("figure",null,P.createElement("div",null,(n==null?void 0:n.id)&&P.createElement("img",{src:n.id,alt:i!=null&&i.label?rh(i.label):""}),P.createElement(tx,null,P.createElement(ex,{isIcon:!0,"data-testid":"thumbnail-tag"},P.createElement(zhe,null),P.createElement(ln,{"aria-label":r},P.createElement($he,{type:r})),["Video","Sound"].includes(r)&&P.createElement(Vhe,null,aQ(i.duration))))),(i==null?void 0:i.label)&&P.createElement("figcaption",{"data-testid":"fig-caption"},P.createElement(Ta,{label:i.label})))),Whe=i=>i.body?i.body.type:"Image",Khe=({items:i})=>{const e=Ar(),t=ni(),{activeCanvas:n,vault:r}=t,[s,o]=k.useState(""),[a,l]=k.useState([]),[u,c]=k.useState(0),h=P.useRef(null),d="painting",g=y=>{n!==y&&e({type:"updateActiveCanvas",canvasId:y})};k.useEffect(()=>{if(!a.length){const y=["Image","Sound","Video"],v=i.map(E=>mQ(r,E,d,y)).filter(E=>E.annotations.length>0);l(v)}},[i,a.length,r]),k.useEffect(()=>{a.forEach((y,v)=>{y!=null&&y.canvas&&y.canvas.id===n&&c(v)})},[n,a]),k.useEffect(()=>{const y=document.querySelector(`[data-canvas="${u}"]`);if(y instanceof HTMLElement&&h.current){const v=y.offsetLeft-h.current.offsetWidth/2+y.offsetWidth/2;h.current.scrollTo({left:v,behavior:"smooth"})}},[u]);const A=y=>o(y),p=y=>{const v=a[u+y];v!=null&&v.canvas&&g(v.canvas.id)};return P.createElement(P.Fragment,null,P.createElement(bhe,{handleFilter:A,handleCanvasToggle:p,activeIndex:u,canvasLength:a.length}),P.createElement(She,{"aria-label":"select item","data-testid":"media",ref:h},a.filter(y=>{var v;if((v=y.canvas)!=null&&v.label){const E=rh(y.canvas.label);if(Array.isArray(E))return E[0].toLowerCase().includes(s.toLowerCase())}}).map((y,v)=>{var E,I;return P.createElement(jhe,{canvas:y.canvas,canvasIndex:v,handleChange:g,isActive:n===((E=y==null?void 0:y.canvas)==null?void 0:E.id),key:(I=y==null?void 0:y.canvas)==null?void 0:I.id,thumbnail:kue(r,y,200,200),type:Whe(y.annotations[0])})})))},qQ=we("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all","& img":{width:"100%",height:"100%",objectFit:"contain",color:"transparent",transition:"$all"},variants:{isMedia:{true:{cursor:"pointer"}}}}),$Q=we("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),jQ=we($Q,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),Yhe=we("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${jQ}`]:{backgroundColor:"$accent"},[`${qQ}`]:{backgroundColor:"#6662"}}}),Zhe=we("div",{width:"100%",height:"100%"}),Xhe=we("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),Jhe=we(hue,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),ede=we(due,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),tde=we(gue,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),ide=we(fue,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),WQ=we(cue,{position:"relative",zIndex:"5",width:"100%"}),ix=({direction:i,title:e})=>{const t=()=>P.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),n=()=>P.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"});return P.createElement(Xhe,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},P.createElement("title",null,e),i==="up"&&P.createElement(t,null),i==="down"&&P.createElement(n,null))},KQ=({children:i,label:e,maxHeight:t,onValueChange:n,value:r})=>P.createElement(WQ,{onValueChange:n,value:r},P.createElement(Jhe,{"data-testid":"select-button"},P.createElement(Hle,{"data-testid":"select-button-value"}),P.createElement(zle,null,P.createElement(ix,{direction:"down",title:"select"}))),P.createElement(Vle,null,P.createElement(ede,{css:{maxHeight:`${t} !important`},"data-testid":"select-content"},P.createElement(aue,null,P.createElement(ix,{direction:"up",title:"scroll up for more"})),P.createElement(Kle,null,P.createElement(Jle,null,e&&P.createElement(ide,null,P.createElement(Ta,{"data-testid":"select-label",label:e})),i)),P.createElement(lue,null,P.createElement(ix,{direction:"down",title:"scroll down for more"}))))),YQ=i=>P.createElement(tde,{...i},i.thumbnail&&P.createElement(GQ,{thumbnail:i.thumbnail}),P.createElement(rue,null,P.createElement(Ta,{label:i.label})),P.createElement(oue,null)),nx=we("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),nde=we("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),rde=we("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${nx}`]:{display:"block"}},false:{[`${nx}`]:{display:"none"}}}}}),sh=({className:i,id:e,label:t,children:n})=>{const r=t.toLowerCase().replace(/\s/g,"-");return P.createElement($Q,{id:e,className:i,"data-testid":"openseadragon-button","data-button":r},P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},P.createElement("title",{id:`${e}-svg-title`},t),n))},sde=we("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),ode=()=>P.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),ade=()=>P.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),lde=()=>P.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),ude=()=>P.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),ZQ=()=>P.createElement(P.Fragment,null,P.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),P.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),cde=({_cloverViewerHasPlaceholder:i,config:e})=>{const t=ni(),{activeCanvas:n,plugins:r,vault:s}=t,o=s.get({id:n,type:"Canvas"});function a(){return r.filter(l=>{var u;return(u=l.imageViewer)==null?void 0:u.controls}).map((l,u)=>{var c,h,d,g;const A=(h=(c=l.imageViewer)==null?void 0:c.controls)==null?void 0:h.component;return P.createElement(A,{key:u,...(g=(d=l==null?void 0:l.imageViewer)==null?void 0:d.controls)==null?void 0:g.componentProps,canvas:o,useViewerDispatch:Ar,useViewerState:ni})})}return P.createElement(sde,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:i},e.showZoomControl&&P.createElement(P.Fragment,null,P.createElement(sh,{id:e.zoomInButton,label:"zoom in"},P.createElement(ode,null)),P.createElement(sh,{id:e.zoomOutButton,label:"zoom out"},P.createElement(ade,null))),e.showFullPageControl&&P.createElement(sh,{id:e.fullPageButton,label:"full page"},P.createElement(lde,null)),e.showRotationControl&&P.createElement(P.Fragment,null,P.createElement(sh,{id:e.rotateRightButton,label:"rotate right"},P.createElement(ZQ,null)),P.createElement(sh,{id:e.rotateLeftButton,label:"rotate left"},P.createElement(ZQ,null))),e.showHomeControl&&P.createElement(sh,{id:e.homeButton,label:"reset"},P.createElement(ude,null)),a())},hde=({ariaLabel:i,config:e,uri:t,_cloverViewerHasPlaceholder:n,imageType:r,openSeadragonCallback:s})=>{const[o,a]=k.useState(),[l,u]=k.useState(),c=Ar(),h=k.useRef(!1);return k.useEffect(()=>(h.current||(h.current=!0,l||u(Ic(e))),()=>l==null?void 0:l.destroy()),[]),k.useEffect(()=>{l&&s&&s(l)},[l,s]),k.useEffect(()=>{l&&t!==o&&(l==null||l.forceRedraw(),a(t))},[l,o,t]),k.useEffect(()=>{if(o&&l)switch(r){case"simpleImage":l==null||l.addSimpleImage({url:o});break;case"tiledImage":Mue(o).then(d=>{try{if(!d)throw new Error(`No tile source found for ${o}`);l==null||l.addTiledImage({tileSource:d,success:()=>{typeof c=="function"&&c({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(g){console.error(g)}});break;default:l==null||l.close(),console.warn(`Unable to render ${o} in OpenSeadragon as type: "${r}"`);break}},[r,o]),P.createElement(rde,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":e.id,hasNavigator:e.showNavigator},P.createElement(cde,{_cloverViewerHasPlaceholder:n,config:e}),e.showNavigator&&P.createElement(nx,{id:e.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),P.createElement(nde,{id:e.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...i&&{"aria-label":i}}))};function dde(i){return{id:`openseadragon-${i}`,navigatorId:`openseadragon-navigator-${i}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${i}`,homeButton:`reset-${i}`,rotateLeftButton:`rotateLeft-${i}`,rotateRightButton:`rotateRight-${i}`,zoomInButton:`zoomIn-${i}`,zoomOutButton:`zoomOut-${i}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}}}const fde=({_cloverViewerHasPlaceholder:i=!1,body:e,instanceId:t,isTiledImage:n=!1,label:r,src:s="",openSeadragonCallback:o,openSeadragonConfig:a={}})=>{const l=t||vc(),u=typeof r=="string"?r:zr(r),c={...dde(l),...a},{imageType:h,uri:d}=e?$ue(e):jue(s,n);return d?P.createElement(np,{FallbackComponent:Yw},P.createElement(hde,{_cloverViewerHasPlaceholder:i,ariaLabel:u,config:c,imageType:h,key:l,uri:d,openSeadragonCallback:o})):null},gde=({isMedia:i,label:e,placeholderCanvas:t,setIsInteractive:n})=>{const{vault:r}=ni(),s=Gm(r,t),o=s?s[0]:void 0,a=e?rh(e):["placeholder image"];return P.createElement(qQ,{onClick:()=>n(!0),isMedia:i,className:"clover-viewer-placeholder"},P.createElement("img",{src:(o==null?void 0:o.id)||"",alt:a.join(),height:o==null?void 0:o.height,width:o==null?void 0:o.width}))},Ade=we("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),pde=P.forwardRef((i,e)=>{const t=P.useRef(null),n=k.useCallback(()=>{var s,o;if((s=e.current)!=null&&s.currentTime&&((o=e.current)==null?void 0:o.currentTime)>0)return;const a=e.current;if(!a)return;const l=new AudioContext,u=l.createMediaElementSource(a),c=l.createAnalyser(),h=t.current;if(!h)return;h.width=a.offsetWidth,h.height=a.offsetHeight;const d=h.getContext("2d");u.connect(c),c.connect(l.destination),c.fftSize=256;const g=c.frequencyBinCount,A=new Uint8Array(g);setInterval(function(){r(c,d,g,A,h.width,h.height)},20)},[e]);P.useEffect(()=>{!e||!e.current||(e.current.onplay=n)},[n,e]);function r(s,o,a,l,u,c){const h=u/a*2.6;let d,g=0;s.getByteFrequencyData(l),o.fillStyle="#000000",o.fillRect(0,0,u,c);for(let A=0;A<a;A++)d=l[A]*2,o.fillStyle="rgba(78, 42, 132, 1)",o.fillRect(g,c-d,h,d),g+=h+6}return P.createElement(Ade,{ref:t,role:"presentation"})}),mde=we("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),yde=({resource:i,ignoreCaptionLabels:e})=>{const t=rh(i.label,"en");return Array.isArray(t)&&t.some(n=>e.includes(n))?null:P.createElement("track",{key:i.id,src:i.id,label:Array.isArray(t)?t[0]:t,srcLang:"en","data-testid":"player-track"})},vde=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],Ede=({allSources:i,annotationResources:e,painting:t})=>{const[n,r]=P.useState(0),[s,o]=P.useState(),a=P.useRef(null),l=(t==null?void 0:t.type)==="Sound",u=ni(),{activeCanvas:c,configOptions:h,vault:d}=u;return k.useEffect(()=>{if(!t.id||!a.current)return;if(a!=null&&a.current){const p=a.current;p.src=t.id,p.load()}if(t.id.split(".").pop()!=="m3u8"&&t.format&&!vde.includes(t.format))return;const g={xhrSetup:function(p,y){p.withCredentials=!!h.withCredentials}},A=new an(g);return A.attachMedia(a.current),A.on(an.Events.MEDIA_ATTACHED,function(){A.loadSource(t.id)}),A.on(an.Events.ERROR,function(p,y){if(y.fatal)switch(y.type){case an.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${p} network error encountered, try to recover`),A.startLoad();break;case an.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${p} media error encountered, try to recover`),A.recoverMediaError();break;default:A.destroy();break}}),()=>{if(A&&a.current){const p=a.current;A.detachMedia(),A.destroy(),p.currentTime=0}}},[h.withCredentials,t.id]),k.useEffect(()=>{var g,A,p,y;const v=d.get(c),E=(g=v.accompanyingCanvas)!=null&&g.id?Gm(d,(A=v.accompanyingCanvas)==null?void 0:A.id):null,I=(p=v.placeholderCanvas)!=null&&p.id?Gm(d,(y=v.placeholderCanvas)==null?void 0:y.id):null;E&&I?o(n===0?I[0].id:E[0].id):(E&&o(E[0].id),I&&o(I[0].id))},[c,n,d]),k.useEffect(()=>{if(a!=null&&a.current){const g=a.current;return g==null||g.addEventListener("timeupdate",()=>r(g.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),P.createElement(mde,{css:{backgroundColor:h.canvasBackgroundColor,maxHeight:h.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},P.createElement("video",{id:"clover-iiif-video",key:t.id,ref:a,controls:!0,height:t.height,width:t.width,crossOrigin:"anonymous",poster:s,style:{maxHeight:h.canvasHeight,position:"relative",zIndex:"1"}},i.map(g=>P.createElement("source",{src:g.id,type:g.format,key:g.id})),(e==null?void 0:e.length)>0&&e.map(g=>{const A=[];return g.items.forEach(p=>{d.get(p.id).body.forEach(y=>{const v=d.get(y.id);A.push(v)})}),A.map(p=>P.createElement(yde,{resource:p,ignoreCaptionLabels:h.ignoreCaptionLabels||[],key:p.id}))}),"Sorry, your browser doesn't support embedded videos."),l&&P.createElement(pde,{ref:a}))},Ide=()=>P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},P.createElement("title",{id:"close-svg-title"},"close"),P.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),_de=({isMedia:i})=>P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},P.createElement("title",{id:"open-svg-title"},"open"),i?P.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):P.createElement(P.Fragment,null,P.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),P.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Cde=({handleToggle:i,isInteractive:e,isMedia:t})=>P.createElement(jQ,{onClick:i,isInteractive:e,isMedia:t,"data-testid":"placeholder-toggle"},e?P.createElement(Ide,null):P.createElement(_de,{isMedia:t})),wde=({activeCanvas:i,annotationResources:e,isMedia:t,painting:n})=>{var r,s,o,a,l;const[u,c]=P.useState(0),[h,d]=P.useState(!1),{configOptions:g,customDisplays:A,openSeadragonViewer:p,vault:y,viewerId:v}=ni(),E=Ar(),I=y.get(i),C=(r=I==null?void 0:I.placeholderCanvas)==null?void 0:r.id,w=!!C,S=(n==null?void 0:n.length)>1,x=C&&!h&&!t,T=`${v}-${xue(i+u)}`,Q=()=>d(!h),M=N=>{const G=n.findIndex(j=>j.id===N);c(G)},R=A.find(N=>{var G;let j=!1;const{canvasId:V,paintingFormat:Z}=N.target;if(Array.isArray(V)&&V.length>0&&(j=V.includes(i)),Array.isArray(Z)&&Z.length>0){const Y=((G=n[u])==null?void 0:G.format)||"";j=!!(Y&&Z.includes(Y))}return j}),z=[];(o=(s=e[0])==null?void 0:s.items)==null||o.forEach(N=>{const G=y.get(N.id);z.push(G)}),k.useEffect(()=>{var N;z&&p&&(N=g.annotationOverlays)!=null&&N.renderOverlays&&(CQ(p,"annotation-overlay"),EQ(p,I,g.annotationOverlays,z,"annotation-overlay"))},[I,z,p,g]);const q=N=>{N&&(p==null?void 0:p.id)!==`openseadragon-${T}`&&E({type:"updateOpenSeadragonViewer",openSeadragonViewer:N})},X=(a=R==null?void 0:R.display)==null?void 0:a.component;return P.createElement(Yhe,{className:"clover-viewer-painting"},P.createElement(Zhe,{style:{backgroundColor:g.canvasBackgroundColor,height:g.canvasHeight==="auto"?"100%":g.canvasHeight}},C&&!t&&P.createElement(Cde,{handleToggle:Q,isInteractive:h,isMedia:t}),x&&!t&&P.createElement(gde,{isMedia:t,label:I==null?void 0:I.label,placeholderCanvas:C,setIsInteractive:d}),!x&&!R&&(t?P.createElement(Ede,{allSources:n,painting:n[u],annotationResources:e}):n&&P.createElement(fde,{_cloverViewerHasPlaceholder:w,body:n[u],instanceId:T,key:T,openSeadragonCallback:q,openSeadragonConfig:g.openSeadragon})),!x&&X&&P.createElement(X,{id:i,annotationBody:n[u],...R==null?void 0:R.display.componentProps})),S&&P.createElement(KQ,{value:(l=n[u])==null?void 0:l.id,onValueChange:M,maxHeight:"200px"},n==null?void 0:n.map(N=>P.createElement(YQ,{value:N==null?void 0:N.id,key:N==null?void 0:N.id,label:N==null?void 0:N.label}))))},xde=({activeCanvas:i,annotationResources:e,searchServiceUrl:t,setContentSearchResource:n,contentSearchResource:r,isAudioVideo:s,items:o,painting:a})=>{const{isInformationOpen:l,configOptions:u}=ni(),{informationPanel:c}=u,h=(c==null?void 0:c.renderAbout)&&l,d=(c==null?void 0:c.renderAnnotation)&&e.length>0&&!c.open;return P.createElement(xQ,{className:"clover-viewer-content","data-testid":"clover-viewer-content"},P.createElement(bQ,null,P.createElement(wde,{activeCanvas:i,annotationResources:e,isMedia:s,painting:a}),h&&P.createElement(SQ,null,P.createElement("span",null,l?"View Items":"More Information")),o.length>1&&P.createElement(wQ,{className:"clover-viewer-media-wrapper"},P.createElement(Khe,{items:o,activeItem:0}))),(h||d)&&P.createElement(Jue,null,P.createElement(TQ,null,P.createElement(mhe,{activeCanvas:i,annotationResources:e,searchServiceUrl:t,setContentSearchResource:n,contentSearchResource:r}))))},bde=we(Nl.Trigger,{width:"30px",padding:"5px"}),XQ=we(Nl.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),Sde=we("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),Tde=we("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${WQ}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),Bde=we("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),Rde=()=>{var i;const e=Ar(),t=ni(),{activeManifest:n,collection:r,configOptions:s,vault:o}=t,a=s==null?void 0:s.canvasHeight,l=u=>{e({type:"updateActiveManifest",manifestId:u}),e({type:"updateViewerId",viewerId:vc()})};return P.createElement("div",{style:{margin:"0.75rem"}},P.createElement(KQ,{label:r.label,maxHeight:a,value:n,onValueChange:l},(i=r==null?void 0:r.items)==null?void 0:i.map(u=>P.createElement(YQ,{value:u.id,key:u.id,thumbnail:u!=null&&u.thumbnail?o.get(u==null?void 0:u.thumbnail):void 0,label:u.label}))))},Lde=(i,e=2500)=>{const[t,n]=k.useState(),r=k.useCallback(()=>{navigator.clipboard.writeText(i).then(()=>n("copied"),()=>n("failed"))},[i]);return k.useEffect(()=>{if(!t)return;const s=setTimeout(()=>n(void 0),e);return()=>clearTimeout(s)},[t]),[t,r]},Dde=we("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),kde=({status:i})=>i?P.createElement(Dde,{"data-copy-status":i},i):null,JQ=({textPrompt:i,textToCopy:e})=>{const[t,n]=Lde(e);return P.createElement("button",{onClick:n},i," ",P.createElement(kde,{status:t}))},Pde=()=>{const i="#ed1d33",e="#2873ab";return P.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},P.createElement("title",null,"IIIF Manifest Options"),P.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},P.createElement("g",{transform:"scale(0.1)"},P.createElement("path",{style:{fill:e},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),P.createElement("path",{style:{fill:e},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),P.createElement("path",{style:{fill:i},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),P.createElement("path",{style:{fill:i},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),P.createElement("path",{style:{fill:e},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),P.createElement("path",{style:{fill:e},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),P.createElement("path",{style:{fill:i},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},Mde=we(_ue,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),Fde=we(Cue,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),Ode=we("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),Nde=we("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),Qde=()=>{var i;const{configOptions:e}=ni(),t=Ar(),[n,r]=k.useState((i=e==null?void 0:e.informationPanel)==null?void 0:i.open);return k.useEffect(()=>{t({type:"updateInformationOpen",isInformationOpen:n})},[n,t]),P.createElement(Nde,null,P.createElement(Ode,{htmlFor:"information-toggle",css:n?{opacity:"1"}:{}},"More Information"),P.createElement(Mde,{checked:n,onCheckedChange:()=>r(!n),id:"information-toggle","aria-label":"information panel toggle",name:"toggled?"},P.createElement(Fde,null)))},Ude=we(Nl.Trigger,{width:"30px",padding:"5px"}),Gde=we(XQ,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function Hde(i){const{vault:e}=ni();try{const t=i&&e.get(i);if(!t)throw new Error(`Vault entity ${i} not found.`);return(t==null?void 0:t["@id"])||(t==null?void 0:t.id)}catch(t){return console.error(t),i}}function e8(i,e){const t=[];if(!i)return t;for(const n of i)if(n.id){const r=e.get(n.id);r&&t.push(r)}return t}function zde(){const{activeCanvas:i,activeManifest:e,vault:t}=ni(),[n,r]=k.useState({root:[],canvas:[]});return k.useEffect(()=>{const s=t.get(e),o=t.get(i),a=s==null?void 0:s.rendering,l=o==null?void 0:o.rendering,u=e8(a,t),c=e8(l,t);r({root:u,canvas:c})},[i,e,t]),{...n}}function t8(i,e){return i.map(({format:t,id:n,label:r})=>{const s=Hde(n);return{format:t,id:s,label:zr(r)||e}})}function Vde(){const i=zde(),e=t8((i==null?void 0:i.root)||[],"Root Rendering Label"),t=t8((i==null?void 0:i.canvas)||[],"Canvas Rendering Label");return{allPages:e,individualPages:t}}const qde=()=>{const{allPages:i,individualPages:e}=Vde(),t=i.length>0||e.length>0,n=r=>{window.open(r,"_blank")};return t?P.createElement(Nl,null,P.createElement(Ude,{"data-testid":"download-button"},P.createElement(ln,null,P.createElement(ln.Download,null))),P.createElement(Gde,{"data-testid":"download-content"},e.length>0&&P.createElement(P.Fragment,null,P.createElement("h3",null,"Individual Pages"),P.createElement("ul",null,e.map(({format:r,id:s,label:o})=>P.createElement("li",{key:o},P.createElement("button",{onClick:()=>n(s)},o," (",r,")"))))),i.length>0&&P.createElement(P.Fragment,null,P.createElement("h3",null,"All Pages"),P.createElement("ul",null,i.map(({format:r,id:s,label:o})=>P.createElement("li",{key:o},P.createElement("button",{onClick:()=>n(s)},o," (",r,")"))))))):null},i8=i=>{const e=()=>window.matchMedia?window.matchMedia(i).matches:!1,[t,n]=k.useState(e);return k.useEffect(()=>{const r=()=>n(e);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)}),t},$de=({manifestId:i,manifestLabel:e})=>{const t=ni(),{collection:n,configOptions:r}=t,{informationPanel:s,showDownload:o,showIIIFBadge:a,showTitle:l}=r,u=o||a||(s==null?void 0:s.renderToggle),c=i8(Ww.sm);return P.createElement(Tde,{className:"clover-viewer-header"},n!=null&&n.items?P.createElement(Rde,null):P.createElement(Sde,{className:l?"":"visually-hidden"},l&&P.createElement(Ta,{label:e,className:"label"})),u&&P.createElement(Bde,null,o&&P.createElement(qde,null),a&&P.createElement(Nl,null,P.createElement(bde,null,P.createElement(Pde,null)),P.createElement(XQ,null,(n==null?void 0:n.items)&&P.createElement("button",{onClick:h=>{h.preventDefault(),window.open(n.id,"_blank")}},"View Collection"),P.createElement("button",{onClick:h=>{h.preventDefault(),window.open(i,"_blank")}},"View Manifest")," ",(n==null?void 0:n.items)&&P.createElement(JQ,{textPrompt:"Copy Collection URL",textToCopy:n.id}),P.createElement(JQ,{textPrompt:"Copy Manifest URL",textToCopy:i}))),(s==null?void 0:s.renderToggle)&&!c&&P.createElement(Qde,null)))},jde=(i=!1)=>{const[e,t]=k.useState(i);return k.useLayoutEffect(()=>{if(!e)return;const n=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=n}},[e]),k.useEffect(()=>{e!==i&&t(i)},[i]),[e,t]},Wde=({manifest:i,theme:e,iiifContentSearchQuery:t})=>{var n;const r=ni(),s=Ar(),{activeCanvas:o,isInformationOpen:a,vault:l,contentSearchVault:u,configOptions:c,openSeadragonViewer:h}=r,d=["100%","auto"],g=(c==null?void 0:c.canvasHeight)&&d.includes(c==null?void 0:c.canvasHeight),[A,p]=k.useState(!1),[y,v]=k.useState(!1),[E,I]=k.useState([]),[C,w]=k.useState([]),[S,x]=k.useState(),[T,Q]=jde(!1),M=i8(Ww.sm),[R,z]=k.useState(),q=k.useCallback(N=>{s({type:"updateInformationOpen",isInformationOpen:N})},[s]);k.useEffect(()=>{var N;(N=c==null?void 0:c.informationPanel)!=null&&N.open&&q(!M)},[M,(n=c==null?void 0:c.informationPanel)==null?void 0:n.open,q]),k.useEffect(()=>{if(!M){Q(!1);return}Q(a)},[a,M,Q]),k.useEffect(()=>{const N=Gm(l,o);N&&(v(["Sound","Video"].indexOf(N[0].type)>-1),I(N)),Due(l,o).then(G=>{G.length>0&&s({type:"updateInformationOpen",isInformationOpen:!0}),w(G),p(G.length!==0)})},[o,C.length,l,s]);const X=i.service.some(N=>N.type==="SearchService2");return k.useEffect(()=>{if(X){const N=i.service.find(G=>G.type==="SearchService2");N&&z(N.id)}},[i,X]),k.useEffect(()=>{var N,G,j;R&&((N=c.informationPanel)==null?void 0:N.renderContentSearch)!==!1&&pQ(u,R,(j=(G=c.localeText)==null?void 0:G.contentSearch)==null?void 0:j.tabLabel,t).then(V=>{x(V)})},[R]),k.useEffect(()=>{if(!h||!S)return;const N=l.get({id:o,type:"Canvas"});CQ(h,"content-search-overlay"),Wue(u,S,h,N,c)},[h,S]),P.createElement(np,{FallbackComponent:Yw},P.createElement(ece,{className:`${e} clover-viewer`,css:{background:c==null?void 0:c.background},"data-body-locked":T,"data-absolute-position":g,"data-information-panel":A,"data-information-panel-open":a},P.createElement(hY,{open:a,onOpenChange:q},P.createElement($de,{manifestLabel:i.label,manifestId:i.id}),P.createElement(xde,{activeCanvas:o,painting:E,annotationResources:C,searchServiceUrl:R,setContentSearchResource:x,contentSearchResource:S,items:i.items,isAudioVideo:y}))))},n8={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function Kde(i){return{ok:i.status>=200&&i.status<300,status:i.status,statusText:i.statusText,headers:i.getAllResponseHeaders(),data:i.responseText,json:()=>JSON.parse(i.responseText)}}function r8(i,e=null){return{ok:!1,status:i.status,statusText:i.statusText,headers:i.getAllResponseHeaders(),data:e||i.statusText,json:()=>JSON.parse(e||i.statusText)}}function Yde(i,e=n8){const t=e.headers||n8.headers;return new Promise((n,r)=>{const s=new XMLHttpRequest;s.open("get",i),s.withCredentials=e.withCredentials,t&&Object.keys(t).forEach(o=>s.setRequestHeader(o,t[o])),s.onload=()=>{n(Kde(s))},s.onerror=()=>{r(r8(s,"Failed to make request."))},s.ontimeout=()=>{r(r8(s,"Request took longer than expected."))},s.send()})}const Zde=({canvasIdCallback:i=()=>{},customDisplays:e=[],plugins:t=[],customTheme:n,iiifContent:r,id:s,manifestId:o,options:a,iiifContentSearchQuery:l})=>{var u,c,h;let d=r;s&&(d=s),o&&(d=o);const g=cQ((c=(u=a==null?void 0:a.informationPanel)==null?void 0:u.vtt)==null?void 0:c.autoScroll);return P.createElement(Lue,{initialState:{...Um,customDisplays:e,plugins:t,isAutoScrollEnabled:g.enabled,isInformationOpen:!!((h=a==null?void 0:a.informationPanel)!=null&&h.open),vault:new Af({customFetcher:A=>Yde(A,{withCredentials:a==null?void 0:a.withCredentials,headers:a==null?void 0:a.requestHeaders}).then(p=>JSON.parse(p.data))})}},P.createElement(Xde,{iiifContent:d,canvasIdCallback:i,customTheme:n,options:a,iiifContentSearchQuery:l}))},Xde=({canvasIdCallback:i,customTheme:e,iiifContent:t,options:n,iiifContentSearchQuery:r})=>{const s=Ar(),o=ni(),{activeCanvas:a,activeManifest:l,isLoaded:u,vault:c}=o,[h,d]=k.useState(),[g,A]=k.useState();let p={};return e&&(p=jY("custom",e)),k.useEffect(()=>{i&&i(a)},[a,i]),k.useEffect(()=>{l&&c.loadManifest(l).then(y=>{A(y),s({type:"updateActiveCanvas",canvasId:Nue(t,y)})}).catch(y=>{console.error(`Manifest failed to load: ${y}`)}).finally(()=>{s({type:"updateIsLoaded",isLoaded:!0})})},[t,l,s,c]),k.useEffect(()=>{s({type:"updateConfigOptions",configOptions:n});const y=Oue(t);c.load(y).then(v=>{d(v)}).catch(v=>{console.error(`The IIIF resource ${t} failed to load: ${v}`)})},[s,t,n,c]),k.useEffect(()=>{if((h==null?void 0:h.type)==="Collection"){s({type:"updateCollection",collection:h});const y=Que(t,h);y&&s({type:"updateActiveManifest",manifestId:y})}else(h==null?void 0:h.type)==="Manifest"&&s({type:"updateActiveManifest",manifestId:h.id})},[s,t,h]),u?!g||!g.items?(console.log(`The IIIF manifest ${t} failed to load.`),P.createElement(P.Fragment,null)):g.items.length===0?(console.log(`The IIIF manifest ${t} does not contain canvases.`),P.createElement(P.Fragment,null)):P.createElement(Wde,{manifest:g,theme:p,key:g.id,iiifContentSearchQuery:r}):P.createElement(P.Fragment,null,"Loading")};let Ql=window.OpenSeadragon;if(!Ql&&(Ql=Ic,!Ql))throw new Error("OpenSeadragon is missing.");const s8="http://www.w3.org/2000/svg";Ql.Viewer&&(Ql.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo?this._svgOverlayInfo:(this._svgOverlayInfo=new o8(this),this._svgOverlayInfo)});const o8=function(i){const e=this;this._viewer=i,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(s8,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(s8,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){e.resize()}),this._viewer.addHandler("open",function(){e.resize()}),this._viewer.addHandler("rotate",function(){e.resize()}),this._viewer.addHandler("flip",function(){e.resize()}),this._viewer.addHandler("resize",function(){e.resize()}),this.resize()};o8.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));const i=this._viewer.viewport.pixelFromPoint(new Ql.Point(0,0),!0),e=this._viewer.viewport.getZoom(!0),t=this._viewer.viewport.getRotation(),n=this._viewer.viewport.getFlip(),r=this._viewer.viewport._containerInnerSize.x;let s=r*e;const o=s;n&&(s=-s,i.x=-i.x+r),this._node.setAttribute("transform","translate("+i.x+","+i.y+") scale("+s+","+o+") rotate("+t+")")},onClick:function(i,e){new Ql.MouseTracker({element:i,clickHandler:e}).setTracking(!0)}};const Jde=i=>fetch(`${i.replace(/\/$/,"")}/info.json`).then(e=>e.json()).then(e=>e).catch(e=>{console.error(`The IIIF tilesource ${i.replace(/\/$/,"")}/info.json failed to load: ${e}`)}),efe=i=>{let e,t;if(Array.isArray(i)&&(e=i[0],e)){let n;"@id"in e?n=e["@id"]:n=e.id,t=n}return t};var qf=(i=>(i.TiledImage="tiledImage",i.SimpleImage="simpleImage",i))(qf||{});const tfe=i=>{const e=Array.isArray(i==null?void 0:i.service)&&(i==null?void 0:i.service.length)>0,t=e?efe(i==null?void 0:i.service):i==null?void 0:i.id,n=e?qf.TiledImage:qf.SimpleImage;return{uri:t,imageType:n}},ife=(i,e)=>{const t=e?qf.TiledImage:qf.SimpleImage;return{uri:i,imageType:t}},rx=209,nfe={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${rx} 100% 38.2%)`,accentMuted:`hsl(${rx} 80% 61.8%)`,accentAlt:`hsl(${rx} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},rfe={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:Ba,css:Bye,keyframes:Rye,createTheme:Lye}=C_({theme:nfe,media:rfe}),sfe=Ba("div",{display:"flex",flexDirection:"column",alignItems:"center"}),ofe=Ba("p",{fontWeight:"bold",fontSize:"x-large"}),afe=Ba("span",{fontSize:"medium"}),lfe=({error:i})=>{const{message:e}=i;return P.createElement(sfe,{role:"alert"},P.createElement(ofe,{"data-testid":"headline"},"Something went wrong"),e&&P.createElement(afe,null,`Error message: ${e}`," "))},sx=Ba("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),ufe=Ba("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),cfe=Ba("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${sx}`]:{display:"block"}},false:{[`${sx}`]:{display:"none"}}}}}),hfe=Ba("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),oh=({className:i,id:e,label:t,children:n})=>{const r=t.toLowerCase().replace(/\s/g,"-");return P.createElement(hfe,{id:e,className:i,"data-testid":"openseadragon-button","data-button":r},P.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},P.createElement("title",{id:`${e}-svg-title`},t),n))},dfe=Ba("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),ffe={behavior:"smooth",block:"center"},ah={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:ffe}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1,localeText:{contentSearch:{tabLabel:"Search Results",formPlaceholder:"Enter search words",noSearchResults:"No search results",loading:"Loading...",moreResults:"more results"}}};function gfe(i){let e={...ah.informationPanel.vtt.autoScroll};return typeof i=="object"&&(e="enabled"in i?i:{enabled:!0,settings:i}),i===!1&&(e.enabled=!1),Afe(e.settings),e}function Afe({behavior:i,block:e}){const t=["auto","instant","smooth"],n=["center","end","nearest","start"];if(!t.includes(i))throw TypeError(`'${i}' not in ${t.join(" | ")}`);if(!n.includes(e))throw TypeError(`'${e}' not in ${n.join(" | ")}`)}var a8,l8;const pfe=gfe((l8=(a8=ah==null?void 0:ah.informationPanel)==null?void 0:a8.vtt)==null?void 0:l8.autoScroll);var u8;const c8={activeCanvas:"",activeManifest:"",OSDImageLoaded:!1,collection:{},configOptions:ah,customDisplays:[],plugins:[],isAutoScrollEnabled:pfe.enabled,isAutoScrolling:!1,isInformationOpen:(u8=ah==null?void 0:ah.informationPanel)==null?void 0:u8.open,isLoaded:!1,isUserScrolling:void 0,vault:new Af,contentSearchVault:new Af,openSeadragonViewer:null,viewerId:vc()},mfe=P.createContext(c8),yfe=P.createContext(c8);function h8(){const i=P.useContext(mfe);if(i===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return i}function d8(){const i=P.useContext(yfe);if(i===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return i}const vfe=()=>P.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),Efe=()=>P.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),Ife=()=>P.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),_fe=()=>P.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),f8=()=>P.createElement(P.Fragment,null,P.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),P.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),Cfe=({_cloverViewerHasPlaceholder:i,config:e})=>{const t=h8(),{activeCanvas:n,plugins:r,vault:s}=t,o=s.get({id:n,type:"Canvas"});function a(){return r.filter(l=>{var u;return(u=l.imageViewer)==null?void 0:u.controls}).map((l,u)=>{var c,h,d,g;const A=(h=(c=l.imageViewer)==null?void 0:c.controls)==null?void 0:h.component;return P.createElement(A,{key:u,...(g=(d=l==null?void 0:l.imageViewer)==null?void 0:d.controls)==null?void 0:g.componentProps,canvas:o,useViewerDispatch:d8,useViewerState:h8})})}return P.createElement(dfe,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:i},e.showZoomControl&&P.createElement(P.Fragment,null,P.createElement(oh,{id:e.zoomInButton,label:"zoom in"},P.createElement(vfe,null)),P.createElement(oh,{id:e.zoomOutButton,label:"zoom out"},P.createElement(Efe,null))),e.showFullPageControl&&P.createElement(oh,{id:e.fullPageButton,label:"full page"},P.createElement(Ife,null)),e.showRotationControl&&P.createElement(P.Fragment,null,P.createElement(oh,{id:e.rotateRightButton,label:"rotate right"},P.createElement(f8,null)),P.createElement(oh,{id:e.rotateLeftButton,label:"rotate left"},P.createElement(f8,null))),e.showHomeControl&&P.createElement(oh,{id:e.homeButton,label:"reset"},P.createElement(_fe,null)),a())},wfe=({ariaLabel:i,config:e,uri:t,_cloverViewerHasPlaceholder:n,imageType:r,openSeadragonCallback:s})=>{const[o,a]=k.useState(),[l,u]=k.useState(),c=d8(),h=k.useRef(!1);return k.useEffect(()=>(h.current||(h.current=!0,l||u(Ic(e))),()=>l==null?void 0:l.destroy()),[]),k.useEffect(()=>{l&&s&&s(l)},[l,s]),k.useEffect(()=>{l&&t!==o&&(l==null||l.forceRedraw(),a(t))},[l,o,t]),k.useEffect(()=>{if(o&&l)switch(r){case"simpleImage":l==null||l.addSimpleImage({url:o});break;case"tiledImage":Jde(o).then(d=>{try{if(!d)throw new Error(`No tile source found for ${o}`);l==null||l.addTiledImage({tileSource:d,success:()=>{typeof c=="function"&&c({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(g){console.error(g)}});break;default:l==null||l.close(),console.warn(`Unable to render ${o} in OpenSeadragon as type: "${r}"`);break}},[r,o]),P.createElement(cfe,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":e.id,hasNavigator:e.showNavigator},P.createElement(Cfe,{_cloverViewerHasPlaceholder:n,config:e}),e.showNavigator&&P.createElement(sx,{id:e.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),P.createElement(ufe,{id:e.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...i&&{"aria-label":i}}))};function xfe(i){return{id:`openseadragon-${i}`,navigatorId:`openseadragon-navigator-${i}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${i}`,homeButton:`reset-${i}`,rotateLeftButton:`rotateLeft-${i}`,rotateRightButton:`rotateRight-${i}`,zoomInButton:`zoomIn-${i}`,zoomOutButton:`zoomOut-${i}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}}}const bfe=(i,e="none")=>{if(!i)return null;if(typeof i=="string")return[i];if(!i[e]){const t=Object.getOwnPropertyNames(i);if(t.length>0)return i[t[0]]}return!i[e]||!Array.isArray(i[e])?null:i[e]},Sfe=(i,e="none",t=", ")=>{const n=bfe(i,e);return Array.isArray(n)?n.join(`${t}`):n},Tfe=({_cloverViewerHasPlaceholder:i=!1,body:e,instanceId:t,isTiledImage:n=!1,label:r,src:s="",openSeadragonCallback:o,openSeadragonConfig:a={}})=>{const l=t||vc(),u=typeof r=="string"?r:Sfe(r),c={...xfe(l),...a},{imageType:h,uri:d}=e?tfe(e):ife(s,n);return d?P.createElement(np,{FallbackComponent:lfe},P.createElement(wfe,{_cloverViewerHasPlaceholder:i,ariaLabel:u,config:c,imageType:h,key:l,uri:d,openSeadragonCallback:o})):null},Bfe={showTitle:!1,showIIIFBadge:!1,informationPanel:{renderToggle:!1,renderAbout:!1}};class ox extends Br{connect(){WD(this.element).render(this.getViewer(this.protocolValue,this.urlValue))}getViewer(e,t){if(e=="Iiif")return k.createElement("div",{style:{height:400}},k.createElement(Tfe,{src:t.replace(/\/info\.json$/,""),isTiledImage:!0}));if(e=="IiifManifest")return k.createElement(Zde,{iiifContent:t,options:Bfe});console.error(`Unsupported protocol name: "${e}"`)}}Ni(ox,"values",{url:String,protocol:String});class ax extends Br{connect(){fetch(this.urlValue).then(e=>e.json()).then(e=>{e&&(this.element.innerHTML=e.html)}).catch(e=>{console.error("Error loading oEmbed data:",e)})}}Ni(ax,"values",{url:String});var lx={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(i,e){(function(t,n){n(e)})(We,function(t){var n="1.9.4";function r(f){var m,_,b,B;for(_=1,b=arguments.length;_<b;_++){B=arguments[_];for(m in B)f[m]=B[m]}return f}var s=Object.create||function(){function f(){}return function(m){return f.prototype=m,new f}}();function o(f,m){var _=Array.prototype.slice;if(f.bind)return f.bind.apply(f,_.call(arguments,1));var b=_.call(arguments,2);return function(){return f.apply(m,b.length?b.concat(_.call(arguments)):arguments)}}var a=0;function l(f){return"_leaflet_id"in f||(f._leaflet_id=++a),f._leaflet_id}function u(f,m,_){var b,B,H,ee;return ee=function(){b=!1,B&&(H.apply(_,B),B=!1)},H=function(){b?B=arguments:(f.apply(_,arguments),setTimeout(ee,m),b=!0)},H}function c(f,m,_){var b=m[1],B=m[0],H=b-B;return f===b&&_?f:((f-B)%H+H)%H+B}function h(){return!1}function d(f,m){if(m===!1)return f;var _=Math.pow(10,m===void 0?6:m);return Math.round(f*_)/_}function g(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function A(f){return g(f).split(/\s+/)}function p(f,m){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?s(f.options):{});for(var _ in m)f.options[_]=m[_];return f.options}function y(f,m,_){var b=[];for(var B in f)b.push(encodeURIComponent(_?B.toUpperCase():B)+"="+encodeURIComponent(f[B]));return(!m||m.indexOf("?")===-1?"?":"&")+b.join("&")}var v=/\{ *([\w_ -]+) *\}/g;function E(f,m){return f.replace(v,function(_,b){var B=m[b];if(B===void 0)throw new Error("No value provided for variable "+_);return typeof B=="function"&&(B=B(m)),B})}var I=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function C(f,m){for(var _=0;_<f.length;_++)if(f[_]===m)return _;return-1}var w="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function S(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var x=0;function T(f){var m=+new Date,_=Math.max(0,16-(m-x));return x=m+_,window.setTimeout(f,_)}var Q=window.requestAnimationFrame||S("RequestAnimationFrame")||T,M=window.cancelAnimationFrame||S("CancelAnimationFrame")||S("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function R(f,m,_){if(_&&Q===T)f.call(m);else return Q.call(window,o(f,m))}function z(f){f&&M.call(window,f)}var q={__proto__:null,extend:r,create:s,bind:o,get lastId(){return a},stamp:l,throttle:u,wrapNum:c,falseFn:h,formatNum:d,trim:g,splitWords:A,setOptions:p,getParamString:y,template:E,isArray:I,indexOf:C,emptyImageUrl:w,requestFn:Q,cancelFn:M,requestAnimFrame:R,cancelAnimFrame:z};function X(){}X.extend=function(f){var m=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},_=m.__super__=this.prototype,b=s(_);b.constructor=m,m.prototype=b;for(var B in this)Object.prototype.hasOwnProperty.call(this,B)&&B!=="prototype"&&B!=="__super__"&&(m[B]=this[B]);return f.statics&&r(m,f.statics),f.includes&&(N(f.includes),r.apply(null,[b].concat(f.includes))),r(b,f),delete b.statics,delete b.includes,b.options&&(b.options=_.options?s(_.options):{},r(b.options,f.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){_.callInitHooks&&_.callInitHooks.call(this),this._initHooksCalled=!0;for(var H=0,ee=b._initHooks.length;H<ee;H++)b._initHooks[H].call(this)}},m},X.include=function(f){var m=this.prototype.options;return r(this.prototype,f),f.options&&(this.prototype.options=m,this.mergeOptions(f.options)),this},X.mergeOptions=function(f){return r(this.prototype.options,f),this},X.addInitHook=function(f){var m=Array.prototype.slice.call(arguments,1),_=typeof f=="function"?f:function(){this[f].apply(this,m)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(_),this};function N(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=I(f)?f:[f];for(var m=0;m<f.length;m++)f[m]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var G={on:function(f,m,_){if(typeof f=="object")for(var b in f)this._on(b,f[b],m);else{f=A(f);for(var B=0,H=f.length;B<H;B++)this._on(f[B],m,_)}return this},off:function(f,m,_){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var b in f)this._off(b,f[b],m);else{f=A(f);for(var B=arguments.length===1,H=0,ee=f.length;H<ee;H++)B?this._off(f[H]):this._off(f[H],m,_)}return this},_on:function(f,m,_,b){if(typeof m!="function"){console.warn("wrong listener type: "+typeof m);return}if(this._listens(f,m,_)===!1){_===this&&(_=void 0);var B={fn:m,ctx:_};b&&(B.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(B)}},_off:function(f,m,_){var b,B,H;if(this._events&&(b=this._events[f],!!b)){if(arguments.length===1){if(this._firingCount)for(B=0,H=b.length;B<H;B++)b[B].fn=h;delete this._events[f];return}if(typeof m!="function"){console.warn("wrong listener type: "+typeof m);return}var ee=this._listens(f,m,_);if(ee!==!1){var ae=b[ee];this._firingCount&&(ae.fn=h,this._events[f]=b=b.slice()),b.splice(ee,1)}}},fire:function(f,m,_){if(!this.listens(f,_))return this;var b=r({},m,{type:f,target:this,sourceTarget:m&&m.sourceTarget||this});if(this._events){var B=this._events[f];if(B){this._firingCount=this._firingCount+1||1;for(var H=0,ee=B.length;H<ee;H++){var ae=B[H],he=ae.fn;ae.once&&this.off(f,he,ae.ctx),he.call(ae.ctx||this,b)}this._firingCount--}}return _&&this._propagateEvent(b),this},listens:function(f,m,_,b){typeof f!="string"&&console.warn('"string" type argument expected');var B=m;typeof m!="function"&&(b=!!m,B=void 0,_=void 0);var H=this._events&&this._events[f];if(H&&H.length&&this._listens(f,B,_)!==!1)return!0;if(b){for(var ee in this._eventParents)if(this._eventParents[ee].listens(f,m,_,b))return!0}return!1},_listens:function(f,m,_){if(!this._events)return!1;var b=this._events[f]||[];if(!m)return!!b.length;_===this&&(_=void 0);for(var B=0,H=b.length;B<H;B++)if(b[B].fn===m&&b[B].ctx===_)return B;return!1},once:function(f,m,_){if(typeof f=="object")for(var b in f)this._on(b,f[b],m,!0);else{f=A(f);for(var B=0,H=f.length;B<H;B++)this._on(f[B],m,_,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[l(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[l(f)],this},_propagateEvent:function(f){for(var m in this._eventParents)this._eventParents[m].fire(f.type,r({layer:f.target,propagatedFrom:f.target},f),!0)}};G.addEventListener=G.on,G.removeEventListener=G.clearAllEventListeners=G.off,G.addOneTimeEventListener=G.once,G.fireEvent=G.fire,G.hasEventListeners=G.listens;var j=X.extend(G);function V(f,m,_){this.x=_?Math.round(f):f,this.y=_?Math.round(m):m}var Z=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};V.prototype={clone:function(){return new V(this.x,this.y)},add:function(f){return this.clone()._add(Y(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(Y(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new V(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new V(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Z(this.x),this.y=Z(this.y),this},distanceTo:function(f){f=Y(f);var m=f.x-this.x,_=f.y-this.y;return Math.sqrt(m*m+_*_)},equals:function(f){return f=Y(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=Y(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+d(this.x)+", "+d(this.y)+")"}};function Y(f,m,_){return f instanceof V?f:I(f)?new V(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new V(f.x,f.y):new V(f,m,_)}function te(f,m){if(f)for(var _=m?[f,m]:f,b=0,B=_.length;b<B;b++)this.extend(_[b])}te.prototype={extend:function(f){var m,_;if(!f)return this;if(f instanceof V||typeof f[0]=="number"||"x"in f)m=_=Y(f);else if(f=J(f),m=f.min,_=f.max,!m||!_)return this;return!this.min&&!this.max?(this.min=m.clone(),this.max=_.clone()):(this.min.x=Math.min(m.x,this.min.x),this.max.x=Math.max(_.x,this.max.x),this.min.y=Math.min(m.y,this.min.y),this.max.y=Math.max(_.y,this.max.y)),this},getCenter:function(f){return Y((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return Y(this.min.x,this.max.y)},getTopRight:function(){return Y(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var m,_;return typeof f[0]=="number"||f instanceof V?f=Y(f):f=J(f),f instanceof te?(m=f.min,_=f.max):m=_=f,m.x>=this.min.x&&_.x<=this.max.x&&m.y>=this.min.y&&_.y<=this.max.y},intersects:function(f){f=J(f);var m=this.min,_=this.max,b=f.min,B=f.max,H=B.x>=m.x&&b.x<=_.x,ee=B.y>=m.y&&b.y<=_.y;return H&&ee},overlaps:function(f){f=J(f);var m=this.min,_=this.max,b=f.min,B=f.max,H=B.x>m.x&&b.x<_.x,ee=B.y>m.y&&b.y<_.y;return H&&ee},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var m=this.min,_=this.max,b=Math.abs(m.x-_.x)*f,B=Math.abs(m.y-_.y)*f;return J(Y(m.x-b,m.y-B),Y(_.x+b,_.y+B))},equals:function(f){return f?(f=J(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function J(f,m){return!f||f instanceof te?f:new te(f,m)}function ce(f,m){if(f)for(var _=m?[f,m]:f,b=0,B=_.length;b<B;b++)this.extend(_[b])}ce.prototype={extend:function(f){var m=this._southWest,_=this._northEast,b,B;if(f instanceof ne)b=f,B=f;else if(f instanceof ce){if(b=f._southWest,B=f._northEast,!b||!B)return this}else return f?this.extend(ue(f)||ie(f)):this;return!m&&!_?(this._southWest=new ne(b.lat,b.lng),this._northEast=new ne(B.lat,B.lng)):(m.lat=Math.min(b.lat,m.lat),m.lng=Math.min(b.lng,m.lng),_.lat=Math.max(B.lat,_.lat),_.lng=Math.max(B.lng,_.lng)),this},pad:function(f){var m=this._southWest,_=this._northEast,b=Math.abs(m.lat-_.lat)*f,B=Math.abs(m.lng-_.lng)*f;return new ce(new ne(m.lat-b,m.lng-B),new ne(_.lat+b,_.lng+B))},getCenter:function(){return new ne((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ne(this.getNorth(),this.getWest())},getSouthEast:function(){return new ne(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ne||"lat"in f?f=ue(f):f=ie(f);var m=this._southWest,_=this._northEast,b,B;return f instanceof ce?(b=f.getSouthWest(),B=f.getNorthEast()):b=B=f,b.lat>=m.lat&&B.lat<=_.lat&&b.lng>=m.lng&&B.lng<=_.lng},intersects:function(f){f=ie(f);var m=this._southWest,_=this._northEast,b=f.getSouthWest(),B=f.getNorthEast(),H=B.lat>=m.lat&&b.lat<=_.lat,ee=B.lng>=m.lng&&b.lng<=_.lng;return H&&ee},overlaps:function(f){f=ie(f);var m=this._southWest,_=this._northEast,b=f.getSouthWest(),B=f.getNorthEast(),H=B.lat>m.lat&&b.lat<_.lat,ee=B.lng>m.lng&&b.lng<_.lng;return H&&ee},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,m){return f?(f=ie(f),this._southWest.equals(f.getSouthWest(),m)&&this._northEast.equals(f.getNorthEast(),m)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ie(f,m){return f instanceof ce?f:new ce(f,m)}function ne(f,m,_){if(isNaN(f)||isNaN(m))throw new Error("Invalid LatLng object: ("+f+", "+m+")");this.lat=+f,this.lng=+m,_!==void 0&&(this.alt=+_)}ne.prototype={equals:function(f,m){if(!f)return!1;f=ue(f);var _=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return _<=(m===void 0?1e-9:m)},toString:function(f){return"LatLng("+d(this.lat,f)+", "+d(this.lng,f)+")"},distanceTo:function(f){return me.distance(this,ue(f))},wrap:function(){return me.wrapLatLng(this)},toBounds:function(f){var m=180*f/40075017,_=m/Math.cos(Math.PI/180*this.lat);return ie([this.lat-m,this.lng-_],[this.lat+m,this.lng+_])},clone:function(){return new ne(this.lat,this.lng,this.alt)}};function ue(f,m,_){return f instanceof ne?f:I(f)&&typeof f[0]!="object"?f.length===3?new ne(f[0],f[1],f[2]):f.length===2?new ne(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ne(f.lat,"lng"in f?f.lng:f.lon,f.alt):m===void 0?null:new ne(f,m,_)}var fe={latLngToPoint:function(f,m){var _=this.projection.project(f),b=this.scale(m);return this.transformation._transform(_,b)},pointToLatLng:function(f,m){var _=this.scale(m),b=this.transformation.untransform(f,_);return this.projection.unproject(b)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var m=this.projection.bounds,_=this.scale(f),b=this.transformation.transform(m.min,_),B=this.transformation.transform(m.max,_);return new te(b,B)},infinite:!1,wrapLatLng:function(f){var m=this.wrapLng?c(f.lng,this.wrapLng,!0):f.lng,_=this.wrapLat?c(f.lat,this.wrapLat,!0):f.lat,b=f.alt;return new ne(_,m,b)},wrapLatLngBounds:function(f){var m=f.getCenter(),_=this.wrapLatLng(m),b=m.lat-_.lat,B=m.lng-_.lng;if(b===0&&B===0)return f;var H=f.getSouthWest(),ee=f.getNorthEast(),ae=new ne(H.lat-b,H.lng-B),he=new ne(ee.lat-b,ee.lng-B);return new ce(ae,he)}},me=r({},fe,{wrapLng:[-180,180],R:6371e3,distance:function(f,m){var _=Math.PI/180,b=f.lat*_,B=m.lat*_,H=Math.sin((m.lat-f.lat)*_/2),ee=Math.sin((m.lng-f.lng)*_/2),ae=H*H+Math.cos(b)*Math.cos(B)*ee*ee,he=2*Math.atan2(Math.sqrt(ae),Math.sqrt(1-ae));return this.R*he}}),Pe=6378137,Re={R:Pe,MAX_LATITUDE:85.0511287798,project:function(f){var m=Math.PI/180,_=this.MAX_LATITUDE,b=Math.max(Math.min(_,f.lat),-_),B=Math.sin(b*m);return new V(this.R*f.lng*m,this.R*Math.log((1+B)/(1-B))/2)},unproject:function(f){var m=180/Math.PI;return new ne((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*m,f.x*m/this.R)},bounds:function(){var f=Pe*Math.PI;return new te([-f,-f],[f,f])}()};function Qe(f,m,_,b){if(I(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=m,this._c=_,this._d=b}Qe.prototype={transform:function(f,m){return this._transform(f.clone(),m)},_transform:function(f,m){return m=m||1,f.x=m*(this._a*f.x+this._b),f.y=m*(this._c*f.y+this._d),f},untransform:function(f,m){return m=m||1,new V((f.x/m-this._b)/this._a,(f.y/m-this._d)/this._c)}};function Oe(f,m,_,b){return new Qe(f,m,_,b)}var wt=r({},me,{code:"EPSG:3857",projection:Re,transformation:function(){var f=.5/(Math.PI*Re.R);return Oe(f,.5,-f,.5)}()}),ft=r({},wt,{code:"EPSG:900913"});function pt(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function at(f,m){var _="",b,B,H,ee,ae,he;for(b=0,H=f.length;b<H;b++){for(ae=f[b],B=0,ee=ae.length;B<ee;B++)he=ae[B],_+=(B?"L":"M")+he.x+" "+he.y;_+=m?Ge.svg?"z":"x":""}return _||"M0 0"}var D=document.documentElement.style,W="ActiveXObject"in window,oe=W&&!document.addEventListener,ve="msLaunchUri"in navigator&&!("documentMode"in document),Ae=Ai("webkit"),Se=Ai("android"),xe=Ai("android 2")||Ai("android 3"),Xe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ot=Se&&Ai("Google")&&Xe<537&&!("AudioNode"in window),gt=!!window.opera,He=!ve&&Ai("chrome"),Ct=Ai("gecko")&&!Ae&&!gt&&!W,O=!He&&Ai("safari"),F=Ai("phantom"),$="OTransition"in D,K=navigator.platform.indexOf("Win")===0,ge=W&&"transition"in D,Ie="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xe,Ue="MozPerspective"in D,yt=!window.L_DISABLE_3D&&(ge||Ie||Ue)&&!$&&!F,Ne=typeof orientation<"u"||Ai("mobile"),Fi=Ne&&Ae,Zt=Ne&&Ie,En=!window.PointerEvent&&window.MSPointerEvent,Vr=!!(window.PointerEvent||En),qr="ontouchstart"in window||!!window.TouchEvent,Wl=!window.L_NO_TOUCH&&(qr||Vr),vy=Ne&&gt,In=Ne&&Ct,Fa=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Qn=function(){var f=!1;try{var m=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",h,m),window.removeEventListener("testPassiveEventSupport",h,m)}catch{}return f}(),$r=function(){return!!document.createElement("canvas").getContext}(),Wi=!!(document.createElementNS&&pt("svg").createSVGRect),yh=!!Wi&&function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),vh=!Wi&&function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var m=f.firstChild;return m.style.behavior="url(#default#VML)",m&&typeof m.adj=="object"}catch{return!1}}(),un=navigator.platform.indexOf("Mac")===0,Un=navigator.platform.indexOf("Linux")===0;function Ai(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var Ge={ie:W,ielt9:oe,edge:ve,webkit:Ae,android:Se,android23:xe,androidStock:ot,opera:gt,chrome:He,gecko:Ct,safari:O,phantom:F,opera12:$,win:K,ie3d:ge,webkit3d:Ie,gecko3d:Ue,any3d:yt,mobile:Ne,mobileWebkit:Fi,mobileWebkit3d:Zt,msPointer:En,pointer:Vr,touch:Wl,touchNative:qr,mobileOpera:vy,mobileGecko:In,retina:Fa,passiveEvents:Qn,canvas:$r,svg:Wi,vml:vh,inlineSvg:yh,mac:un,linux:Un},u4=Ge.msPointer?"MSPointerDown":"pointerdown",c4=Ge.msPointer?"MSPointerMove":"pointermove",h4=Ge.msPointer?"MSPointerUp":"pointerup",d4=Ge.msPointer?"MSPointerCancel":"pointercancel",ob={touchstart:u4,touchmove:c4,touchend:h4,touchcancel:d4},f4={touchstart:Wpe,touchmove:Ey,touchend:Ey,touchcancel:Ey},Eh={},g4=!1;function zpe(f,m,_){return m==="touchstart"&&jpe(),f4[m]?(_=f4[m].bind(this,_),f.addEventListener(ob[m],_,!1),_):(console.warn("wrong event specified:",m),h)}function Vpe(f,m,_){if(!ob[m]){console.warn("wrong event specified:",m);return}f.removeEventListener(ob[m],_,!1)}function qpe(f){Eh[f.pointerId]=f}function $pe(f){Eh[f.pointerId]&&(Eh[f.pointerId]=f)}function A4(f){delete Eh[f.pointerId]}function jpe(){g4||(document.addEventListener(u4,qpe,!0),document.addEventListener(c4,$pe,!0),document.addEventListener(h4,A4,!0),document.addEventListener(d4,A4,!0),g4=!0)}function Ey(f,m){if(m.pointerType!==(m.MSPOINTER_TYPE_MOUSE||"mouse")){m.touches=[];for(var _ in Eh)m.touches.push(Eh[_]);m.changedTouches=[m],f(m)}}function Wpe(f,m){m.MSPOINTER_TYPE_TOUCH&&m.pointerType===m.MSPOINTER_TYPE_TOUCH&&Ki(m),Ey(f,m)}function Kpe(f){var m={},_,b;for(b in f)_=f[b],m[b]=_&&_.bind?_.bind(f):_;return f=m,m.type="dblclick",m.detail=2,m.isTrusted=!1,m._simulated=!0,m}var Ype=200;function Zpe(f,m){f.addEventListener("dblclick",m);var _=0,b;function B(H){if(H.detail!==1){b=H.detail;return}if(!(H.pointerType==="mouse"||H.sourceCapabilities&&!H.sourceCapabilities.firesTouchEvents)){var ee=E4(H);if(!(ee.some(function(he){return he instanceof HTMLLabelElement&&he.attributes.for})&&!ee.some(function(he){return he instanceof HTMLInputElement||he instanceof HTMLSelectElement}))){var ae=Date.now();ae-_<=Ype?(b++,b===2&&m(Kpe(H))):b=1,_=ae}}}return f.addEventListener("click",B),{dblclick:m,simDblclick:B}}function Xpe(f,m){f.removeEventListener("dblclick",m.dblclick),f.removeEventListener("click",m.simDblclick)}var ab=Cy(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),dg=Cy(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),p4=dg==="webkitTransition"||dg==="OTransition"?dg+"End":"transitionend";function m4(f){return typeof f=="string"?document.getElementById(f):f}function fg(f,m){var _=f.style[m]||f.currentStyle&&f.currentStyle[m];if((!_||_==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(f,null);_=b?b[m]:null}return _==="auto"?null:_}function xt(f,m,_){var b=document.createElement(f);return b.className=m||"",_&&_.appendChild(b),b}function ri(f){var m=f.parentNode;m&&m.removeChild(f)}function Iy(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Ih(f){var m=f.parentNode;m&&m.lastChild!==f&&m.appendChild(f)}function _h(f){var m=f.parentNode;m&&m.firstChild!==f&&m.insertBefore(f,m.firstChild)}function lb(f,m){if(f.classList!==void 0)return f.classList.contains(m);var _=_y(f);return _.length>0&&new RegExp("(^|\\s)"+m+"(\\s|$)").test(_)}function st(f,m){if(f.classList!==void 0)for(var _=A(m),b=0,B=_.length;b<B;b++)f.classList.add(_[b]);else if(!lb(f,m)){var H=_y(f);ub(f,(H?H+" ":"")+m)}}function ci(f,m){f.classList!==void 0?f.classList.remove(m):ub(f,g((" "+_y(f)+" ").replace(" "+m+" "," ")))}function ub(f,m){f.className.baseVal===void 0?f.className=m:f.className.baseVal=m}function _y(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function yr(f,m){"opacity"in f.style?f.style.opacity=m:"filter"in f.style&&Jpe(f,m)}function Jpe(f,m){var _=!1,b="DXImageTransform.Microsoft.Alpha";try{_=f.filters.item(b)}catch{if(m===1)return}m=Math.round(m*100),_?(_.Enabled=m!==100,_.Opacity=m):f.style.filter+=" progid:"+b+"(opacity="+m+")"}function Cy(f){for(var m=document.documentElement.style,_=0;_<f.length;_++)if(f[_]in m)return f[_];return!1}function Kl(f,m,_){var b=m||new V(0,0);f.style[ab]=(Ge.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(_?" scale("+_+")":"")}function pi(f,m){f._leaflet_pos=m,Ge.any3d?Kl(f,m):(f.style.left=m.x+"px",f.style.top=m.y+"px")}function Yl(f){return f._leaflet_pos||new V(0,0)}var gg,Ag,cb;if("onselectstart"in document)gg=function(){it(window,"selectstart",Ki)},Ag=function(){zt(window,"selectstart",Ki)};else{var pg=Cy(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);gg=function(){if(pg){var f=document.documentElement.style;cb=f[pg],f[pg]="none"}},Ag=function(){pg&&(document.documentElement.style[pg]=cb,cb=void 0)}}function hb(){it(window,"dragstart",Ki)}function db(){zt(window,"dragstart",Ki)}var wy,fb;function gb(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(xy(),wy=f,fb=f.style.outlineStyle,f.style.outlineStyle="none",it(window,"keydown",xy))}function xy(){wy&&(wy.style.outlineStyle=fb,wy=void 0,fb=void 0,zt(window,"keydown",xy))}function y4(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Ab(f){var m=f.getBoundingClientRect();return{x:m.width/f.offsetWidth||1,y:m.height/f.offsetHeight||1,boundingClientRect:m}}var eme={__proto__:null,TRANSFORM:ab,TRANSITION:dg,TRANSITION_END:p4,get:m4,getStyle:fg,create:xt,remove:ri,empty:Iy,toFront:Ih,toBack:_h,hasClass:lb,addClass:st,removeClass:ci,setClass:ub,getClass:_y,setOpacity:yr,testProp:Cy,setTransform:Kl,setPosition:pi,getPosition:Yl,get disableTextSelection(){return gg},get enableTextSelection(){return Ag},disableImageDrag:hb,enableImageDrag:db,preventOutline:gb,restoreOutline:xy,getSizedParentNode:y4,getScale:Ab};function it(f,m,_,b){if(m&&typeof m=="object")for(var B in m)mb(f,B,m[B],_);else{m=A(m);for(var H=0,ee=m.length;H<ee;H++)mb(f,m[H],_,b)}return this}var Ss="_leaflet_events";function zt(f,m,_,b){if(arguments.length===1)v4(f),delete f[Ss];else if(m&&typeof m=="object")for(var B in m)yb(f,B,m[B],_);else if(m=A(m),arguments.length===2)v4(f,function(ae){return C(m,ae)!==-1});else for(var H=0,ee=m.length;H<ee;H++)yb(f,m[H],_,b);return this}function v4(f,m){for(var _ in f[Ss]){var b=_.split(/\d/)[0];(!m||m(b))&&yb(f,b,null,null,_)}}var pb={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mb(f,m,_,b){var B=m+l(_)+(b?"_"+l(b):"");if(f[Ss]&&f[Ss][B])return this;var H=function(ae){return _.call(b||f,ae||window.event)},ee=H;!Ge.touchNative&&Ge.pointer&&m.indexOf("touch")===0?H=zpe(f,m,H):Ge.touch&&m==="dblclick"?H=Zpe(f,H):"addEventListener"in f?m==="touchstart"||m==="touchmove"||m==="wheel"||m==="mousewheel"?f.addEventListener(pb[m]||m,H,Ge.passiveEvents?{passive:!1}:!1):m==="mouseenter"||m==="mouseleave"?(H=function(ae){ae=ae||window.event,Eb(f,ae)&&ee(ae)},f.addEventListener(pb[m],H,!1)):f.addEventListener(m,ee,!1):f.attachEvent("on"+m,H),f[Ss]=f[Ss]||{},f[Ss][B]=H}function yb(f,m,_,b,B){B=B||m+l(_)+(b?"_"+l(b):"");var H=f[Ss]&&f[Ss][B];if(!H)return this;!Ge.touchNative&&Ge.pointer&&m.indexOf("touch")===0?Vpe(f,m,H):Ge.touch&&m==="dblclick"?Xpe(f,H):"removeEventListener"in f?f.removeEventListener(pb[m]||m,H,!1):f.detachEvent("on"+m,H),f[Ss][B]=null}function Zl(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function vb(f){return mb(f,"wheel",Zl),this}function mg(f){return it(f,"mousedown touchstart dblclick contextmenu",Zl),f._leaflet_disable_click=!0,this}function Ki(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Xl(f){return Ki(f),Zl(f),this}function E4(f){if(f.composedPath)return f.composedPath();for(var m=[],_=f.target;_;)m.push(_),_=_.parentNode;return m}function I4(f,m){if(!m)return new V(f.clientX,f.clientY);var _=Ab(m),b=_.boundingClientRect;return new V((f.clientX-b.left)/_.x-m.clientLeft,(f.clientY-b.top)/_.y-m.clientTop)}var tme=Ge.linux&&Ge.chrome?window.devicePixelRatio:Ge.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function _4(f){return Ge.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/tme:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function Eb(f,m){var _=m.relatedTarget;if(!_)return!0;try{for(;_&&_!==f;)_=_.parentNode}catch{return!1}return _!==f}var ime={__proto__:null,on:it,off:zt,stopPropagation:Zl,disableScrollPropagation:vb,disableClickPropagation:mg,preventDefault:Ki,stop:Xl,getPropagationPath:E4,getMousePosition:I4,getWheelDelta:_4,isExternalTarget:Eb,addListener:it,removeListener:zt},C4=j.extend({run:function(f,m,_,b){this.stop(),this._el=f,this._inProgress=!0,this._duration=_||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Yl(f),this._offset=m.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=R(this._animate,this),this._step()},_step:function(f){var m=+new Date-this._startTime,_=this._duration*1e3;m<_?this._runFrame(this._easeOut(m/_),f):(this._runFrame(1),this._complete())},_runFrame:function(f,m){var _=this._startPos.add(this._offset.multiplyBy(f));m&&_._round(),pi(this._el,_),this.fire("step")},_complete:function(){z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),vt=j.extend({options:{crs:wt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,m){m=p(this,m),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),m.maxBounds&&this.setMaxBounds(m.maxBounds),m.zoom!==void 0&&(this._zoom=this._limitZoom(m.zoom)),m.center&&m.zoom!==void 0&&this.setView(ue(m.center),m.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=dg&&Ge.any3d&&!Ge.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),it(this._proxy,p4,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,m,_){if(m=m===void 0?this._zoom:this._limitZoom(m),f=this._limitCenter(ue(f),m,this.options.maxBounds),_=_||{},this._stop(),this._loaded&&!_.reset&&_!==!0){_.animate!==void 0&&(_.zoom=r({animate:_.animate},_.zoom),_.pan=r({animate:_.animate,duration:_.duration},_.pan));var b=this._zoom!==m?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,m,_.zoom):this._tryAnimatedPan(f,_.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(f,m,_.pan&&_.pan.noMoveStart),this},setZoom:function(f,m){return this._loaded?this.setView(this.getCenter(),f,{zoom:m}):(this._zoom=f,this)},zoomIn:function(f,m){return f=f||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,m)},zoomOut:function(f,m){return f=f||(Ge.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,m)},setZoomAround:function(f,m,_){var b=this.getZoomScale(m),B=this.getSize().divideBy(2),H=f instanceof V?f:this.latLngToContainerPoint(f),ee=H.subtract(B).multiplyBy(1-1/b),ae=this.containerPointToLatLng(B.add(ee));return this.setView(ae,m,{zoom:_})},_getBoundsCenterZoom:function(f,m){m=m||{},f=f.getBounds?f.getBounds():ie(f);var _=Y(m.paddingTopLeft||m.padding||[0,0]),b=Y(m.paddingBottomRight||m.padding||[0,0]),B=this.getBoundsZoom(f,!1,_.add(b));if(B=typeof m.maxZoom=="number"?Math.min(m.maxZoom,B):B,B===1/0)return{center:f.getCenter(),zoom:B};var H=b.subtract(_).divideBy(2),ee=this.project(f.getSouthWest(),B),ae=this.project(f.getNorthEast(),B),he=this.unproject(ee.add(ae).divideBy(2).add(H),B);return{center:he,zoom:B}},fitBounds:function(f,m){if(f=ie(f),!f.isValid())throw new Error("Bounds are not valid.");var _=this._getBoundsCenterZoom(f,m);return this.setView(_.center,_.zoom,m)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,m){return this.setView(f,this._zoom,{pan:m})},panBy:function(f,m){if(f=Y(f).round(),m=m||{},!f.x&&!f.y)return this.fire("moveend");if(m.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new C4,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),m.noMoveStart||this.fire("movestart"),m.animate!==!1){st(this._mapPane,"leaflet-pan-anim");var _=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,_,m.duration||.25,m.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,m,_){if(_=_||{},_.animate===!1||!Ge.any3d)return this.setView(f,m,_);this._stop();var b=this.project(this.getCenter()),B=this.project(f),H=this.getSize(),ee=this._zoom;f=ue(f),m=m===void 0?ee:m;var ae=Math.max(H.x,H.y),he=ae*this.getZoomScale(ee,m),Ee=B.distanceTo(b)||1,Te=1.42,Ye=Te*Te;function lt(mi){var Oy=mi?-1:1,Vme=mi?he:ae,qme=he*he-ae*ae+Oy*Ye*Ye*Ee*Ee,$me=2*Vme*Ye*Ee,Lb=qme/$me,n5=Math.sqrt(Lb*Lb+1)-Lb,jme=n5<1e-9?-18:Math.log(n5);return jme}function _n(mi){return(Math.exp(mi)-Math.exp(-mi))/2}function Oi(mi){return(Math.exp(mi)+Math.exp(-mi))/2}function Er(mi){return _n(mi)/Oi(mi)}var Gn=lt(0);function Th(mi){return ae*(Oi(Gn)/Oi(Gn+Te*mi))}function Ume(mi){return ae*(Oi(Gn)*Er(Gn+Te*mi)-_n(Gn))/Ye}function Gme(mi){return 1-Math.pow(1-mi,1.5)}var Hme=Date.now(),t5=(lt(1)-Gn)/Te,zme=_.duration?1e3*_.duration:1e3*t5*.8;function i5(){var mi=(Date.now()-Hme)/zme,Oy=Gme(mi)*t5;mi<=1?(this._flyToFrame=R(i5,this),this._move(this.unproject(b.add(B.subtract(b).multiplyBy(Ume(Oy)/Ee)),ee),this.getScaleZoom(ae/Th(Oy),ee),{flyTo:!0})):this._move(f,m)._moveEnd(!0)}return this._moveStart(!0,_.noMoveStart),i5.call(this),this},flyToBounds:function(f,m){var _=this._getBoundsCenterZoom(f,m);return this.flyTo(_.center,_.zoom,m)},setMaxBounds:function(f){return f=ie(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var m=this.options.minZoom;return this.options.minZoom=f,this._loaded&&m!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var m=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&m!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,m){this._enforcingBounds=!0;var _=this.getCenter(),b=this._limitCenter(_,this._zoom,ie(f));return _.equals(b)||this.panTo(b,m),this._enforcingBounds=!1,this},panInside:function(f,m){m=m||{};var _=Y(m.paddingTopLeft||m.padding||[0,0]),b=Y(m.paddingBottomRight||m.padding||[0,0]),B=this.project(this.getCenter()),H=this.project(f),ee=this.getPixelBounds(),ae=J([ee.min.add(_),ee.max.subtract(b)]),he=ae.getSize();if(!ae.contains(H)){this._enforcingBounds=!0;var Ee=H.subtract(ae.getCenter()),Te=ae.extend(H).getSize().subtract(he);B.x+=Ee.x<0?-Te.x:Te.x,B.y+=Ee.y<0?-Te.y:Te.y,this.panTo(this.unproject(B),m),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=r({animate:!1,pan:!0},f===!0?{animate:!0}:f);var m=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var _=this.getSize(),b=m.divideBy(2).round(),B=_.divideBy(2).round(),H=b.subtract(B);return!H.x&&!H.y?this:(f.animate&&f.pan?this.panBy(H):(f.pan&&this._rawPanBy(H),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:m,newSize:_}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=r({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var m=o(this._handleGeolocationResponse,this),_=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(m,_,f):navigator.geolocation.getCurrentPosition(m,_,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var m=f.code,_=f.message||(m===1?"permission denied":m===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:m,message:"Geolocation error: "+_+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var m=f.coords.latitude,_=f.coords.longitude,b=new ne(m,_),B=b.toBounds(f.coords.accuracy*2),H=this._locateOptions;if(H.setView){var ee=this.getBoundsZoom(B);this.setView(b,H.maxZoom?Math.min(ee,H.maxZoom):ee)}var ae={latlng:b,bounds:B,timestamp:f.timestamp};for(var he in f.coords)typeof f.coords[he]=="number"&&(ae[he]=f.coords[he]);this.fire("locationfound",ae)}},addHandler:function(f,m){if(!m)return this;var _=this[f]=new m(this);return this._handlers.push(_),this.options[f]&&_.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ri(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)ri(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,m){var _="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),b=xt("div",_,m||this._mapPane);return f&&(this._panes[f]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),m=this.unproject(f.getBottomLeft()),_=this.unproject(f.getTopRight());return new ce(m,_)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,m,_){f=ie(f),_=Y(_||[0,0]);var b=this.getZoom()||0,B=this.getMinZoom(),H=this.getMaxZoom(),ee=f.getNorthWest(),ae=f.getSouthEast(),he=this.getSize().subtract(_),Ee=J(this.project(ae,b),this.project(ee,b)).getSize(),Te=Ge.any3d?this.options.zoomSnap:1,Ye=he.x/Ee.x,lt=he.y/Ee.y,_n=m?Math.max(Ye,lt):Math.min(Ye,lt);return b=this.getScaleZoom(_n,b),Te&&(b=Math.round(b/(Te/100))*(Te/100),b=m?Math.ceil(b/Te)*Te:Math.floor(b/Te)*Te),Math.max(B,Math.min(H,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new V(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,m){var _=this._getTopLeftPoint(f,m);return new te(_,_.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,m){var _=this.options.crs;return m=m===void 0?this._zoom:m,_.scale(f)/_.scale(m)},getScaleZoom:function(f,m){var _=this.options.crs;m=m===void 0?this._zoom:m;var b=_.zoom(f*_.scale(m));return isNaN(b)?1/0:b},project:function(f,m){return m=m===void 0?this._zoom:m,this.options.crs.latLngToPoint(ue(f),m)},unproject:function(f,m){return m=m===void 0?this._zoom:m,this.options.crs.pointToLatLng(Y(f),m)},layerPointToLatLng:function(f){var m=Y(f).add(this.getPixelOrigin());return this.unproject(m)},latLngToLayerPoint:function(f){var m=this.project(ue(f))._round();return m._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(ue(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(ie(f))},distance:function(f,m){return this.options.crs.distance(ue(f),ue(m))},containerPointToLayerPoint:function(f){return Y(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return Y(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var m=this.containerPointToLayerPoint(Y(f));return this.layerPointToLatLng(m)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ue(f)))},mouseEventToContainerPoint:function(f){return I4(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var m=this._container=m4(f);if(m){if(m._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");it(m,"scroll",this._onScroll,this),this._containerId=l(m)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ge.any3d,st(f,"leaflet-container"+(Ge.touch?" leaflet-touch":"")+(Ge.retina?" leaflet-retina":"")+(Ge.ielt9?" leaflet-oldie":"")+(Ge.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var m=fg(f,"position");m!=="absolute"&&m!=="relative"&&m!=="fixed"&&m!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),pi(this._mapPane,new V(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(st(f.markerPane,"leaflet-zoom-hide"),st(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,m,_){pi(this._mapPane,new V(0,0));var b=!this._loaded;this._loaded=!0,m=this._limitZoom(m),this.fire("viewprereset");var B=this._zoom!==m;this._moveStart(B,_)._move(f,m)._moveEnd(B),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(f,m){return f&&this.fire("zoomstart"),m||this.fire("movestart"),this},_move:function(f,m,_,b){m===void 0&&(m=this._zoom);var B=this._zoom!==m;return this._zoom=m,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),b?_&&_.pinch&&this.fire("zoom",_):((B||_&&_.pinch)&&this.fire("zoom",_),this.fire("move",_)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){pi(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[l(this._container)]=this;var m=f?zt:it;m(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&m(window,"resize",this._onResize,this),Ge.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){z(this._resizeRequest),this._resizeRequest=R(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,m){for(var _=[],b,B=m==="mouseout"||m==="mouseover",H=f.target||f.srcElement,ee=!1;H;){if(b=this._targets[l(H)],b&&(m==="click"||m==="preclick")&&this._draggableMoved(b)){ee=!0;break}if(b&&b.listens(m,!0)&&(B&&!Eb(H,f)||(_.push(b),B))||H===this._container)break;H=H.parentNode}return!_.length&&!ee&&!B&&this.listens(m,!0)&&(_=[this]),_},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var m=f.target||f.srcElement;if(!(!this._loaded||m._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(m))){var _=f.type;_==="mousedown"&&gb(m),this._fireDOMEvent(f,_)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,m,_){if(f.type==="click"){var b=r({},f);b.type="preclick",this._fireDOMEvent(b,b.type,_)}var B=this._findEventTargets(f,m);if(_){for(var H=[],ee=0;ee<_.length;ee++)_[ee].listens(m,!0)&&H.push(_[ee]);B=H.concat(B)}if(B.length){m==="contextmenu"&&Ki(f);var ae=B[0],he={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Ee=ae.getLatLng&&(!ae._radius||ae._radius<=10);he.containerPoint=Ee?this.latLngToContainerPoint(ae.getLatLng()):this.mouseEventToContainerPoint(f),he.layerPoint=this.containerPointToLayerPoint(he.containerPoint),he.latlng=Ee?ae.getLatLng():this.layerPointToLatLng(he.layerPoint)}for(ee=0;ee<B.length;ee++)if(B[ee].fire(m,he,!0),he.originalEvent._stopped||B[ee].options.bubblingMouseEvents===!1&&C(this._mouseEvents,m)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,m=this._handlers.length;f<m;f++)this._handlers[f].disable()},whenReady:function(f,m){return this._loaded?f.call(m||this,{target:this}):this.on("load",f,m),this},_getMapPanePos:function(){return Yl(this._mapPane)||new V(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,m){var _=f&&m!==void 0?this._getNewPixelOrigin(f,m):this.getPixelOrigin();return _.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,m){var _=this.getSize()._divideBy(2);return this.project(f,m)._subtract(_)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,m,_){var b=this._getNewPixelOrigin(_,m);return this.project(f,m)._subtract(b)},_latLngBoundsToNewLayerBounds:function(f,m,_){var b=this._getNewPixelOrigin(_,m);return J([this.project(f.getSouthWest(),m)._subtract(b),this.project(f.getNorthWest(),m)._subtract(b),this.project(f.getSouthEast(),m)._subtract(b),this.project(f.getNorthEast(),m)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,m,_){if(!_)return f;var b=this.project(f,m),B=this.getSize().divideBy(2),H=new te(b.subtract(B),b.add(B)),ee=this._getBoundsOffset(H,_,m);return Math.abs(ee.x)<=1&&Math.abs(ee.y)<=1?f:this.unproject(b.add(ee),m)},_limitOffset:function(f,m){if(!m)return f;var _=this.getPixelBounds(),b=new te(_.min.add(f),_.max.add(f));return f.add(this._getBoundsOffset(b,m))},_getBoundsOffset:function(f,m,_){var b=J(this.project(m.getNorthEast(),_),this.project(m.getSouthWest(),_)),B=b.min.subtract(f.min),H=b.max.subtract(f.max),ee=this._rebound(B.x,-H.x),ae=this._rebound(B.y,-H.y);return new V(ee,ae)},_rebound:function(f,m){return f+m>0?Math.round(f-m)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(m))},_limitZoom:function(f){var m=this.getMinZoom(),_=this.getMaxZoom(),b=Ge.any3d?this.options.zoomSnap:1;return b&&(f=Math.round(f/b)*b),Math.max(m,Math.min(_,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ci(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,m){var _=this._getCenterOffset(f)._trunc();return(m&&m.animate)!==!0&&!this.getSize().contains(_)?!1:(this.panBy(_,m),!0)},_createAnimProxy:function(){var f=this._proxy=xt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(m){var _=ab,b=this._proxy.style[_];Kl(this._proxy,this.project(m.center,m.zoom),this.getZoomScale(m.zoom,1)),b===this._proxy.style[_]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ri(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),m=this.getZoom();Kl(this._proxy,this.project(f,m),this.getZoomScale(m,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,m,_){if(this._animatingZoom)return!0;if(_=_||{},!this._zoomAnimated||_.animate===!1||this._nothingToAnimate()||Math.abs(m-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(m),B=this._getCenterOffset(f)._divideBy(1-1/b);return _.animate!==!0&&!this.getSize().contains(B)?!1:(R(function(){this._moveStart(!0,_.noMoveStart||!1)._animateZoom(f,m,!0)},this),!0)},_animateZoom:function(f,m,_,b){this._mapPane&&(_&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=m,st(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:m,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ci(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function nme(f,m){return new vt(f,m)}var jr=X.extend({options:{position:"topright"},initialize:function(f){p(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var m=this._map;return m&&m.removeControl(this),this.options.position=f,m&&m.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var m=this._container=this.onAdd(f),_=this.getPosition(),b=f._controlCorners[_];return st(m,"leaflet-control"),_.indexOf("bottom")!==-1?b.insertBefore(m,b.firstChild):b.appendChild(m),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ri(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),yg=function(f){return new jr(f)};vt.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},m="leaflet-",_=this._controlContainer=xt("div",m+"control-container",this._container);function b(B,H){var ee=m+B+" "+m+H;f[B+H]=xt("div",ee,_)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)ri(this._controlCorners[f]);ri(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var w4=jr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,m,_,b){return _<b?-1:b<_?1:0}},initialize:function(f,m,_){p(this,_),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in f)this._addLayer(f[b],b);for(b in m)this._addLayer(m[b],b,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var m=0;m<this._layers.length;m++)this._layers[m].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return jr.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,m){return this._addLayer(f,m),this._map?this._update():this},addOverlay:function(f,m){return this._addLayer(f,m,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var m=this._getLayer(l(f));return m&&this._layers.splice(this._layers.indexOf(m),1),this._map?this._update():this},expand:function(){st(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(st(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):ci(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ci(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",m=this._container=xt("div",f),_=this.options.collapsed;m.setAttribute("aria-haspopup",!0),mg(m),vb(m);var b=this._section=xt("section",f+"-list");_&&(this._map.on("click",this.collapse,this),it(m,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var B=this._layersLink=xt("a",f+"-toggle",m);B.href="#",B.title="Layers",B.setAttribute("role","button"),it(B,{keydown:function(H){H.keyCode===13&&this._expandSafely()},click:function(H){Ki(H),this._expandSafely()}},this),_||this.expand(),this._baseLayersList=xt("div",f+"-base",b),this._separator=xt("div",f+"-separator",b),this._overlaysList=xt("div",f+"-overlays",b),m.appendChild(b)},_getLayer:function(f){for(var m=0;m<this._layers.length;m++)if(this._layers[m]&&l(this._layers[m].layer)===f)return this._layers[m]},_addLayer:function(f,m,_){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:m,overlay:_}),this.options.sortLayers&&this._layers.sort(o(function(b,B){return this.options.sortFunction(b.layer,B.layer,b.name,B.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Iy(this._baseLayersList),Iy(this._overlaysList),this._layerControlInputs=[];var f,m,_,b,B=0;for(_=0;_<this._layers.length;_++)b=this._layers[_],this._addItem(b),m=m||b.overlay,f=f||!b.overlay,B+=b.overlay?0:1;return this.options.hideSingleBase&&(f=f&&B>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=m&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var m=this._getLayer(l(f.target)),_=m.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;_&&this._map.fire(_,m)},_createRadioElement:function(f,m){var _='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(m?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=_,b.firstChild},_addItem:function(f){var m=document.createElement("label"),_=this._map.hasLayer(f.layer),b;f.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=_):b=this._createRadioElement("leaflet-base-layers_"+l(this),_),this._layerControlInputs.push(b),b.layerId=l(f.layer),it(b,"click",this._onInputClick,this);var B=document.createElement("span");B.innerHTML=" "+f.name;var H=document.createElement("span");m.appendChild(H),H.appendChild(b),H.appendChild(B);var ee=f.overlay?this._overlaysList:this._baseLayersList;return ee.appendChild(m),this._checkDisabledLayers(),m},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,m,_,b=[],B=[];this._handlingClick=!0;for(var H=f.length-1;H>=0;H--)m=f[H],_=this._getLayer(m.layerId).layer,m.checked?b.push(_):m.checked||B.push(_);for(H=0;H<B.length;H++)this._map.hasLayer(B[H])&&this._map.removeLayer(B[H]);for(H=0;H<b.length;H++)this._map.hasLayer(b[H])||this._map.addLayer(b[H]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,m,_,b=this._map.getZoom(),B=f.length-1;B>=0;B--)m=f[B],_=this._getLayer(m.layerId).layer,m.disabled=_.options.minZoom!==void 0&&b<_.options.minZoom||_.options.maxZoom!==void 0&&b>_.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,it(f,"click",Ki),this.expand();var m=this;setTimeout(function(){zt(f,"click",Ki),m._preventClick=!1})}}),rme=function(f,m,_){return new w4(f,m,_)},Ib=jr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var m="leaflet-control-zoom",_=xt("div",m+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,m+"-in",_,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,m+"-out",_,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),_},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,m,_,b,B){var H=xt("a",_,b);return H.innerHTML=f,H.href="#",H.title=m,H.setAttribute("role","button"),H.setAttribute("aria-label",m),mg(H),it(H,"click",Xl),it(H,"click",B,this),it(H,"click",this._refocusOnMap,this),H},_updateDisabled:function(){var f=this._map,m="leaflet-disabled";ci(this._zoomInButton,m),ci(this._zoomOutButton,m),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(st(this._zoomOutButton,m),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(st(this._zoomInButton,m),this._zoomInButton.setAttribute("aria-disabled","true"))}});vt.mergeOptions({zoomControl:!0}),vt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ib,this.addControl(this.zoomControl))});var sme=function(f){return new Ib(f)},x4=jr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var m="leaflet-control-scale",_=xt("div",m),b=this.options;return this._addScales(b,m+"-line",_),f.on(b.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),_},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,m,_){f.metric&&(this._mScale=xt("div",m,_)),f.imperial&&(this._iScale=xt("div",m,_))},_update:function(){var f=this._map,m=f.getSize().y/2,_=f.distance(f.containerPointToLatLng([0,m]),f.containerPointToLatLng([this.options.maxWidth,m]));this._updateScales(_)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var m=this._getRoundNum(f),_=m<1e3?m+" m":m/1e3+" km";this._updateScale(this._mScale,_,m/f)},_updateImperial:function(f){var m=f*3.2808399,_,b,B;m>5280?(_=m/5280,b=this._getRoundNum(_),this._updateScale(this._iScale,b+" mi",b/_)):(B=this._getRoundNum(m),this._updateScale(this._iScale,B+" ft",B/m))},_updateScale:function(f,m,_){f.style.width=Math.round(this.options.maxWidth*_)+"px",f.innerHTML=m},_getRoundNum:function(f){var m=Math.pow(10,(Math.floor(f)+"").length-1),_=f/m;return _=_>=10?10:_>=5?5:_>=3?3:_>=2?2:1,m*_}}),ome=function(f){return new x4(f)},ame='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',_b=jr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ge.inlineSvg?ame+" ":"")+"Leaflet</a>"},initialize:function(f){p(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=xt("div","leaflet-control-attribution"),mg(this._container);for(var m in f._layers)f._layers[m].getAttribution&&this.addAttribution(f._layers[m].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var m in this._attributions)this._attributions[m]&&f.push(m);var _=[];this.options.prefix&&_.push(this.options.prefix),f.length&&_.push(f.join(", ")),this._container.innerHTML=_.join(' <span aria-hidden="true">|</span> ')}}});vt.mergeOptions({attributionControl:!0}),vt.addInitHook(function(){this.options.attributionControl&&new _b().addTo(this)});var lme=function(f){return new _b(f)};jr.Layers=w4,jr.Zoom=Ib,jr.Scale=x4,jr.Attribution=_b,yg.layers=rme,yg.zoom=sme,yg.scale=ome,yg.attribution=lme;var Ts=X.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ts.addTo=function(f,m){return f.addHandler(m,this),this};var ume={Events:G},b4=Ge.touch?"touchstart mousedown":"mousedown",Oa=j.extend({options:{clickTolerance:3},initialize:function(f,m,_,b){p(this,b),this._element=f,this._dragStartTarget=m||f,this._preventOutline=_},enable:function(){this._enabled||(it(this._dragStartTarget,b4,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Oa._dragging===this&&this.finishDrag(!0),zt(this._dragStartTarget,b4,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!lb(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){Oa._dragging===this&&this.finishDrag();return}if(!(Oa._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(Oa._dragging=this,this._preventOutline&&gb(this._element),hb(),gg(),!this._moving)){this.fire("down");var m=f.touches?f.touches[0]:f,_=y4(this._element);this._startPoint=new V(m.clientX,m.clientY),this._startPos=Yl(this._element),this._parentScale=Ab(_);var b=f.type==="mousedown";it(document,b?"mousemove":"touchmove",this._onMove,this),it(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var m=f.touches&&f.touches.length===1?f.touches[0]:f,_=new V(m.clientX,m.clientY)._subtract(this._startPoint);!_.x&&!_.y||Math.abs(_.x)+Math.abs(_.y)<this.options.clickTolerance||(_.x/=this._parentScale.x,_.y/=this._parentScale.y,Ki(f),this._moved||(this.fire("dragstart"),this._moved=!0,st(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),st(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(_),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),pi(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){ci(document.body,"leaflet-dragging"),this._lastTarget&&(ci(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zt(document,"mousemove touchmove",this._onMove,this),zt(document,"mouseup touchend touchcancel",this._onUp,this),db(),Ag();var m=this._moved&&this._moving;this._moving=!1,Oa._dragging=!1,m&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function S4(f,m,_){var b,B=[1,4,2,8],H,ee,ae,he,Ee,Te,Ye,lt;for(H=0,Te=f.length;H<Te;H++)f[H]._code=Jl(f[H],m);for(ae=0;ae<4;ae++){for(Ye=B[ae],b=[],H=0,Te=f.length,ee=Te-1;H<Te;ee=H++)he=f[H],Ee=f[ee],he._code&Ye?Ee._code&Ye||(lt=by(Ee,he,Ye,m,_),lt._code=Jl(lt,m),b.push(lt)):(Ee._code&Ye&&(lt=by(Ee,he,Ye,m,_),lt._code=Jl(lt,m),b.push(lt)),b.push(he));f=b}return f}function T4(f,m){var _,b,B,H,ee,ae,he,Ee,Te;if(!f||f.length===0)throw new Error("latlngs not passed");vr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Ye=ue([0,0]),lt=ie(f),_n=lt.getNorthWest().distanceTo(lt.getSouthWest())*lt.getNorthEast().distanceTo(lt.getNorthWest());_n<1700&&(Ye=Cb(f));var Oi=f.length,Er=[];for(_=0;_<Oi;_++){var Gn=ue(f[_]);Er.push(m.project(ue([Gn.lat-Ye.lat,Gn.lng-Ye.lng])))}for(ae=he=Ee=0,_=0,b=Oi-1;_<Oi;b=_++)B=Er[_],H=Er[b],ee=B.y*H.x-H.y*B.x,he+=(B.x+H.x)*ee,Ee+=(B.y+H.y)*ee,ae+=ee*3;ae===0?Te=Er[0]:Te=[he/ae,Ee/ae];var Th=m.unproject(Y(Te));return ue([Th.lat+Ye.lat,Th.lng+Ye.lng])}function Cb(f){for(var m=0,_=0,b=0,B=0;B<f.length;B++){var H=ue(f[B]);m+=H.lat,_+=H.lng,b++}return ue([m/b,_/b])}var cme={__proto__:null,clipPolygon:S4,polygonCenter:T4,centroid:Cb};function B4(f,m){if(!m||!f.length)return f.slice();var _=m*m;return f=fme(f,_),f=dme(f,_),f}function R4(f,m,_){return Math.sqrt(vg(f,m,_,!0))}function hme(f,m,_){return vg(f,m,_)}function dme(f,m){var _=f.length,b=typeof Uint8Array<"u"?Uint8Array:Array,B=new b(_);B[0]=B[_-1]=1,wb(f,B,m,0,_-1);var H,ee=[];for(H=0;H<_;H++)B[H]&&ee.push(f[H]);return ee}function wb(f,m,_,b,B){var H=0,ee,ae,he;for(ae=b+1;ae<=B-1;ae++)he=vg(f[ae],f[b],f[B],!0),he>H&&(ee=ae,H=he);H>_&&(m[ee]=1,wb(f,m,_,b,ee),wb(f,m,_,ee,B))}function fme(f,m){for(var _=[f[0]],b=1,B=0,H=f.length;b<H;b++)gme(f[b],f[B])>m&&(_.push(f[b]),B=b);return B<H-1&&_.push(f[H-1]),_}var L4;function D4(f,m,_,b,B){var H=b?L4:Jl(f,_),ee=Jl(m,_),ae,he,Ee;for(L4=ee;;){if(!(H|ee))return[f,m];if(H&ee)return!1;ae=H||ee,he=by(f,m,ae,_,B),Ee=Jl(he,_),ae===H?(f=he,H=Ee):(m=he,ee=Ee)}}function by(f,m,_,b,B){var H=m.x-f.x,ee=m.y-f.y,ae=b.min,he=b.max,Ee,Te;return _&8?(Ee=f.x+H*(he.y-f.y)/ee,Te=he.y):_&4?(Ee=f.x+H*(ae.y-f.y)/ee,Te=ae.y):_&2?(Ee=he.x,Te=f.y+ee*(he.x-f.x)/H):_&1&&(Ee=ae.x,Te=f.y+ee*(ae.x-f.x)/H),new V(Ee,Te,B)}function Jl(f,m){var _=0;return f.x<m.min.x?_|=1:f.x>m.max.x&&(_|=2),f.y<m.min.y?_|=4:f.y>m.max.y&&(_|=8),_}function gme(f,m){var _=m.x-f.x,b=m.y-f.y;return _*_+b*b}function vg(f,m,_,b){var B=m.x,H=m.y,ee=_.x-B,ae=_.y-H,he=ee*ee+ae*ae,Ee;return he>0&&(Ee=((f.x-B)*ee+(f.y-H)*ae)/he,Ee>1?(B=_.x,H=_.y):Ee>0&&(B+=ee*Ee,H+=ae*Ee)),ee=f.x-B,ae=f.y-H,b?ee*ee+ae*ae:new V(B,H)}function vr(f){return!I(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function k4(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),vr(f)}function P4(f,m){var _,b,B,H,ee,ae,he,Ee;if(!f||f.length===0)throw new Error("latlngs not passed");vr(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Te=ue([0,0]),Ye=ie(f),lt=Ye.getNorthWest().distanceTo(Ye.getSouthWest())*Ye.getNorthEast().distanceTo(Ye.getNorthWest());lt<1700&&(Te=Cb(f));var _n=f.length,Oi=[];for(_=0;_<_n;_++){var Er=ue(f[_]);Oi.push(m.project(ue([Er.lat-Te.lat,Er.lng-Te.lng])))}for(_=0,b=0;_<_n-1;_++)b+=Oi[_].distanceTo(Oi[_+1])/2;if(b===0)Ee=Oi[0];else for(_=0,H=0;_<_n-1;_++)if(ee=Oi[_],ae=Oi[_+1],B=ee.distanceTo(ae),H+=B,H>b){he=(H-b)/B,Ee=[ae.x-he*(ae.x-ee.x),ae.y-he*(ae.y-ee.y)];break}var Gn=m.unproject(Y(Ee));return ue([Gn.lat+Te.lat,Gn.lng+Te.lng])}var Ame={__proto__:null,simplify:B4,pointToSegmentDistance:R4,closestPointOnSegment:hme,clipSegment:D4,_getEdgeIntersection:by,_getBitCode:Jl,_sqClosestPointOnSegment:vg,isFlat:vr,_flat:k4,polylineCenter:P4},xb={project:function(f){return new V(f.lng,f.lat)},unproject:function(f){return new ne(f.y,f.x)},bounds:new te([-180,-90],[180,90])},bb={R:6378137,R_MINOR:6356752314245179e-9,bounds:new te([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var m=Math.PI/180,_=this.R,b=f.lat*m,B=this.R_MINOR/_,H=Math.sqrt(1-B*B),ee=H*Math.sin(b),ae=Math.tan(Math.PI/4-b/2)/Math.pow((1-ee)/(1+ee),H/2);return b=-_*Math.log(Math.max(ae,1e-10)),new V(f.lng*m*_,b)},unproject:function(f){for(var m=180/Math.PI,_=this.R,b=this.R_MINOR/_,B=Math.sqrt(1-b*b),H=Math.exp(-f.y/_),ee=Math.PI/2-2*Math.atan(H),ae=0,he=.1,Ee;ae<15&&Math.abs(he)>1e-7;ae++)Ee=B*Math.sin(ee),Ee=Math.pow((1-Ee)/(1+Ee),B/2),he=Math.PI/2-2*Math.atan(H*Ee)-ee,ee+=he;return new ne(ee*m,f.x*m/_)}},pme={__proto__:null,LonLat:xb,Mercator:bb,SphericalMercator:Re},mme=r({},me,{code:"EPSG:3395",projection:bb,transformation:function(){var f=.5/(Math.PI*bb.R);return Oe(f,.5,-f,.5)}()}),M4=r({},me,{code:"EPSG:4326",projection:xb,transformation:Oe(1/180,1,-1/180,.5)}),yme=r({},fe,{projection:xb,transformation:Oe(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,m){var _=m.lng-f.lng,b=m.lat-f.lat;return Math.sqrt(_*_+b*b)},infinite:!0});fe.Earth=me,fe.EPSG3395=mme,fe.EPSG3857=wt,fe.EPSG900913=ft,fe.EPSG4326=M4,fe.Simple=yme;var Wr=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[l(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[l(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var m=f.target;if(m.hasLayer(this)){if(this._map=m,this._zoomAnimated=m._zoomAnimated,this.getEvents){var _=this.getEvents();m.on(_,this),this.once("remove",function(){m.off(_,this)},this)}this.onAdd(m),this.fire("add"),m.fire("layeradd",{layer:this})}}});vt.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var m=l(f);return this._layers[m]?this:(this._layers[m]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var m=l(f);return this._layers[m]?(this._loaded&&f.onRemove(this),delete this._layers[m],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return l(f)in this._layers},eachLayer:function(f,m){for(var _ in this._layers)f.call(m,this._layers[_]);return this},_addLayers:function(f){f=f?I(f)?f:[f]:[];for(var m=0,_=f.length;m<_;m++)this.addLayer(f[m])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[l(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var m=l(f);this._zoomBoundLayers[m]&&(delete this._zoomBoundLayers[m],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,m=-1/0,_=this._getZoomSpan();for(var b in this._zoomBoundLayers){var B=this._zoomBoundLayers[b].options;f=B.minZoom===void 0?f:Math.min(f,B.minZoom),m=B.maxZoom===void 0?m:Math.max(m,B.maxZoom)}this._layersMaxZoom=m===-1/0?void 0:m,this._layersMinZoom=f===1/0?void 0:f,_!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ch=Wr.extend({initialize:function(f,m){p(this,m),this._layers={};var _,b;if(f)for(_=0,b=f.length;_<b;_++)this.addLayer(f[_])},addLayer:function(f){var m=this.getLayerId(f);return this._layers[m]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var m=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[m]&&this._map.removeLayer(this._layers[m]),delete this._layers[m],this},hasLayer:function(f){var m=typeof f=="number"?f:this.getLayerId(f);return m in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var m=Array.prototype.slice.call(arguments,1),_,b;for(_ in this._layers)b=this._layers[_],b[f]&&b[f].apply(b,m);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,m){for(var _ in this._layers)f.call(m,this._layers[_]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return l(f)}}),vme=function(f,m){return new Ch(f,m)},_o=Ch.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),Ch.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),Ch.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new ce;for(var m in this._layers){var _=this._layers[m];f.extend(_.getBounds?_.getBounds():_.getLatLng())}return f}}),Eme=function(f,m){return new _o(f,m)},wh=X.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){p(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,m){var _=this._getIconUrl(f);if(!_){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(_,m&&m.tagName==="IMG"?m:null);return this._setIconStyles(b,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(f,m){var _=this.options,b=_[m+"Size"];typeof b=="number"&&(b=[b,b]);var B=Y(b),H=Y(m==="shadow"&&_.shadowAnchor||_.iconAnchor||B&&B.divideBy(2,!0));f.className="leaflet-marker-"+m+" "+(_.className||""),H&&(f.style.marginLeft=-H.x+"px",f.style.marginTop=-H.y+"px"),B&&(f.style.width=B.x+"px",f.style.height=B.y+"px")},_createImg:function(f,m){return m=m||document.createElement("img"),m.src=f,m},_getIconUrl:function(f){return Ge.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Ime(f){return new wh(f)}var Eg=wh.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Eg.imagePath!="string"&&(Eg.imagePath=this._detectIconPath()),(this.options.imagePath||Eg.imagePath)+wh.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var m=function(_,b,B){var H=b.exec(_);return H&&H[B]};return f=m(f,/^url\((['"])?(.+)\1\)$/,2),f&&m(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=xt("div","leaflet-default-icon-path",document.body),m=fg(f,"background-image")||fg(f,"backgroundImage");if(document.body.removeChild(f),m=this._stripUrl(m),m)return m;var _=document.querySelector('link[href$="leaflet.css"]');return _?_.href.substring(0,_.href.length-11-1):""}}),F4=Ts.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new Oa(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),st(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ci(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var m=this._marker,_=m._map,b=this._marker.options.autoPanSpeed,B=this._marker.options.autoPanPadding,H=Yl(m._icon),ee=_.getPixelBounds(),ae=_.getPixelOrigin(),he=J(ee.min._subtract(ae).add(B),ee.max._subtract(ae).subtract(B));if(!he.contains(H)){var Ee=Y((Math.max(he.max.x,H.x)-he.max.x)/(ee.max.x-he.max.x)-(Math.min(he.min.x,H.x)-he.min.x)/(ee.min.x-he.min.x),(Math.max(he.max.y,H.y)-he.max.y)/(ee.max.y-he.max.y)-(Math.min(he.min.y,H.y)-he.min.y)/(ee.min.y-he.min.y)).multiplyBy(b);_.panBy(Ee,{animate:!1}),this._draggable._newPos._add(Ee),this._draggable._startPos._add(Ee),pi(m._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=R(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(z(this._panRequest),this._panRequest=R(this._adjustPan.bind(this,f)))},_onDrag:function(f){var m=this._marker,_=m._shadow,b=Yl(m._icon),B=m._map.layerPointToLatLng(b);_&&pi(_,b),m._latlng=B,f.latlng=B,f.oldLatLng=this._oldLatLng,m.fire("move",f).fire("drag",f)},_onDragEnd:function(f){z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),Sy=Wr.extend({options:{icon:new Eg,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,m){p(this,m),this._latlng=ue(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var m=this._latlng;return this._latlng=ue(f),this.update(),this.fire("move",{oldLatLng:m,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,m="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),_=f.icon.createIcon(this._icon),b=!1;_!==this._icon&&(this._icon&&this._removeIcon(),b=!0,f.title&&(_.title=f.title),_.tagName==="IMG"&&(_.alt=f.alt||"")),st(_,m),f.keyboard&&(_.tabIndex="0",_.setAttribute("role","button")),this._icon=_,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&it(_,"focus",this._panOnFocus,this);var B=f.icon.createShadow(this._shadow),H=!1;B!==this._shadow&&(this._removeShadow(),H=!0),B&&(st(B,m),B.alt=""),this._shadow=B,f.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),B&&H&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zt(this._icon,"focus",this._panOnFocus,this),ri(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ri(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&pi(this._icon,f),this._shadow&&pi(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var m=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(m)},_initInteraction:function(){if(this.options.interactive&&(st(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),F4)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new F4(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&yr(this._icon,f),this._shadow&&yr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var m=this.options.icon.options,_=m.iconSize?Y(m.iconSize):Y(0,0),b=m.iconAnchor?Y(m.iconAnchor):Y(0,0);f.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:_.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _me(f,m){return new Sy(f,m)}var Na=Wr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return p(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ty=Na.extend({options:{fill:!0,radius:10},initialize:function(f,m){p(this,m),this._latlng=ue(f),this._radius=this.options.radius},setLatLng:function(f){var m=this._latlng;return this._latlng=ue(f),this.redraw(),this.fire("move",{oldLatLng:m,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var m=f&&f.radius||this._radius;return Na.prototype.setStyle.call(this,f),this.setRadius(m),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,m=this._radiusY||f,_=this._clickTolerance(),b=[f+_,m+_];this._pxBounds=new te(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Cme(f,m){return new Ty(f,m)}var Sb=Ty.extend({initialize:function(f,m,_){if(typeof m=="number"&&(m=r({},_,{radius:m})),p(this,m),this._latlng=ue(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new ce(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Na.prototype.setStyle,_project:function(){var f=this._latlng.lng,m=this._latlng.lat,_=this._map,b=_.options.crs;if(b.distance===me.distance){var B=Math.PI/180,H=this._mRadius/me.R/B,ee=_.project([m+H,f]),ae=_.project([m-H,f]),he=ee.add(ae).divideBy(2),Ee=_.unproject(he).lat,Te=Math.acos((Math.cos(H*B)-Math.sin(m*B)*Math.sin(Ee*B))/(Math.cos(m*B)*Math.cos(Ee*B)))/B;(isNaN(Te)||Te===0)&&(Te=H/Math.cos(Math.PI/180*m)),this._point=he.subtract(_.getPixelOrigin()),this._radius=isNaN(Te)?0:he.x-_.project([Ee,f-Te]).x,this._radiusY=he.y-ee.y}else{var Ye=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=_.latLngToLayerPoint(this._latlng),this._radius=this._point.x-_.latLngToLayerPoint(Ye).x}this._updateBounds()}});function wme(f,m,_){return new Sb(f,m,_)}var Co=Na.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,m){p(this,m),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var m=1/0,_=null,b=vg,B,H,ee=0,ae=this._parts.length;ee<ae;ee++)for(var he=this._parts[ee],Ee=1,Te=he.length;Ee<Te;Ee++){B=he[Ee-1],H=he[Ee];var Ye=b(f,B,H,!0);Ye<m&&(m=Ye,_=b(f,B,H))}return _&&(_.distance=Math.sqrt(m)),_},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return P4(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,m){return m=m||this._defaultShape(),f=ue(f),m.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new ce,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return vr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var m=[],_=vr(f),b=0,B=f.length;b<B;b++)_?(m[b]=ue(f[b]),this._bounds.extend(m[b])):m[b]=this._convertLatLngs(f[b]);return m},_project:function(){var f=new te;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),m=new V(f,f);this._rawPxBounds&&(this._pxBounds=new te([this._rawPxBounds.min.subtract(m),this._rawPxBounds.max.add(m)]))},_projectLatlngs:function(f,m,_){var b=f[0]instanceof ne,B=f.length,H,ee;if(b){for(ee=[],H=0;H<B;H++)ee[H]=this._map.latLngToLayerPoint(f[H]),_.extend(ee[H]);m.push(ee)}else for(H=0;H<B;H++)this._projectLatlngs(f[H],m,_)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var m=this._parts,_,b,B,H,ee,ae,he;for(_=0,B=0,H=this._rings.length;_<H;_++)for(he=this._rings[_],b=0,ee=he.length;b<ee-1;b++)ae=D4(he[b],he[b+1],f,b,!0),ae&&(m[B]=m[B]||[],m[B].push(ae[0]),(ae[1]!==he[b+1]||b===ee-2)&&(m[B].push(ae[1]),B++))}},_simplifyPoints:function(){for(var f=this._parts,m=this.options.smoothFactor,_=0,b=f.length;_<b;_++)f[_]=B4(f[_],m)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,m){var _,b,B,H,ee,ae,he=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(_=0,H=this._parts.length;_<H;_++)for(ae=this._parts[_],b=0,ee=ae.length,B=ee-1;b<ee;B=b++)if(!(!m&&b===0)&&R4(f,ae[B],ae[b])<=he)return!0;return!1}});function xme(f,m){return new Co(f,m)}Co._flat=k4;var xh=Co.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return T4(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var m=Co.prototype._convertLatLngs.call(this,f),_=m.length;return _>=2&&m[0]instanceof ne&&m[0].equals(m[_-1])&&m.pop(),m},_setLatLngs:function(f){Co.prototype._setLatLngs.call(this,f),vr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return vr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,m=this.options.weight,_=new V(m,m);if(f=new te(f.min.subtract(_),f.max.add(_)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,B=this._rings.length,H;b<B;b++)H=S4(this._rings[b],f,!0),H.length&&this._parts.push(H)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var m=!1,_,b,B,H,ee,ae,he,Ee;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(H=0,he=this._parts.length;H<he;H++)for(_=this._parts[H],ee=0,Ee=_.length,ae=Ee-1;ee<Ee;ae=ee++)b=_[ee],B=_[ae],b.y>f.y!=B.y>f.y&&f.x<(B.x-b.x)*(f.y-b.y)/(B.y-b.y)+b.x&&(m=!m);return m||Co.prototype._containsPoint.call(this,f,!0)}});function bme(f,m){return new xh(f,m)}var wo=_o.extend({initialize:function(f,m){p(this,m),this._layers={},f&&this.addData(f)},addData:function(f){var m=I(f)?f:f.features,_,b,B;if(m){for(_=0,b=m.length;_<b;_++)B=m[_],(B.geometries||B.geometry||B.features||B.coordinates)&&this.addData(B);return this}var H=this.options;if(H.filter&&!H.filter(f))return this;var ee=By(f,H);return ee?(ee.feature=Dy(f),ee.defaultOptions=ee.options,this.resetStyle(ee),H.onEachFeature&&H.onEachFeature(f,ee),this.addLayer(ee)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=r({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(m){this._setLayerStyle(m,f)},this)},_setLayerStyle:function(f,m){f.setStyle&&(typeof m=="function"&&(m=m(f.feature)),f.setStyle(m))}});function By(f,m){var _=f.type==="Feature"?f.geometry:f,b=_?_.coordinates:null,B=[],H=m&&m.pointToLayer,ee=m&&m.coordsToLatLng||Tb,ae,he,Ee,Te;if(!b&&!_)return null;switch(_.type){case"Point":return ae=ee(b),O4(H,f,ae,m);case"MultiPoint":for(Ee=0,Te=b.length;Ee<Te;Ee++)ae=ee(b[Ee]),B.push(O4(H,f,ae,m));return new _o(B);case"LineString":case"MultiLineString":return he=Ry(b,_.type==="LineString"?0:1,ee),new Co(he,m);case"Polygon":case"MultiPolygon":return he=Ry(b,_.type==="Polygon"?1:2,ee),new xh(he,m);case"GeometryCollection":for(Ee=0,Te=_.geometries.length;Ee<Te;Ee++){var Ye=By({geometry:_.geometries[Ee],type:"Feature",properties:f.properties},m);Ye&&B.push(Ye)}return new _o(B);case"FeatureCollection":for(Ee=0,Te=_.features.length;Ee<Te;Ee++){var lt=By(_.features[Ee],m);lt&&B.push(lt)}return new _o(B);default:throw new Error("Invalid GeoJSON object.")}}function O4(f,m,_,b){return f?f(m,_):new Sy(_,b&&b.markersInheritOptions&&b)}function Tb(f){return new ne(f[1],f[0],f[2])}function Ry(f,m,_){for(var b=[],B=0,H=f.length,ee;B<H;B++)ee=m?Ry(f[B],m-1,_):(_||Tb)(f[B]),b.push(ee);return b}function Bb(f,m){return f=ue(f),f.alt!==void 0?[d(f.lng,m),d(f.lat,m),d(f.alt,m)]:[d(f.lng,m),d(f.lat,m)]}function Ly(f,m,_,b){for(var B=[],H=0,ee=f.length;H<ee;H++)B.push(m?Ly(f[H],vr(f[H])?0:m-1,_,b):Bb(f[H],b));return!m&&_&&B.length>0&&B.push(B[0].slice()),B}function bh(f,m){return f.feature?r({},f.feature,{geometry:m}):Dy(m)}function Dy(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Rb={toGeoJSON:function(f){return bh(this,{type:"Point",coordinates:Bb(this.getLatLng(),f)})}};Sy.include(Rb),Sb.include(Rb),Ty.include(Rb),Co.include({toGeoJSON:function(f){var m=!vr(this._latlngs),_=Ly(this._latlngs,m?1:0,!1,f);return bh(this,{type:(m?"Multi":"")+"LineString",coordinates:_})}}),xh.include({toGeoJSON:function(f){var m=!vr(this._latlngs),_=m&&!vr(this._latlngs[0]),b=Ly(this._latlngs,_?2:m?1:0,!0,f);return m||(b=[b]),bh(this,{type:(_?"Multi":"")+"Polygon",coordinates:b})}}),Ch.include({toMultiPoint:function(f){var m=[];return this.eachLayer(function(_){m.push(_.toGeoJSON(f).geometry.coordinates)}),bh(this,{type:"MultiPoint",coordinates:m})},toGeoJSON:function(f){var m=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(m==="MultiPoint")return this.toMultiPoint(f);var _=m==="GeometryCollection",b=[];return this.eachLayer(function(B){if(B.toGeoJSON){var H=B.toGeoJSON(f);if(_)b.push(H.geometry);else{var ee=Dy(H);ee.type==="FeatureCollection"?b.push.apply(b,ee.features):b.push(ee)}}}),_?bh(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function N4(f,m){return new wo(f,m)}var Sme=N4,ky=Wr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,m,_){this._url=f,this._bounds=ie(m),p(this,_)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(st(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ri(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Ih(this._image),this},bringToBack:function(){return this._map&&_h(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=ie(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",m=this._image=f?this._url:xt("img");if(st(m,"leaflet-image-layer"),this._zoomAnimated&&st(m,"leaflet-zoom-animated"),this.options.className&&st(m,this.options.className),m.onselectstart=h,m.onmousemove=h,m.onload=o(this.fire,this,"load"),m.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=m.src;return}m.src=this._url,m.alt=this.options.alt},_animateZoom:function(f){var m=this._map.getZoomScale(f.zoom),_=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Kl(this._image,_,m)},_reset:function(){var f=this._image,m=new te(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),_=m.getSize();pi(f,m.min),f.style.width=_.x+"px",f.style.height=_.y+"px"},_updateOpacity:function(){yr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Tme=function(f,m,_){return new ky(f,m,_)},Q4=ky.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",m=this._image=f?this._url:xt("video");if(st(m,"leaflet-image-layer"),this._zoomAnimated&&st(m,"leaflet-zoom-animated"),this.options.className&&st(m,this.options.className),m.onselectstart=h,m.onmousemove=h,m.onloadeddata=o(this.fire,this,"load"),f){for(var _=m.getElementsByTagName("source"),b=[],B=0;B<_.length;B++)b.push(_[B].src);this._url=_.length>0?b:[m.src];return}I(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(m.style,"objectFit")&&(m.style.objectFit="fill"),m.autoplay=!!this.options.autoplay,m.loop=!!this.options.loop,m.muted=!!this.options.muted,m.playsInline=!!this.options.playsInline;for(var H=0;H<this._url.length;H++){var ee=xt("source");ee.src=this._url[H],m.appendChild(ee)}}});function Bme(f,m,_){return new Q4(f,m,_)}var U4=ky.extend({_initImage:function(){var f=this._image=this._url;st(f,"leaflet-image-layer"),this._zoomAnimated&&st(f,"leaflet-zoom-animated"),this.options.className&&st(f,this.options.className),f.onselectstart=h,f.onmousemove=h}});function Rme(f,m,_){return new U4(f,m,_)}var Bs=Wr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,m){f&&(f instanceof ne||I(f))?(this._latlng=ue(f),p(this,m)):(p(this,f),this._source=m),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&yr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&yr(this._container,1),this.bringToFront(),this.options.interactive&&(st(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(yr(this._container,0),this._removeTimeout=setTimeout(o(ri,void 0,this._container),200)):ri(this._container),this.options.interactive&&(ci(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=ue(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ih(this._container),this},bringToBack:function(){return this._map&&_h(this._container),this},_prepareOpen:function(f){var m=this._source;if(!m._map)return!1;if(m instanceof _o){m=null;var _=this._source._layers;for(var b in _)if(_[b]._map){m=_[b];break}if(!m)return!1;this._source=m}if(!f)if(m.getCenter)f=m.getCenter();else if(m.getLatLng)f=m.getLatLng();else if(m.getBounds)f=m.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,m=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof m=="string")f.innerHTML=m;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(m)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),m=Y(this.options.offset),_=this._getAnchor();this._zoomAnimated?pi(this._container,f.add(_)):m=m.add(f).add(_);var b=this._containerBottom=-m.y,B=this._containerLeft=-Math.round(this._containerWidth/2)+m.x;this._container.style.bottom=b+"px",this._container.style.left=B+"px"}},_getAnchor:function(){return[0,0]}});vt.include({_initOverlay:function(f,m,_,b){var B=m;return B instanceof f||(B=new f(b).setContent(m)),_&&B.setLatLng(_),B}}),Wr.include({_initOverlay:function(f,m,_,b){var B=_;return B instanceof f?(p(B,b),B._source=this):(B=m&&!b?m:new f(b,this),B.setContent(_)),B}});var Py=Bs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,Bs.prototype.openOn.call(this,f)},onAdd:function(f){Bs.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Na||this._source.on("preclick",Zl))},onRemove:function(f){Bs.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Na||this._source.off("preclick",Zl))},getEvents:function(){var f=Bs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",m=this._container=xt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),_=this._wrapper=xt("div",f+"-content-wrapper",m);if(this._contentNode=xt("div",f+"-content",_),mg(m),vb(this._contentNode),it(m,"contextmenu",Zl),this._tipContainer=xt("div",f+"-tip-container",m),this._tip=xt("div",f+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=xt("a",f+"-close-button",m);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',it(b,"click",function(B){Ki(B),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,m=f.style;m.width="",m.whiteSpace="nowrap";var _=f.offsetWidth;_=Math.min(_,this.options.maxWidth),_=Math.max(_,this.options.minWidth),m.width=_+1+"px",m.whiteSpace="",m.height="";var b=f.offsetHeight,B=this.options.maxHeight,H="leaflet-popup-scrolled";B&&b>B?(m.height=B+"px",st(f,H)):ci(f,H),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var m=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),_=this._getAnchor();pi(this._container,m.add(_))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,m=parseInt(fg(this._container,"marginBottom"),10)||0,_=this._container.offsetHeight+m,b=this._containerWidth,B=new V(this._containerLeft,-_-this._containerBottom);B._add(Yl(this._container));var H=f.layerPointToContainerPoint(B),ee=Y(this.options.autoPanPadding),ae=Y(this.options.autoPanPaddingTopLeft||ee),he=Y(this.options.autoPanPaddingBottomRight||ee),Ee=f.getSize(),Te=0,Ye=0;H.x+b+he.x>Ee.x&&(Te=H.x+b-Ee.x+he.x),H.x-Te-ae.x<0&&(Te=H.x-ae.x),H.y+_+he.y>Ee.y&&(Ye=H.y+_-Ee.y+he.y),H.y-Ye-ae.y<0&&(Ye=H.y-ae.y),(Te||Ye)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([Te,Ye]))}},_getAnchor:function(){return Y(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Lme=function(f,m){return new Py(f,m)};vt.mergeOptions({closePopupOnClick:!0}),vt.include({openPopup:function(f,m,_){return this._initOverlay(Py,f,m,_).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Wr.include({bindPopup:function(f,m){return this._popup=this._initOverlay(Py,this._popup,f,m),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof _o||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Xl(f);var m=f.layer||f.target;if(this._popup._source===m&&!(m instanceof Na)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=m,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var My=Bs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){Bs.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){Bs.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=Bs.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",m=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=xt("div",m),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var m,_,b=this._map,B=this._container,H=b.latLngToContainerPoint(b.getCenter()),ee=b.layerPointToContainerPoint(f),ae=this.options.direction,he=B.offsetWidth,Ee=B.offsetHeight,Te=Y(this.options.offset),Ye=this._getAnchor();ae==="top"?(m=he/2,_=Ee):ae==="bottom"?(m=he/2,_=0):ae==="center"?(m=he/2,_=Ee/2):ae==="right"?(m=0,_=Ee/2):ae==="left"?(m=he,_=Ee/2):ee.x<H.x?(ae="right",m=0,_=Ee/2):(ae="left",m=he+(Te.x+Ye.x)*2,_=Ee/2),f=f.subtract(Y(m,_,!0)).add(Te).add(Ye),ci(B,"leaflet-tooltip-right"),ci(B,"leaflet-tooltip-left"),ci(B,"leaflet-tooltip-top"),ci(B,"leaflet-tooltip-bottom"),st(B,"leaflet-tooltip-"+ae),pi(B,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&yr(this._container,f)},_animateZoom:function(f){var m=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(m)},_getAnchor:function(){return Y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Dme=function(f,m){return new My(f,m)};vt.include({openTooltip:function(f,m,_){return this._initOverlay(My,f,m,_).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Wr.include({bindTooltip:function(f,m){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(My,this._tooltip,f,m),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var m=f?"off":"on",_={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?_.add=this._openTooltip:(_.mouseover=this._openTooltip,_.mouseout=this.closeTooltip,_.click=this._openTooltip,this._map?this._addFocusListeners():_.add=this._addFocusListeners),this._tooltip.options.sticky&&(_.mousemove=this._moveTooltip),this[m](_),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof _o||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var m=typeof f.getElement=="function"&&f.getElement();m&&(it(m,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),it(m,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var m=typeof f.getElement=="function"&&f.getElement();m&&m.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var m=this;this._map.once("moveend",function(){m._openOnceFlag=!1,m._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var m=f.latlng,_,b;this._tooltip.options.sticky&&f.originalEvent&&(_=this._map.mouseEventToContainerPoint(f.originalEvent),b=this._map.containerPointToLayerPoint(_),m=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(m)}});var G4=wh.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var m=f&&f.tagName==="DIV"?f:document.createElement("div"),_=this.options;if(_.html instanceof Element?(Iy(m),m.appendChild(_.html)):m.innerHTML=_.html!==!1?_.html:"",_.bgPos){var b=Y(_.bgPos);m.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(m,"icon"),m},createShadow:function(){return null}});function kme(f){return new G4(f)}wh.Default=Eg;var Ig=Wr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ge.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){p(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),ri(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ih(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(_h(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof V?f:new V(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var m=this.getPane().children,_=-f(-1/0,1/0),b=0,B=m.length,H;b<B;b++)H=m[b].style.zIndex,m[b]!==this._container&&H&&(_=f(_,+H));isFinite(_)&&(this.options.zIndex=_+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ge.ielt9){yr(this._container,this.options.opacity);var f=+new Date,m=!1,_=!1;for(var b in this._tiles){var B=this._tiles[b];if(!(!B.current||!B.loaded)){var H=Math.min(1,(f-B.loaded)/200);yr(B.el,H),H<1?m=!0:(B.active?_=!0:this._onOpaqueTile(B),B.active=!0)}}_&&!this._noPrune&&this._pruneTiles(),m&&(z(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=xt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,m=this.options.maxZoom;if(f!==void 0){for(var _ in this._levels)_=Number(_),this._levels[_].el.children.length||_===f?(this._levels[_].el.style.zIndex=m-Math.abs(f-_),this._onUpdateLevel(_)):(ri(this._levels[_].el),this._removeTilesAtZoom(_),this._onRemoveLevel(_),delete this._levels[_]);var b=this._levels[f],B=this._map;return b||(b=this._levels[f]={},b.el=xt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=m,b.origin=B.project(B.unproject(B.getPixelOrigin()),f).round(),b.zoom=f,this._setZoomTransform(b,B.getCenter(),B.getZoom()),h(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var f,m,_=this._map.getZoom();if(_>this.options.maxZoom||_<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)m=this._tiles[f],m.retain=m.current;for(f in this._tiles)if(m=this._tiles[f],m.current&&!m.active){var b=m.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var m in this._tiles)this._tiles[m].coords.z===f&&this._removeTile(m)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)ri(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,m,_,b){var B=Math.floor(f/2),H=Math.floor(m/2),ee=_-1,ae=new V(+B,+H);ae.z=+ee;var he=this._tileCoordsToKey(ae),Ee=this._tiles[he];return Ee&&Ee.active?(Ee.retain=!0,!0):(Ee&&Ee.loaded&&(Ee.retain=!0),ee>b?this._retainParent(B,H,ee,b):!1)},_retainChildren:function(f,m,_,b){for(var B=2*f;B<2*f+2;B++)for(var H=2*m;H<2*m+2;H++){var ee=new V(B,H);ee.z=_+1;var ae=this._tileCoordsToKey(ee),he=this._tiles[ae];if(he&&he.active){he.retain=!0;continue}else he&&he.loaded&&(he.retain=!0);_+1<b&&this._retainChildren(B,H,_+1,b)}},_resetView:function(f){var m=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),m,m)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var m=this.options;return m.minNativeZoom!==void 0&&f<m.minNativeZoom?m.minNativeZoom:m.maxNativeZoom!==void 0&&m.maxNativeZoom<f?m.maxNativeZoom:f},_setView:function(f,m,_,b){var B=Math.round(m);this.options.maxZoom!==void 0&&B>this.options.maxZoom||this.options.minZoom!==void 0&&B<this.options.minZoom?B=void 0:B=this._clampZoom(B);var H=this.options.updateWhenZooming&&B!==this._tileZoom;(!b||H)&&(this._tileZoom=B,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),B!==void 0&&this._update(f),_||this._pruneTiles(),this._noPrune=!!_),this._setZoomTransforms(f,m)},_setZoomTransforms:function(f,m){for(var _ in this._levels)this._setZoomTransform(this._levels[_],f,m)},_setZoomTransform:function(f,m,_){var b=this._map.getZoomScale(_,f.zoom),B=f.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(m,_)).round();Ge.any3d?Kl(f.el,B,b):pi(f.el,B)},_resetGrid:function(){var f=this._map,m=f.options.crs,_=this._tileSize=this.getTileSize(),b=this._tileZoom,B=this._map.getPixelWorldBounds(this._tileZoom);B&&(this._globalTileRange=this._pxBoundsToTileRange(B)),this._wrapX=m.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,m.wrapLng[0]],b).x/_.x),Math.ceil(f.project([0,m.wrapLng[1]],b).x/_.y)],this._wrapY=m.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([m.wrapLat[0],0],b).y/_.x),Math.ceil(f.project([m.wrapLat[1],0],b).y/_.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var m=this._map,_=m._animatingZoom?Math.max(m._animateToZoom,m.getZoom()):m.getZoom(),b=m.getZoomScale(_,this._tileZoom),B=m.project(f,this._tileZoom).floor(),H=m.getSize().divideBy(b*2);return new te(B.subtract(H),B.add(H))},_update:function(f){var m=this._map;if(m){var _=this._clampZoom(m.getZoom());if(f===void 0&&(f=m.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(f),B=this._pxBoundsToTileRange(b),H=B.getCenter(),ee=[],ae=this.options.keepBuffer,he=new te(B.getBottomLeft().subtract([ae,-ae]),B.getTopRight().add([ae,-ae]));if(!(isFinite(B.min.x)&&isFinite(B.min.y)&&isFinite(B.max.x)&&isFinite(B.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ee in this._tiles){var Te=this._tiles[Ee].coords;(Te.z!==this._tileZoom||!he.contains(new V(Te.x,Te.y)))&&(this._tiles[Ee].current=!1)}if(Math.abs(_-this._tileZoom)>1){this._setView(f,_);return}for(var Ye=B.min.y;Ye<=B.max.y;Ye++)for(var lt=B.min.x;lt<=B.max.x;lt++){var _n=new V(lt,Ye);if(_n.z=this._tileZoom,!!this._isValidTile(_n)){var Oi=this._tiles[this._tileCoordsToKey(_n)];Oi?Oi.current=!0:ee.push(_n)}}if(ee.sort(function(Gn,Th){return Gn.distanceTo(H)-Th.distanceTo(H)}),ee.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Er=document.createDocumentFragment();for(lt=0;lt<ee.length;lt++)this._addTile(ee[lt],Er);this._level.el.appendChild(Er)}}}},_isValidTile:function(f){var m=this._map.options.crs;if(!m.infinite){var _=this._globalTileRange;if(!m.wrapLng&&(f.x<_.min.x||f.x>_.max.x)||!m.wrapLat&&(f.y<_.min.y||f.y>_.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(f);return ie(this.options.bounds).overlaps(b)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var m=this._map,_=this.getTileSize(),b=f.scaleBy(_),B=b.add(_),H=m.unproject(b,f.z),ee=m.unproject(B,f.z);return[H,ee]},_tileCoordsToBounds:function(f){var m=this._tileCoordsToNwSe(f),_=new ce(m[0],m[1]);return this.options.noWrap||(_=this._map.wrapLatLngBounds(_)),_},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var m=f.split(":"),_=new V(+m[0],+m[1]);return _.z=+m[2],_},_removeTile:function(f){var m=this._tiles[f];m&&(ri(m.el),delete this._tiles[f],this.fire("tileunload",{tile:m.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){st(f,"leaflet-tile");var m=this.getTileSize();f.style.width=m.x+"px",f.style.height=m.y+"px",f.onselectstart=h,f.onmousemove=h,Ge.ielt9&&this.options.opacity<1&&yr(f,this.options.opacity)},_addTile:function(f,m){var _=this._getTilePos(f),b=this._tileCoordsToKey(f),B=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(B),this.createTile.length<2&&R(o(this._tileReady,this,f,null,B)),pi(B,_),this._tiles[b]={el:B,coords:f,current:!0},m.appendChild(B),this.fire("tileloadstart",{tile:B,coords:f})},_tileReady:function(f,m,_){m&&this.fire("tileerror",{error:m,tile:_,coords:f});var b=this._tileCoordsToKey(f);_=this._tiles[b],_&&(_.loaded=+new Date,this._map._fadeAnimated?(yr(_.el,0),z(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this)):(_.active=!0,this._pruneTiles()),m||(st(_.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:_.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ge.ielt9||!this._map._fadeAnimated?R(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var m=new V(this._wrapX?c(f.x,this._wrapX):f.x,this._wrapY?c(f.y,this._wrapY):f.y);return m.z=f.z,m},_pxBoundsToTileRange:function(f){var m=this.getTileSize();return new te(f.min.unscaleBy(m).floor(),f.max.unscaleBy(m).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function Pme(f){return new Ig(f)}var Sh=Ig.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,m){this._url=f,m=p(this,m),m.detectRetina&&Ge.retina&&m.maxZoom>0?(m.tileSize=Math.floor(m.tileSize/2),m.zoomReverse?(m.zoomOffset--,m.minZoom=Math.min(m.maxZoom,m.minZoom+1)):(m.zoomOffset++,m.maxZoom=Math.max(m.minZoom,m.maxZoom-1)),m.minZoom=Math.max(0,m.minZoom)):m.zoomReverse?m.minZoom=Math.min(m.maxZoom,m.minZoom):m.maxZoom=Math.max(m.minZoom,m.maxZoom),typeof m.subdomains=="string"&&(m.subdomains=m.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,m){return this._url===f&&m===void 0&&(m=!0),this._url=f,m||this.redraw(),this},createTile:function(f,m){var _=document.createElement("img");return it(_,"load",o(this._tileOnLoad,this,m,_)),it(_,"error",o(this._tileOnError,this,m,_)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(_.referrerPolicy=this.options.referrerPolicy),_.alt="",_.src=this.getTileUrl(f),_},getTileUrl:function(f){var m={r:Ge.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var _=this._globalTileRange.max.y-f.y;this.options.tms&&(m.y=_),m["-y"]=_}return E(this._url,r(m,this.options))},_tileOnLoad:function(f,m){Ge.ielt9?setTimeout(o(f,this,null,m),0):f(null,m)},_tileOnError:function(f,m,_){var b=this.options.errorTileUrl;b&&m.getAttribute("src")!==b&&(m.src=b),f(_,m)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,m=this.options.maxZoom,_=this.options.zoomReverse,b=this.options.zoomOffset;return _&&(f=m-f),f+b},_getSubdomain:function(f){var m=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[m]},_abortLoading:function(){var f,m;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(m=this._tiles[f].el,m.onload=h,m.onerror=h,!m.complete)){m.src=w;var _=this._tiles[f].coords;ri(m),delete this._tiles[f],this.fire("tileabort",{tile:m,coords:_})}},_removeTile:function(f){var m=this._tiles[f];if(m)return m.el.setAttribute("src",w),Ig.prototype._removeTile.call(this,f)},_tileReady:function(f,m,_){if(!(!this._map||_&&_.getAttribute("src")===w))return Ig.prototype._tileReady.call(this,f,m,_)}});function H4(f,m){return new Sh(f,m)}var z4=Sh.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,m){this._url=f;var _=r({},this.defaultWmsParams);for(var b in m)b in this.options||(_[b]=m[b]);m=p(this,m);var B=m.detectRetina&&Ge.retina?2:1,H=this.getTileSize();_.width=H.x*B,_.height=H.y*B,this.wmsParams=_},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var m=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[m]=this._crs.code,Sh.prototype.onAdd.call(this,f)},getTileUrl:function(f){var m=this._tileCoordsToNwSe(f),_=this._crs,b=J(_.project(m[0]),_.project(m[1])),B=b.min,H=b.max,ee=(this._wmsVersion>=1.3&&this._crs===M4?[B.y,B.x,H.y,H.x]:[B.x,B.y,H.x,H.y]).join(","),ae=Sh.prototype.getTileUrl.call(this,f);return ae+y(this.wmsParams,ae,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ee},setParams:function(f,m){return r(this.wmsParams,f),m||this.redraw(),this}});function Mme(f,m){return new z4(f,m)}Sh.WMS=z4,H4.wms=Mme;var xo=Wr.extend({options:{padding:.1},initialize:function(f){p(this,f),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),st(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,m){var _=this._map.getZoomScale(m,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),B=this._map.project(this._center,m),H=b.multiplyBy(-_).add(B).subtract(this._map._getNewPixelOrigin(f,m));Ge.any3d?Kl(this._container,H,_):pi(this._container,H)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,m=this._map.getSize(),_=this._map.containerPointToLayerPoint(m.multiplyBy(-f)).round();this._bounds=new te(_,_.add(m.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),V4=xo.extend({options:{tolerance:0},getEvents:function(){var f=xo.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){xo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");it(f,"mousemove",this._onMouseMove,this),it(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),it(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){z(this._redrawRequest),delete this._ctx,ri(this._container),zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var m in this._layers)f=this._layers[m],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xo.prototype._update.call(this);var f=this._bounds,m=this._container,_=f.getSize(),b=Ge.retina?2:1;pi(m,f.min),m.width=b*_.x,m.height=b*_.y,m.style.width=_.x+"px",m.style.height=_.y+"px",Ge.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){xo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[l(f)]=f;var m=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=m),this._drawLast=m,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var m=f._order,_=m.next,b=m.prev;_?_.prev=b:this._drawLast=b,b?b.next=_:this._drawFirst=_,delete f._order,delete this._layers[l(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var m=f.options.dashArray.split(/[, ]+/),_=[],b,B;for(B=0;B<m.length;B++){if(b=Number(m[B]),isNaN(b))return;_.push(b)}f.options._dashArray=_}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||R(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var m=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new te,this._redrawBounds.extend(f._pxBounds.min.subtract([m,m])),this._redrawBounds.extend(f._pxBounds.max.add([m,m]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var m=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,m.x,m.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,m=this._redrawBounds;if(this._ctx.save(),m){var _=m.getSize();this._ctx.beginPath(),this._ctx.rect(m.min.x,m.min.y,_.x,_.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)f=b.layer,(!m||f._pxBounds&&f._pxBounds.intersects(m))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,m){if(this._drawing){var _,b,B,H,ee=f._parts,ae=ee.length,he=this._ctx;if(ae){for(he.beginPath(),_=0;_<ae;_++){for(b=0,B=ee[_].length;b<B;b++)H=ee[_][b],he[b?"lineTo":"moveTo"](H.x,H.y);m&&he.closePath()}this._fillStroke(he,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var m=f._point,_=this._ctx,b=Math.max(Math.round(f._radius),1),B=(Math.max(Math.round(f._radiusY),1)||b)/b;B!==1&&(_.save(),_.scale(1,B)),_.beginPath(),_.arc(m.x,m.y/B,b,0,Math.PI*2,!1),B!==1&&_.restore(),this._fillStroke(_,f)}},_fillStroke:function(f,m){var _=m.options;_.fill&&(f.globalAlpha=_.fillOpacity,f.fillStyle=_.fillColor||_.color,f.fill(_.fillRule||"evenodd")),_.stroke&&_.weight!==0&&(f.setLineDash&&f.setLineDash(m.options&&m.options._dashArray||[]),f.globalAlpha=_.opacity,f.lineWidth=_.weight,f.strokeStyle=_.color,f.lineCap=_.lineCap,f.lineJoin=_.lineJoin,f.stroke())},_onClick:function(f){for(var m=this._map.mouseEventToLayerPoint(f),_,b,B=this._drawFirst;B;B=B.next)_=B.layer,_.options.interactive&&_._containsPoint(m)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(_))&&(b=_);this._fireEvent(b?[b]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var m=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,m)}},_handleMouseOut:function(f){var m=this._hoveredLayer;m&&(ci(this._container,"leaflet-interactive"),this._fireEvent([m],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,m){if(!this._mouseHoverThrottled){for(var _,b,B=this._drawFirst;B;B=B.next)_=B.layer,_.options.interactive&&_._containsPoint(m)&&(b=_);b!==this._hoveredLayer&&(this._handleMouseOut(f),b&&(st(this._container,"leaflet-interactive"),this._fireEvent([b],f,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,m,_){this._map._fireDOMEvent(m,_||m.type,f)},_bringToFront:function(f){var m=f._order;if(m){var _=m.next,b=m.prev;if(_)_.prev=b;else return;b?b.next=_:_&&(this._drawFirst=_),m.prev=this._drawLast,this._drawLast.next=m,m.next=null,this._drawLast=m,this._requestRedraw(f)}},_bringToBack:function(f){var m=f._order;if(m){var _=m.next,b=m.prev;if(b)b.next=_;else return;_?_.prev=b:b&&(this._drawLast=b),m.prev=null,m.next=this._drawFirst,this._drawFirst.prev=m,this._drawFirst=m,this._requestRedraw(f)}}});function q4(f){return Ge.canvas?new V4(f):null}var _g=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Fme={_initContainer:function(){this._container=xt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(xo.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var m=f._container=_g("shape");st(m,"leaflet-vml-shape "+(this.options.className||"")),m.coordsize="1 1",f._path=_g("path"),m.appendChild(f._path),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){var m=f._container;this._container.appendChild(m),f.options.interactive&&f.addInteractiveTarget(m)},_removePath:function(f){var m=f._container;ri(m),f.removeInteractiveTarget(m),delete this._layers[l(f)]},_updateStyle:function(f){var m=f._stroke,_=f._fill,b=f.options,B=f._container;B.stroked=!!b.stroke,B.filled=!!b.fill,b.stroke?(m||(m=f._stroke=_g("stroke")),B.appendChild(m),m.weight=b.weight+"px",m.color=b.color,m.opacity=b.opacity,b.dashArray?m.dashStyle=I(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):m.dashStyle="",m.endcap=b.lineCap.replace("butt","flat"),m.joinstyle=b.lineJoin):m&&(B.removeChild(m),f._stroke=null),b.fill?(_||(_=f._fill=_g("fill")),B.appendChild(_),_.color=b.fillColor||b.color,_.opacity=b.fillOpacity):_&&(B.removeChild(_),f._fill=null)},_updateCircle:function(f){var m=f._point.round(),_=Math.round(f._radius),b=Math.round(f._radiusY||_);this._setPath(f,f._empty()?"M0 0":"AL "+m.x+","+m.y+" "+_+","+b+" 0,"+65535*360)},_setPath:function(f,m){f._path.v=m},_bringToFront:function(f){Ih(f._container)},_bringToBack:function(f){_h(f._container)}},Fy=Ge.vml?_g:pt,Cg=xo.extend({_initContainer:function(){this._container=Fy("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Fy("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ri(this._container),zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){xo.prototype._update.call(this);var f=this._bounds,m=f.getSize(),_=this._container;(!this._svgSize||!this._svgSize.equals(m))&&(this._svgSize=m,_.setAttribute("width",m.x),_.setAttribute("height",m.y)),pi(_,f.min),_.setAttribute("viewBox",[f.min.x,f.min.y,m.x,m.y].join(" ")),this.fire("update")}},_initPath:function(f){var m=f._path=Fy("path");f.options.className&&st(m,f.options.className),f.options.interactive&&st(m,"leaflet-interactive"),this._updateStyle(f),this._layers[l(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){ri(f._path),f.removeInteractiveTarget(f._path),delete this._layers[l(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var m=f._path,_=f.options;m&&(_.stroke?(m.setAttribute("stroke",_.color),m.setAttribute("stroke-opacity",_.opacity),m.setAttribute("stroke-width",_.weight),m.setAttribute("stroke-linecap",_.lineCap),m.setAttribute("stroke-linejoin",_.lineJoin),_.dashArray?m.setAttribute("stroke-dasharray",_.dashArray):m.removeAttribute("stroke-dasharray"),_.dashOffset?m.setAttribute("stroke-dashoffset",_.dashOffset):m.removeAttribute("stroke-dashoffset")):m.setAttribute("stroke","none"),_.fill?(m.setAttribute("fill",_.fillColor||_.color),m.setAttribute("fill-opacity",_.fillOpacity),m.setAttribute("fill-rule",_.fillRule||"evenodd")):m.setAttribute("fill","none"))},_updatePoly:function(f,m){this._setPath(f,at(f._parts,m))},_updateCircle:function(f){var m=f._point,_=Math.max(Math.round(f._radius),1),b=Math.max(Math.round(f._radiusY),1)||_,B="a"+_+","+b+" 0 1,0 ",H=f._empty()?"M0 0":"M"+(m.x-_)+","+m.y+B+_*2+",0 "+B+-_*2+",0 ";this._setPath(f,H)},_setPath:function(f,m){f._path.setAttribute("d",m)},_bringToFront:function(f){Ih(f._path)},_bringToBack:function(f){_h(f._path)}});Ge.vml&&Cg.include(Fme);function $4(f){return Ge.svg||Ge.vml?new Cg(f):null}vt.include({getRenderer:function(f){var m=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return m||(m=this._renderer=this._createRenderer()),this.hasLayer(m)||this.addLayer(m),m},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var m=this._paneRenderers[f];return m===void 0&&(m=this._createRenderer({pane:f}),this._paneRenderers[f]=m),m},_createRenderer:function(f){return this.options.preferCanvas&&q4(f)||$4(f)}});var j4=xh.extend({initialize:function(f,m){xh.prototype.initialize.call(this,this._boundsToLatLngs(f),m)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=ie(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function Ome(f,m){return new j4(f,m)}Cg.create=Fy,Cg.pointsToPath=at,wo.geometryToLayer=By,wo.coordsToLatLng=Tb,wo.coordsToLatLngs=Ry,wo.latLngToCoords=Bb,wo.latLngsToCoords=Ly,wo.getFeature=bh,wo.asFeature=Dy,vt.mergeOptions({boxZoom:!0});var W4=Ts.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){it(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ri(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),gg(),hb(),this._startPoint=this._map.mouseEventToContainerPoint(f),it(document,{contextmenu:Xl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=xt("div","leaflet-zoom-box",this._container),st(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var m=new te(this._point,this._startPoint),_=m.getSize();pi(this._box,m.min),this._box.style.width=_.x+"px",this._box.style.height=_.y+"px"},_finish:function(){this._moved&&(ri(this._box),ci(this._container,"leaflet-crosshair")),Ag(),db(),zt(document,{contextmenu:Xl,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var m=new ce(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(m).fire("boxzoomend",{boxZoomBounds:m})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});vt.addInitHook("addHandler","boxZoom",W4),vt.mergeOptions({doubleClickZoom:!0});var K4=Ts.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var m=this._map,_=m.getZoom(),b=m.options.zoomDelta,B=f.originalEvent.shiftKey?_-b:_+b;m.options.doubleClickZoom==="center"?m.setZoom(B):m.setZoomAround(f.containerPoint,B)}});vt.addInitHook("addHandler","doubleClickZoom",K4),vt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Y4=Ts.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new Oa(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}st(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ci(this._map._container,"leaflet-grab"),ci(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var m=ie(this._map.options.maxBounds);this._offsetLimit=J(this._map.latLngToContainerPoint(m.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(m.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var m=this._lastTime=+new Date,_=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(_),this._times.push(m),this._prunePositions(m)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),m=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=m.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,m){return f-(f-m)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),m=this._offsetLimit;f.x<m.min.x&&(f.x=this._viscousLimit(f.x,m.min.x)),f.y<m.min.y&&(f.y=this._viscousLimit(f.y,m.min.y)),f.x>m.max.x&&(f.x=this._viscousLimit(f.x,m.max.x)),f.y>m.max.y&&(f.y=this._viscousLimit(f.y,m.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,m=Math.round(f/2),_=this._initialWorldOffset,b=this._draggable._newPos.x,B=(b-m+_)%f+m-_,H=(b+m+_)%f-m-_,ee=Math.abs(B+_)<Math.abs(H+_)?B:H;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ee},_onDragEnd:function(f){var m=this._map,_=m.options,b=!_.inertia||f.noInertia||this._times.length<2;if(m.fire("dragend",f),b)m.fire("moveend");else{this._prunePositions(+new Date);var B=this._lastPos.subtract(this._positions[0]),H=(this._lastTime-this._times[0])/1e3,ee=_.easeLinearity,ae=B.multiplyBy(ee/H),he=ae.distanceTo([0,0]),Ee=Math.min(_.inertiaMaxSpeed,he),Te=ae.multiplyBy(Ee/he),Ye=Ee/(_.inertiaDeceleration*ee),lt=Te.multiplyBy(-Ye/2).round();!lt.x&&!lt.y?m.fire("moveend"):(lt=m._limitOffset(lt,m.options.maxBounds),R(function(){m.panBy(lt,{duration:Ye,easeLinearity:ee,noMoveStart:!0,animate:!0})}))}}});vt.addInitHook("addHandler","dragging",Y4),vt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Z4=Ts.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),it(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,m=document.documentElement,_=f.scrollTop||m.scrollTop,b=f.scrollLeft||m.scrollLeft;this._map._container.focus(),window.scrollTo(b,_)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var m=this._panKeys={},_=this.keyCodes,b,B;for(b=0,B=_.left.length;b<B;b++)m[_.left[b]]=[-1*f,0];for(b=0,B=_.right.length;b<B;b++)m[_.right[b]]=[f,0];for(b=0,B=_.down.length;b<B;b++)m[_.down[b]]=[0,f];for(b=0,B=_.up.length;b<B;b++)m[_.up[b]]=[0,-1*f]},_setZoomDelta:function(f){var m=this._zoomKeys={},_=this.keyCodes,b,B;for(b=0,B=_.zoomIn.length;b<B;b++)m[_.zoomIn[b]]=f;for(b=0,B=_.zoomOut.length;b<B;b++)m[_.zoomOut[b]]=-f},_addHooks:function(){it(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var m=f.keyCode,_=this._map,b;if(m in this._panKeys){if(!_._panAnim||!_._panAnim._inProgress)if(b=this._panKeys[m],f.shiftKey&&(b=Y(b).multiplyBy(3)),_.options.maxBounds&&(b=_._limitOffset(Y(b),_.options.maxBounds)),_.options.worldCopyJump){var B=_.wrapLatLng(_.unproject(_.project(_.getCenter()).add(b)));_.panTo(B)}else _.panBy(b)}else if(m in this._zoomKeys)_.setZoom(_.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[m]);else if(m===27&&_._popup&&_._popup.options.closeOnEscapeKey)_.closePopup();else return;Xl(f)}}});vt.addInitHook("addHandler","keyboard",Z4),vt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var X4=Ts.extend({addHooks:function(){it(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var m=_4(f),_=this._map.options.wheelDebounceTime;this._delta+=m,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var b=Math.max(_-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),b),Xl(f)},_performZoom:function(){var f=this._map,m=f.getZoom(),_=this._map.options.zoomSnap||0;f._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),B=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,H=_?Math.ceil(B/_)*_:B,ee=f._limitZoom(m+(this._delta>0?H:-H))-m;this._delta=0,this._startTime=null,ee&&(f.options.scrollWheelZoom==="center"?f.setZoom(m+ee):f.setZoomAround(this._lastMousePos,m+ee))}});vt.addInitHook("addHandler","scrollWheelZoom",X4);var Nme=600;vt.mergeOptions({tapHold:Ge.touchNative&&Ge.safari&&Ge.mobile,tapTolerance:15});var J4=Ts.extend({addHooks:function(){it(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var m=f.touches[0];this._startPos=this._newPos=new V(m.clientX,m.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(it(document,"touchend",Ki),it(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",m))},this),Nme),it(document,"touchend touchcancel contextmenu",this._cancel,this),it(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){zt(document,"touchend",Ki),zt(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),zt(document,"touchend touchcancel contextmenu",this._cancel,this),zt(document,"touchmove",this._onMove,this)},_onMove:function(f){var m=f.touches[0];this._newPos=new V(m.clientX,m.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,m){var _=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:m.screenX,screenY:m.screenY,clientX:m.clientX,clientY:m.clientY});_._simulated=!0,m.target.dispatchEvent(_)}});vt.addInitHook("addHandler","tapHold",J4),vt.mergeOptions({touchZoom:Ge.touch,bounceAtZoomLimits:!0});var e5=Ts.extend({addHooks:function(){st(this._map._container,"leaflet-touch-zoom"),it(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ci(this._map._container,"leaflet-touch-zoom"),zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var m=this._map;if(!(!f.touches||f.touches.length!==2||m._animatingZoom||this._zooming)){var _=m.mouseEventToContainerPoint(f.touches[0]),b=m.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=m.getSize()._divideBy(2),this._startLatLng=m.containerPointToLatLng(this._centerPoint),m.options.touchZoom!=="center"&&(this._pinchStartLatLng=m.containerPointToLatLng(_.add(b)._divideBy(2))),this._startDist=_.distanceTo(b),this._startZoom=m.getZoom(),this._moved=!1,this._zooming=!0,m._stop(),it(document,"touchmove",this._onTouchMove,this),it(document,"touchend touchcancel",this._onTouchEnd,this),Ki(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var m=this._map,_=m.mouseEventToContainerPoint(f.touches[0]),b=m.mouseEventToContainerPoint(f.touches[1]),B=_.distanceTo(b)/this._startDist;if(this._zoom=m.getScaleZoom(B,this._startZoom),!m.options.bounceAtZoomLimits&&(this._zoom<m.getMinZoom()&&B<1||this._zoom>m.getMaxZoom()&&B>1)&&(this._zoom=m._limitZoom(this._zoom)),m.options.touchZoom==="center"){if(this._center=this._startLatLng,B===1)return}else{var H=_._add(b)._divideBy(2)._subtract(this._centerPoint);if(B===1&&H.x===0&&H.y===0)return;this._center=m.unproject(m.project(this._pinchStartLatLng,this._zoom).subtract(H),this._zoom)}this._moved||(m._moveStart(!0,!1),this._moved=!0),z(this._animRequest);var ee=o(m._move,m,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=R(ee,this,!0),Ki(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,z(this._animRequest),zt(document,"touchmove",this._onTouchMove,this),zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});vt.addInitHook("addHandler","touchZoom",e5),vt.BoxZoom=W4,vt.DoubleClickZoom=K4,vt.Drag=Y4,vt.Keyboard=Z4,vt.ScrollWheelZoom=X4,vt.TapHold=J4,vt.TouchZoom=e5,t.Bounds=te,t.Browser=Ge,t.CRS=fe,t.Canvas=V4,t.Circle=Sb,t.CircleMarker=Ty,t.Class=X,t.Control=jr,t.DivIcon=G4,t.DivOverlay=Bs,t.DomEvent=ime,t.DomUtil=eme,t.Draggable=Oa,t.Evented=j,t.FeatureGroup=_o,t.GeoJSON=wo,t.GridLayer=Ig,t.Handler=Ts,t.Icon=wh,t.ImageOverlay=ky,t.LatLng=ne,t.LatLngBounds=ce,t.Layer=Wr,t.LayerGroup=Ch,t.LineUtil=Ame,t.Map=vt,t.Marker=Sy,t.Mixin=ume,t.Path=Na,t.Point=V,t.PolyUtil=cme,t.Polygon=xh,t.Polyline=Co,t.Popup=Py,t.PosAnimation=C4,t.Projection=pme,t.Rectangle=j4,t.Renderer=xo,t.SVG=Cg,t.SVGOverlay=U4,t.TileLayer=Sh,t.Tooltip=My,t.Transformation=Qe,t.Util=q,t.VideoOverlay=Q4,t.bind=o,t.bounds=J,t.canvas=q4,t.circle=wme,t.circleMarker=Cme,t.control=yg,t.divIcon=kme,t.extend=r,t.featureGroup=Eme,t.geoJSON=N4,t.geoJson=Sme,t.gridLayer=Pme,t.icon=Ime,t.imageOverlay=Tme,t.latLng=ue,t.latLngBounds=ie,t.layerGroup=vme,t.map=nme,t.marker=_me,t.point=Y,t.polygon=bme,t.polyline=xme,t.popup=Lme,t.rectangle=Ome,t.setOptions=p,t.stamp=l,t.svg=$4,t.svgOverlay=Rme,t.tileLayer=H4,t.tooltip=Dme,t.transformation=Oe,t.version=n,t.videoOverlay=Bme;var Qme=window.L;t.noConflict=function(){return window.L=Qme,this},window.L=t})})(lx,lx.exports);var re=lx.exports;L.Control.Fullscreen=L.Control.extend({options:{position:"topleft",title:{false:"View Fullscreen",true:"Exit Fullscreen"}},onAdd:function(i){var e=L.DomUtil.create("div","leaflet-control-fullscreen leaflet-bar leaflet-control");return this.link=L.DomUtil.create("a","leaflet-control-fullscreen-button leaflet-bar-part",e),this.link.href="#",this._map=i,this._map.on("fullscreenchange",this._toggleTitle,this),this._toggleTitle(),L.DomEvent.on(this.link,"click",this._click,this),e},_click:function(i){L.DomEvent.stopPropagation(i),L.DomEvent.preventDefault(i),this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}}),L.Map.include({isFullscreen:function(){return this._isFullscreen||!1},toggleFullscreen:function(i){var e=this.getContainer();this.isFullscreen()?i&&i.pseudoFullscreen?this._disablePseudoFullscreen(e):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():this._disablePseudoFullscreen(e):i&&i.pseudoFullscreen?this._enablePseudoFullscreen(e):e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen?e.msRequestFullscreen():this._enablePseudoFullscreen(e)},_enablePseudoFullscreen:function(i){L.DomUtil.addClass(i,"leaflet-pseudo-fullscreen"),this._setFullscreen(!0),this.fire("fullscreenchange")},_disablePseudoFullscreen:function(i){L.DomUtil.removeClass(i,"leaflet-pseudo-fullscreen"),this._setFullscreen(!1),this.fire("fullscreenchange")},_setFullscreen:function(i){this._isFullscreen=i;var e=this.getContainer();i?L.DomUtil.addClass(e,"leaflet-fullscreen-on"):L.DomUtil.removeClass(e,"leaflet-fullscreen-on"),this.invalidateSize()},_onFullscreenChange:function(i){var e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;e===this.getContainer()&&!this._isFullscreen?(this._setFullscreen(!0),this.fire("fullscreenchange")):e!==this.getContainer()&&this._isFullscreen&&(this._setFullscreen(!1),this.fire("fullscreenchange"))}}),L.Map.mergeOptions({fullscreenControl:!1}),L.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=new L.Control.Fullscreen(this.options.fullscreenControl),this.addControl(this.fullscreenControl));var i;if("onfullscreenchange"in document?i="fullscreenchange":"onmozfullscreenchange"in document?i="mozfullscreenchange":"onwebkitfullscreenchange"in document?i="webkitfullscreenchange":"onmsfullscreenchange"in document&&(i="MSFullscreenChange"),i){var e=L.bind(this._onFullscreenChange,this);this.whenReady(function(){L.DomEvent.on(document,i,e)}),this.on("unload",function(){L.DomEvent.off(document,i,e)})}}),L.control.fullscreen=function(i){return new L.Control.Fullscreen(i)};var Vm=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Ra=document.documentElement.style.pointerEvents==="",Ul={cors:Vm,pointerEvents:Ra},Rfe={attributionWidthOffset:55},g8=0;function qm(i){var e="";i.f=i.f||"json";for(var t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var n=i[t],r=Object.prototype.toString.call(n),s;e.length&&(e+="&"),r==="[object Array]"?s=Object.prototype.toString.call(n[0])==="[object Object]"?JSON.stringify(n):n.join(","):r==="[object Object]"?s=JSON.stringify(n):r==="[object Date]"?s=n.valueOf():s=n,e+=encodeURIComponent(t)+"="+encodeURIComponent(s)}return e.replaceAll("'","%27")}function ux(i,e){var t=new window.XMLHttpRequest;return t.onerror=function(n){t.onreadystatechange=re.Util.falseFn,i.call(e,{error:{code:500,message:"XMLHttpRequest error"}},null)},t.onreadystatechange=function(){var n,r;if(t.readyState===4){try{n=JSON.parse(t.responseText)}catch{n=null,r={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!r&&n.error&&(r=n.error,n=null),t.onerror=re.Util.falseFn,i.call(e,r,n)}},t.ontimeout=function(){this.onerror()},t}function Lfe(i,e,t,n){var r=ux(t,n);return r.open("POST",i),typeof n<"u"&&n!==null&&typeof n.options<"u"&&(r.timeout=n.options.timeout),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.send(qm(e)),r}function A8(i,e,t,n){var r=ux(t,n);return r.open("GET",i+"?"+qm(e),!0),typeof n<"u"&&n!==null&&typeof n.options<"u"&&(r.timeout=n.options.timeout,n.options.withCredentials&&(r.withCredentials=!0)),r.send(null),r}function p8(i,e,t,n){var r=qm(e),s=ux(t,n),o=(i+"?"+r).length;if(o<=2e3&&Ul.cors?s.open("GET",i+"?"+r):o>2e3&&Ul.cors&&(s.open("POST",i),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),typeof n<"u"&&n!==null&&typeof n.options<"u"&&(s.timeout=n.options.timeout,n.options.withCredentials&&(s.withCredentials=!0)),o<=2e3&&Ul.cors)s.send(null);else if(o>2e3&&Ul.cors)s.send(r);else{if(o<=2e3&&!Ul.cors)return cx(i,e,t,n);Gl("a request to "+i+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy https://developers.arcgis.com/esri-leaflet/api-reference/request/");return}return s}function cx(i,e,t,n){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var r="c"+g8;e.callback="window._EsriLeafletCallbacks."+r,window._EsriLeafletCallbacks[r]=function(o){if(window._EsriLeafletCallbacks[r]!==!0){var a,l=Object.prototype.toString.call(o);l==="[object Object]"||l==="[object Array]"||(a={error:{code:500,message:"Expected array or object as JSONP response"}},o=null),!a&&o.error&&(a=o,o=null),t.call(n,a,o),window._EsriLeafletCallbacks[r]=!0}};var s=re.DomUtil.create("script",null,document.body);return s.type="text/javascript",s.src=i+"?"+qm(e),s.id=r,s.onerror=function(o){if(o&&window._EsriLeafletCallbacks[r]!==!0){var a={error:{code:500,message:"An unknown error occurred"}};t.call(n,a),window._EsriLeafletCallbacks[r]=!0}},re.DomUtil.addClass(s,"esri-leaflet-jsonp"),g8++,{id:r,url:s.src,abort:function(){window._EsriLeafletCallbacks._callback[r]({code:0,message:"Request aborted."})}}}var hx=Ul.cors?A8:cx;hx.CORS=A8,hx.JSONP=cx;function Gl(){console&&console.warn&&console.warn.apply(console,arguments)}var $m={request:p8,get:hx,post:Lfe};/* @preserve
* @terraformer/arcgis - v2.1.1 - MIT
* Copyright (c) 2012-2022 Environmental Systems Research Institute, Inc.
* Tue Aug 02 2022 14:23:48 GMT-0700 (Pacific Daylight Time)
*/var Dfe=function(e,t,n,r){var s=(r[0]-n[0])*(e[1]-n[1])-(r[1]-n[1])*(e[0]-n[0]),o=(t[0]-e[0])*(e[1]-n[1])-(t[1]-e[1])*(e[0]-n[0]),a=(r[1]-n[1])*(t[0]-e[0])-(r[0]-n[0])*(t[1]-e[1]);if(a!==0){var l=s/a,u=o/a;if(l>=0&&l<=1&&u>=0&&u<=1)return!0}return!1},kfe=function(e,t){for(var n=!1,r=-1,s=e.length,o=s-1;++r<s;o=r)(e[r][1]<=t[1]&&t[1]<e[o][1]||e[o][1]<=t[1]&&t[1]<e[r][1])&&t[0]<(e[o][0]-e[r][0])*(t[1]-e[r][1])/(e[o][1]-e[r][1])+e[r][0]&&(n=!n);return n},Pfe=function(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},m8=function(e,t){for(var n=0;n<e.length-1;n++)for(var r=0;r<t.length-1;r++)if(Dfe(e[n],e[n+1],t[r],t[r+1]))return!0;return!1},dx=function(e){return Pfe(e[0],e[e.length-1])||e.push(e[0]),e},fx=function(e){var t=0,n=0,r=e.length,s=e[n],o;for(n;n<r-1;n++)o=e[n+1],t+=(o[0]-s[0])*(o[1]+s[1]),s=o;return t>=0},y8=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},Mfe=function(e,t){var n=m8(e,t),r=kfe(e,t[0]);return!!(!n&&r)},Ffe=function(e){for(var t=[],n=[],r,s,o,a=0;a<e.length;a++){var l=dx(e[a].slice(0));if(!(l.length<4))if(fx(l)){var u=[l.slice().reverse()];t.push(u)}else n.push(l.slice().reverse())}for(var c=[];n.length;){o=n.pop();var h=!1;for(r=t.length-1;r>=0;r--)if(s=t[r][0],Mfe(s,o)){t[r].push(o),h=!0;break}h||c.push(o)}for(;c.length;){o=c.pop();var d=!1;for(r=t.length-1;r>=0;r--)if(s=t[r][0],m8(s,o)){t[r].push(o),d=!0;break}d||t.push([o.reverse()])}return t.length===1?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}},Ofe=function(e,t){for(var n=t?[t,"OBJECTID","FID"]:["OBJECTID","FID"],r=0;r<n.length;r++){var s=n[r];if(s in e&&(typeof e[s]=="string"||typeof e[s]=="number"))return e[s]}throw Error("No valid id attribute found")},Nfe=function i(e,t){var n={};if(e.features){n.type="FeatureCollection",n.features=[];for(var r=0;r<e.features.length;r++)n.features.push(i(e.features[r],t))}if(typeof e.x=="number"&&typeof e.y=="number"&&(n.type="Point",n.coordinates=[e.x,e.y],typeof e.z=="number"&&n.coordinates.push(e.z)),e.points&&(n.type="MultiPoint",n.coordinates=e.points.slice(0)),e.paths&&(e.paths.length===1?(n.type="LineString",n.coordinates=e.paths[0].slice(0)):(n.type="MultiLineString",n.coordinates=e.paths.slice(0))),e.rings&&(n=Ffe(e.rings.slice(0))),typeof e.xmin=="number"&&typeof e.ymin=="number"&&typeof e.xmax=="number"&&typeof e.ymax=="number"&&(n.type="Polygon",n.coordinates=[[[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax]]]),(e.geometry||e.attributes)&&(n.type="Feature",n.geometry=e.geometry?i(e.geometry):null,n.properties=e.attributes?y8(e.attributes):null,e.attributes))try{n.id=Ofe(e.attributes,t)}catch{}return JSON.stringify(n.geometry)===JSON.stringify({})&&(n.geometry=null),e.spatialReference&&e.spatialReference.wkid&&e.spatialReference.wkid!==4326&&console.warn("Object converted in non-standard crs - "+JSON.stringify(e.spatialReference)),n},v8=function(e){var t=[],n=e.slice(0),r=dx(n.shift().slice(0));if(r.length>=4){fx(r)||r.reverse(),t.push(r);for(var s=0;s<n.length;s++){var o=dx(n[s].slice(0));o.length>=4&&(fx(o)&&o.reverse(),t.push(o))}}return t},Qfe=function(e){for(var t=[],n=0;n<e.length;n++)for(var r=v8(e[n]),s=r.length-1;s>=0;s--){var o=r[s].slice(0);t.push(o)}return t},Ufe=function i(e,t){t=t||"OBJECTID";var n={wkid:4326},r={},s;switch(e.type){case"Point":r.x=e.coordinates[0],r.y=e.coordinates[1],e.coordinates[2]!=null&&(r.z=e.coordinates[2]),r.spatialReference=n;break;case"MultiPoint":r.points=e.coordinates.slice(0),e.coordinates[0][2]!=null&&(r.hasZ=!0),r.spatialReference=n;break;case"LineString":r.paths=[e.coordinates.slice(0)],e.coordinates[0][2]!=null&&(r.hasZ=!0),r.spatialReference=n;break;case"MultiLineString":r.paths=e.coordinates.slice(0),e.coordinates[0][0][2]!=null&&(r.hasZ=!0),r.spatialReference=n;break;case"Polygon":r.rings=v8(e.coordinates.slice(0)),e.coordinates[0][0][2]!=null&&(r.hasZ=!0),r.spatialReference=n;break;case"MultiPolygon":r.rings=Qfe(e.coordinates.slice(0)),e.coordinates[0][0][0][2]!=null&&(r.hasZ=!0),r.spatialReference=n;break;case"Feature":e.geometry&&(r.geometry=i(e.geometry,t)),r.attributes=e.properties?y8(e.properties):{},e.id&&(r.attributes[t]=e.id);break;case"FeatureCollection":for(r=[],s=0;s<e.features.length;s++)r.push(i(e.features[s],t));break;case"GeometryCollection":for(r=[],s=0;s<e.geometries.length;s++)r.push(i(e.geometries[s],t));break}return r},Gfe='Powered by <a href="https://www.esri.com">Esri</a>';function jm(i,e){return Ufe(i,e)}function Hfe(i,e){return Nfe(i,e)}function E8(i){if(i.xmin!=="NaN"&&i.ymin!=="NaN"&&i.xmax!=="NaN"&&i.ymax!=="NaN"){var e=re.latLng(i.ymin,i.xmin),t=re.latLng(i.ymax,i.xmax);return re.latLngBounds(e,t)}else return null}function I8(i){return i=re.latLngBounds(i),{xmin:i.getSouthWest().lng,ymin:i.getSouthWest().lat,xmax:i.getNorthEast().lng,ymax:i.getNorthEast().lat,spatialReference:{wkid:4326}}}var _8=/^(OBJECTID|FID|OID|ID)$/i;function zfe(i){var e;if(i.objectIdFieldName)e=i.objectIdFieldName;else if(i.fields){for(var t=0;t<=i.fields.length-1;t++)if(i.fields[t].type==="esriFieldTypeOID"){e=i.fields[t].name;break}if(!e){for(t=0;t<=i.fields.length-1;t++)if(i.fields[t].name.match(_8)){e=i.fields[t].name;break}}}return e}function Vfe(i){for(var e in i.attributes)if(e.match(_8))return e}function Wm(i,e){var t,n=i.features||i.results,r=n&&n.length;e?t=e:t=zfe(i);var s={type:"FeatureCollection",features:[]};if(r)for(var o=n.length-1;o>=0;o--){var a=Hfe(n[o],t||Vfe(n[o]));s.features.push(a)}return s}function gx(i){return i=re.Util.trim(i),i[i.length-1]!=="/"&&(i+="/"),i}function Km(i){if(i.url.indexOf("?")!==-1){i.requestParams=i.requestParams||{};var e=i.url.substring(i.url.indexOf("?")+1);i.url=i.url.split("?")[0],i.requestParams=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return i.url=gx(i.url.split("?")[0]),i}function qfe(i){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(i)}function C8(i){var e;switch(i){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":e="esriGeometryPolyline";break;case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":e="esriGeometryPolygon";break;case"MultiPolygon":e="esriGeometryPolygon";break}return e}function Ax(i){return i.getSize().x-Rfe.attributionWidthOffset+"px"}function Ym(i){if(i.attributionControl){if(i.attributionControl._esriAttributionLayerCount||(i.attributionControl._esriAttributionLayerCount=0),i.attributionControl._esriAttributionLayerCount===0){if(!i.attributionControl._esriAttributionAddedOnce){var e=document.createElement("style");e.type="text/css",e.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(e);var t=document.createElement("style");t.type="text/css",t.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+Ax(i)+";}",document.getElementsByTagName("head")[0].appendChild(t),i.on("resize",function(n){i.attributionControl&&(i.attributionControl._container.style.maxWidth=Ax(n.target))}),i.attributionControl._esriAttributionAddedOnce=!0}re.DomUtil.addClass(i.attributionControl._container,"esri-truncated-attribution:hover"),re.DomUtil.addClass(i.attributionControl._container,"esri-truncated-attribution")}i.attributionControl._esriAttributionLayerCount=i.attributionControl._esriAttributionLayerCount+1}}function Zm(i){i.attributionControl&&(i.attributionControl._esriAttributionLayerCount&&i.attributionControl._esriAttributionLayerCount===1&&(re.DomUtil.removeClass(i.attributionControl._container,"esri-truncated-attribution:hover"),re.DomUtil.removeClass(i.attributionControl._container,"esri-truncated-attribution")),i.attributionControl._esriAttributionLayerCount=i.attributionControl._esriAttributionLayerCount-1)}function w8(i){var e={geometry:null,geometryType:null};if(i instanceof re.LatLngBounds)return e.geometry=I8(i),e.geometryType="esriGeometryEnvelope",e;if(i.getLatLng&&(i=i.getLatLng()),i instanceof re.LatLng&&(i={type:"Point",coordinates:[i.lng,i.lat]}),i instanceof re.GeoJSON&&(i=i.getLayers()[0].feature.geometry,e.geometry=jm(i),e.geometryType=C8(i.type)),i.toGeoJSON&&(i=i.toGeoJSON()),i.type==="Feature"&&(i=i.geometry),i.type==="Point"||i.type==="LineString"||i.type==="Polygon"||i.type==="MultiPolygon")return e.geometry=jm(i),e.geometryType=C8(i.type),e;Gl("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}function $fe(i,e){Ul.cors&&p8(i,{},re.Util.bind(function(t,n){if(!t){e._esriAttributions=[];for(var r=0;r<n.contributors.length;r++)for(var s=n.contributors[r],o=0;o<s.coverageAreas.length;o++){var a=s.coverageAreas[o],l=re.latLng(a.bbox[0],a.bbox[1]),u=re.latLng(a.bbox[2],a.bbox[3]);e._esriAttributions.push({attribution:s.attribution,score:a.score,bounds:re.latLngBounds(l,u),minZoom:a.zoomMin,maxZoom:a.zoomMax})}e._esriAttributions.sort(function(h,d){return d.score-h.score});var c={target:e};px(c)}},this))}function px(i){var e=i.target,t=e._esriAttributions;if(!(!e||!e.attributionControl)){var n=e.attributionControl._container.querySelector(".esri-dynamic-attribution");if(n&&t){for(var r="",s=e.getBounds(),o=re.latLngBounds(s.getSouthWest().wrap(),s.getNorthEast().wrap()),a=e.getZoom(),l=0;l<t.length;l++){var u=t[l],c=u.attribution;!r.match(c)&&u.bounds.intersects(o)&&a>=u.minZoom&&a<=u.maxZoom&&(r+=", "+c)}r=Gfe+" | "+r.substr(2),n.innerHTML=r,n.style.maxWidth=Ax(e),e.fire("attributionupdated",{attribution:r})}}}var mx=re.Class.extend({options:{proxy:!1,useCors:Vm},generateSetter:function(i,e){return re.Util.bind(function(t){return this.params[i]=t,this},e)},initialize:function(i){if(i.request&&i.options?(this._service=i,re.Util.setOptions(this,i.options)):(re.Util.setOptions(this,i),this.options.url=gx(i.url)),this.params=re.Util.extend({},this.params||{}),this.setters)for(var e in this.setters){var t=this.setters[e];this[e]=this.generateSetter(t,this)}},token:function(i){return this._service?this._service.authenticate(i):this.params.token=i,this},apikey:function(i){return this.token(i)},format:function(i){return this.params.returnUnformattedValues=!i,this},request:function(i,e){return this.options.requestParams&&re.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,i,e):this._request("request",this.path,this.params,i,e)},_request:function(i,e,t,n,r){var s=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return(i==="get"||i==="request")&&!this.options.useCors?$m.get.JSONP(s,t,n,r):$m[i](s,t,n,r)}}),jfe=mx.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(i){return this._setGeometryParams(i),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(i,e){return i=re.latLng(i),this.params.geometry=[i.lng,i.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=e,this.params.inSR=4326,this},where:function(i){return this.params.where=i,this},between:function(i,e){return this.params.time=[i.valueOf(),e.valueOf()],this},simplify:function(i,e){var t=Math.abs(i.getBounds().getWest()-i.getBounds().getEast());return this.params.maxAllowableOffset=t/i.getSize().y*e,this},orderBy:function(i,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[i,e].join(" "),this},run:function(i,e){return this._cleanParams(),this.options.isModern||qfe(this.options.url)&&this.options.isModern===void 0?(this.params.f="geojson",this.request(function(t,n){this._trapSQLerrors(t),i.call(e,t,n,n)},this)):this.request(function(t,n){this._trapSQLerrors(t),i.call(e,t,n&&Wm(n),n)},this)},count:function(i,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(t,n){i.call(this,t,n&&n.count,n)},e)},ids:function(i,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(t,n){i.call(this,t,n&&n.objectIds,n)},e)},bounds:function(i,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(t,n){n&&n.extent&&E8(n.extent)?i.call(e,t,E8(n.extent),n):(t={message:"Invalid Bounds"},i.call(e,t,null,n))},e)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(i){var e=re.point(i);return this.params.pixelSize=[e.x,e.y],this},layer:function(i){return this.path=i+"/query",this},_trapSQLerrors:function(i){i&&i.code==="400"&&Gl("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(i){this.params.inSR=4326;var e=w8(i);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}});function yx(i){return new jfe(i)}var Wfe=mx.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(i,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[i,e].join(":"),this},simplify:function(i,e){var t=Math.abs(i.getBounds().getWest()-i.getBounds().getEast());return this.params.maxAllowableOffset=t/i.getSize().y*e,this},run:function(i,e){return this.request(function(t,n){i.call(e,t,n&&Wm(n),n)},e)}});function Kfe(i){return new Wfe(i)}var x8=mx.extend({path:"identify",between:function(i,e){return this.params.time=[i.valueOf(),e.valueOf()],this}}),Yfe=x8.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(i){var e=I8(i.getBounds()),t=i.getSize();return this.params.imageDisplay=[t.x,t.y,96],this.params.mapExtent=[e.xmin,e.ymin,e.xmax,e.ymax],this},at:function(i){return i.length===2&&(i=re.latLng(i)),this._setGeometryParams(i),this},layerDef:function(i,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[i,e].join(":"),this},simplify:function(i,e){var t=Math.abs(i.getBounds().getWest()-i.getBounds().getEast());return this.params.maxAllowableOffset=t/i.getSize().y*e,this},run:function(i,e){return this.request(function(t,n){if(t)i.call(e,t,void 0,n);else{var r=Wm(n);n.results=n.results.reverse();for(var s=0;s<r.features.length;s++){var o=r.features[s];o.layerId=n.results[s].layerId}i.call(e,void 0,r,n)}})},_setGeometryParams:function(i){var e=w8(i);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}});function b8(i){return new Yfe(i)}var Zfe=x8.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(i){return i=re.latLng(i),this.params.geometry=JSON.stringify({x:i.lng,y:i.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(i,e){return this.request(function(t,n){i.call(e,t,n&&this._responseToGeoJSON(n),n)},this)},_responseToGeoJSON:function(i){var e=i.location,t=i.catalogItems,n=i.catalogItemVisibilities,r={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[e.x,e.y]},crs:{type:"EPSG",properties:{code:e.spatialReference.wkid}},properties:{OBJECTID:i.objectId,name:i.name,value:i.value},id:i.objectId}};if(i.properties&&i.properties.Values&&(r.pixel.properties.values=i.properties.Values),t&&t.features&&(r.catalogItems=Wm(t),n&&n.length===r.catalogItems.features.length))for(var s=n.length-1;s>=0;s--)r.catalogItems.features[s].properties.catalogItemVisibility=n[s];return r}});function Xfe(i){return new Zfe(i)}var vx=re.Evented.extend({options:{proxy:!1,useCors:Vm,timeout:0},initialize:function(i){i=i||{},this._requestQueue=[],this._authenticating=!1,re.Util.setOptions(this,i),this.options.url=gx(this.options.url)},get:function(i,e,t,n){return this._request("get",i,e,t,n)},post:function(i,e,t,n){return this._request("post",i,e,t,n)},request:function(i,e,t,n){return this._request("request",i,e,t,n)},metadata:function(i,e){return this._request("get","",{},i,e)},authenticate:function(i){return this._authenticating=!1,this.options.token=i,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(i){this.options.timeout=i},_request:function(i,e,t,n,r){this.fire("requeststart",{url:this.options.url+e,params:t,method:i},!0);var s=this._createServiceCallback(i,e,t,n,r);if(this.options.token&&(t.token=this.options.token),this.options.requestParams&&re.Util.extend(t,this.options.requestParams),this._authenticating)this._requestQueue.push([i,e,t,n,r]);else{var o=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return(i==="get"||i==="request")&&!this.options.useCors?$m.get.JSONP(o,t,s,r):$m[i](o,t,s,r)}},_createServiceCallback:function(i,e,t,n,r){return re.Util.bind(function(s,o){s&&(s.code===499||s.code===498)&&(this._authenticating=!0,this._requestQueue.push([i,e,t,n,r]),this.fire("authenticationrequired",{authenticate:re.Util.bind(this.authenticate,this)},!0),s.authenticate=re.Util.bind(this.authenticate,this)),n.call(r,s,o),s?this.fire("requesterror",{url:this.options.url+e,params:t,message:s.message,code:s.code,method:i},!0):this.fire("requestsuccess",{url:this.options.url+e,params:t,response:o,method:i},!0),this.fire("requestend",{url:this.options.url+e,params:t,method:i},!0)},this)},_runQueue:function(){for(var i=this._requestQueue.length-1;i>=0;i--){var e=this._requestQueue[i],t=e.shift();this[t].apply(this,e)}this._requestQueue=[]}}),Jfe=vx.extend({identify:function(){return b8(this)},find:function(){return Kfe(this)},query:function(){return yx(this)}});function S8(i){return new Jfe(i)}var ege=vx.extend({query:function(){return yx(this)},identify:function(){return Xfe(this)}});function tge(i){return new ege(i)}var ige=vx.extend({options:{idAttribute:"OBJECTID"},query:function(){return yx(this)},addFeature:function(i,e,t){this.addFeatures(i,e,t)},addFeatures:function(i,e,t){for(var n=i.features?i.features:[i],r=n.length-1;r>=0;r--)delete n[r].id;return i=jm(i),i=n.length>1?i:[i],this.post("addFeatures",{features:i},function(s,o){var a=o&&o.addResults?o.addResults.length>1?o.addResults:o.addResults[0]:void 0;e&&e.call(t,s||o.addResults[0].error,a)},t)},updateFeature:function(i,e,t){this.updateFeatures(i,e,t)},updateFeatures:function(i,e,t){var n=i.features?i.features:[i];return i=jm(i,this.options.idAttribute),i=n.length>1?i:[i],this.post("updateFeatures",{features:i},function(r,s){var o=s&&s.updateResults?s.updateResults.length>1?s.updateResults:s.updateResults[0]:void 0;e&&e.call(t,r||s.updateResults[0].error,o)},t)},deleteFeature:function(i,e,t){this.deleteFeatures(i,e,t)},deleteFeatures:function(i,e,t){return this.post("deleteFeatures",{objectIds:i},function(n,r){var s=r&&r.deleteResults?r.deleteResults.length>1?r.deleteResults:r.deleteResults[0]:void 0;e&&e.call(t,n||r.deleteResults[0].error,s)},t)}});function nge(i){return new ige(i)}var gi=window.location.protocol!=="https:"?"http:":"https:",T8=re.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:gi+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:gi+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:Ra?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:gi+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:gi+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:gi+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:gi+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(i,e){var t;if(typeof i=="object"&&i.urlTemplate&&i.options)t=i;else if(typeof i=="string"&&T8.TILES[i])t=T8.TILES[i];else throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var n=re.Util.extend(t.options,e);re.Util.setOptions(this,n),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&t.urlTemplate.indexOf("token=")===-1&&(t.urlTemplate+="?token="+this.options.token),this.options.proxy&&(t.urlTemplate=this.options.proxy+"?"+t.urlTemplate),re.TileLayer.prototype.initialize.call(this,t.urlTemplate,n)},onAdd:function(i){Ym(i),this.options.pane==="esri-labels"&&this._initPane(),this.options.attributionUrl&&$fe((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,i),i.on("moveend",px),re.TileLayer.prototype.onAdd.call(this,i)},onRemove:function(i){Zm(i),i.off("moveend",px),re.TileLayer.prototype.onRemove.call(this,i)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var i=this._map.createPane(this.options.pane);i.style.pointerEvents="none",i.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var i='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return i}}),B8=re.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(i){i=re.Util.setOptions(this,i),i=Km(i),this.tileUrl=(i.proxy?i.proxy+"?":"")+i.url+"tile/{z}/{y}/{x}"+(i.requestParams&&Object.keys(i.requestParams).length>0?re.Util.getParamString(i.requestParams):""),i.url.indexOf("{s}")!==-1&&i.subdomains&&(i.url=i.url.replace("{s}",i.subdomains[0])),this.service=S8(i),this.service.addEventParent(this);var e=new RegExp(/tiles.arcgis(online)?\.com/g);e.test(i.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),i.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),re.TileLayer.prototype.initialize.call(this,this.tileUrl,i)},getTileUrl:function(i){var e=this._getZoomForUrl();return re.Util.template(this.tileUrl,re.Util.extend({s:this._getSubdomain(i),x:i.x,y:i.y,z:this._lodMap&&this._lodMap[e]!==void 0?this._lodMap[e]:e},this.options))},createTile:function(i,e){var t=document.createElement("img");return re.DomEvent.on(t,"load",re.Util.bind(this._tileOnLoad,this,e,t)),re.DomEvent.on(t,"error",re.Util.bind(this._tileOnError,this,e,t)),this.options.crossOrigin&&(t.crossOrigin=""),t.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]!==void 0?t.src=this.getTileUrl(i):this.once("lodmap",function(){t.src=this.getTileUrl(i)},this),t},onAdd:function(i){Ym(i),this._lodMap||this.metadata(function(e,t){if(!e&&t.spatialReference){var n=t.spatialReference.latestWkid||t.spatialReference.wkid;if(!this.options.attribution&&i.attributionControl&&t.copyrightText&&(this.options.attribution=t.copyrightText,i.attributionControl.addAttribution(this.getAttribution())),i.options.crs===re.CRS.EPSG3857&&(n===102100||n===3857)){this._lodMap={};for(var r=t.tileInfo.lods,s=B8.MercatorZoomLevels,o=0;o<r.length;o++){var a=r[o];for(var l in s){var u=s[l];if(this._withinPercentage(a.resolution,u,this.options.zoomOffsetAllowance)){this._lodMap[l]=a.level;break}}}this.fire("lodmap")}else i.options.crs&&i.options.crs.code&&i.options.crs.code.indexOf(n)>-1||Gl("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet https://developers.arcgis.com/esri-leaflet/samples/non-mercator-projection/")}},this),re.TileLayer.prototype.onAdd.call(this,i)},onRemove:function(i){Zm(i),re.TileLayer.prototype.onRemove.call(this,i)},metadata:function(i,e){return this.service.metadata(i,e),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(i){var e="?token="+i;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,e):this.tileUrl+e,this.options.token=i,this.service.authenticate(i),this},_withinPercentage:function(i,e,t){var n=Math.abs(i/e-1);return n<t}});function rge(i,e){return new B8(i,e)}var sge=re.ImageOverlay.extend({onAdd:function(i){this._topLeft=i.getPixelBounds().min,re.ImageOverlay.prototype.onAdd.call(this,i)},_reset:function(){this._map.options.crs===re.CRS.EPSG3857?re.ImageOverlay.prototype._reset.call(this):re.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),R8=re.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:Vm,attribution:null,interactive:!1,alt:""},onAdd:function(i){Ym(i),this.options.zIndex&&(this.options.position=null),this._update=re.Util.throttle(this._update,this.options.updateInterval,this),i.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?i.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(e,t){!e&&!this.options.attribution&&i.attributionControl&&t.copyrightText&&(this.options.attribution=t.copyrightText,i.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(i){Zm(i),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(i,e){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=re.popup(e),this._popupFunction=i,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(i){return this.options.zIndex=i,this._currentImage&&this._currentImage.setZIndex(i),this},_setAutoZIndex:function(i){if(this._currentImage){for(var e=this._currentImage.getPane().children,t=-i(-1/0,1/0),n=0,r=e.length,s;n<r;n++)s=e[n].style.zIndex,e[n]!==this._currentImage._image&&s&&(t=i(t,+s));isFinite(t)&&(this.options.zIndex=t+i(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(i){return this.options.opacity=i,this._currentImage&&this._currentImage.setOpacity(i),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(i,e){return this.options.from=i,this.options.to=e,this._update(),this},metadata:function(i,e){return this.service.metadata(i,e),this},authenticate:function(i){return this.service.authenticate(i),this},redraw:function(){this._update()},_renderImage:function(i,e,t){if(this._map){if(t&&(i="data:"+t+";base64,"+i),!i)return;var n=new sge(i,e,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),r=function(){this._map.removeLayer(n),this.fire("error"),n.off("load",s,this)},s=function(o){if(n.off("error",r,this),this._map){var a=o.target,l=this._currentImage;a._bounds.equals(e)&&a._bounds.equals(this._map.getBounds())?(this._currentImage=a,this.options.position==="front"?this.bringToFront():this.options.position==="back"&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),l&&this._map&&this._map.removeLayer(l),l&&l._map&&l._map.removeLayer(l)):this._map.removeLayer(a)}this.fire("load",{bounds:e})};n.once("error",r,this),n.once("load",s,this)}},_update:function(){if(this._map){var i=this._map.getZoom(),e=this._map.getBounds();if(!this._animatingZoom&&!(this._map._panTransition&&this._map._panTransition._inProgress)){if(i>this.options.maxZoom||i<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}var t=this._buildExportParams();re.Util.extend(t,this.options.requestParams),t?(this._requestExport(t,e),this.fire("loading",{bounds:e})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(i,e,t,n){if(i=re.latLng(i),this._shouldRenderPopup&&this._lastClick.equals(i)){var r=this._popupFunction(e,t,n);r&&this._popup.setLatLng(i).setContent(r).openOn(this._map)}},_resetPopupState:function(i){this._shouldRenderPopup=!1,this._lastClick=i.latlng},_calculateBbox:function(){var i=this._map.getPixelBounds(),e=this._map.unproject(i.getBottomLeft()),t=this._map.unproject(i.getTopRight()),n=this._map.options.crs.project(t),r=this._map.options.crs.project(e),s=re.bounds(n,r);return[s.getBottomLeft().x,s.getBottomLeft().y,s.getTopRight().x,s.getTopRight().y].join(",")},_calculateImageSize:function(){var i=this._map.getPixelBounds(),e=this._map.getSize(),t=this._map.unproject(i.getBottomLeft()),n=this._map.unproject(i.getTopRight()),r=this._map.latLngToLayerPoint(n).y,s=this._map.latLngToLayerPoint(t).y;return(r>0||s<e.y)&&(e.y=s-r),e.x+","+e.y}}),oge=R8.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(i){i=Km(i),this.service=tge(i),this.service.addEventParent(this),re.Util.setOptions(this,i)},setPixelType:function(i){return this.options.pixelType=i,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(i){return re.Util.isArray(i)?this.options.bandIds=i.join(","):this.options.bandIds=i.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(i,e){return re.Util.isArray(i)?this.options.noData=i.join(","):this.options.noData=i.toString(),e&&(this.options.noDataInterpretation=e),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(i){this.options.renderingRule=i,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(i){this.options.mosaicRule=i,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(i){var e=re.Util.bind(function(n,r,s){n||setTimeout(re.Util.bind(function(){this._renderPopup(i.latlng,n,r,s)},this),300)},this),t=this.identify().at(i.latlng);this.options.mosaicRule&&t.setMosaicRule(this.options.mosaicRule),t.run(e),this._shouldRenderPopup=!0,this._lastClick=i.latlng},_buildExportParams:function(){var i=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:i,imageSR:i};return this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(e.pixelType=this.options.pixelType),this.options.interpolation&&(e.interpolation=this.options.interpolation),this.options.compressionQuality&&(e.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(e.bandIds=this.options.bandIds),(this.options.noData===0||this.options.noData)&&(e.noData=this.options.noData),this.options.noDataInterpretation&&(e.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(e.token=this.service.options.token),this.options.renderingRule&&(e.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(e.mosaicRule=JSON.stringify(this.options.mosaicRule)),e},_requestExport:function(i,e){if(this.options.f==="json")this.service.request("exportImage",i,function(n,r){n||(this.options.token&&(r.href+="?token="+this.options.token),this.options.proxy&&(r.href=this.options.proxy+"?"+r.href),this._renderImage(r.href,e))},this);else{i.f="image";var t=this.options.url+"exportImage"+re.Util.getParamString(i);this.options.proxy&&(t=this.options.proxy+"?"+t),this._renderImage(t,e)}}});function age(i,e){return new oge(i,e)}var lge=R8.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(i){i=Km(i),this.service=S8(i),this.service.addEventParent(this),re.Util.setOptions(this,i)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(i){return this.options.dynamicLayers=i,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(i){return this.options.layers=i,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(i){return this.options.layerDefs=i,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(i){return this.options.timeOptions=i,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(i){var e=re.Util.bind(function(r,s,o){r||setTimeout(re.Util.bind(function(){this._renderPopup(i.latlng,r,s,o)},this),300)},this),t;if(this.options.popup?t=this.options.popup.on(this._map).at(i.latlng):t=this.identify().on(this._map).at(i.latlng),t.params.maxAllowableOffset||t.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?t.layers("visible:"+this.options.layers.join(",")):t.layers("visible")),this.options.layerDefs&&typeof this.options.layerDefs!="string"&&!t.params.layerDefs)for(var n in this.options.layerDefs)Object.prototype.hasOwnProperty.call(this.options.layerDefs,n)&&t.layerDef(n,this.options.layerDefs[n]);t.run(e),this._shouldRenderPopup=!0,this._lastClick=i.latlng},_buildExportParams:function(){var i=parseInt(this._map.options.crs.code.split(":")[1],10),e={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:i,imageSR:i};if(this.options.dynamicLayers&&(e.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(this.options.layers.length===0)return;e.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(e.layerDefs=typeof this.options.layerDefs=="string"?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(e.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(e.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(e.token=this.service.options.token),this.options.proxy&&(e.proxy=this.options.proxy),this.options.disableCache&&(e._ts=Date.now()),e},_requestExport:function(i,e){if(this.options.f==="json")this.service.request("export",i,function(n,r){n||(this.options.token&&r.href&&(r.href+="?token="+this.options.token),this.options.proxy&&r.href&&(r.href=this.options.proxy+"?"+r.href),r.href?this._renderImage(r.href,e):this._renderImage(r.imageData,e,r.contentType))},this);else{i.f="image";var t=this.options.url+"export"+re.Util.getParamString(i);this.options.proxy&&(t=this.options.proxy+"?"+t),this._renderImage(t,e)}}});function uge(i,e){return new lge(i,e)}var Xm=re.Layer.extend({options:{cellSize:512,updateWhenIdle:re.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(i){re.Util.setOptions(this,i)},onAdd:function(i){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(i){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=re.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),i},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var i=this.options.cellSize;return i instanceof re.Point?i:new re.Point(i,i)},_pruneCells:function(){if(this._map){var i,e;for(i in this._cells)e=this._cells[i],e.retain=e.current;for(i in this._cells)if(e=this._cells[i],e.current&&!e.active){var t=e.coords;this._retainParent(t.x,t.y,t.z,t.z-5)||this._retainChildren(t.x,t.y,t.z,t.z+2)}for(i in this._cells)this._cells[i].retain||this._removeCell(i)}},_removeAllCells:function(){for(var i in this._cells)this._removeCell(i)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(i,e,t,n){var r=Math.floor(i/2),s=Math.floor(e/2),o=t-1,a=new re.Point(+r,+s);a.z=+o;var l=this._cellCoordsToKey(a),u=this._cells[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),o>n?this._retainParent(r,s,o,n):!1)},_retainChildren:function(i,e,t,n){for(var r=2*i;r<2*i+2;r++)for(var s=2*e;s<2*e+2;s++){var o=new re.Point(r,s);o.z=t+1;var a=this._cellCoordsToKey(o),l=this._cells[a];if(l&&l.active){l.retain=!0;continue}else l&&l.loaded&&(l.retain=!0);t+1<n&&this._retainChildren(r,s,t+1,n)}},_resetView:function(i){var e=i&&(i.pinch||i.flyTo);e||this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_setView:function(i,e,t,n){var r=Math.round(e);n||(this._cellZoom=r,this._abortLoading&&this._abortLoading(),this._resetGrid(),r!==void 0&&this._update(i),t||this._pruneCells(),this._noPrune=!!t)},_resetGrid:function(){var i=this._map,e=i.options.crs,t=this._cellSize=this.getCellSize(),n=this._cellZoom,r=this._map.getPixelWorldBounds(this._cellZoom);r&&(this._globalCellRange=this._pxBoundsToCellRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,e.wrapLng[0]],n).x/t.x),Math.ceil(i.project([0,e.wrapLng[1]],n).x/t.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([e.wrapLat[0],0],n).y/t.x),Math.ceil(i.project([e.wrapLat[1],0],n).y/t.y)]},_onMoveEnd:function(i){var e=i&&(i.pinch||i.flyTo);e||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(i){var e=this._map,t=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(t,this._cellZoom),r=e.project(i,this._cellZoom).floor(),s=e.getSize().divideBy(n*2);return new re.Bounds(r.subtract(s),r.add(s))},_update:function(i){var e=this._map;if(e){var t=Math.round(e.getZoom());i===void 0&&(i=e.getCenter());var n=this._getCelldPixelBounds(i),r=this._pxBoundsToCellRange(n),s=r.getCenter(),o=[],a=this.options.keepBuffer,l=new re.Bounds(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var u in this._cells){var c=this._cells[u].coords;(c.z!==this._cellZoom||!l.contains(new re.Point(c.x,c.y)))&&(this._cells[u].current=!1)}if(Math.abs(t-this._cellZoom)>1){this._setView(i,t);return}for(var h=r.min.y;h<=r.max.y;h++)for(var d=r.min.x;d<=r.max.x;d++){var g=new re.Point(d,h);if(g.z=this._cellZoom,!!this._isValidCell(g)){var A=this._cells[this._cellCoordsToKey(g)];A?A.current=!0:o.push(g)}}if(o.sort(function(v,E){return v.distanceTo(s)-E.distanceTo(s)}),o.length!==0)for(this._loading||(this._loading=!0),d=0;d<o.length;d++){var p=this._cellCoordsToKey(o[d]),y=this._keyToCellCoords(p);this._activeCells[y]?this._reuseCell(o[d]):this._createCell(o[d])}}},_isValidCell:function(i){var e=this._map.options.crs;if(!e.infinite){var t=this._globalCellRange;if(!e.wrapLng&&(i.x<t.min.x||i.x>t.max.x)||!e.wrapLat&&(i.y<t.min.y||i.y>t.max.y))return!1}if(!this.options.bounds)return!0;var n=this._cellCoordsToBounds(i);return re.toLatLngBounds(this.options.bounds).overlaps(n)},_keyToBounds:function(i){return this._cellCoordsToBounds(this._keyToCellCoords(i))},_cellCoordsToNwSe:function(i){var e=this._map,t=this.getCellSize(),n=i.scaleBy(t),r=n.add(t),s=e.unproject(n,i.z),o=e.unproject(r,i.z);return[s,o]},_cellCoordsToBounds:function(i){var e=this._cellCoordsToNwSe(i),t=new re.LatLngBounds(e[0],e[1]);return this.options.noWrap||(t=this._map.wrapLatLngBounds(t)),t},_cellCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToCellCoords:function(i){var e=i.split(":"),t=new re.Point(+e[0],+e[1]);return t.z=+e[2],t},_removeCell:function(i){var e=this._cells[i];if(e){var t=this._keyToCellCoords(i),n=this._wrapCoords(t),r=this._cellCoordsToBounds(this._wrapCoords(t));e.current=!1,delete this._cells[i],this._activeCells[i]=e,this.cellLeave(r,n,i),this.fire("cellleave",{key:i,coords:n,bounds:r})}},_reuseCell:function(i){var e=this._cellCoordsToKey(i);this._cells[e]=this._activeCells[e],this._cells[e].current=!0;var t=this._wrapCoords(i),n=this._cellCoordsToBounds(this._wrapCoords(i));this.cellEnter(n,t,e),this.fire("cellenter",{key:e,coords:t,bounds:n})},_createCell:function(i){var e=this._cellCoordsToKey(i),t=this._wrapCoords(i),n=this._cellCoordsToBounds(this._wrapCoords(i));this.createCell(n,t,e),this.fire("cellcreate",{key:e,coords:t,bounds:n}),this._cells[e]={coords:i,current:!0},re.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(i,e,t){var n=this._cellCoordsToKey(i);t=this._cells[n],t&&(t.loaded=+new Date,t.active=!0)},_getCellPos:function(i){return i.scaleBy(this.getCellSize())},_wrapCoords:function(i){var e=new re.Point(this._wrapX?re.Util.wrapNum(i.x,this._wrapX):i.x,this._wrapY?re.Util.wrapNum(i.y,this._wrapY):i.y);return e.z=i.z,e},_pxBoundsToCellRange:function(i){var e=this.getCellSize();return new re.Bounds(i.min.unscaleBy(e).floor(),i.max.unscaleBy(e).ceil().subtract([1,1]))}});function po(i){this.values=[].concat(i||[])}po.prototype.query=function(i){var e=this.getIndex(i);return this.values[e]},po.prototype.getIndex=function(e){this.dirty&&this.sort();for(var t=0,n=this.values.length-1,r,s;t<=n;)if(r=(t+n)/2|0,s=this.values[Math.round(r)],+s.value<+e)t=r+1;else if(+s.value>+e)n=r-1;else return r;return Math.abs(~n)},po.prototype.between=function(e,t){var n=this.getIndex(e),r=this.getIndex(t);if(n===0&&r===0)return[];for(;this.values[n-1]&&this.values[n-1].value===e;)n--;for(;this.values[r+1]&&this.values[r+1].value===t;)r++;return this.values[r]&&this.values[r].value===t&&this.values[r+1]&&r++,this.values.slice(n,r)},po.prototype.insert=function(e){return this.values.splice(this.getIndex(e.value),0,e),this},po.prototype.bulkAdd=function(e,t){return this.values=this.values.concat([].concat(e||[])),t?this.sort():this.dirty=!0,this},po.prototype.sort=function(){return this.values.sort(function(e,t){return+t.value-+e.value}).reverse(),this.dirty=!1,this};var Ex=Xm.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(i){if(Xm.prototype.initialize.call(this,i),i=Km(i),i=re.Util.setOptions(this,i),this.service=nge(i),this.service.addEventParent(this),this.options.fields[0]!=="*"){for(var e=!1,t=0;t<this.options.fields.length;t++)this.options.fields[t].match(/^(OBJECTID|FID|OID|ID)$/i)&&(e=!0);e===!1&&Gl("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new po,this._endTimeIndex=new po):this.options.timeField&&(this._timeIndex=new po),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(i){return Ym(i),this.service.metadata(function(e,t){if(!e){var n=t.supportedQueryFormats,r=!1;(this.service.options.isModern===!1||this.options.fetchAllFeatures)&&(r=!0),!r&&n&&n.indexOf("geoJSON")!==-1&&(this.service.options.isModern=!0),t.objectIdField&&(this.service.options.idAttribute=t.objectIdField),!this.options.attribution&&i.attributionControl&&t.copyrightText&&(this.options.attribution=t.copyrightText,i.attributionControl.addAttribution(this.getAttribution()))}},this),i.on("zoomend",this._handleZoomChange,this),Xm.prototype.onAdd.call(this,i)},onRemove:function(i){return Zm(i),i.off("zoomend",this._handleZoomChange,this),Xm.prototype.onRemove.call(this,i)},getAttribution:function(){return this.options.attribution},createCell:function(i,e){this._visibleZoom()&&this._requestFeatures(i,e)},_requestFeatures:function(i,e,t,n){this._activeRequests++,n=n||0;var r=this.options.where;return this._activeRequests===1&&this.fire("loading",{bounds:i},!0),this._buildQuery(i,n).run(function(s,o,a){a&&a.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===r&&(!s&&o&&o.features.length&&re.Util.requestAnimFrame(re.Util.bind(function(){this._addFeatures(o.features,e),this._postProcessFeatures(i)},this)),!s&&o&&!o.features.length&&this._postProcessFeatures(i),s&&this._postProcessFeatures(i),t&&t.call(this,s,o),a&&(a.exceededTransferLimit||a.properties&&a.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(i,e,t,n+o.features.length))},this)},_postProcessFeatures:function(i){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:i})},_cacheKey:function(i){return i.z+":"+i.x+":"+i.y},_addFeatures:function(i,e){if(e){var t=this._cacheKey(e);this._cache[t]=this._cache[t]||[]}for(var n=i.length-1;n>=0;n--){var r=i[n].id;this._currentSnapshot.indexOf(r)===-1&&this._currentSnapshot.push(r),typeof t<"u"&&this._cache[t].indexOf(r)===-1&&this._cache[t].push(r)}this.options.timeField&&this._buildTimeIndexes(i),this.createLayers(i)},_buildQuery:function(i,e){var t=this.service.query().intersects(i).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(e))&&(t=t.offset(e)),t.params.resultType="tile",this.options.requestParams&&re.Util.extend(t.params,this.options.requestParams),this.options.simplifyFactor&&t.simplify(this._map,this.options.simplifyFactor),this.options.timeFilterMode==="server"&&this.options.from&&this.options.to&&t.between(this.options.from,this.options.to),t},setWhere:function(i,e,t){this.options.where=i&&i.length?i:"1=1";for(var n=[],r=[],s=0,o=null,a=re.Util.bind(function(d,g){if(d&&(o=d),g)for(var A=g.features.length-1;A>=0;A--)r.push(g.features[A].id);s--,s<=0&&this._visibleZoom()&&i===this.options.where&&(this._currentSnapshot=r,re.Util.requestAnimFrame(re.Util.bind(function(){this.removeLayers(n),this.addLayers(r),e&&e.call(t,o)},this)))},this),l=this._currentSnapshot.length-1;l>=0;l--)n.push(this._currentSnapshot[l]);this._cache={};for(var u in this._cells){s++;var c=this._keyToCellCoords(u),h=this._cellCoordsToBounds(c);this._requestFeatures(h,c,a)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(i,e,t,n){var r=this.options.from,s=this.options.to,o=0,a=null,l=re.Util.bind(function(d){d&&(a=d),this._filterExistingFeatures(r,s,i,e),o--,t&&o<=0&&t.call(n,a)},this);if(this.options.from=i,this.options.to=e,this._filterExistingFeatures(r,s,i,e),this.options.timeFilterMode==="server")for(var u in this._cells){o++;var c=this._keyToCellCoords(u),h=this._cellCoordsToBounds(c);this._requestFeatures(h,c,l)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(i,e,t,n){var r=i&&e?this._getFeaturesInTimeRange(i,e):this._currentSnapshot,s=this._getFeaturesInTimeRange(t,n);if(s.indexOf)for(var o=0;o<s.length;o++){var a=r.indexOf(s[o]);a>=0&&r.splice(a,1)}re.Util.requestAnimFrame(re.Util.bind(function(){this.removeLayers(r),this.addLayers(s)},this))},_getFeaturesInTimeRange:function(i,e){var t=[],n;if(this.options.timeField.start&&this.options.timeField.end){var r=this._startTimeIndex.between(i,e),s=this._endTimeIndex.between(i,e);n=r.concat(s)}else if(this._timeIndex)n=this._timeIndex.between(i,e);else return Gl("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];for(var o=n.length-1;o>=0;o--)t.push(n[o].id);return t},_buildTimeIndexes:function(i){var e,t;if(this.options.timeField.start&&this.options.timeField.end){var n=[],r=[];for(e=i.length-1;e>=0;e--)t=i[e],n.push({id:t.id,value:new Date(t.properties[this.options.timeField.start])}),r.push({id:t.id,value:new Date(t.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(n),this._endTimeIndex.bulkAdd(r)}else{var s=[];for(e=i.length-1;e>=0;e--)t=i[e],s.push({id:t.id,value:new Date(t.properties[this.options.timeField])});this._timeIndex.bulkAdd(s)}},_featureWithinTimeRange:function(i){if(!this.options.from||!this.options.to)return!0;var e=+this.options.from.valueOf(),t=+this.options.to.valueOf();if(typeof this.options.timeField=="string"){var n=+i.properties[this.options.timeField];return n>=e&&n<=t}if(this.options.timeField.start&&this.options.timeField.end){var r=+i.properties[this.options.timeField.start],s=+i.properties[this.options.timeField.end];return r>=e&&r<=t||s>=e&&s<=t||r<=e&&s>=t}},_visibleZoom:function(){if(!this._map)return!1;var i=this._map.getZoom();return!(i>this.options.maxZoom||i<this.options.minZoom)},_handleZoomChange:function(){if(!this._visibleZoom())this.removeLayers(this._currentSnapshot),this._currentSnapshot=[];else for(var i in this._cells){var e=this._cells[i].coords,t=this._cacheKey(e);this._cache[t]&&this.addLayers(this._cache[t])}},authenticate:function(i){return this.service.authenticate(i),this},metadata:function(i,e){return this.service.metadata(i,e),this},query:function(){return this.service.query()},_getMetadata:function(i){if(this._metadata){var e;i(e,this._metadata)}else this.metadata(re.Util.bind(function(t,n){this._metadata=n,i(t,this._metadata)},this))},addFeature:function(i,e,t){this.addFeatures(i,e,t)},addFeatures:function(i,e,t){this._getMetadata(re.Util.bind(function(n,r){if(n){e&&e.call(this,n,null);return}var s=i.features?i.features:[i];this.service.addFeatures(i,re.Util.bind(function(o,a){if(!o){for(var l=s.length-1;l>=0;l--)s[l].properties[r.objectIdField]=s.length>1?a[l].objectId:a.objectId,s[l].id=s.length>1?a[l].objectId:a.objectId;this._addFeatures(s)}e&&e.call(t,o,a)},this))},this))},updateFeature:function(i,e,t){this.updateFeatures(i,e,t)},updateFeatures:function(i,e,t){var n=i.features?i.features:[i];this.service.updateFeatures(i,function(r,s){if(!r){for(var o=n.length-1;o>=0;o--)this.removeLayers([n[o].id],!0);this._addFeatures(n)}e&&e.call(t,r,s)},this)},deleteFeature:function(i,e,t){this.deleteFeatures(i,e,t)},deleteFeatures:function(i,e,t){return this.service.deleteFeatures(i,function(n,r){var s=r.length?r:[r];if(!n&&s.length>0)for(var o=s.length-1;o>=0;o--)this.removeLayers([s[o].objectId],!0);e&&e.call(t,n,r)},this)}}),cge=Ex.extend({options:{cacheLayers:!0},initialize:function(i){i.apikey&&(i.token=i.apikey),Ex.prototype.initialize.call(this,i),this._originalStyle=this.options.style,this._layers={}},onRemove:function(i){for(var e in this._layers)i.removeLayer(this._layers[e]),this.fire("removefeature",{feature:this._layers[e].feature,permanent:!1},!0);return Ex.prototype.onRemove.call(this,i)},createNewLayer:function(i){var e=re.GeoJSON.geometryToLayer(i,this.options);return e&&(e.defaultOptions=e.options),e},_updateLayer:function(i,e){var t=[],n=this.options.coordsToLatLng||re.GeoJSON.coordsToLatLng;switch(e.properties&&(i.feature.properties=e.properties),e.geometry.type){case"Point":t=re.GeoJSON.coordsToLatLng(e.geometry.coordinates),i.setLatLng(t);break;case"LineString":t=re.GeoJSON.coordsToLatLngs(e.geometry.coordinates,0,n),i.setLatLngs(t);break;case"MultiLineString":t=re.GeoJSON.coordsToLatLngs(e.geometry.coordinates,1,n),i.setLatLngs(t);break;case"Polygon":t=re.GeoJSON.coordsToLatLngs(e.geometry.coordinates,1,n),i.setLatLngs(t);break;case"MultiPolygon":t=re.GeoJSON.coordsToLatLngs(e.geometry.coordinates,2,n),i.setLatLngs(t);break}this.redraw(i.feature.id)},createLayers:function(i){for(var e=i.length-1;e>=0;e--){var t=i[e],n=this._layers[t.id],r;this._visibleZoom()&&n&&!this._map.hasLayer(n)&&(!this.options.timeField||this._featureWithinTimeRange(t))&&(this._map.addLayer(n),this.fire("addfeature",{feature:n.feature},!0)),n&&(n.setLatLngs||n.setLatLng)&&this._updateLayer(n,t),n||(r=this.createNewLayer(t),r?(r.feature=t,r.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(r.feature,r),this._layers[r.feature.id]=r,this.setFeatureStyle(r.feature.id,this.options.style),this.fire("createfeature",{feature:r.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(t))&&this._map.addLayer(r)):Gl("invalid GeoJSON encountered"))}},addLayers:function(i){for(var e=i.length-1;e>=0;e--){var t=this._layers[i[e]];t&&(!this.options.timeField||this._featureWithinTimeRange(t.feature))&&(this._map.addLayer(t),this.fire("addfeature",{feature:t.feature},!0))}},removeLayers:function(i,e){for(var t=i.length-1;t>=0;t--){var n=i[t],r=this._layers[n];r&&(this.fire("removefeature",{feature:r.feature,permanent:e},!0),this._map.removeLayer(r)),r&&e&&delete this._layers[n]}},cellEnter:function(i,e){this._visibleZoom()&&!this._zooming&&this._map&&re.Util.requestAnimFrame(re.Util.bind(function(){var t=this._cacheKey(e),n=this._cellCoordsToKey(e),r=this._cache[t];this._activeCells[n]&&r&&this.addLayers(r)},this))},cellLeave:function(i,e){this._zooming||re.Util.requestAnimFrame(re.Util.bind(function(){if(this._map){var t=this._cacheKey(e),n=this._cellCoordsToKey(e),r=this._cache[t],s=this._map.getBounds();if(!this._activeCells[n]&&r){for(var o=!0,a=0;a<r.length;a++){var l=this._layers[r[a]];l&&l.getBounds&&s.intersects(l.getBounds())&&(o=!1)}o&&this.removeLayers(r,!this.options.cacheLayers),!this.options.cacheLayers&&o&&(delete this._cache[t],delete this._cells[n],delete this._activeCells[n])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(i){this.resetFeatureStyle(i.feature.id)},this),this},setStyle:function(i){return this.options.style=i,this.eachFeature(function(e){this.setFeatureStyle(e.feature.id,i)},this),this},resetFeatureStyle:function(i){var e=this._layers[i],t=this._originalStyle||re.Path.prototype.options;return e&&(re.Util.extend(e.options,e.defaultOptions),this.setFeatureStyle(i,t)),this},setFeatureStyle:function(i,e){var t=this._layers[i];return typeof e=="function"&&(e=e(t.feature)),t.setStyle&&t.setStyle(e),this},eachActiveFeature:function(i,e){if(this._map){var t=this._map.getBounds();for(var n in this._layers)this._currentSnapshot.indexOf(this._layers[n].feature.id)!==-1&&(typeof this._layers[n].getLatLng=="function"&&t.contains(this._layers[n].getLatLng())?i.call(e,this._layers[n]):typeof this._layers[n].getBounds=="function"&&t.intersects(this._layers[n].getBounds())&&i.call(e,this._layers[n]))}return this},eachFeature:function(i,e){for(var t in this._layers)i.call(e,this._layers[t]);return this},getFeature:function(i){return this._layers[i]},bringToBack:function(){this.eachFeature(function(i){i.bringToBack&&i.bringToBack()})},bringToFront:function(){this.eachFeature(function(i){i.bringToFront&&i.bringToFront()})},redraw:function(i){return i&&this._redraw(i),this},_redraw:function(i){var e=this._layers[i],t=e.feature;if(e&&e.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var n=this.options.pointToLayer(t,re.latLng(t.geometry.coordinates[1],t.geometry.coordinates[0])),r=n.options.icon;e.setIcon(r)}if(e&&e.setStyle&&this.options.pointToLayer){var s=this.options.pointToLayer(t,re.latLng(t.geometry.coordinates[1],t.geometry.coordinates[0])),o=s.options;this.setFeatureStyle(t.id,o)}e&&e.setStyle&&this.options.style&&this.resetFeatureStyle(t.id)},openPopup(i){return this._popup&&this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map),this},openTooltip(i){return this._tooltip&&this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this)),this}});function hge(i){return new cge(i)}const Ix={darkMatter:{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},positron:{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},positronLite:{url:"https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},worldAntique:{url:"https://cartocdn_{s}.global.ssl.fastly.net/base-antique/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},worldEco:{url:"https://cartocdn_{s}.global.ssl.fastly.net/base-eco/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},flatBlue:{url:"https://cartocdn_{s}.global.ssl.fastly.net/base-flatblue/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},midnightCommander:{url:"https://cartocdn_{s}.global.ssl.fastly.net/base-midnight/{z}/{x}/{y}{retina}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://carto.com/attributions">Carto</a>',maxZoom:18,worldCopyJump:!0,retina:"@2x"},openstreetmapHot:{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>',maxZoom:19,worldCopyJump:!0,retina:"@2x"},openstreetmapStandard:{url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,worldCopyJump:!0,retina:"@2x"}};class dge extends re.Control{constructor(e,t={}){var n;super(t),this.options.position="topleft",typeof e.getLayers<"u"?(this.options.layer=e.getLayers()[0],(n=this.options).layer??(n.layer=e)):this.options.layer=e}onAdd(e){const t=re.DomUtil.create("div","opacity-control unselectable");re.DomUtil.create("div","opacity-area",t);const n=re.DomUtil.create("div","opacity-handle",t);re.DomUtil.create("div","opacity-arrow-up",n);const r=re.DomUtil.create("div","opacity-text",n);re.DomUtil.create("div","opacity-arrow-down",n);const s=re.DomUtil.create("div","opacity-bottom",t);return re.DomEvent.stopPropagation(t),re.DomEvent.disableClickPropagation(t),this.setListeners(n,s,r),n.style.top=`${n.offsetTop-13+50}px`,r.innerHTML=`${parseInt(this.options.layer.options.opacity*100)}%`,t}setListeners(e,t,n){let r=!1,s;re.DomEvent.on(document,"mousemove",o=>{if(!r)return;const a=Math.max(0,Math.min(200,s+parseInt(o.clientY,10)-r))/2;e.style.top=`${a*2-13}px`,n.innerHTML=`${Math.round((1-a/100)*100)}%`,t.style.height=`${Math.max(0,(100-a)*2-13)}px`,t.style.top=`${Math.min(200,a*2+13)}px`,this.options.layer.setOpacity(1-a/100)}),re.DomEvent.on(e,"mousedown",o=>(r=parseInt(o.clientY,10),s=e.offsetTop-12,!1)),re.DomEvent.on(document,"mouseup",()=>{r=null})}}const fge=i=>{let e=i.getSouthWest(),t=i.getNorthEast();return t.lng-e.lng>=360&&(e.lng=-180,t.lng=180),e=e.wrap(),t=t.wrap(),[re.Util.formatNum(e.lng,6),re.Util.formatNum(e.lat,6),re.Util.formatNum(t.lng,6),re.Util.formatNum(t.lat,6)]},_x=i=>re.geoJSON(i).getBounds(),gge=(i,e)=>{let t=null;return function(...n){clearTimeout(t),t=setTimeout(()=>{i.apply(this,n)},e)}},Age=i=>{const e=i.bounds;if(e){const t=re.latLng(e[1],e[0]),n=re.latLng(e[3],e[2]);return re.latLngBounds(t,n)}},L8=()=>{const i=`<tbody class="attribute-table-body"><tr><td colspan="2">
    <span id="attribute-table">
    <div class="spinner-border" role="status"><span class="visually-hidden">Inspecting</span></div>
    </span>
    </td></tr></tbody>`;document.querySelector(".attribute-table-body").innerHTML=i},D8=()=>{document.querySelector(".attribute-table-body").innerHTML=`<tbody class="attribute-table-body">
    <tr><td colspan="2">Could not find that feature</td></tr></tbody>`},pge=i=>{const e=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/g;return i.toString().replace(e,"<a href='$1'>$1</a>")},mge={dynamic:!0,delay:800};class yge extends re.Control{constructor(e){const t={...mge,...e};super(t),re.setOptions(this,t)}onAdd(e){this.map=e,this.map.options.geoSearchControl=this,this.staticButton=this.createStaticButton(),this.dynamicButton=this.createDynamicButton();const t=re.DomUtil.create("div");return t.className="leaflet-control search-control",t.appendChild(this.staticButton),t.appendChild(this.dynamicButton),this.options.dynamic?this.dynamicButton.style.display="block":this.staticButton.style.display="block",this.dynamicSearcher=gge(()=>{this.options.dynamic&&this.applySearch()},this.options.delay),this.map.addHandler("geosearch",vge),t}createStaticButton(){const e=re.DomUtil.create("a");return e.setAttribute("id","gbl-static-button"),e.setAttribute("href","#"),e.setAttribute("style","display:none;"),e.className="btn btn-primary",e.textContent="Search here",e.addEventListener("click",this.staticSearch.bind(this)),e}createDynamicButton(){const e=re.DomUtil.create("label");e.setAttribute("id","gbl-dynamic-button"),e.textContent=" Search when I move the map",e.setAttribute("style","display:none;");const t=re.DomUtil.create("input");return t.setAttribute("type","checkbox"),t.checked=!0,e.insertBefore(t,e.firstChild),e.addEventListener("input",this.toggleDynamicSearch.bind(this)),e}staticSearch(){this.staticButton.style.display="none",this.options.dynamic&&(this.dynamicButton.style.display="block"),this.applySearch({turbo:!1})}applySearch(e={turbo:!0}){const t=new URL(window.location).searchParams;t.delete("page"),t.delete("bbox");const n=fge(this._map.getBounds());t.set("bbox",n.join(" "));const r=new URL(this.options.baseUrl);r.search=t.toString(),window.Turbo&&e.turbo?window.Turbo.visit(r):window.location.href=r}toggleDynamicSearch(){this.options.dynamic=!this.options.dynamic}hideDynamicButton(){this.dynamicButton.style.display="none",this.staticButton.style.display="block"}}class vge extends re.Handler{constructor(e){super(e),this.map=e,this.control=e.options.geoSearchControl,this.wasResized=!1}addHooks(){this.map.on("resize",this.handleResize.bind(this)),this.map.on("dragend",this.handleDragEnd.bind(this)),this.map.on("dragstart",this.handleDragStart.bind(this)),this.map.on("zoomstart",this.handleDragEnd.bind(this)),this.map.on("zoomend",this.handleDragStart.bind(this))}removeHooks(){this.map.off("resize"),this.map.off("dragend"),this.map.off("dragstart"),this.map.off("zoomend"),this.map.off("zoomstart")}handleResize(){this.wasResized=!0}handleDragEnd(){this.wasResized?this.wasResized=!1:this.control.dynamicSearcher.apply(this.control)}handleDragStart(){this.control.options.dynamic||this.control.hideDynamicButton()}}const Ege=(i,e,t)=>{i.on("click",async n=>{const r=document.createElement("tbody");r.className="attribute-table-body",r.innerHTML='<tr><td colspan="2"><div class="spinner-border" role="status"><span class="visually-hidden">Inspecting</span></div></td></tr>',document.querySelector(".attribute-table-body").replaceWith(r);const s={URL:e,LAYERS:t,BBOX:i.getBounds().toBBoxString(),WIDTH:Math.round(document.getElementById("leaflet-viewer").clientWidth),HEIGHT:Math.round(document.getElementById("leaflet-viewer").clientHeight),QUERY_LAYERS:t,X:Math.round(n.containerPoint.x),Y:Math.round(n.containerPoint.y)};try{const o=await fetch("/wms/handle",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(s)});if(!o.ok)throw new Error("Network response was not ok.");const a=await o.json();if(a.hasOwnProperty("error")||a.values.length===0){document.querySelector(".attribute-table-body").innerHTML='<tr><td colspan="2">Could not find that feature</td></tr>';return}const l=document.createElement("tbody");l.className="attribute-table-body",a.values.forEach(u=>{l.innerHTML+=`<tr><td>${u[0]}</td><td>${u[1]}</td></tr>`}),document.querySelector(".attribute-table-body").replaceWith(l)}catch(o){console.error("Fetch error: ",o)}})},Ige=(i,e,t)=>{i.on("click",n=>{L8();const r=b8({url:e.options.url,useCors:!0}).tolerance(2).returnGeometry(!1).on(i).at(n.latlng);t&&r.layers("all: "+t),r.run((s,o,a)=>{s||a.results<1?D8():k8(o.features[0])})})},_ge=(i,e)=>{e.on("click",t=>{const n=3e3/(1+i.getZoom());L8(),e.query().returnGeometry(!1).nearby(t.latlng,n).run((r,s)=>{r||!s.features.length?D8():k8(s.features[0])})})},k8=i=>{let e='<tbody class="attribute-table-body">';Object.keys(i.properties).forEach(n=>{e+=`<tr><td>${n}</td>
               <td>${pge(i.properties[n])}</td></tr>`}),e+="</tbody>";const t=document.querySelector(".attribute-table-body");t&&(t.outerHTML=e)},P8=new re.LatLngBounds([[-30,-100],[30,100]]),Cge=.75,wge=(i,e)=>{const t=new DOMParser,n=t.parseFromString(i,"application/xml"),r=n.getElementsByTagName("Layer"),s=xge(r,e);return{url:s.getElementsByTagName("ResourceURL")[0].getAttribute("template").replace("{Style}",bge(s)).replace("{TileMatrixSet}",Sge(s)).replace("TileMatrix","z").replace("TileCol","x").replace("TileRow","y"),bounds:Tge(s)}},xge=(i,e)=>{if(i.length===1)return i[0];for(let t=0;t<i.length;t++){const n=i[t].getElementsByTagName("ows:Identifier");for(let r=0;r<n.length;r++)if(n[r].textContent===e)return i[t]}},bge=i=>{const e=i.getElementsByTagName("Style")[0];return e?e.getElementsByTagName("ows:Identifier")[0].textContent:void 0},Sge=i=>{const e=i.getElementsByTagName("TileMatrixSet")[0];return e?e.textContent:void 0},Tge=i=>{const e=i.getElementsByTagName("ows:LowerCorner")[0],t=i.getElementsByTagName("ows:UpperCorner")[0];if(e&&t){const n=e.textContent.split(" "),r=t.textContent.split(" "),s=re.latLng(n[1],n[0]),o=re.latLng(r[1],r[0]);return re.latLngBounds(s,o)}},Bge=i=>`
  <div class="index-map-info">
    ${i.title?`
      <div class="col-sm-12">
        <h3>${i.title}</h3>
      </div>`:""}
    <div class="col-sm-12">
      ${i.thumbnailUrl?`
        ${i.websiteUrl?`
          <a href="${i.websiteUrl}">
            <img src="${i.thumbnailUrl}" class="img-responsive">
          </a>`:`
          <img src="${i.thumbnailUrl}">`}`:""}
      <dl class="row dl-invert document-metadata">
        ${i.websiteUrl?`
          <dt class="col-sm-3">Website:</dt>
          <dd class="col-sm-9"><a href="${i.websiteUrl}">${i.websiteUrl}</a></dd>`:""}
        ${i.downloadUrl?`
          <dt class="col-sm-3">Download:</dt>
          <dd class="col-sm-9"><a href="${i.downloadUrl}">${i.downloadUrl}</a></dd>`:""}
        ${i.recordIdentifier?`
          <dt class="col-sm-3">Record Identifier:</dt>
          <dd class="col-sm-9">${i.recordIdentifier}</dd>`:""}
        ${i.label?`
          <dt class="col-sm-3">Label:</dt>
          <dd class="col-sm-9">${i.label}</dd>`:""}
        ${i.note?`
          <dt class="col-sm-3">Note:</dt>
          <dd class="col-sm-9">${i.note}</dd>`:""}
      </dl>
    </div>
  </div>`,Rge=i=>i.downloadUrl?`
  <li class="list-group-item download js-index-map-feature">
    <h3 class="card-subtitle">Selected feature</h3>
    <ul class="list-group list-group-flush list-group-nested">
      <li class="list-group-item download">
        <div class="download-link-container">
          <a class="btn btn-default download download-original" href="${i.downloadUrl}">
            ${i.label?i.label:"Download"}
          </a>
        </div>
      </li>
    </ul>
  </li>
`:"",Lge=i=>new Promise(e=>{i.iiifUrl&&!i.thumbnailUrl?fetch(i.iiifUrl).then(t=>t.json()).then(t=>{t.thumbnail["@id"]!==null&&(i.thumbnailUrl=t.thumbnail["@id"]),e(i)}).catch(()=>e(i)):e(i)}),Dge=(i,e)=>i||typeof i>"u"?e.LAYERS.INDEX.DEFAULT:e.LAYERS.INDEX.UNAVAILABLE,kge=i=>{Lge(i).then(e=>{const t=Bge(e);document.querySelector(".viewer-information").innerHTML=t;const n=Rge(e),r=document.querySelector(".js-download-list");r&&(r.innerHTML+=n,r.querySelectorAll(".js-index-map-feature").forEach(s=>s.remove()))})},Pge=(i,{layerId:e,opacity:t,detectRetina:n})=>re.tileLayer.wms(i,{layers:e,format:"image/png",transparent:!0,tiled:!0,CRS:"EPSG:3857",opacity:t,detectRetina:n}),Mge=async(i,{opacity:e,detectRetina:t,layerId:n})=>{const r=await fetch(i);if(!r.ok)throw new Error("Unable to fetch WMTSCapabilities document",i);const s=await r.text();if(!s)throw new Error("Unable to parse WMTSCapabilities document",i);const o=wge(s,n),a=o.bounds?{bounds:o.bounds}:{};return re.tileLayer(o.url,{opacity:e,detectRetina:t,...a})},Fge=(i,{opacity:e,detectRetina:t})=>{i=i.replace(/\/$/,"");const n=i.split("/"),r=n[n.length-1];let s;return Number(r)===parseInt(r,10)&&(s=r,i=i.slice(0,-(r.length+1))),uge({url:i,opacity:e,detectRetina:t,...s?{layers:[s]}:{}})},Oge=(i,{opacity:e,detectRetina:t})=>hge({url:i,opacity:e,detectRetina:t}),Nge=async(i,e)=>{const t=await fetch(i);if(!t.ok)throw new Error("Unable to fetch EsriTiledMapLayer document",i);let n;try{n=await t.json()}catch{throw new Error("Unable to parse TiledMapLayer document",t)}if(n.singleFusedMapCache===!0&&n.spatialReference.wkid===102100)return rge({url:i,...e})},Qge=async(i,e)=>{const t=await fetch(i);if(!t.ok)throw new Error("Unable to fetch TiledJson document",i);const n=await t.json(),r=Age(n);r&&(e.bounds=r);const s=n.tiles[0];return re.tileLayer(s,e)},Uge=async(i,e)=>{let t=null;const n=await fetch(i);if(!n.ok)throw new Error("Unable to fetch indexMapLayer document",i);const r=await n.json(),s=re.geoJson(r,{style:o=>Dge(o.properties.available,e),onEachFeature:(o,a)=>{o.properties.label!==null&&a.bindTooltip(o.properties.label),o.properties.available!==null&&a.on("click",l=>{a.setStyle(e.LAYERS.INDEX.SELECTED),t!==null&&s.resetStyle(t),t=a,kge(o.properties)})},pointToLayer:(o,a)=>re.circleMarker(a)});return s};class Cx extends Br{connect(){re.Icon.Default.imagePath="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/",this.basemap=this.getBasemap(),this.overlay=re.layerGroup(),this.bounds=P8,this.hasMapGeomValue&&(this.bounds=_x(this.mapGeomValue)),this.loadMap()}get config(){return!this.optionsValue.VIEWERS||!this.hasProtocolValue?{}:this.optionsValue.VIEWERS[this.protocolValue.toUpperCase()]}async loadMap(){this.map||(this.map=re.map(this.element),this.map.addLayer(this.basemap),this.map.addLayer(this.overlay),this.fitBounds(this.bounds),this.availableValue&&this.protocolValue?(await this.addPreviewOverlay(),this.addInspection()):this.drawInitialBoundsValue&&this.bounds&&this.addBoundsOverlay(this.bounds),this.addControls(),this.protocolValue=="IndexMap"&&this.fitBounds(this.previewOverlay.getBounds()),this.map.geosearch&&this.map.geosearch.enable(),this.dispatch("loaded"))}fitBounds(e){this.map.geosearch&&this.map.geosearch.disable(),this.map.fitBounds(e,{animate:!1,noMoveStart:!0}),this.bounds=e,this.map.geosearch&&this.map.geosearch.enable(),this.element.dataset.bounds=this.bounds.toBBoxString()}getBasemap(){const e=this.basemapValue||"positron";return re.tileLayer(Ix[e].url,{...Ix[e],detectRetina:this.optionsValue.LAYERS.DETECT_RETINA||!1})}addControls(){const e=this.optionsValue.CONTROLS||{};if(Object.entries(e).forEach(([t,n])=>{const r=this.getControl(t,n);r&&this.addControl(r)}),this.hasProtocolValue){const t=this.getControl("Opacity");this.protocolValue!=="IndexMap"&&this.addControl(t);const n=this.getControl("Fullscreen");this.addControl(n)}}addControl(e){this.map.addControl(e)}getControl(e,t){if(e=="Opacity")return new dge(this.previewOverlay);if(e=="Fullscreen")return new re.Control.Fullscreen({position:"topright",...t});if(e=="Geosearch")return new yge({baseUrl:this.catalogBaseUrlValue,...t});console.error(`Unsupported control name: "${e}"`)}addBoundsOverlay(e){const t=re.polygon([e.getSouthWest(),e.getSouthEast(),e.getNorthEast(),e.getNorthWest()]);this.boundsOverlay=t,this.overlay.addLayer(t)}removeBoundsOverlay(){this.boundsOverlay&&this.overlay.removeLayer(this.boundsOverlay)}addInspection(){if(this.protocolValue=="Wms")return Ege(this.map,this.urlValue,this.layerIdValue);if(this.protocolValue=="FeatureLayer")return _ge(this.map,this.previewOverlay);if(this.protocolValue=="DynamicMapLayer")return Ige(this.map,this.previewOverlay,this.layerIdValue)}async addPreviewOverlay(){this.previewOverlay=await this.getPreviewOverlay(this.protocolValue,this.urlValue,{layerId:this.layerIdValue,opacity:this.optionsValue.opacity||Cge,detectRetina:this.optionsValue.LAYERS.DETECT_RETINA||!1}),this.previewOverlay&&this.overlay.addLayer(this.previewOverlay)}async getPreviewOverlay(e,t,n){if(e=="DynamicMapLayer")return Fge(t,n);if(e=="FeatureLayer")return Oge(t,n);if(e=="ImageMapLayer")return age({url:t,...n});if(e=="IndexMap")return await Uge(t,this.optionsValue);if(e=="TiledMapLayer")return await Nge(t,n);if(e=="Tilejson")return await Qge(t,n);if(e=="Tms")return re.tileLayer(t,{tms:!0,...n});if(e=="Wms")return Pge(t,n);if(e=="Wmts")return await Mge(t,n);if(e=="Xyz")return re.tileLayer(t,n);console.error(`Unsupported protocol name: "${e}"`)}}Ni(Cx,"values",{url:String,catalogBaseUrl:String,protocol:String,available:Boolean,options:Object,basemap:String,mapGeom:Object,layerId:String,drawInitialBounds:Boolean});class Jm extends Br{fitResultBounds(){new URL(window.location).searchParams.get("bbox")||this.leafletViewerOutlet.fitBounds(this.getMaximalBounds())}getResultBounds(e){const t=e.querySelector("[data-geom]");if(t&&t.dataset.geom)return _x(JSON.parse(t.dataset.geom))}getMaximalBounds(){const t=this.resultTargets.map(this.getResultBounds).filter(n=>n);return t.length>0?t.reduce((n,r)=>n.extend(r)):P8}previewResultOnMap(e){const t=e.target.querySelector("[data-geom]");if(t&&t.dataset.geom!==""){const n=JSON.parse(t.dataset.geom),r=_x(n);this.leafletViewerOutlet.addBoundsOverlay(r)}}clearPreview(){this.leafletViewerOutlet.removeBoundsOverlay()}}Ni(Jm,"targets",["result"]),Ni(Jm,"outlets",["leaflet-viewer"]);class M8 extends Br{download(e){if(e.preventDefault(),this.downloading)return;this.downloading=!0,e.target.classList.add("download-in-progress");const t=e.target.dataset.downloadPath;e.target.removeAttribute("href"),e.target.innerHTML='<div class="spinner-border spinner-border-sm float-right"></div> Preparing download...',fetch(t).then(n=>n.ok?n.json():n.json().then(r=>{const s=new Error("Network response was not ok");throw s.data=r,s})).then(n=>this.complete(n,e.target)).catch(n=>this.error(n,e.target))}complete(e,t){this.downloading=!1,t.classList.remove("download-in-progress"),t.classList.add("download-complete"),t.innerHTML=`Download ready (${t.dataset.downloadType})`,t.href=e[1],this.renderMessage(e[0])}error(e,t){this.downloading=!1,t.classList.remove("download-in-progress"),t.classList.add("download-complete"),t.innerHTML=`Download failed (${t.dataset.downloadType})`,this.renderMessage(e.data[0])}renderMessage(e){Object.entries(e).forEach(([t,n])=>{const r=document.createElement("div");r.className=`alert alert-${n[0]}`,r.innerHTML=`<button type="button" class="close" data-bs-dismiss="alert" aria-hidden="true">&times;</button>${n[1]}`,document.querySelector("div.flash_messages").appendChild(r)})}}class wx extends Br{async copyToClipboard(e){let t=e.target.dataset.clipboardValue;await navigator.clipboard.writeText(t),this.alertTarget.classList.remove("d-none")}}Ni(wx,"targets",["alert"]);function Gge(){document.querySelectorAll('[data-bs-toggle="popover"]').forEach(e=>{new bootstrap.Popover(e,{trigger:"hover"})})}const Hge=(i,e)=>{i.style.opacity=0,i.style.display="block";let t=null;function n(r){t||(t=r);const s=r-t;i.style.opacity=Math.min(s/e,1),s<e&&window.requestAnimationFrame(n)}window.requestAnimationFrame(n)};function zge(){document.querySelectorAll('[data-relations="true"]').forEach(i=>{const t=`${i.dataset.url}/relations`;fetch(t,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(n=>{if(!n.ok)throw new Error("Network response was not ok");return n.text()}).then(n=>{const r=document.createElement("div");r.innerHTML=n,i.appendChild(r),r.style.display="none",Hge(r,200)}).catch(n=>console.error("Error:",n))})}function Vge(){document.body.addEventListener("mouseenter",i=>{if(i.target.closest(".blacklight-icons.svg_tooltip svg")){const e=i.target.closest(".blacklight-icons.svg_tooltip svg"),t=e.querySelector("title"),n=t?t.textContent:"";n!==void 0&&n!==""&&(new bootstrap.Tooltip(e,{placement:"bottom",title:n}).show(),e.setAttribute("data-original-title",n),t.remove())}},!0),document.body.addEventListener("mouseleave",i=>{if(i.target.closest(".blacklight-icons.svg_tooltip svg")){const e=i.target.closest(".blacklight-icons.svg_tooltip svg"),t=e.getAttribute("data-original-title");if(t!==void 0&&t!==""){const n=document.createElement("title");n.textContent=t,e.prepend(n),e.setAttribute("data-original-title","")}}document.querySelectorAll(".tooltip").forEach(e=>e.remove())},!0)}function qge(){document.querySelectorAll(".truncate-abstract").forEach((i,e)=>{let t=12*parseFloat(window.getComputedStyle(i).fontSize);if(i.getBoundingClientRect().height<t)return;let n=i.id||"truncate-"+e;i.id=n,i.classList.add("collapse");let r=document.createElement("button");r.className="btn btn-link p-0 border-0",r.setAttribute("data-bs-toggle","collapse"),r.setAttribute("aria-expanded","false"),r.setAttribute("data-bs-target",`#${n}`),r.setAttribute("aria-controls",n),r.textContent="Read more",r.addEventListener("click",function(){let s=r.getAttribute("aria-expanded")==="true";r.textContent=s?"Read more":"Close",r.setAttribute("aria-expanded",!s)}),i.parentNode.insertBefore(r,i.nextSibling)})}class $ge{constructor(e,t){this.options=t,this.el=e,this.configureHandler()}configureHandler(){this.el.addEventListener("submit",e=>this.download(e))}download(e){e.preventDefault();const t=this.options.modal;typeof t=="string"?document.querySelector(t).style.display="none":t instanceof HTMLElement&&(t.style.display="none");const n=this.el.querySelector("#requestEmail").value,r=this.el.querySelector("#requestUrl").value;fetch(r,{method:"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})}).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>this.complete(s)).catch(s=>this.error(s))}complete(e){this.downloading=!1,this.element.classList.remove("disabled"),this.element.innerHTML="Download ready",this.element.href=e[1],this.renderMessage(e[0]),this.spinnerTarget.style.display="none"}error(e){console.error("Download error:",e),this.downloading=!1,this.element.classList.remove("disabled"),this.element.innerHTML="Download failed",this.spinnerTarget.style.display="none"}}function jge(){const i=document.getElementById("blacklight-modal");i.addEventListener("loaded.blacklight.blacklight-modal",()=>{i.querySelectorAll("#hglRequest").forEach(e=>{new $ge(e,{modal:i})})})}class Wge{constructor(e,t,n={}){this.options=n,this.el=typeof e=="string"?document.querySelector(e):e,this.download=document.querySelector(this.options.target||this.el.getAttribute("data-ref-download")),t===0&&this.setRefUrl(),this.configureHandler()}configureHandler(){this.el.addEventListener("click",()=>this.setRefUrl())}setRefUrl(){const e=this.el.getAttribute("data-ref-endpoint");e?(this.download.style.display="",this.download.setAttribute("href",e)):this.download.style.display="none"}}function Kge(){const i=document.getElementById("blacklight-modal");i.addEventListener("focus",e=>{Array.from(e.target.classList).includes("show")&&(e.target.querySelectorAll(".metadata-body").forEach(t=>{t.closest(".modal-content").classList.add("metadata-modal")}),e.target.querySelectorAll(".pill-metadata").forEach((t,n)=>{new Wge(t,n)}))}),i.addEventListener("blur",e=>{Array.from(e.target.classList).includes("show")||e.target.querySelectorAll(".metadata-body").forEach(t=>{t.closest(".modal-content").classList.remove("metadata-modal")})})}const mo=function(){const i=[];return{onLoad:function(e){i.push(e)},activate:function(e){i.forEach(t=>{t(e)})},listeners:function(){return typeof Turbo<"u"?["turbo:load","turbo:frame-load"]:["DOMContentLoaded"]}}}();mo.listeners().forEach(i=>document.addEventListener(i,e=>mo.activate(e))),mo.onLoad(Gge),mo.onLoad(zge),mo.onLoad(Vge),mo.onLoad(qge),mo.onLoad(jge),mo.onLoad(Kge),typeof Stimulus<"u"?(Stimulus.register("openlayers-viewer",GE),Stimulus.register("clover-viewer",ox),Stimulus.register("oembed-viewer",ax),Stimulus.register("leaflet-viewer",Cx),Stimulus.register("search-results",Jm),Stimulus.register("downloads",M8),Stimulus.register("clipboard",wx)):console.error("Couldn't find Stimulus. Check instructions at https://github.com/hotwired/stimulus-rails");const Yge={OpenlayersViewerController:GE,CloverViewerController:ox,OembedViewerController:ax,LeafletViewerController:Cx,SearchResultsController:Jm,DownloadsController:M8,ClipboardController:wx,openLayersBasemaps:y2,leafletBasemaps:Ix,Core:mo};class Zge extends tl{decodeBlock(e){return e}}const Xge=Object.freeze(Object.defineProperty({__proto__:null,default:Zge},Symbol.toStringTag,{value:"Module"})),F8=9,xx=256,bx=257,Jge=12;function eAe(i,e,t){const n=e%8,r=Math.floor(e/8),s=8-n,o=e+t-(r+1)*8;let a=8*(r+2)-(e+t);const l=(r+2)*8-e;if(a=Math.max(0,a),r>=i.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),bx;let u=i[r]&2**(8-n)-1;u<<=t-s;let c=u;if(r+1<i.length){let h=i[r+1]>>>a;h<<=Math.max(0,t-l),c+=h}if(o>8&&r+2<i.length){const h=(r+3)*8-(e+t),d=i[r+2]>>>h;c+=d}return c}function Sx(i,e){for(let t=e.length-1;t>=0;t--)i.push(e[t]);return i}function tAe(i){const e=new Uint16Array(4093),t=new Uint8Array(4093);for(let A=0;A<=257;A++)e[A]=4096,t[A]=A;let n=258,r=F8,s=0;function o(){n=258,r=F8}function a(A){const p=eAe(A,s,r);return s+=r,p}function l(A,p){return t[n]=p,e[n]=A,n++,n-1}function u(A){const p=[];for(let y=A;y!==4096;y=e[y])p.push(t[y]);return p}const c=[];o();const h=new Uint8Array(i);let d=a(h),g;for(;d!==bx;){if(d===xx){for(o(),d=a(h);d===xx;)d=a(h);if(d===bx)break;if(d>xx)throw new Error(`corrupted code at scanline ${d}`);{const A=u(d);Sx(c,A),g=d}}else if(d<n){const A=u(d);Sx(c,A),l(g,A[A.length-1]),g=d}else{const A=u(g);if(!A)throw new Error(`Bogus entry. Not in dictionary, ${g} / ${n}, position: ${s}`);Sx(c,A),c.push(A[A.length-1]),l(g,A[A.length-1]),g=d}n+1>=2**r&&(r===Jge?g=void 0:r++),d=a(h)}return new Uint8Array(c)}class iAe extends tl{decodeBlock(e){return tAe(e).buffer}}const nAe=Object.freeze(Object.defineProperty({__proto__:null,default:iAe},Symbol.toStringTag,{value:"Module"})),$f=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),ey=4017,ty=799,iy=3406,ny=2276,ry=1567,sy=3784,lh=5793,oy=2896;function O8(i,e){let t=0;const n=[];let r=16;for(;r>0&&!i[r-1];)--r;n.push({children:[],index:0});let s=n[0],o;for(let a=0;a<r;a++){for(let l=0;l<i[a];l++){for(s=n.pop(),s.children[s.index]=e[t];s.index>0;)s=n.pop();for(s.index++,n.push(s);n.length<=a;)n.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;t++}a+1<r&&(n.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return n[0].children}function rAe(i,e,t,n,r,s,o,a,l){const{mcusPerLine:u,progressive:c}=t,h=e;let d=e,g=0,A=0;function p(){if(A>0)return A--,g>>A&1;if(g=i[d++],g===255){const ie=i[d++];if(ie)throw new Error(`unexpected marker: ${(g<<8|ie).toString(16)}`)}return A=7,g>>>7}function y(ie){let ne=ie,ue;for(;(ue=p())!==null;){if(ne=ne[ue],typeof ne=="number")return ne;if(typeof ne!="object")throw new Error("invalid huffman sequence")}return null}function v(ie){let ne=ie,ue=0;for(;ne>0;){const fe=p();if(fe===null)return;ue=ue<<1|fe,--ne}return ue}function E(ie){const ne=v(ie);return ne>=1<<ie-1?ne:ne+(-1<<ie)+1}function I(ie,ne){const ue=y(ie.huffmanTableDC),fe=ue===0?0:E(ue);ie.pred+=fe,ne[0]=ie.pred;let me=1;for(;me<64;){const Pe=y(ie.huffmanTableAC),Re=Pe&15,Qe=Pe>>4;if(Re===0){if(Qe<15)break;me+=16}else{me+=Qe;const Oe=$f[me];ne[Oe]=E(Re),me++}}}function C(ie,ne){const ue=y(ie.huffmanTableDC),fe=ue===0?0:E(ue)<<l;ie.pred+=fe,ne[0]=ie.pred}function w(ie,ne){ne[0]|=p()<<l}let S=0;function x(ie,ne){if(S>0){S--;return}let ue=s;const fe=o;for(;ue<=fe;){const me=y(ie.huffmanTableAC),Pe=me&15,Re=me>>4;if(Pe===0){if(Re<15){S=v(Re)+(1<<Re)-1;break}ue+=16}else{ue+=Re;const Qe=$f[ue];ne[Qe]=E(Pe)*(1<<l),ue++}}}let T=0,Q;function M(ie,ne){let ue=s;const fe=o;let me=0;for(;ue<=fe;){const Pe=$f[ue],Re=ne[Pe]<0?-1:1;switch(T){case 0:{const Qe=y(ie.huffmanTableAC),Oe=Qe&15;if(me=Qe>>4,Oe===0)me<15?(S=v(me)+(1<<me),T=4):(me=16,T=1);else{if(Oe!==1)throw new Error("invalid ACn encoding");Q=E(Oe),T=me?2:3}continue}case 1:case 2:ne[Pe]?ne[Pe]+=(p()<<l)*Re:(me--,me===0&&(T=T===2?3:0));break;case 3:ne[Pe]?ne[Pe]+=(p()<<l)*Re:(ne[Pe]=Q<<l,T=0);break;case 4:ne[Pe]&&(ne[Pe]+=(p()<<l)*Re);break}ue++}T===4&&(S--,S===0&&(T=0))}function R(ie,ne,ue,fe,me){const Pe=ue/u|0,Re=ue%u,Qe=Pe*ie.v+fe,Oe=Re*ie.h+me;ne(ie,ie.blocks[Qe][Oe])}function z(ie,ne,ue){const fe=ue/ie.blocksPerLine|0,me=ue%ie.blocksPerLine;ne(ie,ie.blocks[fe][me])}const q=n.length;let X,N,G,j,V,Z;c?s===0?Z=a===0?C:w:Z=a===0?x:M:Z=I;let Y=0,te,J;q===1?J=n[0].blocksPerLine*n[0].blocksPerColumn:J=u*t.mcusPerColumn;const ce=r||J;for(;Y<J;){for(N=0;N<q;N++)n[N].pred=0;if(S=0,q===1)for(X=n[0],V=0;V<ce;V++)z(X,Z,Y),Y++;else for(V=0;V<ce;V++){for(N=0;N<q;N++){X=n[N];const{h:ie,v:ne}=X;for(G=0;G<ne;G++)for(j=0;j<ie;j++)R(X,Z,Y,G,j)}if(Y++,Y===J)break}if(A=0,te=i[d]<<8|i[d+1],te<65280)throw new Error("marker was not found");if(te>=65488&&te<=65495)d+=2;else break}return d-h}function sAe(i,e){const t=[],{blocksPerLine:n,blocksPerColumn:r}=e,s=n<<3,o=new Int32Array(64),a=new Uint8Array(64);function l(u,c,h){const d=e.quantizationTable;let g,A,p,y,v,E,I,C,w;const S=h;let x;for(x=0;x<64;x++)S[x]=u[x]*d[x];for(x=0;x<8;++x){const T=8*x;if(S[1+T]===0&&S[2+T]===0&&S[3+T]===0&&S[4+T]===0&&S[5+T]===0&&S[6+T]===0&&S[7+T]===0){w=lh*S[0+T]+512>>10,S[0+T]=w,S[1+T]=w,S[2+T]=w,S[3+T]=w,S[4+T]=w,S[5+T]=w,S[6+T]=w,S[7+T]=w;continue}g=lh*S[0+T]+128>>8,A=lh*S[4+T]+128>>8,p=S[2+T],y=S[6+T],v=oy*(S[1+T]-S[7+T])+128>>8,C=oy*(S[1+T]+S[7+T])+128>>8,E=S[3+T]<<4,I=S[5+T]<<4,w=g-A+1>>1,g=g+A+1>>1,A=w,w=p*sy+y*ry+128>>8,p=p*ry-y*sy+128>>8,y=w,w=v-I+1>>1,v=v+I+1>>1,I=w,w=C+E+1>>1,E=C-E+1>>1,C=w,w=g-y+1>>1,g=g+y+1>>1,y=w,w=A-p+1>>1,A=A+p+1>>1,p=w,w=v*ny+C*iy+2048>>12,v=v*iy-C*ny+2048>>12,C=w,w=E*ty+I*ey+2048>>12,E=E*ey-I*ty+2048>>12,I=w,S[0+T]=g+C,S[7+T]=g-C,S[1+T]=A+I,S[6+T]=A-I,S[2+T]=p+E,S[5+T]=p-E,S[3+T]=y+v,S[4+T]=y-v}for(x=0;x<8;++x){const T=x;if(S[1*8+T]===0&&S[2*8+T]===0&&S[3*8+T]===0&&S[4*8+T]===0&&S[5*8+T]===0&&S[6*8+T]===0&&S[7*8+T]===0){w=lh*h[x+0]+8192>>14,S[0*8+T]=w,S[1*8+T]=w,S[2*8+T]=w,S[3*8+T]=w,S[4*8+T]=w,S[5*8+T]=w,S[6*8+T]=w,S[7*8+T]=w;continue}g=lh*S[0*8+T]+2048>>12,A=lh*S[4*8+T]+2048>>12,p=S[2*8+T],y=S[6*8+T],v=oy*(S[1*8+T]-S[7*8+T])+2048>>12,C=oy*(S[1*8+T]+S[7*8+T])+2048>>12,E=S[3*8+T],I=S[5*8+T],w=g-A+1>>1,g=g+A+1>>1,A=w,w=p*sy+y*ry+2048>>12,p=p*ry-y*sy+2048>>12,y=w,w=v-I+1>>1,v=v+I+1>>1,I=w,w=C+E+1>>1,E=C-E+1>>1,C=w,w=g-y+1>>1,g=g+y+1>>1,y=w,w=A-p+1>>1,A=A+p+1>>1,p=w,w=v*ny+C*iy+2048>>12,v=v*iy-C*ny+2048>>12,C=w,w=E*ty+I*ey+2048>>12,E=E*ey-I*ty+2048>>12,I=w,S[0*8+T]=g+C,S[7*8+T]=g-C,S[1*8+T]=A+I,S[6*8+T]=A-I,S[2*8+T]=p+E,S[5*8+T]=p-E,S[3*8+T]=y+v,S[4*8+T]=y-v}for(x=0;x<64;++x){const T=128+(S[x]+8>>4);T<0?c[x]=0:T>255?c[x]=255:c[x]=T}}for(let u=0;u<r;u++){const c=u<<3;for(let h=0;h<8;h++)t.push(new Uint8Array(s));for(let h=0;h<n;h++){l(e.blocks[u][h],a,o);let d=0;const g=h<<3;for(let A=0;A<8;A++){const p=t[c+A];for(let y=0;y<8;y++)p[g+y]=a[d++]}}}return t}class oAe{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(e){let t=0;function n(){const a=e[t]<<8|e[t+1];return t+=2,a}function r(){const a=n(),l=e.subarray(t,t+a-2);return t+=l.length,l}function s(a){let l=0,u=0,c,h;for(h in a.components)a.components.hasOwnProperty(h)&&(c=a.components[h],l<c.h&&(l=c.h),u<c.v&&(u=c.v));const d=Math.ceil(a.samplesPerLine/8/l),g=Math.ceil(a.scanLines/8/u);for(h in a.components)if(a.components.hasOwnProperty(h)){c=a.components[h];const A=Math.ceil(Math.ceil(a.samplesPerLine/8)*c.h/l),p=Math.ceil(Math.ceil(a.scanLines/8)*c.v/u),y=d*c.h,v=g*c.v,E=[];for(let I=0;I<v;I++){const C=[];for(let w=0;w<y;w++)C.push(new Int32Array(64));E.push(C)}c.blocksPerLine=A,c.blocksPerColumn=p,c.blocks=E}a.maxH=l,a.maxV=u,a.mcusPerLine=d,a.mcusPerColumn=g}let o=n();if(o!==65496)throw new Error("SOI not found");for(o=n();o!==65497;){switch(o){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const a=r();o===65504&&a[0]===74&&a[1]===70&&a[2]===73&&a[3]===70&&a[4]===0&&(this.jfif={version:{major:a[5],minor:a[6]},densityUnits:a[7],xDensity:a[8]<<8|a[9],yDensity:a[10]<<8|a[11],thumbWidth:a[12],thumbHeight:a[13],thumbData:a.subarray(14,14+3*a[12]*a[13])}),o===65518&&a[0]===65&&a[1]===100&&a[2]===111&&a[3]===98&&a[4]===101&&a[5]===0&&(this.adobe={version:a[6],flags0:a[7]<<8|a[8],flags1:a[9]<<8|a[10],transformCode:a[11]});break}case 65499:{const l=n()+t-2;for(;t<l;){const u=e[t++],c=new Int32Array(64);if(u>>4)if(u>>4===1)for(let h=0;h<64;h++){const d=$f[h];c[d]=n()}else throw new Error("DQT: invalid table spec");else for(let h=0;h<64;h++){const d=$f[h];c[d]=e[t++]}this.quantizationTables[u&15]=c}break}case 65472:case 65473:case 65474:{n();const a={extended:o===65473,progressive:o===65474,precision:e[t++],scanLines:n(),samplesPerLine:n(),components:{},componentsOrder:[]},l=e[t++];let u;for(let c=0;c<l;c++){u=e[t];const h=e[t+1]>>4,d=e[t+1]&15,g=e[t+2];a.componentsOrder.push(u),a.components[u]={h,v:d,quantizationIdx:g},t+=3}s(a),this.frames.push(a);break}case 65476:{const a=n();for(let l=2;l<a;){const u=e[t++],c=new Uint8Array(16);let h=0;for(let g=0;g<16;g++,t++)c[g]=e[t],h+=c[g];const d=new Uint8Array(h);for(let g=0;g<h;g++,t++)d[g]=e[t];l+=17+h,u>>4?this.huffmanTablesAC[u&15]=O8(c,d):this.huffmanTablesDC[u&15]=O8(c,d)}break}case 65501:n(),this.resetInterval=n();break;case 65498:{n();const a=e[t++],l=[],u=this.frames[0];for(let A=0;A<a;A++){const p=u.components[e[t++]],y=e[t++];p.huffmanTableDC=this.huffmanTablesDC[y>>4],p.huffmanTableAC=this.huffmanTablesAC[y&15],l.push(p)}const c=e[t++],h=e[t++],d=e[t++],g=rAe(e,t,u,l,this.resetInterval,c,h,d>>4,d&15);t+=g;break}case 65535:e[t]!==255&&t--;break;default:if(e[t-3]===255&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error(`unknown JPEG marker ${o.toString(16)}`)}o=n()}}getResult(){const{frames:e}=this;if(this.frames.length===0)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let c=0;c<this.frames.length;c++){const h=this.frames[c].components;for(const d of Object.keys(h))h[d].quantizationTable=this.quantizationTables[h[d].quantizationIdx],delete h[d].quantizationIdx}const t=e[0],{components:n,componentsOrder:r}=t,s=[],o=t.samplesPerLine,a=t.scanLines;for(let c=0;c<r.length;c++){const h=n[r[c]];s.push({lines:sAe(t,h),scaleX:h.h/t.maxH,scaleY:h.v/t.maxV})}const l=new Uint8Array(o*a*s.length);let u=0;for(let c=0;c<a;++c)for(let h=0;h<o;++h)for(let d=0;d<s.length;++d){const g=s[d];l[u]=g.lines[0|c*g.scaleY][0|h*g.scaleX],++u}return l}}class aAe extends tl{constructor(e){super(),this.reader=new oAe,e.JPEGTables&&this.reader.parse(e.JPEGTables)}decodeBlock(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}const lAe=Object.freeze(Object.defineProperty({__proto__:null,default:aAe},Symbol.toStringTag,{value:"Module"}));/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const uAe=4,N8=0,Q8=1,cAe=2;function uh(i){let e=i.length;for(;--e>=0;)i[e]=0}const hAe=0,U8=1,dAe=2,fAe=3,gAe=258,Tx=29,jf=256,Wf=jf+1+Tx,ch=30,Bx=19,G8=2*Wf+1,Hl=15,Rx=16,AAe=7,Lx=256,H8=16,z8=17,V8=18,Dx=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ay=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),pAe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),q8=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mAe=512,yo=new Array((Wf+2)*2);uh(yo);const Kf=new Array(ch*2);uh(Kf);const Yf=new Array(mAe);uh(Yf);const Zf=new Array(gAe-fAe+1);uh(Zf);const kx=new Array(Tx);uh(kx);const ly=new Array(ch);uh(ly);function Px(i,e,t,n,r){this.static_tree=i,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=r,this.has_stree=i&&i.length}let $8,j8,W8;function Mx(i,e){this.dyn_tree=i,this.max_code=0,this.stat_desc=e}const K8=i=>i<256?Yf[i]:Yf[256+(i>>>7)],Xf=(i,e)=>{i.pending_buf[i.pending++]=e&255,i.pending_buf[i.pending++]=e>>>8&255},Nn=(i,e,t)=>{i.bi_valid>Rx-t?(i.bi_buf|=e<<i.bi_valid&65535,Xf(i,i.bi_buf),i.bi_buf=e>>Rx-i.bi_valid,i.bi_valid+=t-Rx):(i.bi_buf|=e<<i.bi_valid&65535,i.bi_valid+=t)},Cs=(i,e,t)=>{Nn(i,t[e*2],t[e*2+1])},Y8=(i,e)=>{let t=0;do t|=i&1,i>>>=1,t<<=1;while(--e>0);return t>>>1},yAe=i=>{i.bi_valid===16?(Xf(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},vAe=(i,e)=>{const t=e.dyn_tree,n=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let u,c,h,d,g,A,p=0;for(d=0;d<=Hl;d++)i.bl_count[d]=0;for(t[i.heap[i.heap_max]*2+1]=0,u=i.heap_max+1;u<G8;u++)c=i.heap[u],d=t[t[c*2+1]*2+1]+1,d>l&&(d=l,p++),t[c*2+1]=d,!(c>n)&&(i.bl_count[d]++,g=0,c>=a&&(g=o[c-a]),A=t[c*2],i.opt_len+=A*(d+g),s&&(i.static_len+=A*(r[c*2+1]+g)));if(p!==0){do{for(d=l-1;i.bl_count[d]===0;)d--;i.bl_count[d]--,i.bl_count[d+1]+=2,i.bl_count[l]--,p-=2}while(p>0);for(d=l;d!==0;d--)for(c=i.bl_count[d];c!==0;)h=i.heap[--u],!(h>n)&&(t[h*2+1]!==d&&(i.opt_len+=(d-t[h*2+1])*t[h*2],t[h*2+1]=d),c--)}},Z8=(i,e,t)=>{const n=new Array(Hl+1);let r=0,s,o;for(s=1;s<=Hl;s++)r=r+t[s-1]<<1,n[s]=r;for(o=0;o<=e;o++){let a=i[o*2+1];a!==0&&(i[o*2]=Y8(n[a]++,a))}},EAe=()=>{let i,e,t,n,r;const s=new Array(Hl+1);for(t=0,n=0;n<Tx-1;n++)for(kx[n]=t,i=0;i<1<<Dx[n];i++)Zf[t++]=n;for(Zf[t-1]=n,r=0,n=0;n<16;n++)for(ly[n]=r,i=0;i<1<<ay[n];i++)Yf[r++]=n;for(r>>=7;n<ch;n++)for(ly[n]=r<<7,i=0;i<1<<ay[n]-7;i++)Yf[256+r++]=n;for(e=0;e<=Hl;e++)s[e]=0;for(i=0;i<=143;)yo[i*2+1]=8,i++,s[8]++;for(;i<=255;)yo[i*2+1]=9,i++,s[9]++;for(;i<=279;)yo[i*2+1]=7,i++,s[7]++;for(;i<=287;)yo[i*2+1]=8,i++,s[8]++;for(Z8(yo,Wf+1,s),i=0;i<ch;i++)Kf[i*2+1]=5,Kf[i*2]=Y8(i,5);$8=new Px(yo,Dx,jf+1,Wf,Hl),j8=new Px(Kf,ay,0,ch,Hl),W8=new Px(new Array(0),pAe,0,Bx,AAe)},X8=i=>{let e;for(e=0;e<Wf;e++)i.dyn_ltree[e*2]=0;for(e=0;e<ch;e++)i.dyn_dtree[e*2]=0;for(e=0;e<Bx;e++)i.bl_tree[e*2]=0;i.dyn_ltree[Lx*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},J8=i=>{i.bi_valid>8?Xf(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},e6=(i,e,t,n)=>{const r=e*2,s=t*2;return i[r]<i[s]||i[r]===i[s]&&n[e]<=n[t]},Fx=(i,e,t)=>{const n=i.heap[t];let r=t<<1;for(;r<=i.heap_len&&(r<i.heap_len&&e6(e,i.heap[r+1],i.heap[r],i.depth)&&r++,!e6(e,n,i.heap[r],i.depth));)i.heap[t]=i.heap[r],t=r,r<<=1;i.heap[t]=n},t6=(i,e,t)=>{let n,r,s=0,o,a;if(i.sym_next!==0)do n=i.pending_buf[i.sym_buf+s++]&255,n+=(i.pending_buf[i.sym_buf+s++]&255)<<8,r=i.pending_buf[i.sym_buf+s++],n===0?Cs(i,r,e):(o=Zf[r],Cs(i,o+jf+1,e),a=Dx[o],a!==0&&(r-=kx[o],Nn(i,r,a)),n--,o=K8(n),Cs(i,o,t),a=ay[o],a!==0&&(n-=ly[o],Nn(i,n,a)));while(s<i.sym_next);Cs(i,Lx,e)},Ox=(i,e)=>{const t=e.dyn_tree,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,l=-1,u;for(i.heap_len=0,i.heap_max=G8,o=0;o<s;o++)t[o*2]!==0?(i.heap[++i.heap_len]=l=o,i.depth[o]=0):t[o*2+1]=0;for(;i.heap_len<2;)u=i.heap[++i.heap_len]=l<2?++l:0,t[u*2]=1,i.depth[u]=0,i.opt_len--,r&&(i.static_len-=n[u*2+1]);for(e.max_code=l,o=i.heap_len>>1;o>=1;o--)Fx(i,t,o);u=s;do o=i.heap[1],i.heap[1]=i.heap[i.heap_len--],Fx(i,t,1),a=i.heap[1],i.heap[--i.heap_max]=o,i.heap[--i.heap_max]=a,t[u*2]=t[o*2]+t[a*2],i.depth[u]=(i.depth[o]>=i.depth[a]?i.depth[o]:i.depth[a])+1,t[o*2+1]=t[a*2+1]=u,i.heap[1]=u++,Fx(i,t,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],vAe(i,e),Z8(t,l,i.bl_count)},i6=(i,e,t)=>{let n,r=-1,s,o=e[0*2+1],a=0,l=7,u=4;for(o===0&&(l=138,u=3),e[(t+1)*2+1]=65535,n=0;n<=t;n++)s=o,o=e[(n+1)*2+1],!(++a<l&&s===o)&&(a<u?i.bl_tree[s*2]+=a:s!==0?(s!==r&&i.bl_tree[s*2]++,i.bl_tree[H8*2]++):a<=10?i.bl_tree[z8*2]++:i.bl_tree[V8*2]++,a=0,r=s,o===0?(l=138,u=3):s===o?(l=6,u=3):(l=7,u=4))},n6=(i,e,t)=>{let n,r=-1,s,o=e[0*2+1],a=0,l=7,u=4;for(o===0&&(l=138,u=3),n=0;n<=t;n++)if(s=o,o=e[(n+1)*2+1],!(++a<l&&s===o)){if(a<u)do Cs(i,s,i.bl_tree);while(--a!==0);else s!==0?(s!==r&&(Cs(i,s,i.bl_tree),a--),Cs(i,H8,i.bl_tree),Nn(i,a-3,2)):a<=10?(Cs(i,z8,i.bl_tree),Nn(i,a-3,3)):(Cs(i,V8,i.bl_tree),Nn(i,a-11,7));a=0,r=s,o===0?(l=138,u=3):s===o?(l=6,u=3):(l=7,u=4)}},IAe=i=>{let e;for(i6(i,i.dyn_ltree,i.l_desc.max_code),i6(i,i.dyn_dtree,i.d_desc.max_code),Ox(i,i.bl_desc),e=Bx-1;e>=3&&i.bl_tree[q8[e]*2+1]===0;e--);return i.opt_len+=3*(e+1)+5+5+4,e},_Ae=(i,e,t,n)=>{let r;for(Nn(i,e-257,5),Nn(i,t-1,5),Nn(i,n-4,4),r=0;r<n;r++)Nn(i,i.bl_tree[q8[r]*2+1],3);n6(i,i.dyn_ltree,e-1),n6(i,i.dyn_dtree,t-1)},CAe=i=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&i.dyn_ltree[t*2]!==0)return N8;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return Q8;for(t=32;t<jf;t++)if(i.dyn_ltree[t*2]!==0)return Q8;return N8};let r6=!1;const wAe=i=>{r6||(EAe(),r6=!0),i.l_desc=new Mx(i.dyn_ltree,$8),i.d_desc=new Mx(i.dyn_dtree,j8),i.bl_desc=new Mx(i.bl_tree,W8),i.bi_buf=0,i.bi_valid=0,X8(i)},s6=(i,e,t,n)=>{Nn(i,(hAe<<1)+(n?1:0),3),J8(i),Xf(i,t),Xf(i,~t),t&&i.pending_buf.set(i.window.subarray(e,e+t),i.pending),i.pending+=t},xAe=i=>{Nn(i,U8<<1,3),Cs(i,Lx,yo),yAe(i)},bAe=(i,e,t,n)=>{let r,s,o=0;i.level>0?(i.strm.data_type===cAe&&(i.strm.data_type=CAe(i)),Ox(i,i.l_desc),Ox(i,i.d_desc),o=IAe(i),r=i.opt_len+3+7>>>3,s=i.static_len+3+7>>>3,s<=r&&(r=s)):r=s=t+5,t+4<=r&&e!==-1?s6(i,e,t,n):i.strategy===uAe||s===r?(Nn(i,(U8<<1)+(n?1:0),3),t6(i,yo,Kf)):(Nn(i,(dAe<<1)+(n?1:0),3),_Ae(i,i.l_desc.max_code+1,i.d_desc.max_code+1,o+1),t6(i,i.dyn_ltree,i.dyn_dtree)),X8(i),n&&J8(i)},SAe=(i,e,t)=>(i.pending_buf[i.sym_buf+i.sym_next++]=e,i.pending_buf[i.sym_buf+i.sym_next++]=e>>8,i.pending_buf[i.sym_buf+i.sym_next++]=t,e===0?i.dyn_ltree[t*2]++:(i.matches++,e--,i.dyn_ltree[(Zf[t]+jf+1)*2]++,i.dyn_dtree[K8(e)*2]++),i.sym_next===i.sym_end);var TAe=wAe,BAe=s6,RAe=bAe,LAe=SAe,DAe=xAe,kAe={_tr_init:TAe,_tr_stored_block:BAe,_tr_flush_block:RAe,_tr_tally:LAe,_tr_align:DAe},Jf=(i,e,t,n)=>{let r=i&65535|0,s=i>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+e[n++]|0,s=s+r|0;while(--o);r%=65521,s%=65521}return r|s<<16|0};const PAe=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},MAe=new Uint32Array(PAe());var Mi=(i,e,t,n)=>{const r=MAe,s=n+t;i^=-1;for(let o=n;o<s;o++)i=i>>>8^r[(i^e[o])&255];return i^-1},hh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},eg={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:FAe,_tr_stored_block:Nx,_tr_flush_block:OAe,_tr_tally:La,_tr_align:NAe}=kAe,{Z_NO_FLUSH:Da,Z_PARTIAL_FLUSH:QAe,Z_FULL_FLUSH:UAe,Z_FINISH:pr,Z_BLOCK:o6,Z_OK:ji,Z_STREAM_END:a6,Z_STREAM_ERROR:ws,Z_DATA_ERROR:GAe,Z_BUF_ERROR:Qx,Z_DEFAULT_COMPRESSION:HAe,Z_FILTERED:zAe,Z_HUFFMAN_ONLY:uy,Z_RLE:VAe,Z_FIXED:qAe,Z_DEFAULT_STRATEGY:$Ae,Z_UNKNOWN:jAe,Z_DEFLATED:cy}=eg,WAe=9,KAe=15,YAe=8,Ux=256+1+29,ZAe=30,XAe=19,JAe=2*Ux+1,e0e=15,At=3,ka=258,xs=ka+At+1,t0e=32,dh=42,Gx=57,Hx=69,zx=73,Vx=91,qx=103,zl=113,tg=666,vn=1,fh=2,Vl=3,gh=4,i0e=3,ql=(i,e)=>(i.msg=hh[e],e),l6=i=>i*2-(i>4?9:0),Pa=i=>{let e=i.length;for(;--e>=0;)i[e]=0},n0e=i=>{let e,t,n,r=i.w_size;e=i.hash_size,n=e;do t=i.head[--n],i.head[n]=t>=r?t-r:0;while(--e);e=r,n=e;do t=i.prev[--n],i.prev[n]=t>=r?t-r:0;while(--e)};let Ma=(i,e,t)=>(e<<i.hash_shift^t)&i.hash_mask;const tr=i=>{const e=i.state;let t=e.pending;t>i.avail_out&&(t=i.avail_out),t!==0&&(i.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),i.next_out),i.next_out+=t,e.pending_out+=t,i.total_out+=t,i.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},ir=(i,e)=>{OAe(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,e),i.block_start=i.strstart,tr(i.strm)},Bt=(i,e)=>{i.pending_buf[i.pending++]=e},ig=(i,e)=>{i.pending_buf[i.pending++]=e>>>8&255,i.pending_buf[i.pending++]=e&255},$x=(i,e,t,n)=>{let r=i.avail_in;return r>n&&(r=n),r===0?0:(i.avail_in-=r,e.set(i.input.subarray(i.next_in,i.next_in+r),t),i.state.wrap===1?i.adler=Jf(i.adler,e,r,t):i.state.wrap===2&&(i.adler=Mi(i.adler,e,r,t)),i.next_in+=r,i.total_in+=r,r)},u6=(i,e)=>{let t=i.max_chain_length,n=i.strstart,r,s,o=i.prev_length,a=i.nice_match;const l=i.strstart>i.w_size-xs?i.strstart-(i.w_size-xs):0,u=i.window,c=i.w_mask,h=i.prev,d=i.strstart+ka;let g=u[n+o-1],A=u[n+o];i.prev_length>=i.good_match&&(t>>=2),a>i.lookahead&&(a=i.lookahead);do if(r=e,!(u[r+o]!==A||u[r+o-1]!==g||u[r]!==u[n]||u[++r]!==u[n+1])){n+=2,r++;do;while(u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&n<d);if(s=ka-(d-n),n=d-ka,s>o){if(i.match_start=e,o=s,s>=a)break;g=u[n+o-1],A=u[n+o]}}while((e=h[e&c])>l&&--t!==0);return o<=i.lookahead?o:i.lookahead},Ah=i=>{const e=i.w_size;let t,n,r;do{if(n=i.window_size-i.lookahead-i.strstart,i.strstart>=e+(e-xs)&&(i.window.set(i.window.subarray(e,e+e-n),0),i.match_start-=e,i.strstart-=e,i.block_start-=e,i.insert>i.strstart&&(i.insert=i.strstart),n0e(i),n+=e),i.strm.avail_in===0)break;if(t=$x(i.strm,i.window,i.strstart+i.lookahead,n),i.lookahead+=t,i.lookahead+i.insert>=At)for(r=i.strstart-i.insert,i.ins_h=i.window[r],i.ins_h=Ma(i,i.ins_h,i.window[r+1]);i.insert&&(i.ins_h=Ma(i,i.ins_h,i.window[r+At-1]),i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++,i.insert--,!(i.lookahead+i.insert<At)););}while(i.lookahead<xs&&i.strm.avail_in!==0)},c6=(i,e)=>{let t=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,n,r,s,o=0,a=i.strm.avail_in;do{if(n=65535,s=i.bi_valid+42>>3,i.strm.avail_out<s||(s=i.strm.avail_out-s,r=i.strstart-i.block_start,n>r+i.strm.avail_in&&(n=r+i.strm.avail_in),n>s&&(n=s),n<t&&(n===0&&e!==pr||e===Da||n!==r+i.strm.avail_in)))break;o=e===pr&&n===r+i.strm.avail_in?1:0,Nx(i,0,0,o),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,tr(i.strm),r&&(r>n&&(r=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+r),i.strm.next_out),i.strm.next_out+=r,i.strm.avail_out-=r,i.strm.total_out+=r,i.block_start+=r,n-=r),n&&($x(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(o===0);return a-=i.strm.avail_in,a&&(a>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=a&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-a,i.strm.next_in),i.strstart),i.strstart+=a,i.insert+=a>i.w_size-i.insert?i.w_size-i.insert:a),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),o?gh:e!==Da&&e!==pr&&i.strm.avail_in===0&&i.strstart===i.block_start?fh:(s=i.window_size-i.strstart,i.strm.avail_in>s&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,s+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),s>i.strm.avail_in&&(s=i.strm.avail_in),s&&($x(i.strm,i.window,i.strstart,s),i.strstart+=s,i.insert+=s>i.w_size-i.insert?i.w_size-i.insert:s),i.high_water<i.strstart&&(i.high_water=i.strstart),s=i.bi_valid+42>>3,s=i.pending_buf_size-s>65535?65535:i.pending_buf_size-s,t=s>i.w_size?i.w_size:s,r=i.strstart-i.block_start,(r>=t||(r||e===pr)&&e!==Da&&i.strm.avail_in===0&&r<=s)&&(n=r>s?s:r,o=e===pr&&i.strm.avail_in===0&&n===r?1:0,Nx(i,i.block_start,n,o),i.block_start+=n,tr(i.strm)),o?Vl:vn)},jx=(i,e)=>{let t,n;for(;;){if(i.lookahead<xs){if(Ah(i),i.lookahead<xs&&e===Da)return vn;if(i.lookahead===0)break}if(t=0,i.lookahead>=At&&(i.ins_h=Ma(i,i.ins_h,i.window[i.strstart+At-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),t!==0&&i.strstart-t<=i.w_size-xs&&(i.match_length=u6(i,t)),i.match_length>=At)if(n=La(i,i.strstart-i.match_start,i.match_length-At),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=At){i.match_length--;do i.strstart++,i.ins_h=Ma(i,i.ins_h,i.window[i.strstart+At-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Ma(i,i.ins_h,i.window[i.strstart+1]);else n=La(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(n&&(ir(i,!1),i.strm.avail_out===0))return vn}return i.insert=i.strstart<At-1?i.strstart:At-1,e===pr?(ir(i,!0),i.strm.avail_out===0?Vl:gh):i.sym_next&&(ir(i,!1),i.strm.avail_out===0)?vn:fh},ph=(i,e)=>{let t,n,r;for(;;){if(i.lookahead<xs){if(Ah(i),i.lookahead<xs&&e===Da)return vn;if(i.lookahead===0)break}if(t=0,i.lookahead>=At&&(i.ins_h=Ma(i,i.ins_h,i.window[i.strstart+At-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=At-1,t!==0&&i.prev_length<i.max_lazy_match&&i.strstart-t<=i.w_size-xs&&(i.match_length=u6(i,t),i.match_length<=5&&(i.strategy===zAe||i.match_length===At&&i.strstart-i.match_start>4096)&&(i.match_length=At-1)),i.prev_length>=At&&i.match_length<=i.prev_length){r=i.strstart+i.lookahead-At,n=La(i,i.strstart-1-i.prev_match,i.prev_length-At),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=r&&(i.ins_h=Ma(i,i.ins_h,i.window[i.strstart+At-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=At-1,i.strstart++,n&&(ir(i,!1),i.strm.avail_out===0))return vn}else if(i.match_available){if(n=La(i,0,i.window[i.strstart-1]),n&&ir(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return vn}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(n=La(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<At-1?i.strstart:At-1,e===pr?(ir(i,!0),i.strm.avail_out===0?Vl:gh):i.sym_next&&(ir(i,!1),i.strm.avail_out===0)?vn:fh},r0e=(i,e)=>{let t,n,r,s;const o=i.window;for(;;){if(i.lookahead<=ka){if(Ah(i),i.lookahead<=ka&&e===Da)return vn;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=At&&i.strstart>0&&(r=i.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){s=i.strstart+ka;do;while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);i.match_length=ka-(s-r),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=At?(t=La(i,1,i.match_length-At),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(t=La(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),t&&(ir(i,!1),i.strm.avail_out===0))return vn}return i.insert=0,e===pr?(ir(i,!0),i.strm.avail_out===0?Vl:gh):i.sym_next&&(ir(i,!1),i.strm.avail_out===0)?vn:fh},s0e=(i,e)=>{let t;for(;;){if(i.lookahead===0&&(Ah(i),i.lookahead===0)){if(e===Da)return vn;break}if(i.match_length=0,t=La(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,t&&(ir(i,!1),i.strm.avail_out===0))return vn}return i.insert=0,e===pr?(ir(i,!0),i.strm.avail_out===0?Vl:gh):i.sym_next&&(ir(i,!1),i.strm.avail_out===0)?vn:fh};function bs(i,e,t,n,r){this.good_length=i,this.max_lazy=e,this.nice_length=t,this.max_chain=n,this.func=r}const ng=[new bs(0,0,0,0,c6),new bs(4,4,8,4,jx),new bs(4,5,16,8,jx),new bs(4,6,32,32,jx),new bs(4,4,16,16,ph),new bs(8,16,32,32,ph),new bs(8,16,128,128,ph),new bs(8,32,128,256,ph),new bs(32,128,258,1024,ph),new bs(32,258,258,4096,ph)],o0e=i=>{i.window_size=2*i.w_size,Pa(i.head),i.max_lazy_match=ng[i.level].max_lazy,i.good_match=ng[i.level].good_length,i.nice_match=ng[i.level].nice_length,i.max_chain_length=ng[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=At-1,i.match_available=0,i.ins_h=0};function a0e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=cy,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(JAe*2),this.dyn_dtree=new Uint16Array((2*ZAe+1)*2),this.bl_tree=new Uint16Array((2*XAe+1)*2),Pa(this.dyn_ltree),Pa(this.dyn_dtree),Pa(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(e0e+1),this.heap=new Uint16Array(2*Ux+1),Pa(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ux+1),Pa(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const rg=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.status!==dh&&e.status!==Gx&&e.status!==Hx&&e.status!==zx&&e.status!==Vx&&e.status!==qx&&e.status!==zl&&e.status!==tg?1:0},h6=i=>{if(rg(i))return ql(i,ws);i.total_in=i.total_out=0,i.data_type=jAe;const e=i.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?Gx:e.wrap?dh:zl,i.adler=e.wrap===2?0:1,e.last_flush=-2,FAe(e),ji},d6=i=>{const e=h6(i);return e===ji&&o0e(i.state),e},l0e=(i,e)=>rg(i)||i.state.wrap!==2?ws:(i.state.gzhead=e,ji),f6=(i,e,t,n,r,s)=>{if(!i)return ws;let o=1;if(e===HAe&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>WAe||t!==cy||n<8||n>15||e<0||e>9||s<0||s>qAe||n===8&&o!==1)return ql(i,ws);n===8&&(n=9);const a=new a0e;return i.state=a,a.strm=i,a.status=dh,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+At-1)/At),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=e,a.strategy=s,a.method=t,d6(i)},u0e=(i,e)=>f6(i,e,cy,KAe,YAe,$Ae),c0e=(i,e)=>{if(rg(i)||e>o6||e<0)return i?ql(i,ws):ws;const t=i.state;if(!i.output||i.avail_in!==0&&!i.input||t.status===tg&&e!==pr)return ql(i,i.avail_out===0?Qx:ws);const n=t.last_flush;if(t.last_flush=e,t.pending!==0){if(tr(i),i.avail_out===0)return t.last_flush=-1,ji}else if(i.avail_in===0&&l6(e)<=l6(n)&&e!==pr)return ql(i,Qx);if(t.status===tg&&i.avail_in!==0)return ql(i,Qx);if(t.status===dh&&t.wrap===0&&(t.status=zl),t.status===dh){let r=cy+(t.w_bits-8<<4)<<8,s=-1;if(t.strategy>=uy||t.level<2?s=0:t.level<6?s=1:t.level===6?s=2:s=3,r|=s<<6,t.strstart!==0&&(r|=t0e),r+=31-r%31,ig(t,r),t.strstart!==0&&(ig(t,i.adler>>>16),ig(t,i.adler&65535)),i.adler=1,t.status=zl,tr(i),t.pending!==0)return t.last_flush=-1,ji}if(t.status===Gx){if(i.adler=0,Bt(t,31),Bt(t,139),Bt(t,8),t.gzhead)Bt(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),Bt(t,t.gzhead.time&255),Bt(t,t.gzhead.time>>8&255),Bt(t,t.gzhead.time>>16&255),Bt(t,t.gzhead.time>>24&255),Bt(t,t.level===9?2:t.strategy>=uy||t.level<2?4:0),Bt(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(Bt(t,t.gzhead.extra.length&255),Bt(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(i.adler=Mi(i.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=Hx;else if(Bt(t,0),Bt(t,0),Bt(t,0),Bt(t,0),Bt(t,0),Bt(t,t.level===9?2:t.strategy>=uy||t.level<2?4:0),Bt(t,i0e),t.status=zl,tr(i),t.pending!==0)return t.last_flush=-1,ji}if(t.status===Hx){if(t.gzhead.extra){let r=t.pending,s=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+s>t.pending_buf_size;){let a=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+a),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>r&&(i.adler=Mi(i.adler,t.pending_buf,t.pending-r,r)),t.gzindex+=a,tr(i),t.pending!==0)return t.last_flush=-1,ji;r=0,s-=a}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+s),t.pending),t.pending+=s,t.gzhead.hcrc&&t.pending>r&&(i.adler=Mi(i.adler,t.pending_buf,t.pending-r,r)),t.gzindex=0}t.status=zx}if(t.status===zx){if(t.gzhead.name){let r=t.pending,s;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>r&&(i.adler=Mi(i.adler,t.pending_buf,t.pending-r,r)),tr(i),t.pending!==0)return t.last_flush=-1,ji;r=0}t.gzindex<t.gzhead.name.length?s=t.gzhead.name.charCodeAt(t.gzindex++)&255:s=0,Bt(t,s)}while(s!==0);t.gzhead.hcrc&&t.pending>r&&(i.adler=Mi(i.adler,t.pending_buf,t.pending-r,r)),t.gzindex=0}t.status=Vx}if(t.status===Vx){if(t.gzhead.comment){let r=t.pending,s;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>r&&(i.adler=Mi(i.adler,t.pending_buf,t.pending-r,r)),tr(i),t.pending!==0)return t.last_flush=-1,ji;r=0}t.gzindex<t.gzhead.comment.length?s=t.gzhead.comment.charCodeAt(t.gzindex++)&255:s=0,Bt(t,s)}while(s!==0);t.gzhead.hcrc&&t.pending>r&&(i.adler=Mi(i.adler,t.pending_buf,t.pending-r,r))}t.status=qx}if(t.status===qx){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(tr(i),t.pending!==0))return t.last_flush=-1,ji;Bt(t,i.adler&255),Bt(t,i.adler>>8&255),i.adler=0}if(t.status=zl,tr(i),t.pending!==0)return t.last_flush=-1,ji}if(i.avail_in!==0||t.lookahead!==0||e!==Da&&t.status!==tg){let r=t.level===0?c6(t,e):t.strategy===uy?s0e(t,e):t.strategy===VAe?r0e(t,e):ng[t.level].func(t,e);if((r===Vl||r===gh)&&(t.status=tg),r===vn||r===Vl)return i.avail_out===0&&(t.last_flush=-1),ji;if(r===fh&&(e===QAe?NAe(t):e!==o6&&(Nx(t,0,0,!1),e===UAe&&(Pa(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),tr(i),i.avail_out===0))return t.last_flush=-1,ji}return e!==pr?ji:t.wrap<=0?a6:(t.wrap===2?(Bt(t,i.adler&255),Bt(t,i.adler>>8&255),Bt(t,i.adler>>16&255),Bt(t,i.adler>>24&255),Bt(t,i.total_in&255),Bt(t,i.total_in>>8&255),Bt(t,i.total_in>>16&255),Bt(t,i.total_in>>24&255)):(ig(t,i.adler>>>16),ig(t,i.adler&65535)),tr(i),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?ji:a6)},h0e=i=>{if(rg(i))return ws;const e=i.state.status;return i.state=null,e===zl?ql(i,GAe):ji},d0e=(i,e)=>{let t=e.length;if(rg(i))return ws;const n=i.state,r=n.wrap;if(r===2||r===1&&n.status!==dh||n.lookahead)return ws;if(r===1&&(i.adler=Jf(i.adler,e,t,0)),n.wrap=0,t>=n.w_size){r===0&&(Pa(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(e.subarray(t-n.w_size,t),0),e=l,t=n.w_size}const s=i.avail_in,o=i.next_in,a=i.input;for(i.avail_in=t,i.next_in=0,i.input=e,Ah(n);n.lookahead>=At;){let l=n.strstart,u=n.lookahead-(At-1);do n.ins_h=Ma(n,n.ins_h,n.window[l+At-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--u);n.strstart=l,n.lookahead=At-1,Ah(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=At-1,n.match_available=0,i.next_in=o,i.input=a,i.avail_in=s,n.wrap=r,ji};var f0e=u0e,g0e=f6,A0e=d6,p0e=h6,m0e=l0e,y0e=c0e,v0e=h0e,E0e=d0e,I0e="pako deflate (from Nodeca project)",sg={deflateInit:f0e,deflateInit2:g0e,deflateReset:A0e,deflateResetKeep:p0e,deflateSetHeader:m0e,deflate:y0e,deflateEnd:v0e,deflateSetDictionary:E0e,deflateInfo:I0e};const _0e=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var C0e=function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)_0e(t,n)&&(i[n]=t[n])}}return i},w0e=i=>{let e=0;for(let n=0,r=i.length;n<r;n++)e+=i[n].length;const t=new Uint8Array(e);for(let n=0,r=0,s=i.length;n<s;n++){let o=i[n];t.set(o,r),r+=o.length}return t},hy={assign:C0e,flattenChunks:w0e};let g6=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g6=!1}const og=new Uint8Array(256);for(let i=0;i<256;i++)og[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;og[254]=og[254]=1;var x0e=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,n,r,s,o=i.length,a=0;for(r=0;r<o;r++)t=i.charCodeAt(r),(t&64512)===55296&&r+1<o&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)t=i.charCodeAt(r),(t&64512)===55296&&r+1<o&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const b0e=(i,e)=>{if(e<65534&&i.subarray&&g6)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(i[n]);return t};var S0e=(i,e)=>{const t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let n,r;const s=new Array(t*2);for(r=0,n=0;n<t;){let o=i[n++];if(o<128){s[r++]=o;continue}let a=og[o];if(a>4){s[r++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<t;)o=o<<6|i[n++]&63,a--;if(a>1){s[r++]=65533;continue}o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|o&1023)}return b0e(s,r)},T0e=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+og[i[t]]>e?t:e},ag={string2buf:x0e,buf2string:S0e,utf8border:T0e};function B0e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var A6=B0e;const p6=Object.prototype.toString,{Z_NO_FLUSH:R0e,Z_SYNC_FLUSH:L0e,Z_FULL_FLUSH:D0e,Z_FINISH:k0e,Z_OK:dy,Z_STREAM_END:P0e,Z_DEFAULT_COMPRESSION:M0e,Z_DEFAULT_STRATEGY:F0e,Z_DEFLATED:O0e}=eg;function Wx(i){this.options=hy.assign({level:M0e,method:O0e,chunkSize:16384,windowBits:15,memLevel:8,strategy:F0e},i||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A6,this.strm.avail_out=0;let t=sg.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==dy)throw new Error(hh[t]);if(e.header&&sg.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=ag.string2buf(e.dictionary):p6.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,t=sg.deflateSetDictionary(this.strm,n),t!==dy)throw new Error(hh[t]);this._dict_set=!0}}Wx.prototype.push=function(i,e){const t=this.strm,n=this.options.chunkSize;let r,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?k0e:R0e,typeof i=="string"?t.input=ag.string2buf(i):p6.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),(s===L0e||s===D0e)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(r=sg.deflate(t,s),r===P0e)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),r=sg.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===dy;if(t.avail_out===0){this.onData(t.output);continue}if(s>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0},Wx.prototype.onData=function(i){this.chunks.push(i)},Wx.prototype.onEnd=function(i){i===dy&&(this.result=hy.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};const fy=16209,N0e=16191;var Q0e=function(e,t){let n,r,s,o,a,l,u,c,h,d,g,A,p,y,v,E,I,C,w,S,x,T,Q,M;const R=e.state;n=e.next_in,Q=e.input,r=n+(e.avail_in-5),s=e.next_out,M=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=R.dmax,u=R.wsize,c=R.whave,h=R.wnext,d=R.window,g=R.hold,A=R.bits,p=R.lencode,y=R.distcode,v=(1<<R.lenbits)-1,E=(1<<R.distbits)-1;e:do{A<15&&(g+=Q[n++]<<A,A+=8,g+=Q[n++]<<A,A+=8),I=p[g&v];t:for(;;){if(C=I>>>24,g>>>=C,A-=C,C=I>>>16&255,C===0)M[s++]=I&65535;else if(C&16){w=I&65535,C&=15,C&&(A<C&&(g+=Q[n++]<<A,A+=8),w+=g&(1<<C)-1,g>>>=C,A-=C),A<15&&(g+=Q[n++]<<A,A+=8,g+=Q[n++]<<A,A+=8),I=y[g&E];i:for(;;){if(C=I>>>24,g>>>=C,A-=C,C=I>>>16&255,C&16){if(S=I&65535,C&=15,A<C&&(g+=Q[n++]<<A,A+=8,A<C&&(g+=Q[n++]<<A,A+=8)),S+=g&(1<<C)-1,S>l){e.msg="invalid distance too far back",R.mode=fy;break e}if(g>>>=C,A-=C,C=s-o,S>C){if(C=S-C,C>c&&R.sane){e.msg="invalid distance too far back",R.mode=fy;break e}if(x=0,T=d,h===0){if(x+=u-C,C<w){w-=C;do M[s++]=d[x++];while(--C);x=s-S,T=M}}else if(h<C){if(x+=u+h-C,C-=h,C<w){w-=C;do M[s++]=d[x++];while(--C);if(x=0,h<w){C=h,w-=C;do M[s++]=d[x++];while(--C);x=s-S,T=M}}}else if(x+=h-C,C<w){w-=C;do M[s++]=d[x++];while(--C);x=s-S,T=M}for(;w>2;)M[s++]=T[x++],M[s++]=T[x++],M[s++]=T[x++],w-=3;w&&(M[s++]=T[x++],w>1&&(M[s++]=T[x++]))}else{x=s-S;do M[s++]=M[x++],M[s++]=M[x++],M[s++]=M[x++],w-=3;while(w>2);w&&(M[s++]=M[x++],w>1&&(M[s++]=M[x++]))}}else if(C&64){e.msg="invalid distance code",R.mode=fy;break e}else{I=y[(I&65535)+(g&(1<<C)-1)];continue i}break}}else if(C&64)if(C&32){R.mode=N0e;break e}else{e.msg="invalid literal/length code",R.mode=fy;break e}else{I=p[(I&65535)+(g&(1<<C)-1)];continue t}break}}while(n<r&&s<a);w=A>>3,n-=w,A-=w<<3,g&=(1<<A)-1,e.next_in=n,e.next_out=s,e.avail_in=n<r?5+(r-n):5-(n-r),e.avail_out=s<a?257+(a-s):257-(s-a),R.hold=g,R.bits=A};const mh=15,m6=852,y6=592,v6=0,Kx=1,E6=2,U0e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),G0e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),H0e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),z0e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var lg=(i,e,t,n,r,s,o,a)=>{const l=a.bits;let u=0,c=0,h=0,d=0,g=0,A=0,p=0,y=0,v=0,E=0,I,C,w,S,x,T=null,Q;const M=new Uint16Array(mh+1),R=new Uint16Array(mh+1);let z=null,q,X,N;for(u=0;u<=mh;u++)M[u]=0;for(c=0;c<n;c++)M[e[t+c]]++;for(g=l,d=mh;d>=1&&M[d]===0;d--);if(g>d&&(g=d),d===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,a.bits=1,0;for(h=1;h<d&&M[h]===0;h++);for(g<h&&(g=h),y=1,u=1;u<=mh;u++)if(y<<=1,y-=M[u],y<0)return-1;if(y>0&&(i===v6||d!==1))return-1;for(R[1]=0,u=1;u<mh;u++)R[u+1]=R[u]+M[u];for(c=0;c<n;c++)e[t+c]!==0&&(o[R[e[t+c]]++]=c);if(i===v6?(T=z=o,Q=20):i===Kx?(T=U0e,z=G0e,Q=257):(T=H0e,z=z0e,Q=0),E=0,c=0,u=h,x=s,A=g,p=0,w=-1,v=1<<g,S=v-1,i===Kx&&v>m6||i===E6&&v>y6)return 1;for(;;){q=u-p,o[c]+1<Q?(X=0,N=o[c]):o[c]>=Q?(X=z[o[c]-Q],N=T[o[c]-Q]):(X=96,N=0),I=1<<u-p,C=1<<A,h=C;do C-=I,r[x+(E>>p)+C]=q<<24|X<<16|N|0;while(C!==0);for(I=1<<u-1;E&I;)I>>=1;if(I!==0?(E&=I-1,E+=I):E=0,c++,--M[u]===0){if(u===d)break;u=e[t+o[c]]}if(u>g&&(E&S)!==w){for(p===0&&(p=g),x+=h,A=u-p,y=1<<A;A+p<d&&(y-=M[A+p],!(y<=0));)A++,y<<=1;if(v+=1<<A,i===Kx&&v>m6||i===E6&&v>y6)return 1;w=E&S,r[w]=g<<24|A<<16|x-s|0}}return E!==0&&(r[x+E]=u-p<<24|64<<16|0),a.bits=g,0};const V0e=0,I6=1,_6=2,{Z_FINISH:C6,Z_BLOCK:q0e,Z_TREES:gy,Z_OK:$l,Z_STREAM_END:$0e,Z_NEED_DICT:j0e,Z_STREAM_ERROR:mr,Z_DATA_ERROR:w6,Z_MEM_ERROR:x6,Z_BUF_ERROR:W0e,Z_DEFLATED:b6}=eg,Ay=16180,S6=16181,T6=16182,B6=16183,R6=16184,L6=16185,D6=16186,k6=16187,P6=16188,M6=16189,py=16190,vo=16191,Yx=16192,F6=16193,Zx=16194,O6=16195,N6=16196,Q6=16197,U6=16198,my=16199,yy=16200,G6=16201,H6=16202,z6=16203,V6=16204,q6=16205,Xx=16206,$6=16207,j6=16208,Yt=16209,W6=16210,K6=16211,K0e=852,Y0e=592,Z0e=15,Y6=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function X0e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const jl=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<Ay||e.mode>K6?1:0},Z6=i=>{if(jl(i))return mr;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=Ay,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(K0e),e.distcode=e.distdyn=new Int32Array(Y0e),e.sane=1,e.back=-1,$l},X6=i=>{if(jl(i))return mr;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,Z6(i)},J6=(i,e)=>{let t;if(jl(i))return mr;const n=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?mr:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,X6(i))},e4=(i,e)=>{if(!i)return mr;const t=new X0e;i.state=t,t.strm=i,t.window=null,t.mode=Ay;const n=J6(i,e);return n!==$l&&(i.state=null),n},J0e=i=>e4(i,Z0e);let t4=!0,Jx,eb;const epe=i=>{if(t4){Jx=new Int32Array(512),eb=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(lg(I6,i.lens,0,288,Jx,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;lg(_6,i.lens,0,32,eb,0,i.work,{bits:5}),t4=!1}i.lencode=Jx,i.lenbits=9,i.distcode=eb,i.distbits=5},i4=(i,e,t,n)=>{let r;const s=i.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(t-n,t-n+r),s.wnext),n-=r,n?(s.window.set(e.subarray(t-n,t),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},tpe=(i,e)=>{let t,n,r,s,o,a,l,u,c,h,d,g,A,p,y=0,v,E,I,C,w,S,x,T;const Q=new Uint8Array(4);let M,R;const z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(jl(i)||!i.output||!i.input&&i.avail_in!==0)return mr;t=i.state,t.mode===vo&&(t.mode=Yx),o=i.next_out,r=i.output,l=i.avail_out,s=i.next_in,n=i.input,a=i.avail_in,u=t.hold,c=t.bits,h=a,d=l,T=$l;e:for(;;)switch(t.mode){case Ay:if(t.wrap===0){t.mode=Yx;break}for(;c<16;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(t.wrap&2&&u===35615){t.wbits===0&&(t.wbits=15),t.check=0,Q[0]=u&255,Q[1]=u>>>8&255,t.check=Mi(t.check,Q,2,0),u=0,c=0,t.mode=S6;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){i.msg="incorrect header check",t.mode=Yt;break}if((u&15)!==b6){i.msg="unknown compression method",t.mode=Yt;break}if(u>>>=4,c-=4,x=(u&15)+8,t.wbits===0&&(t.wbits=x),x>15||x>t.wbits){i.msg="invalid window size",t.mode=Yt;break}t.dmax=1<<t.wbits,t.flags=0,i.adler=t.check=1,t.mode=u&512?M6:vo,u=0,c=0;break;case S6:for(;c<16;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(t.flags=u,(t.flags&255)!==b6){i.msg="unknown compression method",t.mode=Yt;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=Yt;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&t.wrap&4&&(Q[0]=u&255,Q[1]=u>>>8&255,t.check=Mi(t.check,Q,2,0)),u=0,c=0,t.mode=T6;case T6:for(;c<32;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}t.head&&(t.head.time=u),t.flags&512&&t.wrap&4&&(Q[0]=u&255,Q[1]=u>>>8&255,Q[2]=u>>>16&255,Q[3]=u>>>24&255,t.check=Mi(t.check,Q,4,0)),u=0,c=0,t.mode=B6;case B6:for(;c<16;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&t.wrap&4&&(Q[0]=u&255,Q[1]=u>>>8&255,t.check=Mi(t.check,Q,2,0)),u=0,c=0,t.mode=R6;case R6:if(t.flags&1024){for(;c<16;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&t.wrap&4&&(Q[0]=u&255,Q[1]=u>>>8&255,t.check=Mi(t.check,Q,2,0)),u=0,c=0}else t.head&&(t.head.extra=null);t.mode=L6;case L6:if(t.flags&1024&&(g=t.length,g>a&&(g=a),g&&(t.head&&(x=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(s,s+g),x)),t.flags&512&&t.wrap&4&&(t.check=Mi(t.check,n,g,s)),a-=g,s+=g,t.length-=g),t.length))break e;t.length=0,t.mode=D6;case D6:if(t.flags&2048){if(a===0)break e;g=0;do x=n[s+g++],t.head&&x&&t.length<65536&&(t.head.name+=String.fromCharCode(x));while(x&&g<a);if(t.flags&512&&t.wrap&4&&(t.check=Mi(t.check,n,g,s)),a-=g,s+=g,x)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=k6;case k6:if(t.flags&4096){if(a===0)break e;g=0;do x=n[s+g++],t.head&&x&&t.length<65536&&(t.head.comment+=String.fromCharCode(x));while(x&&g<a);if(t.flags&512&&t.wrap&4&&(t.check=Mi(t.check,n,g,s)),a-=g,s+=g,x)break e}else t.head&&(t.head.comment=null);t.mode=P6;case P6:if(t.flags&512){for(;c<16;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(t.wrap&4&&u!==(t.check&65535)){i.msg="header crc mismatch",t.mode=Yt;break}u=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=vo;break;case M6:for(;c<32;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}i.adler=t.check=Y6(u),u=0,c=0,t.mode=py;case py:if(t.havedict===0)return i.next_out=o,i.avail_out=l,i.next_in=s,i.avail_in=a,t.hold=u,t.bits=c,j0e;i.adler=t.check=1,t.mode=vo;case vo:if(e===q0e||e===gy)break e;case Yx:if(t.last){u>>>=c&7,c-=c&7,t.mode=Xx;break}for(;c<3;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}switch(t.last=u&1,u>>>=1,c-=1,u&3){case 0:t.mode=F6;break;case 1:if(epe(t),t.mode=my,e===gy){u>>>=2,c-=2;break e}break;case 2:t.mode=N6;break;case 3:i.msg="invalid block type",t.mode=Yt}u>>>=2,c-=2;break;case F6:for(u>>>=c&7,c-=c&7;c<32;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){i.msg="invalid stored block lengths",t.mode=Yt;break}if(t.length=u&65535,u=0,c=0,t.mode=Zx,e===gy)break e;case Zx:t.mode=O6;case O6:if(g=t.length,g){if(g>a&&(g=a),g>l&&(g=l),g===0)break e;r.set(n.subarray(s,s+g),o),a-=g,s+=g,l-=g,o+=g,t.length-=g;break}t.mode=vo;break;case N6:for(;c<14;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(t.nlen=(u&31)+257,u>>>=5,c-=5,t.ndist=(u&31)+1,u>>>=5,c-=5,t.ncode=(u&15)+4,u>>>=4,c-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=Yt;break}t.have=0,t.mode=Q6;case Q6:for(;t.have<t.ncode;){for(;c<3;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}t.lens[z[t.have++]]=u&7,u>>>=3,c-=3}for(;t.have<19;)t.lens[z[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,M={bits:t.lenbits},T=lg(V0e,t.lens,0,19,t.lencode,0,t.work,M),t.lenbits=M.bits,T){i.msg="invalid code lengths set",t.mode=Yt;break}t.have=0,t.mode=U6;case U6:for(;t.have<t.nlen+t.ndist;){for(;y=t.lencode[u&(1<<t.lenbits)-1],v=y>>>24,E=y>>>16&255,I=y&65535,!(v<=c);){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(I<16)u>>>=v,c-=v,t.lens[t.have++]=I;else{if(I===16){for(R=v+2;c<R;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(u>>>=v,c-=v,t.have===0){i.msg="invalid bit length repeat",t.mode=Yt;break}x=t.lens[t.have-1],g=3+(u&3),u>>>=2,c-=2}else if(I===17){for(R=v+3;c<R;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}u>>>=v,c-=v,x=0,g=3+(u&7),u>>>=3,c-=3}else{for(R=v+7;c<R;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}u>>>=v,c-=v,x=0,g=11+(u&127),u>>>=7,c-=7}if(t.have+g>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=Yt;break}for(;g--;)t.lens[t.have++]=x}}if(t.mode===Yt)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=Yt;break}if(t.lenbits=9,M={bits:t.lenbits},T=lg(I6,t.lens,0,t.nlen,t.lencode,0,t.work,M),t.lenbits=M.bits,T){i.msg="invalid literal/lengths set",t.mode=Yt;break}if(t.distbits=6,t.distcode=t.distdyn,M={bits:t.distbits},T=lg(_6,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,M),t.distbits=M.bits,T){i.msg="invalid distances set",t.mode=Yt;break}if(t.mode=my,e===gy)break e;case my:t.mode=yy;case yy:if(a>=6&&l>=258){i.next_out=o,i.avail_out=l,i.next_in=s,i.avail_in=a,t.hold=u,t.bits=c,Q0e(i,d),o=i.next_out,r=i.output,l=i.avail_out,s=i.next_in,n=i.input,a=i.avail_in,u=t.hold,c=t.bits,t.mode===vo&&(t.back=-1);break}for(t.back=0;y=t.lencode[u&(1<<t.lenbits)-1],v=y>>>24,E=y>>>16&255,I=y&65535,!(v<=c);){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(E&&!(E&240)){for(C=v,w=E,S=I;y=t.lencode[S+((u&(1<<C+w)-1)>>C)],v=y>>>24,E=y>>>16&255,I=y&65535,!(C+v<=c);){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}u>>>=C,c-=C,t.back+=C}if(u>>>=v,c-=v,t.back+=v,t.length=I,E===0){t.mode=q6;break}if(E&32){t.back=-1,t.mode=vo;break}if(E&64){i.msg="invalid literal/length code",t.mode=Yt;break}t.extra=E&15,t.mode=G6;case G6:if(t.extra){for(R=t.extra;c<R;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=H6;case H6:for(;y=t.distcode[u&(1<<t.distbits)-1],v=y>>>24,E=y>>>16&255,I=y&65535,!(v<=c);){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(!(E&240)){for(C=v,w=E,S=I;y=t.distcode[S+((u&(1<<C+w)-1)>>C)],v=y>>>24,E=y>>>16&255,I=y&65535,!(C+v<=c);){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}u>>>=C,c-=C,t.back+=C}if(u>>>=v,c-=v,t.back+=v,E&64){i.msg="invalid distance code",t.mode=Yt;break}t.offset=I,t.extra=E&15,t.mode=z6;case z6:if(t.extra){for(R=t.extra;c<R;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=Yt;break}t.mode=V6;case V6:if(l===0)break e;if(g=d-l,t.offset>g){if(g=t.offset-g,g>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=Yt;break}g>t.wnext?(g-=t.wnext,A=t.wsize-g):A=t.wnext-g,g>t.length&&(g=t.length),p=t.window}else p=r,A=o-t.offset,g=t.length;g>l&&(g=l),l-=g,t.length-=g;do r[o++]=p[A++];while(--g);t.length===0&&(t.mode=yy);break;case q6:if(l===0)break e;r[o++]=t.length,l--,t.mode=yy;break;case Xx:if(t.wrap){for(;c<32;){if(a===0)break e;a--,u|=n[s++]<<c,c+=8}if(d-=l,i.total_out+=d,t.total+=d,t.wrap&4&&d&&(i.adler=t.check=t.flags?Mi(t.check,r,d,o-d):Jf(t.check,r,d,o-d)),d=l,t.wrap&4&&(t.flags?u:Y6(u))!==t.check){i.msg="incorrect data check",t.mode=Yt;break}u=0,c=0}t.mode=$6;case $6:if(t.wrap&&t.flags){for(;c<32;){if(a===0)break e;a--,u+=n[s++]<<c,c+=8}if(t.wrap&4&&u!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=Yt;break}u=0,c=0}t.mode=j6;case j6:T=$0e;break e;case Yt:T=w6;break e;case W6:return x6;case K6:default:return mr}return i.next_out=o,i.avail_out=l,i.next_in=s,i.avail_in=a,t.hold=u,t.bits=c,(t.wsize||d!==i.avail_out&&t.mode<Yt&&(t.mode<Xx||e!==C6))&&i4(i,i.output,i.next_out,d-i.avail_out),h-=i.avail_in,d-=i.avail_out,i.total_in+=h,i.total_out+=d,t.total+=d,t.wrap&4&&d&&(i.adler=t.check=t.flags?Mi(t.check,r,d,i.next_out-d):Jf(t.check,r,d,i.next_out-d)),i.data_type=t.bits+(t.last?64:0)+(t.mode===vo?128:0)+(t.mode===my||t.mode===Zx?256:0),(h===0&&d===0||e===C6)&&T===$l&&(T=W0e),T},ipe=i=>{if(jl(i))return mr;let e=i.state;return e.window&&(e.window=null),i.state=null,$l},npe=(i,e)=>{if(jl(i))return mr;const t=i.state;return t.wrap&2?(t.head=e,e.done=!1,$l):mr},rpe=(i,e)=>{const t=e.length;let n,r,s;return jl(i)||(n=i.state,n.wrap!==0&&n.mode!==py)?mr:n.mode===py&&(r=1,r=Jf(r,e,t,0),r!==n.check)?w6:(s=i4(i,e,t,t),s?(n.mode=W6,x6):(n.havedict=1,$l))};var spe=X6,ope=J6,ape=Z6,lpe=J0e,upe=e4,cpe=tpe,hpe=ipe,dpe=npe,fpe=rpe,gpe="pako inflate (from Nodeca project)",Eo={inflateReset:spe,inflateReset2:ope,inflateResetKeep:ape,inflateInit:lpe,inflateInit2:upe,inflate:cpe,inflateEnd:hpe,inflateGetHeader:dpe,inflateSetDictionary:fpe,inflateInfo:gpe};function Ape(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ppe=Ape;const n4=Object.prototype.toString,{Z_NO_FLUSH:mpe,Z_FINISH:ype,Z_OK:ug,Z_STREAM_END:tb,Z_NEED_DICT:ib,Z_STREAM_ERROR:vpe,Z_DATA_ERROR:r4,Z_MEM_ERROR:Epe}=eg;function cg(i){this.options=hy.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A6,this.strm.avail_out=0;let t=Eo.inflateInit2(this.strm,e.windowBits);if(t!==ug)throw new Error(hh[t]);if(this.header=new ppe,Eo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=ag.string2buf(e.dictionary):n4.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Eo.inflateSetDictionary(this.strm,e.dictionary),t!==ug)))throw new Error(hh[t])}cg.prototype.push=function(i,e){const t=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?ype:mpe,n4.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),s=Eo.inflate(t,o),s===ib&&r&&(s=Eo.inflateSetDictionary(t,r),s===ug?s=Eo.inflate(t,o):s===r4&&(s=ib));t.avail_in>0&&s===tb&&t.state.wrap>0&&i[t.next_in]!==0;)Eo.inflateReset(t),s=Eo.inflate(t,o);switch(s){case vpe:case r4:case ib:case Epe:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===tb))if(this.options.to==="string"){let l=ag.utf8border(t.output,t.next_out),u=t.next_out-l,c=ag.buf2string(t.output,l);t.next_out=u,t.avail_out=n-u,u&&t.output.set(t.output.subarray(l,l+u),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===ug&&a===0)){if(s===tb)return s=Eo.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0},cg.prototype.onData=function(i){this.chunks.push(i)},cg.prototype.onEnd=function(i){i===ug&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=hy.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function nb(i,e){const t=new cg(e);if(t.push(i),t.err)throw t.msg||hh[t.err];return t.result}function Ipe(i,e){return e=e||{},e.raw=!0,nb(i,e)}var _pe=cg,Cpe=nb,wpe=Ipe,xpe=nb,bpe=eg,Spe={Inflate:_pe,inflate:Cpe,inflateRaw:wpe,ungzip:xpe,constants:bpe};const{Inflate:Qye,inflate:Tpe,inflateRaw:Uye,ungzip:Gye}=Spe;var s4=Tpe;class Bpe extends tl{decodeBlock(e){return s4(new Uint8Array(e)).buffer}}const Rpe=Object.freeze(Object.defineProperty({__proto__:null,default:Bpe},Symbol.toStringTag,{value:"Module"}));class Lpe extends tl{decodeBlock(e){const t=new DataView(e),n=[];for(let r=0;r<e.byteLength;++r){let s=t.getInt8(r);if(s<0){const o=t.getUint8(r+1);s=-s;for(let a=0;a<=s;++a)n.push(o);r+=1}else{for(let o=0;o<=s;++o)n.push(t.getUint8(r+o+1));r+=s+1}}return new Uint8Array(n).buffer}}const Dpe=Object.freeze(Object.defineProperty({__proto__:null,default:Lpe},Symbol.toStringTag,{value:"Module"}));var o4={exports:{}};(function(i){/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */(function(){var e=function(){var s={};s.defaultNoDataValue=-34027999387901484e22,s.decode=function(h,d){d=d||{};var g=d.encodedMaskData||d.encodedMaskData===null,A=u(h,d.inputOffset||0,g),p=d.noDataValue!==null?d.noDataValue:s.defaultNoDataValue,y=o(A,d.pixelType||Float32Array,d.encodedMaskData,p,d.returnMask),v={width:A.width,height:A.height,pixelData:y.resultPixels,minValue:y.minValue,maxValue:A.pixels.maxValue,noDataValue:p};return y.resultMask&&(v.maskData=y.resultMask),d.returnEncodedMask&&A.mask&&(v.encodedMaskData=A.mask.bitset?A.mask.bitset:null),d.returnFileInfo&&(v.fileInfo=a(A),d.computeUsedBitDepths&&(v.fileInfo.bitDepths=l(A))),v};var o=function(h,d,g,A,p){var y=0,v=h.pixels.numBlocksX,E=h.pixels.numBlocksY,I=Math.floor(h.width/v),C=Math.floor(h.height/E),w=2*h.maxZError,S=Number.MAX_VALUE,x;g=g||(h.mask?h.mask.bitset:null);var T,Q;T=new d(h.width*h.height),p&&g&&(Q=new Uint8Array(h.width*h.height));for(var M=new Float32Array(I*C),R,z,q=0;q<=E;q++){var X=q!==E?C:h.height%E;if(X!==0)for(var N=0;N<=v;N++){var G=N!==v?I:h.width%v;if(G!==0){var j=q*h.width*C+N*I,V=h.width-G,Z=h.pixels.blocks[y],Y,te,J;Z.encoding<2?(Z.encoding===0?Y=Z.rawData:(c(Z.stuffedData,Z.bitsPerPixel,Z.numValidPixels,Z.offset,w,M,h.pixels.maxValue),Y=M),te=0):Z.encoding===2?J=0:J=Z.offset;var ce;if(g)for(z=0;z<X;z++){for(j&7&&(ce=g[j>>3],ce<<=j&7),R=0;R<G;R++)j&7||(ce=g[j>>3]),ce&128?(Q&&(Q[j]=1),x=Z.encoding<2?Y[te++]:J,S=S>x?x:S,T[j++]=x):(Q&&(Q[j]=0),T[j++]=A),ce<<=1;j+=V}else if(Z.encoding<2)for(z=0;z<X;z++){for(R=0;R<G;R++)x=Y[te++],S=S>x?x:S,T[j++]=x;j+=V}else for(S=S>J?J:S,z=0;z<X;z++){for(R=0;R<G;R++)T[j++]=J;j+=V}if(Z.encoding===1&&te!==Z.numValidPixels)throw"Block and Mask do not match";y++}}}return{resultPixels:T,resultMask:Q,minValue:S}},a=function(h){return{fileIdentifierString:h.fileIdentifierString,fileVersion:h.fileVersion,imageType:h.imageType,height:h.height,width:h.width,maxZError:h.maxZError,eofOffset:h.eofOffset,mask:h.mask?{numBlocksX:h.mask.numBlocksX,numBlocksY:h.mask.numBlocksY,numBytes:h.mask.numBytes,maxValue:h.mask.maxValue}:null,pixels:{numBlocksX:h.pixels.numBlocksX,numBlocksY:h.pixels.numBlocksY,numBytes:h.pixels.numBytes,maxValue:h.pixels.maxValue,noDataValue:h.noDataValue}}},l=function(h){for(var d=h.pixels.numBlocksX*h.pixels.numBlocksY,g={},A=0;A<d;A++){var p=h.pixels.blocks[A];p.encoding===0?g.float32=!0:p.encoding===1?g[p.bitsPerPixel]=!0:g[0]=!0}return Object.keys(g)},u=function(h,d,g){var A={},p=new Uint8Array(h,d,10);if(A.fileIdentifierString=String.fromCharCode.apply(null,p),A.fileIdentifierString.trim()!=="CntZImage")throw"Unexpected file identifier string: "+A.fileIdentifierString;d+=10;var y=new DataView(h,d,24);if(A.fileVersion=y.getInt32(0,!0),A.imageType=y.getInt32(4,!0),A.height=y.getUint32(8,!0),A.width=y.getUint32(12,!0),A.maxZError=y.getFloat64(16,!0),d+=24,!g)if(y=new DataView(h,d,16),A.mask={},A.mask.numBlocksY=y.getUint32(0,!0),A.mask.numBlocksX=y.getUint32(4,!0),A.mask.numBytes=y.getUint32(8,!0),A.mask.maxValue=y.getFloat32(12,!0),d+=16,A.mask.numBytes>0){var v=new Uint8Array(Math.ceil(A.width*A.height/8));y=new DataView(h,d,A.mask.numBytes);var E=y.getInt16(0,!0),I=2,C=0;do{if(E>0)for(;E--;)v[C++]=y.getUint8(I++);else{var w=y.getUint8(I++);for(E=-E;E--;)v[C++]=w}E=y.getInt16(I,!0),I+=2}while(I<A.mask.numBytes);if(E!==-32768||C<v.length)throw"Unexpected end of mask RLE encoding";A.mask.bitset=v,d+=A.mask.numBytes}else A.mask.numBytes|A.mask.numBlocksY|A.mask.maxValue||(A.mask.bitset=new Uint8Array(Math.ceil(A.width*A.height/8)));y=new DataView(h,d,16),A.pixels={},A.pixels.numBlocksY=y.getUint32(0,!0),A.pixels.numBlocksX=y.getUint32(4,!0),A.pixels.numBytes=y.getUint32(8,!0),A.pixels.maxValue=y.getFloat32(12,!0),d+=16;var S=A.pixels.numBlocksX,x=A.pixels.numBlocksY,T=S+(A.width%S>0?1:0),Q=x+(A.height%x>0?1:0);A.pixels.blocks=new Array(T*Q);for(var M=0,R=0;R<Q;R++)for(var z=0;z<T;z++){var q=0,X=h.byteLength-d;y=new DataView(h,d,Math.min(10,X));var N={};A.pixels.blocks[M++]=N;var G=y.getUint8(0);if(q++,N.encoding=G&63,N.encoding>3)throw"Invalid block encoding ("+N.encoding+")";if(N.encoding===2){d++;continue}if(G!==0&&G!==2){if(G>>=6,N.offsetType=G,G===2)N.offset=y.getInt8(1),q++;else if(G===1)N.offset=y.getInt16(1,!0),q+=2;else if(G===0)N.offset=y.getFloat32(1,!0),q+=4;else throw"Invalid block offset type";if(N.encoding===1)if(G=y.getUint8(q),q++,N.bitsPerPixel=G&63,G>>=6,N.numValidPixelsType=G,G===2)N.numValidPixels=y.getUint8(q),q++;else if(G===1)N.numValidPixels=y.getUint16(q,!0),q+=2;else if(G===0)N.numValidPixels=y.getUint32(q,!0),q+=4;else throw"Invalid valid pixel count type"}if(d+=q,N.encoding!==3){var j,V;if(N.encoding===0){var Z=(A.pixels.numBytes-1)/4;if(Z!==Math.floor(Z))throw"uncompressed block has invalid length";j=new ArrayBuffer(Z*4),V=new Uint8Array(j),V.set(new Uint8Array(h,d,Z*4));var Y=new Float32Array(j);N.rawData=Y,d+=Z*4}else if(N.encoding===1){var te=Math.ceil(N.numValidPixels*N.bitsPerPixel/8),J=Math.ceil(te/4);j=new ArrayBuffer(J*4),V=new Uint8Array(j),V.set(new Uint8Array(h,d,te)),N.stuffedData=new Uint32Array(j),d+=te}}}return A.eofOffset=d,A},c=function(h,d,g,A,p,y,v){var E=(1<<d)-1,I=0,C,w=0,S,x,T=Math.ceil((v-A)/p),Q=h.length*4-Math.ceil(d*g/8);for(h[h.length-1]<<=8*Q,C=0;C<g;C++){if(w===0&&(x=h[I++],w=32),w>=d)S=x>>>w-d&E,w-=d;else{var M=d-w;S=(x&E)<<M&E,x=h[I++],w=32-M,S+=x>>>w}y[C]=S<T?A+S*p:v}return y};return s}(),t=function(){var s={unstuff:function(u,c,h,d,g,A,p,y){var v=(1<<h)-1,E=0,I,C=0,w,S,x,T,Q=u.length*4-Math.ceil(h*d/8);if(u[u.length-1]<<=8*Q,g)for(I=0;I<d;I++)C===0&&(S=u[E++],C=32),C>=h?(w=S>>>C-h&v,C-=h):(x=h-C,w=(S&v)<<x&v,S=u[E++],C=32-x,w+=S>>>C),c[I]=g[w];else for(T=Math.ceil((y-A)/p),I=0;I<d;I++)C===0&&(S=u[E++],C=32),C>=h?(w=S>>>C-h&v,C-=h):(x=h-C,w=(S&v)<<x&v,S=u[E++],C=32-x,w+=S>>>C),c[I]=w<T?A+w*p:y},unstuffLUT:function(u,c,h,d,g,A){var p=(1<<c)-1,y=0,v=0,E=0,I=0,C=0,w,S=[],x=u.length*4-Math.ceil(c*h/8);u[u.length-1]<<=8*x;var T=Math.ceil((A-d)/g);for(v=0;v<h;v++)I===0&&(w=u[y++],I=32),I>=c?(C=w>>>I-c&p,I-=c):(E=c-I,C=(w&p)<<E&p,w=u[y++],I=32-E,C+=w>>>I),S[v]=C<T?d+C*g:A;return S.unshift(d),S},unstuff2:function(u,c,h,d,g,A,p,y){var v=(1<<h)-1,E=0,I,C=0,w=0,S,x,T;if(g)for(I=0;I<d;I++)C===0&&(x=u[E++],C=32,w=0),C>=h?(S=x>>>w&v,C-=h,w+=h):(T=h-C,S=x>>>w&v,x=u[E++],C=32-T,S|=(x&(1<<T)-1)<<h-T,w=T),c[I]=g[S];else{var Q=Math.ceil((y-A)/p);for(I=0;I<d;I++)C===0&&(x=u[E++],C=32,w=0),C>=h?(S=x>>>w&v,C-=h,w+=h):(T=h-C,S=x>>>w&v,x=u[E++],C=32-T,S|=(x&(1<<T)-1)<<h-T,w=T),c[I]=S<Q?A+S*p:y}return c},unstuffLUT2:function(u,c,h,d,g,A){var p=(1<<c)-1,y=0,v=0,E=0,I=0,C=0,w=0,S,x=[],T=Math.ceil((A-d)/g);for(v=0;v<h;v++)I===0&&(S=u[y++],I=32,w=0),I>=c?(C=S>>>w&p,I-=c,w+=c):(E=c-I,C=S>>>w&p,S=u[y++],I=32-E,C|=(S&(1<<E)-1)<<c-E,w=E),x[v]=C<T?d+C*g:A;return x.unshift(d),x},originalUnstuff:function(u,c,h,d){var g=(1<<h)-1,A=0,p,y=0,v,E,I,C=u.length*4-Math.ceil(h*d/8);for(u[u.length-1]<<=8*C,p=0;p<d;p++)y===0&&(E=u[A++],y=32),y>=h?(v=E>>>y-h&g,y-=h):(I=h-y,v=(E&g)<<I&g,E=u[A++],y=32-I,v+=E>>>y),c[p]=v;return c},originalUnstuff2:function(u,c,h,d){var g=(1<<h)-1,A=0,p,y=0,v=0,E,I,C;for(p=0;p<d;p++)y===0&&(I=u[A++],y=32,v=0),y>=h?(E=I>>>v&g,y-=h,v+=h):(C=h-y,E=I>>>v&g,I=u[A++],y=32-C,E|=(I&(1<<C)-1)<<h-C,v=C),c[p]=E;return c}},o={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(u){for(var c=65535,h=65535,d=u.length,g=Math.floor(d/2),A=0;g;){var p=g>=359?359:g;g-=p;do c+=u[A++]<<8,h+=c+=u[A++];while(--p);c=(c&65535)+(c>>>16),h=(h&65535)+(h>>>16)}return d&1&&(h+=c+=u[A]<<8),c=(c&65535)+(c>>>16),h=(h&65535)+(h>>>16),(h<<16|c)>>>0},readHeaderInfo:function(u,c){var h=c.ptr,d=new Uint8Array(u,h,6),g={};if(g.fileIdentifierString=String.fromCharCode.apply(null,d),g.fileIdentifierString.lastIndexOf("Lerc2",0)!==0)throw"Unexpected file identifier string (expect Lerc2 ): "+g.fileIdentifierString;h+=6;var A=new DataView(u,h,8),p=A.getInt32(0,!0);g.fileVersion=p,h+=4,p>=3&&(g.checksum=A.getUint32(4,!0),h+=4),A=new DataView(u,h,12),g.height=A.getUint32(0,!0),g.width=A.getUint32(4,!0),h+=8,p>=4?(g.numDims=A.getUint32(8,!0),h+=4):g.numDims=1,A=new DataView(u,h,40),g.numValidPixel=A.getUint32(0,!0),g.microBlockSize=A.getInt32(4,!0),g.blobSize=A.getInt32(8,!0),g.imageType=A.getInt32(12,!0),g.maxZError=A.getFloat64(16,!0),g.zMin=A.getFloat64(24,!0),g.zMax=A.getFloat64(32,!0),h+=40,c.headerInfo=g,c.ptr=h;var y,v;if(p>=3&&(v=p>=4?52:48,y=this.computeChecksumFletcher32(new Uint8Array(u,h-v,g.blobSize-14)),y!==g.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(u,c){var h=c.headerInfo,d=this.getDataTypeArray(h.imageType),g=h.numDims*this.getDataTypeSize(h.imageType),A=this.readSubArray(u,c.ptr,d,g),p=this.readSubArray(u,c.ptr+g,d,g);c.ptr+=2*g;var y,v=!0;for(y=0;y<h.numDims;y++)if(A[y]!==p[y]){v=!1;break}return h.minValues=A,h.maxValues=p,v},readSubArray:function(u,c,h,d){var g;if(h===Uint8Array)g=new Uint8Array(u,c,d);else{var A=new ArrayBuffer(d),p=new Uint8Array(A);p.set(new Uint8Array(u,c,d)),g=new h(A)}return g},readMask:function(u,c){var h=c.ptr,d=c.headerInfo,g=d.width*d.height,A=d.numValidPixel,p=new DataView(u,h,4),y={};if(y.numBytes=p.getUint32(0,!0),h+=4,(A===0||g===A)&&y.numBytes!==0)throw"invalid mask";var v,E;if(A===0)v=new Uint8Array(Math.ceil(g/8)),y.bitset=v,E=new Uint8Array(g),c.pixels.resultMask=E,h+=y.numBytes;else if(y.numBytes>0){v=new Uint8Array(Math.ceil(g/8)),p=new DataView(u,h,y.numBytes);var I=p.getInt16(0,!0),C=2,w=0,S=0;do{if(I>0)for(;I--;)v[w++]=p.getUint8(C++);else for(S=p.getUint8(C++),I=-I;I--;)v[w++]=S;I=p.getInt16(C,!0),C+=2}while(C<y.numBytes);if(I!==-32768||w<v.length)throw"Unexpected end of mask RLE encoding";E=new Uint8Array(g);var x=0,T=0;for(T=0;T<g;T++)T&7?(x=v[T>>3],x<<=T&7):x=v[T>>3],x&128&&(E[T]=1);c.pixels.resultMask=E,y.bitset=v,h+=y.numBytes}return c.ptr=h,c.mask=y,!0},readDataOneSweep:function(u,c,h,d){var g=c.ptr,A=c.headerInfo,p=A.numDims,y=A.width*A.height,v=A.imageType,E=A.numValidPixel*o.getDataTypeSize(v)*p,I,C=c.pixels.resultMask;if(h===Uint8Array)I=new Uint8Array(u,g,E);else{var w=new ArrayBuffer(E),S=new Uint8Array(w);S.set(new Uint8Array(u,g,E)),I=new h(w)}if(I.length===y*p)d?c.pixels.resultPixels=o.swapDimensionOrder(I,y,p,h,!0):c.pixels.resultPixels=I;else{c.pixels.resultPixels=new h(y*p);var x=0,T=0,Q=0,M=0;if(p>1){if(d){for(T=0;T<y;T++)if(C[T])for(M=T,Q=0;Q<p;Q++,M+=y)c.pixels.resultPixels[M]=I[x++]}else for(T=0;T<y;T++)if(C[T])for(M=T*p,Q=0;Q<p;Q++)c.pixels.resultPixels[M+Q]=I[x++]}else for(T=0;T<y;T++)C[T]&&(c.pixels.resultPixels[T]=I[x++])}return g+=E,c.ptr=g,!0},readHuffmanTree:function(u,c){var h=this.HUFFMAN_LUT_BITS_MAX,d=new DataView(u,c.ptr,16);c.ptr+=16;var g=d.getInt32(0,!0);if(g<2)throw"unsupported Huffman version";var A=d.getInt32(4,!0),p=d.getInt32(8,!0),y=d.getInt32(12,!0);if(p>=y)return!1;var v=new Uint32Array(y-p);o.decodeBits(u,c,v);var E=[],I,C,w,S;for(I=p;I<y;I++)C=I-(I<A?0:A),E[C]={first:v[I-p],second:null};var x=u.byteLength-c.ptr,T=Math.ceil(x/4),Q=new ArrayBuffer(T*4),M=new Uint8Array(Q);M.set(new Uint8Array(u,c.ptr,x));var R=new Uint32Array(Q),z=0,q,X=0;for(q=R[0],I=p;I<y;I++)C=I-(I<A?0:A),S=E[C].first,S>0&&(E[C].second=q<<z>>>32-S,32-z>=S?(z+=S,z===32&&(z=0,X++,q=R[X])):(z+=S-32,X++,q=R[X],E[C].second|=q>>>32-z));var N=0,G=0,j=new a;for(I=0;I<E.length;I++)E[I]!==void 0&&(N=Math.max(N,E[I].first));N>=h?G=h:G=N;var V=[],Z,Y,te,J,ce,ie;for(I=p;I<y;I++)if(C=I-(I<A?0:A),S=E[C].first,S>0)if(Z=[S,C],S<=G)for(Y=E[C].second<<G-S,te=1<<G-S,w=0;w<te;w++)V[Y|w]=Z;else for(Y=E[C].second,ie=j,J=S-1;J>=0;J--)ce=Y>>>J&1,ce?(ie.right||(ie.right=new a),ie=ie.right):(ie.left||(ie.left=new a),ie=ie.left),J===0&&!ie.val&&(ie.val=Z[1]);return{decodeLut:V,numBitsLUTQick:G,numBitsLUT:N,tree:j,stuffedData:R,srcPtr:X,bitPos:z}},readHuffman:function(u,c,h,d){var g=c.headerInfo,A=g.numDims,p=c.headerInfo.height,y=c.headerInfo.width,v=y*p,E=this.readHuffmanTree(u,c),I=E.decodeLut,C=E.tree,w=E.stuffedData,S=E.srcPtr,x=E.bitPos,T=E.numBitsLUTQick,Q=E.numBitsLUT,M=c.headerInfo.imageType===0?128:0,R,z,q,X=c.pixels.resultMask,N,G,j,V,Z,Y,te,J=0;x>0&&(S++,x=0);var ce=w[S],ie=c.encodeMode===1,ne=new h(v*A),ue=ne,fe;if(A<2||ie){for(fe=0;fe<A;fe++)if(A>1&&(ue=new h(ne.buffer,v*fe,v),J=0),c.headerInfo.numValidPixel===y*p)for(Y=0,V=0;V<p;V++)for(Z=0;Z<y;Z++,Y++){if(z=0,N=ce<<x>>>32-T,G=N,32-x<T&&(N|=w[S+1]>>>64-x-T,G=N),I[G])z=I[G][1],x+=I[G][0];else for(N=ce<<x>>>32-Q,G=N,32-x<Q&&(N|=w[S+1]>>>64-x-Q,G=N),R=C,te=0;te<Q;te++)if(j=N>>>Q-te-1&1,R=j?R.right:R.left,!(R.left||R.right)){z=R.val,x=x+te+1;break}x>=32&&(x-=32,S++,ce=w[S]),q=z-M,ie?(Z>0?q+=J:V>0?q+=ue[Y-y]:q+=J,q&=255,ue[Y]=q,J=q):ue[Y]=q}else for(Y=0,V=0;V<p;V++)for(Z=0;Z<y;Z++,Y++)if(X[Y]){if(z=0,N=ce<<x>>>32-T,G=N,32-x<T&&(N|=w[S+1]>>>64-x-T,G=N),I[G])z=I[G][1],x+=I[G][0];else for(N=ce<<x>>>32-Q,G=N,32-x<Q&&(N|=w[S+1]>>>64-x-Q,G=N),R=C,te=0;te<Q;te++)if(j=N>>>Q-te-1&1,R=j?R.right:R.left,!(R.left||R.right)){z=R.val,x=x+te+1;break}x>=32&&(x-=32,S++,ce=w[S]),q=z-M,ie?(Z>0&&X[Y-1]?q+=J:V>0&&X[Y-y]?q+=ue[Y-y]:q+=J,q&=255,ue[Y]=q,J=q):ue[Y]=q}}else for(Y=0,V=0;V<p;V++)for(Z=0;Z<y;Z++)if(Y=V*y+Z,!X||X[Y])for(fe=0;fe<A;fe++,Y+=v){if(z=0,N=ce<<x>>>32-T,G=N,32-x<T&&(N|=w[S+1]>>>64-x-T,G=N),I[G])z=I[G][1],x+=I[G][0];else for(N=ce<<x>>>32-Q,G=N,32-x<Q&&(N|=w[S+1]>>>64-x-Q,G=N),R=C,te=0;te<Q;te++)if(j=N>>>Q-te-1&1,R=j?R.right:R.left,!(R.left||R.right)){z=R.val,x=x+te+1;break}x>=32&&(x-=32,S++,ce=w[S]),q=z-M,ue[Y]=q}c.ptr=c.ptr+(S+1)*4+(x>0?4:0),c.pixels.resultPixels=ne,A>1&&!d&&(c.pixels.resultPixels=o.swapDimensionOrder(ne,v,A,h))},decodeBits:function(u,c,h,d,g){{var A=c.headerInfo,p=A.fileVersion,y=0,v=u.byteLength-c.ptr>=5?5:u.byteLength-c.ptr,E=new DataView(u,c.ptr,v),I=E.getUint8(0);y++;var C=I>>6,w=C===0?4:3-C,S=(I&32)>0,x=I&31,T=0;if(w===1)T=E.getUint8(y),y++;else if(w===2)T=E.getUint16(y,!0),y+=2;else if(w===4)T=E.getUint32(y,!0),y+=4;else throw"Invalid valid pixel count type";var Q=2*A.maxZError,M,R,z,q,X,N,G,j,V,Z=A.numDims>1?A.maxValues[g]:A.zMax;if(S){for(c.counter.lut++,j=E.getUint8(y),y++,q=Math.ceil((j-1)*x/8),X=Math.ceil(q/4),R=new ArrayBuffer(X*4),z=new Uint8Array(R),c.ptr+=y,z.set(new Uint8Array(u,c.ptr,q)),G=new Uint32Array(R),c.ptr+=q,V=0;j-1>>>V;)V++;q=Math.ceil(T*V/8),X=Math.ceil(q/4),R=new ArrayBuffer(X*4),z=new Uint8Array(R),z.set(new Uint8Array(u,c.ptr,q)),M=new Uint32Array(R),c.ptr+=q,p>=3?N=s.unstuffLUT2(G,x,j-1,d,Q,Z):N=s.unstuffLUT(G,x,j-1,d,Q,Z),p>=3?s.unstuff2(M,h,V,T,N):s.unstuff(M,h,V,T,N)}else c.counter.bitstuffer++,V=x,c.ptr+=y,V>0&&(q=Math.ceil(T*V/8),X=Math.ceil(q/4),R=new ArrayBuffer(X*4),z=new Uint8Array(R),z.set(new Uint8Array(u,c.ptr,q)),M=new Uint32Array(R),c.ptr+=q,p>=3?d==null?s.originalUnstuff2(M,h,V,T):s.unstuff2(M,h,V,T,!1,d,Q,Z):d==null?s.originalUnstuff(M,h,V,T):s.unstuff(M,h,V,T,!1,d,Q,Z))}},readTiles:function(u,c,h,d){var g=c.headerInfo,A=g.width,p=g.height,y=A*p,v=g.microBlockSize,E=g.imageType,I=o.getDataTypeSize(E),C=Math.ceil(A/v),w=Math.ceil(p/v);c.pixels.numBlocksY=w,c.pixels.numBlocksX=C,c.pixels.ptr=0;var S=0,x=0,T=0,Q=0,M=0,R=0,z=0,q=0,X=0,N=0,G=0,j=0,V=0,Z=0,Y=0,te=0,J,ce,ie,ne,ue,fe,me=new h(v*v),Pe=p%v||v,Re=A%v||v,Qe,Oe,wt=g.numDims,ft,pt=c.pixels.resultMask,at=c.pixels.resultPixels,D=g.fileVersion,W=D>=5?14:15,oe,ve=g.zMax,Ae;for(T=0;T<w;T++)for(M=T!==w-1?v:Pe,Q=0;Q<C;Q++)for(R=Q!==C-1?v:Re,G=T*A*v+Q*v,j=A-R,ft=0;ft<wt;ft++){if(wt>1?(Ae=at,G=T*A*v+Q*v,at=new h(c.pixels.resultPixels.buffer,y*ft*I,y),ve=g.maxValues[ft]):Ae=null,z=u.byteLength-c.ptr,J=new DataView(u,c.ptr,Math.min(10,z)),ce={},te=0,q=J.getUint8(0),te++,oe=g.fileVersion>=5?q&4:0,X=q>>6&255,N=q>>2&W,N!==(Q*v>>3&W)||oe&&ft===0)throw"integrity issue";if(fe=q&3,fe>3)throw c.ptr+=te,"Invalid block encoding ("+fe+")";if(fe===2){if(oe)if(pt)for(S=0;S<M;S++)for(x=0;x<R;x++)pt[G]&&(at[G]=Ae[G]),G++;else for(S=0;S<M;S++)for(x=0;x<R;x++)at[G]=Ae[G],G++;c.counter.constant++,c.ptr+=te;continue}else if(fe===0){if(oe)throw"integrity issue";if(c.counter.uncompressed++,c.ptr+=te,V=M*R*I,Z=u.byteLength-c.ptr,V=V<Z?V:Z,ie=new ArrayBuffer(V%I===0?V:V+I-V%I),ne=new Uint8Array(ie),ne.set(new Uint8Array(u,c.ptr,V)),ue=new h(ie),Y=0,pt)for(S=0;S<M;S++){for(x=0;x<R;x++)pt[G]&&(at[G]=ue[Y++]),G++;G+=j}else for(S=0;S<M;S++){for(x=0;x<R;x++)at[G++]=ue[Y++];G+=j}c.ptr+=Y*I}else if(Qe=o.getDataTypeUsed(oe&&E<6?4:E,X),Oe=o.getOnePixel(ce,te,Qe,J),te+=o.getDataTypeSize(Qe),fe===3)if(c.ptr+=te,c.counter.constantoffset++,pt)for(S=0;S<M;S++){for(x=0;x<R;x++)pt[G]&&(at[G]=oe?Math.min(ve,Ae[G]+Oe):Oe),G++;G+=j}else for(S=0;S<M;S++){for(x=0;x<R;x++)at[G]=oe?Math.min(ve,Ae[G]+Oe):Oe,G++;G+=j}else if(c.ptr+=te,o.decodeBits(u,c,me,Oe,ft),te=0,oe)if(pt)for(S=0;S<M;S++){for(x=0;x<R;x++)pt[G]&&(at[G]=me[te++]+Ae[G]),G++;G+=j}else for(S=0;S<M;S++){for(x=0;x<R;x++)at[G]=me[te++]+Ae[G],G++;G+=j}else if(pt)for(S=0;S<M;S++){for(x=0;x<R;x++)pt[G]&&(at[G]=me[te++]),G++;G+=j}else for(S=0;S<M;S++){for(x=0;x<R;x++)at[G++]=me[te++];G+=j}}wt>1&&!d&&(c.pixels.resultPixels=o.swapDimensionOrder(c.pixels.resultPixels,y,wt,h))},formatFileInfo:function(u){return{fileIdentifierString:u.headerInfo.fileIdentifierString,fileVersion:u.headerInfo.fileVersion,imageType:u.headerInfo.imageType,height:u.headerInfo.height,width:u.headerInfo.width,numValidPixel:u.headerInfo.numValidPixel,microBlockSize:u.headerInfo.microBlockSize,blobSize:u.headerInfo.blobSize,maxZError:u.headerInfo.maxZError,pixelType:o.getPixelType(u.headerInfo.imageType),eofOffset:u.eofOffset,mask:u.mask?{numBytes:u.mask.numBytes}:null,pixels:{numBlocksX:u.pixels.numBlocksX,numBlocksY:u.pixels.numBlocksY,maxValue:u.headerInfo.zMax,minValue:u.headerInfo.zMin,noDataValue:u.noDataValue}}},constructConstantSurface:function(u,c){var h=u.headerInfo.zMax,d=u.headerInfo.zMin,g=u.headerInfo.maxValues,A=u.headerInfo.numDims,p=u.headerInfo.height*u.headerInfo.width,y=0,v=0,E=0,I=u.pixels.resultMask,C=u.pixels.resultPixels;if(I)if(A>1){if(c)for(y=0;y<A;y++)for(E=y*p,h=g[y],v=0;v<p;v++)I[v]&&(C[E+v]=h);else for(v=0;v<p;v++)if(I[v])for(E=v*A,y=0;y<A;y++)C[E+A]=g[y]}else for(v=0;v<p;v++)I[v]&&(C[v]=h);else if(A>1&&d!==h)if(c)for(y=0;y<A;y++)for(E=y*p,h=g[y],v=0;v<p;v++)C[E+v]=h;else for(v=0;v<p;v++)for(E=v*A,y=0;y<A;y++)C[E+y]=g[y];else for(v=0;v<p*A;v++)C[v]=h},getDataTypeArray:function(u){var c;switch(u){case 0:c=Int8Array;break;case 1:c=Uint8Array;break;case 2:c=Int16Array;break;case 3:c=Uint16Array;break;case 4:c=Int32Array;break;case 5:c=Uint32Array;break;case 6:c=Float32Array;break;case 7:c=Float64Array;break;default:c=Float32Array}return c},getPixelType:function(u){var c;switch(u){case 0:c="S8";break;case 1:c="U8";break;case 2:c="S16";break;case 3:c="U16";break;case 4:c="S32";break;case 5:c="U32";break;case 6:c="F32";break;case 7:c="F64";break;default:c="F32"}return c},isValidPixelValue:function(u,c){if(c==null)return!1;var h;switch(u){case 0:h=c>=-128&&c<=127;break;case 1:h=c>=0&&c<=255;break;case 2:h=c>=-32768&&c<=32767;break;case 3:h=c>=0&&c<=65536;break;case 4:h=c>=-2147483648&&c<=2147483647;break;case 5:h=c>=0&&c<=4294967296;break;case 6:h=c>=-34027999387901484e22&&c<=34027999387901484e22;break;case 7:h=c>=-17976931348623157e292&&c<=17976931348623157e292;break;default:h=!1}return h},getDataTypeSize:function(u){var c=0;switch(u){case 0:case 1:c=1;break;case 2:case 3:c=2;break;case 4:case 5:case 6:c=4;break;case 7:c=8;break;default:c=u}return c},getDataTypeUsed:function(u,c){var h=u;switch(u){case 2:case 4:h=u-c;break;case 3:case 5:h=u-2*c;break;case 6:c===0?h=u:c===1?h=2:h=1;break;case 7:c===0?h=u:h=u-2*c+1;break;default:h=u;break}return h},getOnePixel:function(u,c,h,d){var g=0;switch(h){case 0:g=d.getInt8(c);break;case 1:g=d.getUint8(c);break;case 2:g=d.getInt16(c,!0);break;case 3:g=d.getUint16(c,!0);break;case 4:g=d.getInt32(c,!0);break;case 5:g=d.getUInt32(c,!0);break;case 6:g=d.getFloat32(c,!0);break;case 7:g=d.getFloat64(c,!0);break;default:throw"the decoder does not understand this pixel type"}return g},swapDimensionOrder:function(u,c,h,d,g){var A=0,p=0,y=0,v=0,E=u;if(h>1)if(E=new d(c*h),g)for(A=0;A<c;A++)for(v=A,y=0;y<h;y++,v+=c)E[v]=u[p++];else for(A=0;A<c;A++)for(v=A,y=0;y<h;y++,v+=c)E[p++]=u[v];return E}},a=function(u,c,h){this.val=u,this.left=c,this.right=h},l={decode:function(u,c){c=c||{};var h=c.noDataValue,d=0,g={};if(g.ptr=c.inputOffset||0,g.pixels={},!!o.readHeaderInfo(u,g)){var A=g.headerInfo,p=A.fileVersion,y=o.getDataTypeArray(A.imageType);if(p>5)throw"unsupported lerc version 2."+p;o.readMask(u,g),A.numValidPixel!==A.width*A.height&&!g.pixels.resultMask&&(g.pixels.resultMask=c.maskData);var v=A.width*A.height;g.pixels.resultPixels=new y(v*A.numDims),g.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var E=!c.returnPixelInterleavedDims;if(A.numValidPixel!==0)if(A.zMax===A.zMin)o.constructConstantSurface(g,E);else if(p>=4&&o.checkMinMaxRanges(u,g))o.constructConstantSurface(g,E);else{var I=new DataView(u,g.ptr,2),C=I.getUint8(0);if(g.ptr++,C)o.readDataOneSweep(u,g,y,E);else if(p>1&&A.imageType<=1&&Math.abs(A.maxZError-.5)<1e-5){var w=I.getUint8(1);if(g.ptr++,g.encodeMode=w,w>2||p<4&&w>1)throw"Invalid Huffman flag "+w;w?o.readHuffman(u,g,y,E):o.readTiles(u,g,y,E)}else o.readTiles(u,g,y,E)}g.eofOffset=g.ptr;var S;c.inputOffset?(S=g.headerInfo.blobSize+c.inputOffset-g.ptr,Math.abs(S)>=1&&(g.eofOffset=c.inputOffset+g.headerInfo.blobSize)):(S=g.headerInfo.blobSize-g.ptr,Math.abs(S)>=1&&(g.eofOffset=g.headerInfo.blobSize));var x={width:A.width,height:A.height,pixelData:g.pixels.resultPixels,minValue:A.zMin,maxValue:A.zMax,validPixelCount:A.numValidPixel,dimCount:A.numDims,dimStats:{minValues:A.minValues,maxValues:A.maxValues},maskData:g.pixels.resultMask};if(g.pixels.resultMask&&o.isValidPixelValue(A.imageType,h)){var T=g.pixels.resultMask;for(d=0;d<v;d++)T[d]||(x.pixelData[d]=h);x.noDataValue=h}return g.noDataValue=h,c.returnFileInfo&&(x.fileInfo=o.formatFileInfo(g)),x}},getBandCount:function(u){var c=0,h=0,d={};for(d.ptr=0,d.pixels={};h<u.byteLength-58;)o.readHeaderInfo(u,d),h+=d.headerInfo.blobSize,c++,d.ptr=h;return c}};return l}(),n=function(){var s=new ArrayBuffer(4),o=new Uint8Array(s),a=new Uint32Array(s);return a[0]=1,o[0]===1}(),r={decode:function(s,o){if(!n)throw"Big endian system is not supported.";o=o||{};var a=o.inputOffset||0,l=new Uint8Array(s,a,10),u=String.fromCharCode.apply(null,l),c,h;if(u.trim()==="CntZImage")c=e,h=1;else if(u.substring(0,5)==="Lerc2")c=t,h=2;else throw"Unexpected file identifier string: "+u;for(var d=0,g=s.byteLength-10,A,p=[],y,v,E={width:0,height:0,pixels:[],pixelType:o.pixelType,mask:null,statistics:[]},I=0;a<g;){var C=c.decode(s,{inputOffset:a,encodedMaskData:A,maskData:v,returnMask:d===0,returnEncodedMask:d===0,returnFileInfo:!0,returnPixelInterleavedDims:o.returnPixelInterleavedDims,pixelType:o.pixelType||null,noDataValue:o.noDataValue||null});a=C.fileInfo.eofOffset,v=C.maskData,d===0&&(A=C.encodedMaskData,E.width=C.width,E.height=C.height,E.dimCount=C.dimCount||1,E.pixelType=C.pixelType||C.fileInfo.pixelType,E.mask=v),h>1&&(v&&p.push(v),C.fileInfo.mask&&C.fileInfo.mask.numBytes>0&&I++),d++,E.pixels.push(C.pixelData),E.statistics.push({minValue:C.minValue,maxValue:C.maxValue,noDataValue:C.noDataValue,dimStats:C.dimStats})}var w,S,x;if(h>1&&I>1){for(x=E.width*E.height,E.bandMasks=p,v=new Uint8Array(x),v.set(p[0]),w=1;w<p.length;w++)for(y=p[w],S=0;S<x;S++)v[S]=v[S]&y[S];E.maskData=v}return E}};i.exports?i.exports=r:this.Lerc=r})()})(o4);var kpe=o4.exports;const Ppe=jo(kpe);let hg,Io,rb;const sb={env:{emscripten_notify_memory_growth:function(i){rb=new Uint8Array(Io.exports.memory.buffer)}}};class Mpe{init(){return hg||(typeof fetch<"u"?hg=fetch("data:application/wasm;base64,"+a4).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,sb)).then(this._init):hg=WebAssembly.instantiate(Buffer.from(a4,"base64"),sb).then(this._init),hg)}_init(e){Io=e.instance,sb.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!Io)throw new Error("ZSTDDecoder: Await .init() before decoding.");const n=e.byteLength,r=Io.exports.malloc(n);rb.set(e,r),t=t||Number(Io.exports.ZSTD_findDecompressedSize(r,n));const s=Io.exports.malloc(t),o=Io.exports.ZSTD_decompress(s,t,r,n),a=rb.slice(s,s+o);return Io.exports.free(r),Io.exports.free(s),a}}const a4="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",l4=new Mpe;class Fpe extends tl{constructor(e){super(),this.planarConfiguration=typeof e.PlanarConfiguration<"u"?e.PlanarConfiguration:1,this.samplesPerPixel=typeof e.SamplesPerPixel<"u"?e.SamplesPerPixel:1,this.addCompression=e.LercParameters[Sz.AddCompression]}decodeBlock(e){switch(this.addCompression){case mE.None:break;case mE.Deflate:e=s4(new Uint8Array(e)).buffer;break;case mE.Zstandard:e=l4.decode(new Uint8Array(e)).buffer;break;default:throw new Error(`Unsupported LERC additional compression method identifier: ${this.addCompression}`)}return Ppe.decode(e,{returnPixelInterleavedDims:this.planarConfiguration===1}).pixels[0].buffer}}const Ope=Object.freeze(Object.defineProperty({__proto__:null,default:Fpe,zstd:l4},Symbol.toStringTag,{value:"Module"}));class Npe extends tl{constructor(){if(super(),typeof createImageBitmap>"u")throw new Error("Cannot decode WebImage as `createImageBitmap` is not available");if(typeof document>"u"&&typeof OffscreenCanvas>"u")throw new Error("Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available")}async decode(e,t){const n=new Blob([t]),r=await createImageBitmap(n);let s;typeof document<"u"?(s=document.createElement("canvas"),s.width=r.width,s.height=r.height):s=new OffscreenCanvas(r.width,r.height);const o=s.getContext("2d");return o.drawImage(r,0,0),o.getImageData(0,0,r.width,r.height).data.buffer}}const Qpe=Object.freeze(Object.defineProperty({__proto__:null,default:Npe},Symbol.toStringTag,{value:"Module"})),Upe=Worker;function Gpe(){const i='function A(A,e,t,i,r,I,g){try{var n=A[I](g),a=n.value}catch(A){return void t(A)}n.done?e(a):Promise.resolve(a).then(i,r)}function e(e){return function(){var t=this,i=arguments;return new Promise((function(r,I){var g=e.apply(t,i);function n(e){A(g,r,I,n,a,"next",e)}function a(e){A(g,r,I,n,a,"throw",e)}n(void 0)}))}}function t(A){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&"function"==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},t(A)}var i={exports:{}};!function(A){var e=function(A){var e,i=Object.prototype,r=i.hasOwnProperty,I="function"==typeof Symbol?Symbol:{},g=I.iterator||"@@iterator",n=I.asyncIterator||"@@asyncIterator",a=I.toStringTag||"@@toStringTag";function o(A,e,t){return Object.defineProperty(A,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),A[e]}try{o({},"")}catch(A){o=function(A,e,t){return A[e]=t}}function B(A,e,t,i){var r=e&&e.prototype instanceof h?e:h,I=Object.create(r.prototype),g=new S(i||[]);return I._invoke=function(A,e,t){var i=Q;return function(r,I){if(i===s)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw I;return R()}for(t.method=r,t.arg=I;;){var g=t.delegate;if(g){var n=m(g,t);if(n){if(n===c)continue;return n}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(i===Q)throw i=f,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);i=s;var a=C(A,e,t);if("normal"===a.type){if(i=t.done?f:E,a.arg===c)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(i=f,t.method="throw",t.arg=a.arg)}}}(A,t,g),I}function C(A,e,t){try{return{type:"normal",arg:A.call(e,t)}}catch(A){return{type:"throw",arg:A}}}A.wrap=B;var Q="suspendedStart",E="suspendedYield",s="executing",f="completed",c={};function h(){}function l(){}function u(){}var w={};o(w,g,(function(){return this}));var d=Object.getPrototypeOf,D=d&&d(d(v([])));D&&D!==i&&r.call(D,g)&&(w=D);var y=u.prototype=h.prototype=Object.create(w);function k(A){["next","throw","return"].forEach((function(e){o(A,e,(function(A){return this._invoke(e,A)}))}))}function p(A,e){function i(I,g,n,a){var o=C(A[I],A,g);if("throw"!==o.type){var B=o.arg,Q=B.value;return Q&&"object"===t(Q)&&r.call(Q,"__await")?e.resolve(Q.__await).then((function(A){i("next",A,n,a)}),(function(A){i("throw",A,n,a)})):e.resolve(Q).then((function(A){B.value=A,n(B)}),(function(A){return i("throw",A,n,a)}))}a(o.arg)}var I;this._invoke=function(A,t){function r(){return new e((function(e,r){i(A,t,e,r)}))}return I=I?I.then(r,r):r()}}function m(A,t){var i=A.iterator[t.method];if(i===e){if(t.delegate=null,"throw"===t.method){if(A.iterator.return&&(t.method="return",t.arg=e,m(A,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a \'throw\' method")}return c}var r=C(i,A.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var I=r.arg;return I?I.done?(t[A.resultName]=I.value,t.next=A.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,c):I:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function G(A){var e={tryLoc:A[0]};1 in A&&(e.catchLoc=A[1]),2 in A&&(e.finallyLoc=A[2],e.afterLoc=A[3]),this.tryEntries.push(e)}function F(A){var e=A.completion||{};e.type="normal",delete e.arg,A.completion=e}function S(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(G,this),this.reset(!0)}function v(A){if(A){var t=A[g];if(t)return t.call(A);if("function"==typeof A.next)return A;if(!isNaN(A.length)){var i=-1,I=function t(){for(;++i<A.length;)if(r.call(A,i))return t.value=A[i],t.done=!1,t;return t.value=e,t.done=!0,t};return I.next=I}}return{next:R}}function R(){return{value:e,done:!0}}return l.prototype=u,o(y,"constructor",u),o(u,"constructor",l),l.displayName=o(u,a,"GeneratorFunction"),A.isGeneratorFunction=function(A){var e="function"==typeof A&&A.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},A.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,u):(A.__proto__=u,o(A,a,"GeneratorFunction")),A.prototype=Object.create(y),A},A.awrap=function(A){return{__await:A}},k(p.prototype),o(p.prototype,n,(function(){return this})),A.AsyncIterator=p,A.async=function(e,t,i,r,I){void 0===I&&(I=Promise);var g=new p(B(e,t,i,r),I);return A.isGeneratorFunction(t)?g:g.next().then((function(A){return A.done?A.value:g.next()}))},k(y),o(y,a,"Generator"),o(y,g,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),A.keys=function(A){var e=[];for(var t in A)e.push(t);return e.reverse(),function t(){for(;e.length;){var i=e.pop();if(i in A)return t.value=i,t.done=!1,t}return t.done=!0,t}},A.values=v,S.prototype={constructor:S,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(F),!A)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if("throw"===A.type)throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var t=this;function i(i,r){return n.type="throw",n.arg=A,t.next=i,r&&(t.method="next",t.arg=e),!!r}for(var I=this.tryEntries.length-1;I>=0;--I){var g=this.tryEntries[I],n=g.completion;if("root"===g.tryLoc)return i("end");if(g.tryLoc<=this.prev){var a=r.call(g,"catchLoc"),o=r.call(g,"finallyLoc");if(a&&o){if(this.prev<g.catchLoc)return i(g.catchLoc,!0);if(this.prev<g.finallyLoc)return i(g.finallyLoc)}else if(a){if(this.prev<g.catchLoc)return i(g.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<g.finallyLoc)return i(g.finallyLoc)}}}},abrupt:function(A,e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var I=i;break}}I&&("break"===A||"continue"===A)&&I.tryLoc<=e&&e<=I.finallyLoc&&(I=null);var g=I?I.completion:{};return g.type=A,g.arg=e,I?(this.method="next",this.next=I.finallyLoc,c):this.complete(g)},complete:function(A,e){if("throw"===A.type)throw A.arg;return"break"===A.type||"continue"===A.type?this.next=A.arg:"return"===A.type?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):"normal"===A.type&&e&&(this.next=e),c},finish:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===A)return this.complete(t.completion,t.afterLoc),F(t),c}},catch:function(A){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===A){var i=t.completion;if("throw"===i.type){var r=i.arg;F(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(A,t,i){return this.delegate={iterator:v(A),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=e),c}},A}(A.exports);try{regeneratorRuntime=e}catch(A){"object"===("undefined"==typeof globalThis?"undefined":t(globalThis))?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(i);var r=i.exports,I=new Map;function g(A,e){Array.isArray(A)||(A=[A]),A.forEach((function(A){return I.set(A,e)}))}function n(A){return a.apply(this,arguments)}function a(){return(a=e(r.mark((function A(e){var t,i;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(t=I.get(e.Compression)){A.next=3;break}throw new Error("Unknown compression method identifier: ".concat(e.Compression));case 3:return A.next=5,t();case 5:return i=A.sent,A.abrupt("return",new i(e));case 7:case"end":return A.stop()}}),A)})))).apply(this,arguments)}g([void 0,1],(function(){return Promise.resolve().then((function(){return y})).then((function(A){return A.default}))})),g(5,(function(){return Promise.resolve().then((function(){return F})).then((function(A){return A.default}))})),g(6,(function(){throw new Error("old style JPEG compression is not supported.")})),g(7,(function(){return Promise.resolve().then((function(){return N})).then((function(A){return A.default}))})),g([8,32946],(function(){return Promise.resolve().then((function(){return OA})).then((function(A){return A.default}))})),g(32773,(function(){return Promise.resolve().then((function(){return _A})).then((function(A){return A.default}))})),g(34887,(function(){return Promise.resolve().then((function(){return le})).then(function(){var A=e(r.mark((function A(e){return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,e.zstd.init();case 2:return A.abrupt("return",e);case 3:case"end":return A.stop()}}),A)})));return function(e){return A.apply(this,arguments)}}()).then((function(A){return A.default}))})),g(50001,(function(){return Promise.resolve().then((function(){return de})).then((function(A){return A.default}))}));var o=globalThis;function B(A,e){if(!(A instanceof e))throw new TypeError("Cannot call a class as a function")}function C(A,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(A,i.key,i)}}function Q(A,e,t){return e&&C(A.prototype,e),t&&C(A,t),A}function E(A,e){return E=Object.setPrototypeOf||function(A,e){return A.__proto__=e,A},E(A,e)}function s(A,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(e&&e.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),e&&E(A,e)}function f(A,e){if(e&&("object"===t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(void 0===A)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return A}(A)}function c(A){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(A){return A.__proto__||Object.getPrototypeOf(A)},c(A)}function h(A,e){var t=A.length-e,i=0;do{for(var r=e;r>0;r--)A[i+e]+=A[i],i++;t-=e}while(t>0)}function l(A,e,t){for(var i=0,r=A.length,I=r/t;r>e;){for(var g=e;g>0;--g)A[i+e]+=A[i],++i;r-=e}for(var n=A.slice(),a=0;a<I;++a)for(var o=0;o<t;++o)A[t*a+o]=n[(t-o-1)*I+a]}function u(A,e,t,i,r,I){if(!e||1===e)return A;for(var g=0;g<r.length;++g){if(r[g]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(r[g]!==r[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var n=r[0]/8,a=2===I?1:r.length,o=0;o<i&&!(o*a*t*n>=A.byteLength);++o){var B=void 0;if(2===e){switch(r[0]){case 8:B=new Uint8Array(A,o*a*t*n,a*t*n);break;case 16:B=new Uint16Array(A,o*a*t*n,a*t*n/2);break;case 32:B=new Uint32Array(A,o*a*t*n,a*t*n/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(r[0]," bits per sample."))}h(B,a)}else 3===e&&l(B=new Uint8Array(A,o*a*t*n,a*t*n),a,n)}return A}o.addEventListener("message",function(){var A=e(r.mark((function A(e){var t,i,I,g,a,B;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=e.data,i=t.id,I=t.fileDirectory,g=t.buffer,A.next=3,n(I);case 3:return a=A.sent,A.next=6,a.decode(I,g);case 6:B=A.sent,o.postMessage({decoded:B,id:i},[B]);case 8:case"end":return A.stop()}}),A)})));return function(e){return A.apply(this,arguments)}}());var w=function(){function A(){B(this,A)}var t;return Q(A,[{key:"decode",value:(t=e(r.mark((function A(e,t){var i,I,g,n,a;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.decodeBlock(t);case 2:if(i=A.sent,1===(I=e.Predictor||1)){A.next=9;break}return g=!e.StripOffsets,n=g?e.TileWidth:e.ImageWidth,a=g?e.TileLength:e.RowsPerStrip||e.ImageLength,A.abrupt("return",u(i,I,n,a,e.BitsPerSample,e.PlanarConfiguration));case 9:return A.abrupt("return",i);case 10:case"end":return A.stop()}}),A,this)}))),function(A,e){return t.apply(this,arguments)})}]),A}();function d(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var D=function(A){s(t,w);var e=d(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){return A}}]),t}(),y=Object.freeze({__proto__:null,default:D});function k(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}function p(A,e){for(var t=e.length-1;t>=0;t--)A.push(e[t]);return A}function m(A){for(var e=new Uint16Array(4093),t=new Uint8Array(4093),i=0;i<=257;i++)e[i]=4096,t[i]=i;var r=258,I=9,g=0;function n(){r=258,I=9}function a(A){var e=function(A,e,t){var i=e%8,r=Math.floor(e/8),I=8-i,g=e+t-8*(r+1),n=8*(r+2)-(e+t),a=8*(r+2)-e;if(n=Math.max(0,n),r>=A.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;var o=A[r]&Math.pow(2,8-i)-1,B=o<<=t-I;if(r+1<A.length){var C=A[r+1]>>>n;B+=C<<=Math.max(0,t-a)}if(g>8&&r+2<A.length){var Q=8*(r+3)-(e+t);B+=A[r+2]>>>Q}return B}(A,g,I);return g+=I,e}function o(A,i){return t[r]=i,e[r]=A,++r-1}function B(A){for(var i=[],r=A;4096!==r;r=e[r])i.push(t[r]);return i}var C=[];n();for(var Q,E=new Uint8Array(A),s=a(E);257!==s;){if(256===s){for(n(),s=a(E);256===s;)s=a(E);if(257===s)break;if(s>256)throw new Error("corrupted code at scanline ".concat(s));p(C,B(s)),Q=s}else if(s<r){var f=B(s);p(C,f),o(Q,f[f.length-1]),Q=s}else{var c=B(Q);if(!c)throw new Error("Bogus entry. Not in dictionary, ".concat(Q," / ").concat(r,", position: ").concat(g));p(C,c),C.push(c[c.length-1]),o(Q,c[c.length-1]),Q=s}r+1>=Math.pow(2,I)&&(12===I?Q=void 0:I++),s=a(E)}return new Uint8Array(C)}var G=function(A){s(t,w);var e=k(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){return m(A).buffer}}]),t}(),F=Object.freeze({__proto__:null,default:G});function S(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var v=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function R(A,e){for(var t=0,i=[],r=16;r>0&&!A[r-1];)--r;i.push({children:[],index:0});for(var I,g=i[0],n=0;n<r;n++){for(var a=0;a<A[n];a++){for((g=i.pop()).children[g.index]=e[t];g.index>0;)g=i.pop();for(g.index++,i.push(g);i.length<=n;)i.push(I={children:[],index:0}),g.children[g.index]=I.children,g=I;t++}n+1<r&&(i.push(I={children:[],index:0}),g.children[g.index]=I.children,g=I)}return i[0].children}function U(A,e,i,r,I,g,n,a,o){var B=i.mcusPerLine,C=i.progressive,Q=e,E=e,s=0,f=0;function c(){if(f>0)return f--,s>>f&1;if(255===(s=A[E++])){var e=A[E++];if(e)throw new Error("unexpected marker: ".concat((s<<8|e).toString(16)))}return f=7,s>>>7}function h(A){for(var e,i=A;null!==(e=c());){if("number"==typeof(i=i[e]))return i;if("object"!==t(i))throw new Error("invalid huffman sequence")}return null}function l(A){for(var e=A,t=0;e>0;){var i=c();if(null===i)return;t=t<<1|i,--e}return t}function u(A){var e=l(A);return e>=1<<A-1?e:e+(-1<<A)+1}var w=0;var d,D=0;function y(A,e,t,i,r){var I=t%B,g=(t/B|0)*A.v+i,n=I*A.h+r;e(A,A.blocks[g][n])}function k(A,e,t){var i=t/A.blocksPerLine|0,r=t%A.blocksPerLine;e(A,A.blocks[i][r])}var p,m,G,F,S,R,U=r.length;R=C?0===g?0===a?function(A,e){var t=h(A.huffmanTableDC),i=0===t?0:u(t)<<o;A.pred+=i,e[0]=A.pred}:function(A,e){e[0]|=c()<<o}:0===a?function(A,e){if(w>0)w--;else for(var t=g,i=n;t<=i;){var r=h(A.huffmanTableAC),I=15&r,a=r>>4;if(0===I){if(a<15){w=l(a)+(1<<a)-1;break}t+=16}else e[v[t+=a]]=u(I)*(1<<o),t++}}:function(A,e){for(var t=g,i=n,r=0;t<=i;){var I=v[t],a=e[I]<0?-1:1;switch(D){case 0:var B=h(A.huffmanTableAC),C=15&B;if(r=B>>4,0===C)r<15?(w=l(r)+(1<<r),D=4):(r=16,D=1);else{if(1!==C)throw new Error("invalid ACn encoding");d=u(C),D=r?2:3}continue;case 1:case 2:e[I]?e[I]+=(c()<<o)*a:0==--r&&(D=2===D?3:0);break;case 3:e[I]?e[I]+=(c()<<o)*a:(e[I]=d<<o,D=0);break;case 4:e[I]&&(e[I]+=(c()<<o)*a)}t++}4===D&&0==--w&&(D=0)}:function(A,e){var t=h(A.huffmanTableDC),i=0===t?0:u(t);A.pred+=i,e[0]=A.pred;for(var r=1;r<64;){var I=h(A.huffmanTableAC),g=15&I,n=I>>4;if(0===g){if(n<15)break;r+=16}else e[v[r+=n]]=u(g),r++}};var L,b,M=0;b=1===U?r[0].blocksPerLine*r[0].blocksPerColumn:B*i.mcusPerColumn;for(var N=I||b;M<b;){for(m=0;m<U;m++)r[m].pred=0;if(w=0,1===U)for(p=r[0],S=0;S<N;S++)k(p,R,M),M++;else for(S=0;S<N;S++){for(m=0;m<U;m++){var x=p=r[m],J=x.h,q=x.v;for(G=0;G<q;G++)for(F=0;F<J;F++)y(p,R,M,G,F)}if(++M===b)break}if(f=0,(L=A[E]<<8|A[E+1])<65280)throw new Error("marker was not found");if(!(L>=65488&&L<=65495))break;E+=2}return E-Q}function L(A,e){var t=[],i=e.blocksPerLine,r=e.blocksPerColumn,I=i<<3,g=new Int32Array(64),n=new Uint8Array(64);function a(A,t,i){var r,I,g,n,a,o,B,C,Q,E,s=e.quantizationTable,f=i;for(E=0;E<64;E++)f[E]=A[E]*s[E];for(E=0;E<8;++E){var c=8*E;0!==f[1+c]||0!==f[2+c]||0!==f[3+c]||0!==f[4+c]||0!==f[5+c]||0!==f[6+c]||0!==f[7+c]?(r=5793*f[0+c]+128>>8,I=5793*f[4+c]+128>>8,g=f[2+c],n=f[6+c],a=2896*(f[1+c]-f[7+c])+128>>8,C=2896*(f[1+c]+f[7+c])+128>>8,o=f[3+c]<<4,Q=r-I+1>>1,r=r+I+1>>1,I=Q,Q=3784*g+1567*n+128>>8,g=1567*g-3784*n+128>>8,n=Q,Q=a-(B=f[5+c]<<4)+1>>1,a=a+B+1>>1,B=Q,Q=C+o+1>>1,o=C-o+1>>1,C=Q,Q=r-n+1>>1,r=r+n+1>>1,n=Q,Q=I-g+1>>1,I=I+g+1>>1,g=Q,Q=2276*a+3406*C+2048>>12,a=3406*a-2276*C+2048>>12,C=Q,Q=799*o+4017*B+2048>>12,o=4017*o-799*B+2048>>12,B=Q,f[0+c]=r+C,f[7+c]=r-C,f[1+c]=I+B,f[6+c]=I-B,f[2+c]=g+o,f[5+c]=g-o,f[3+c]=n+a,f[4+c]=n-a):(Q=5793*f[0+c]+512>>10,f[0+c]=Q,f[1+c]=Q,f[2+c]=Q,f[3+c]=Q,f[4+c]=Q,f[5+c]=Q,f[6+c]=Q,f[7+c]=Q)}for(E=0;E<8;++E){var h=E;0!==f[8+h]||0!==f[16+h]||0!==f[24+h]||0!==f[32+h]||0!==f[40+h]||0!==f[48+h]||0!==f[56+h]?(r=5793*f[0+h]+2048>>12,I=5793*f[32+h]+2048>>12,g=f[16+h],n=f[48+h],a=2896*(f[8+h]-f[56+h])+2048>>12,C=2896*(f[8+h]+f[56+h])+2048>>12,o=f[24+h],Q=r-I+1>>1,r=r+I+1>>1,I=Q,Q=3784*g+1567*n+2048>>12,g=1567*g-3784*n+2048>>12,n=Q,Q=a-(B=f[40+h])+1>>1,a=a+B+1>>1,B=Q,Q=C+o+1>>1,o=C-o+1>>1,C=Q,Q=r-n+1>>1,r=r+n+1>>1,n=Q,Q=I-g+1>>1,I=I+g+1>>1,g=Q,Q=2276*a+3406*C+2048>>12,a=3406*a-2276*C+2048>>12,C=Q,Q=799*o+4017*B+2048>>12,o=4017*o-799*B+2048>>12,B=Q,f[0+h]=r+C,f[56+h]=r-C,f[8+h]=I+B,f[48+h]=I-B,f[16+h]=g+o,f[40+h]=g-o,f[24+h]=n+a,f[32+h]=n-a):(Q=5793*i[E+0]+8192>>14,f[0+h]=Q,f[8+h]=Q,f[16+h]=Q,f[24+h]=Q,f[32+h]=Q,f[40+h]=Q,f[48+h]=Q,f[56+h]=Q)}for(E=0;E<64;++E){var l=128+(f[E]+8>>4);t[E]=l<0?0:l>255?255:l}}for(var o=0;o<r;o++){for(var B=o<<3,C=0;C<8;C++)t.push(new Uint8Array(I));for(var Q=0;Q<i;Q++){a(e.blocks[o][Q],n,g);for(var E=0,s=Q<<3,f=0;f<8;f++)for(var c=t[B+f],h=0;h<8;h++)c[s+h]=n[E++]}}return t}var b=function(){function A(){B(this,A),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return Q(A,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(A){var e=0;function t(){var t=A[e]<<8|A[e+1];return e+=2,t}function i(A){var e,t,i=0,r=0;for(t in A.components)A.components.hasOwnProperty(t)&&(i<(e=A.components[t]).h&&(i=e.h),r<e.v&&(r=e.v));var I=Math.ceil(A.samplesPerLine/8/i),g=Math.ceil(A.scanLines/8/r);for(t in A.components)if(A.components.hasOwnProperty(t)){e=A.components[t];for(var n=Math.ceil(Math.ceil(A.samplesPerLine/8)*e.h/i),a=Math.ceil(Math.ceil(A.scanLines/8)*e.v/r),o=I*e.h,B=g*e.v,C=[],Q=0;Q<B;Q++){for(var E=[],s=0;s<o;s++)E.push(new Int32Array(64));C.push(E)}e.blocksPerLine=n,e.blocksPerColumn=a,e.blocks=C}A.maxH=i,A.maxV=r,A.mcusPerLine=I,A.mcusPerColumn=g}var r,I,g=t();if(65496!==g)throw new Error("SOI not found");for(g=t();65497!==g;){switch(g){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var n=(r=void 0,I=void 0,r=t(),I=A.subarray(e,e+r-2),e+=I.length,I);65504===g&&74===n[0]&&70===n[1]&&73===n[2]&&70===n[3]&&0===n[4]&&(this.jfif={version:{major:n[5],minor:n[6]},densityUnits:n[7],xDensity:n[8]<<8|n[9],yDensity:n[10]<<8|n[11],thumbWidth:n[12],thumbHeight:n[13],thumbData:n.subarray(14,14+3*n[12]*n[13])}),65518===g&&65===n[0]&&100===n[1]&&111===n[2]&&98===n[3]&&101===n[4]&&0===n[5]&&(this.adobe={version:n[6],flags0:n[7]<<8|n[8],flags1:n[9]<<8|n[10],transformCode:n[11]});break;case 65499:for(var a=t()+e-2;e<a;){var o=A[e++],B=new Int32Array(64);if(o>>4==0)for(var C=0;C<64;C++){B[v[C]]=A[e++]}else{if(o>>4!=1)throw new Error("DQT: invalid table spec");for(var Q=0;Q<64;Q++){B[v[Q]]=t()}}this.quantizationTables[15&o]=B}break;case 65472:case 65473:case 65474:t();for(var E={extended:65473===g,progressive:65474===g,precision:A[e++],scanLines:t(),samplesPerLine:t(),components:{},componentsOrder:[]},s=A[e++],f=void 0,c=0;c<s;c++){f=A[e];var h=A[e+1]>>4,l=15&A[e+1],u=A[e+2];E.componentsOrder.push(f),E.components[f]={h:h,v:l,quantizationIdx:u},e+=3}i(E),this.frames.push(E);break;case 65476:for(var w=t(),d=2;d<w;){for(var D=A[e++],y=new Uint8Array(16),k=0,p=0;p<16;p++,e++)y[p]=A[e],k+=y[p];for(var m=new Uint8Array(k),G=0;G<k;G++,e++)m[G]=A[e];d+=17+k,D>>4==0?this.huffmanTablesDC[15&D]=R(y,m):this.huffmanTablesAC[15&D]=R(y,m)}break;case 65501:t(),this.resetInterval=t();break;case 65498:t();for(var F=A[e++],S=[],L=this.frames[0],b=0;b<F;b++){var M=L.components[A[e++]],N=A[e++];M.huffmanTableDC=this.huffmanTablesDC[N>>4],M.huffmanTableAC=this.huffmanTablesAC[15&N],S.push(M)}var x=A[e++],J=A[e++],q=A[e++],Y=U(A,e,L,S,this.resetInterval,x,J,q>>4,15&q);e+=Y;break;case 65535:255!==A[e]&&e--;break;default:if(255===A[e-3]&&A[e-2]>=192&&A[e-2]<=254){e-=3;break}throw new Error("unknown JPEG marker ".concat(g.toString(16)))}g=t()}}},{key:"getResult",value:function(){var A=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var e=0;e<this.frames.length;e++)for(var t=this.frames[e].components,i=0,r=Object.keys(t);i<r.length;i++){var I=r[i];t[I].quantizationTable=this.quantizationTables[t[I].quantizationIdx],delete t[I].quantizationIdx}for(var g=A[0],n=g.components,a=g.componentsOrder,o=[],B=g.samplesPerLine,C=g.scanLines,Q=0;Q<a.length;Q++){var E=n[a[Q]];o.push({lines:L(0,E),scaleX:E.h/g.maxH,scaleY:E.v/g.maxV})}for(var s=new Uint8Array(B*C*o.length),f=0,c=0;c<C;++c)for(var h=0;h<B;++h)for(var l=0;l<o.length;++l){var u=o[l];s[f]=u.lines[0|c*u.scaleY][0|h*u.scaleX],++f}return s}}]),A}(),M=function(A){s(t,w);var e=S(t);function t(A){var i;return B(this,t),(i=e.call(this)).reader=new b,A.JPEGTables&&i.reader.parse(A.JPEGTables),i}return Q(t,[{key:"decodeBlock",value:function(A){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(A)),this.reader.getResult().buffer}}]),t}(),N=Object.freeze({__proto__:null,default:M});function x(A){for(var e=A.length;--e>=0;)A[e]=0}x(new Array(576)),x(new Array(60)),x(new Array(512)),x(new Array(256)),x(new Array(29)),x(new Array(30));var J=function(A,e,t,i){for(var r=65535&A|0,I=A>>>16&65535|0,g=0;0!==t;){t-=g=t>2e3?2e3:t;do{I=I+(r=r+e[i++]|0)|0}while(--g);r%=65521,I%=65521}return r|I<<16|0},q=new Uint32Array(function(){for(var A,e=[],t=0;t<256;t++){A=t;for(var i=0;i<8;i++)A=1&A?3988292384^A>>>1:A>>>1;e[t]=A}return e}()),Y=function(A,e,t,i){var r=q,I=i+t;A^=-1;for(var g=i;g<I;g++)A=A>>>8^r[255&(A^e[g])];return-1^A},K={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},H={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},O=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},P=function(A){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!==t(i))throw new TypeError(i+"must be non-object");for(var r in i)O(i,r)&&(A[r]=i[r])}}return A},T=function(A){for(var e=0,t=0,i=A.length;t<i;t++)e+=A[t].length;for(var r=new Uint8Array(e),I=0,g=0,n=A.length;I<n;I++){var a=A[I];r.set(a,g),g+=a.length}return r},V=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(A){V=!1}for(var _=new Uint8Array(256),X=0;X<256;X++)_[X]=X>=252?6:X>=248?5:X>=240?4:X>=224?3:X>=192?2:1;_[254]=_[254]=1;var Z=function(A){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(A);var e,t,i,r,I,g=A.length,n=0;for(r=0;r<g;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<g&&56320==(64512&(i=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(i-56320),r++),n+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(n),I=0,r=0;I<n;r++)55296==(64512&(t=A.charCodeAt(r)))&&r+1<g&&56320==(64512&(i=A.charCodeAt(r+1)))&&(t=65536+(t-55296<<10)+(i-56320),r++),t<128?e[I++]=t:t<2048?(e[I++]=192|t>>>6,e[I++]=128|63&t):t<65536?(e[I++]=224|t>>>12,e[I++]=128|t>>>6&63,e[I++]=128|63&t):(e[I++]=240|t>>>18,e[I++]=128|t>>>12&63,e[I++]=128|t>>>6&63,e[I++]=128|63&t);return e},j=function(A,e){var t,i,r=e||A.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(A.subarray(0,e));var I=new Array(2*r);for(i=0,t=0;t<r;){var g=A[t++];if(g<128)I[i++]=g;else{var n=_[g];if(n>4)I[i++]=65533,t+=n-1;else{for(g&=2===n?31:3===n?15:7;n>1&&t<r;)g=g<<6|63&A[t++],n--;n>1?I[i++]=65533:g<65536?I[i++]=g:(g-=65536,I[i++]=55296|g>>10&1023,I[i++]=56320|1023&g)}}}return function(A,e){if(e<65534&&A.subarray&&V)return String.fromCharCode.apply(null,A.length===e?A:A.subarray(0,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(A[i]);return t}(I,i)},W=function(A,e){(e=e||A.length)>A.length&&(e=A.length);for(var t=e-1;t>=0&&128==(192&A[t]);)t--;return t<0||0===t?e:t+_[A[t]]>e?t:e};var z=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},$=function(A,e){var t,i,r,I,g,n,a,o,B,C,Q,E,s,f,c,h,l,u,w,d,D,y,k,p,m=A.state;t=A.next_in,k=A.input,i=t+(A.avail_in-5),r=A.next_out,p=A.output,I=r-(e-A.avail_out),g=r+(A.avail_out-257),n=m.dmax,a=m.wsize,o=m.whave,B=m.wnext,C=m.window,Q=m.hold,E=m.bits,s=m.lencode,f=m.distcode,c=(1<<m.lenbits)-1,h=(1<<m.distbits)-1;A:do{E<15&&(Q+=k[t++]<<E,E+=8,Q+=k[t++]<<E,E+=8),l=s[Q&c];e:for(;;){if(Q>>>=u=l>>>24,E-=u,0===(u=l>>>16&255))p[r++]=65535&l;else{if(!(16&u)){if(0==(64&u)){l=s[(65535&l)+(Q&(1<<u)-1)];continue e}if(32&u){m.mode=12;break A}A.msg="invalid literal/length code",m.mode=30;break A}w=65535&l,(u&=15)&&(E<u&&(Q+=k[t++]<<E,E+=8),w+=Q&(1<<u)-1,Q>>>=u,E-=u),E<15&&(Q+=k[t++]<<E,E+=8,Q+=k[t++]<<E,E+=8),l=f[Q&h];t:for(;;){if(Q>>>=u=l>>>24,E-=u,!(16&(u=l>>>16&255))){if(0==(64&u)){l=f[(65535&l)+(Q&(1<<u)-1)];continue t}A.msg="invalid distance code",m.mode=30;break A}if(d=65535&l,E<(u&=15)&&(Q+=k[t++]<<E,(E+=8)<u&&(Q+=k[t++]<<E,E+=8)),(d+=Q&(1<<u)-1)>n){A.msg="invalid distance too far back",m.mode=30;break A}if(Q>>>=u,E-=u,d>(u=r-I)){if((u=d-u)>o&&m.sane){A.msg="invalid distance too far back",m.mode=30;break A}if(D=0,y=C,0===B){if(D+=a-u,u<w){w-=u;do{p[r++]=C[D++]}while(--u);D=r-d,y=p}}else if(B<u){if(D+=a+B-u,(u-=B)<w){w-=u;do{p[r++]=C[D++]}while(--u);if(D=0,B<w){w-=u=B;do{p[r++]=C[D++]}while(--u);D=r-d,y=p}}}else if(D+=B-u,u<w){w-=u;do{p[r++]=C[D++]}while(--u);D=r-d,y=p}for(;w>2;)p[r++]=y[D++],p[r++]=y[D++],p[r++]=y[D++],w-=3;w&&(p[r++]=y[D++],w>1&&(p[r++]=y[D++]))}else{D=r-d;do{p[r++]=p[D++],p[r++]=p[D++],p[r++]=p[D++],w-=3}while(w>2);w&&(p[r++]=p[D++],w>1&&(p[r++]=p[D++]))}break}}break}}while(t<i&&r<g);t-=w=E>>3,Q&=(1<<(E-=w<<3))-1,A.next_in=t,A.next_out=r,A.avail_in=t<i?i-t+5:5-(t-i),A.avail_out=r<g?g-r+257:257-(r-g),m.hold=Q,m.bits=E},AA=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eA=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tA=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),iA=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),rA=function(A,e,t,i,r,I,g,n){var a,o,B,C,Q,E,s,f,c,h=n.bits,l=0,u=0,w=0,d=0,D=0,y=0,k=0,p=0,m=0,G=0,F=null,S=0,v=new Uint16Array(16),R=new Uint16Array(16),U=null,L=0;for(l=0;l<=15;l++)v[l]=0;for(u=0;u<i;u++)v[e[t+u]]++;for(D=h,d=15;d>=1&&0===v[d];d--);if(D>d&&(D=d),0===d)return r[I++]=20971520,r[I++]=20971520,n.bits=1,0;for(w=1;w<d&&0===v[w];w++);for(D<w&&(D=w),p=1,l=1;l<=15;l++)if(p<<=1,(p-=v[l])<0)return-1;if(p>0&&(0===A||1!==d))return-1;for(R[1]=0,l=1;l<15;l++)R[l+1]=R[l]+v[l];for(u=0;u<i;u++)0!==e[t+u]&&(g[R[e[t+u]]++]=u);if(0===A?(F=U=g,E=19):1===A?(F=AA,S-=257,U=eA,L-=257,E=256):(F=tA,U=iA,E=-1),G=0,u=0,l=w,Q=I,y=D,k=0,B=-1,C=(m=1<<D)-1,1===A&&m>852||2===A&&m>592)return 1;for(;;){s=l-k,g[u]<E?(f=0,c=g[u]):g[u]>E?(f=U[L+g[u]],c=F[S+g[u]]):(f=96,c=0),a=1<<l-k,w=o=1<<y;do{r[Q+(G>>k)+(o-=a)]=s<<24|f<<16|c|0}while(0!==o);for(a=1<<l-1;G&a;)a>>=1;if(0!==a?(G&=a-1,G+=a):G=0,u++,0==--v[l]){if(l===d)break;l=e[t+g[u]]}if(l>D&&(G&C)!==B){for(0===k&&(k=D),Q+=w,p=1<<(y=l-k);y+k<d&&!((p-=v[y+k])<=0);)y++,p<<=1;if(m+=1<<y,1===A&&m>852||2===A&&m>592)return 1;r[B=G&C]=D<<24|y<<16|Q-I|0}}return 0!==G&&(r[Q+G]=l-k<<24|64<<16|0),n.bits=D,0},IA=H.Z_FINISH,gA=H.Z_BLOCK,nA=H.Z_TREES,aA=H.Z_OK,oA=H.Z_STREAM_END,BA=H.Z_NEED_DICT,CA=H.Z_STREAM_ERROR,QA=H.Z_DATA_ERROR,EA=H.Z_MEM_ERROR,sA=H.Z_BUF_ERROR,fA=H.Z_DEFLATED,cA=function(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)};function hA(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var lA,uA,wA=function(A){if(!A||!A.state)return CA;var e=A.state;return A.total_in=A.total_out=e.total=0,A.msg="",e.wrap&&(A.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,aA},dA=function(A){if(!A||!A.state)return CA;var e=A.state;return e.wsize=0,e.whave=0,e.wnext=0,wA(A)},DA=function(A,e){var t;if(!A||!A.state)return CA;var i=A.state;return e<0?(t=0,e=-e):(t=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?CA:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,dA(A))},yA=function(A,e){if(!A)return CA;var t=new hA;A.state=t,t.window=null;var i=DA(A,e);return i!==aA&&(A.state=null),i},kA=!0,pA=function(A){if(kA){lA=new Int32Array(512),uA=new Int32Array(32);for(var e=0;e<144;)A.lens[e++]=8;for(;e<256;)A.lens[e++]=9;for(;e<280;)A.lens[e++]=7;for(;e<288;)A.lens[e++]=8;for(rA(1,A.lens,0,288,lA,0,A.work,{bits:9}),e=0;e<32;)A.lens[e++]=5;rA(2,A.lens,0,32,uA,0,A.work,{bits:5}),kA=!1}A.lencode=lA,A.lenbits=9,A.distcode=uA,A.distbits=5},mA=function(A,e,t,i){var r,I=A.state;return null===I.window&&(I.wsize=1<<I.wbits,I.wnext=0,I.whave=0,I.window=new Uint8Array(I.wsize)),i>=I.wsize?(I.window.set(e.subarray(t-I.wsize,t),0),I.wnext=0,I.whave=I.wsize):((r=I.wsize-I.wnext)>i&&(r=i),I.window.set(e.subarray(t-i,t-i+r),I.wnext),(i-=r)?(I.window.set(e.subarray(t-i,t),0),I.wnext=i,I.whave=I.wsize):(I.wnext+=r,I.wnext===I.wsize&&(I.wnext=0),I.whave<I.wsize&&(I.whave+=r))),0},GA={inflateReset:dA,inflateReset2:DA,inflateResetKeep:wA,inflateInit:function(A){return yA(A,15)},inflateInit2:yA,inflate:function(A,e){var t,i,r,I,g,n,a,o,B,C,Q,E,s,f,c,h,l,u,w,d,D,y,k,p,m=0,G=new Uint8Array(4),F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!A||!A.state||!A.output||!A.input&&0!==A.avail_in)return CA;12===(t=A.state).mode&&(t.mode=13),g=A.next_out,r=A.output,a=A.avail_out,I=A.next_in,i=A.input,n=A.avail_in,o=t.hold,B=t.bits,C=n,Q=a,y=aA;A:for(;;)switch(t.mode){case 1:if(0===t.wrap){t.mode=13;break}for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(2&t.wrap&&35615===o){t.check=0,G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0),o=0,B=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&o)<<8)+(o>>8))%31){A.msg="incorrect header check",t.mode=30;break}if((15&o)!==fA){A.msg="unknown compression method",t.mode=30;break}if(B-=4,D=8+(15&(o>>>=4)),0===t.wbits)t.wbits=D;else if(D>t.wbits){A.msg="invalid window size",t.mode=30;break}t.dmax=1<<t.wbits,A.adler=t.check=1,t.mode=512&o?10:12,o=0,B=0;break;case 2:for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(t.flags=o,(255&t.flags)!==fA){A.msg="unknown compression method",t.mode=30;break}if(57344&t.flags){A.msg="unknown header flags set",t.mode=30;break}t.head&&(t.head.text=o>>8&1),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0)),o=0,B=0,t.mode=3;case 3:for(;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.head&&(t.head.time=o),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,G[2]=o>>>16&255,G[3]=o>>>24&255,t.check=Y(t.check,G,4,0)),o=0,B=0,t.mode=4;case 4:for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.head&&(t.head.xflags=255&o,t.head.os=o>>8),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0)),o=0,B=0,t.mode=5;case 5:if(1024&t.flags){for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.length=o,t.head&&(t.head.extra_len=o),512&t.flags&&(G[0]=255&o,G[1]=o>>>8&255,t.check=Y(t.check,G,2,0)),o=0,B=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&((E=t.length)>n&&(E=n),E&&(t.head&&(D=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(I,I+E),D)),512&t.flags&&(t.check=Y(t.check,i,E,I)),n-=E,I+=E,t.length-=E),t.length))break A;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(0===n)break A;E=0;do{D=i[I+E++],t.head&&D&&t.length<65536&&(t.head.name+=String.fromCharCode(D))}while(D&&E<n);if(512&t.flags&&(t.check=Y(t.check,i,E,I)),n-=E,I+=E,D)break A}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(0===n)break A;E=0;do{D=i[I+E++],t.head&&D&&t.length<65536&&(t.head.comment+=String.fromCharCode(D))}while(D&&E<n);if(512&t.flags&&(t.check=Y(t.check,i,E,I)),n-=E,I+=E,D)break A}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;B<16;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(o!==(65535&t.check)){A.msg="header crc mismatch",t.mode=30;break}o=0,B=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),A.adler=t.check=0,t.mode=12;break;case 10:for(;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}A.adler=t.check=cA(o),o=0,B=0,t.mode=11;case 11:if(0===t.havedict)return A.next_out=g,A.avail_out=a,A.next_in=I,A.avail_in=n,t.hold=o,t.bits=B,BA;A.adler=t.check=1,t.mode=12;case 12:if(e===gA||e===nA)break A;case 13:if(t.last){o>>>=7&B,B-=7&B,t.mode=27;break}for(;B<3;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}switch(t.last=1&o,B-=1,3&(o>>>=1)){case 0:t.mode=14;break;case 1:if(pA(t),t.mode=20,e===nA){o>>>=2,B-=2;break A}break;case 2:t.mode=17;break;case 3:A.msg="invalid block type",t.mode=30}o>>>=2,B-=2;break;case 14:for(o>>>=7&B,B-=7&B;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if((65535&o)!=(o>>>16^65535)){A.msg="invalid stored block lengths",t.mode=30;break}if(t.length=65535&o,o=0,B=0,t.mode=15,e===nA)break A;case 15:t.mode=16;case 16:if(E=t.length){if(E>n&&(E=n),E>a&&(E=a),0===E)break A;r.set(i.subarray(I,I+E),g),n-=E,I+=E,a-=E,g+=E,t.length-=E;break}t.mode=12;break;case 17:for(;B<14;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(t.nlen=257+(31&o),o>>>=5,B-=5,t.ndist=1+(31&o),o>>>=5,B-=5,t.ncode=4+(15&o),o>>>=4,B-=4,t.nlen>286||t.ndist>30){A.msg="too many length or distance symbols",t.mode=30;break}t.have=0,t.mode=18;case 18:for(;t.have<t.ncode;){for(;B<3;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.lens[F[t.have++]]=7&o,o>>>=3,B-=3}for(;t.have<19;)t.lens[F[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,k={bits:t.lenbits},y=rA(0,t.lens,0,19,t.lencode,0,t.work,k),t.lenbits=k.bits,y){A.msg="invalid code lengths set",t.mode=30;break}t.have=0,t.mode=19;case 19:for(;t.have<t.nlen+t.ndist;){for(;h=(m=t.lencode[o&(1<<t.lenbits)-1])>>>16&255,l=65535&m,!((c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(l<16)o>>>=c,B-=c,t.lens[t.have++]=l;else{if(16===l){for(p=c+2;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(o>>>=c,B-=c,0===t.have){A.msg="invalid bit length repeat",t.mode=30;break}D=t.lens[t.have-1],E=3+(3&o),o>>>=2,B-=2}else if(17===l){for(p=c+3;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}B-=c,D=0,E=3+(7&(o>>>=c)),o>>>=3,B-=3}else{for(p=c+7;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}B-=c,D=0,E=11+(127&(o>>>=c)),o>>>=7,B-=7}if(t.have+E>t.nlen+t.ndist){A.msg="invalid bit length repeat",t.mode=30;break}for(;E--;)t.lens[t.have++]=D}}if(30===t.mode)break;if(0===t.lens[256]){A.msg="invalid code -- missing end-of-block",t.mode=30;break}if(t.lenbits=9,k={bits:t.lenbits},y=rA(1,t.lens,0,t.nlen,t.lencode,0,t.work,k),t.lenbits=k.bits,y){A.msg="invalid literal/lengths set",t.mode=30;break}if(t.distbits=6,t.distcode=t.distdyn,k={bits:t.distbits},y=rA(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,k),t.distbits=k.bits,y){A.msg="invalid distances set",t.mode=30;break}if(t.mode=20,e===nA)break A;case 20:t.mode=21;case 21:if(n>=6&&a>=258){A.next_out=g,A.avail_out=a,A.next_in=I,A.avail_in=n,t.hold=o,t.bits=B,$(A,Q),g=A.next_out,r=A.output,a=A.avail_out,I=A.next_in,i=A.input,n=A.avail_in,o=t.hold,B=t.bits,12===t.mode&&(t.back=-1);break}for(t.back=0;h=(m=t.lencode[o&(1<<t.lenbits)-1])>>>16&255,l=65535&m,!((c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(h&&0==(240&h)){for(u=c,w=h,d=l;h=(m=t.lencode[d+((o&(1<<u+w)-1)>>u)])>>>16&255,l=65535&m,!(u+(c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}o>>>=u,B-=u,t.back+=u}if(o>>>=c,B-=c,t.back+=c,t.length=l,0===h){t.mode=26;break}if(32&h){t.back=-1,t.mode=12;break}if(64&h){A.msg="invalid literal/length code",t.mode=30;break}t.extra=15&h,t.mode=22;case 22:if(t.extra){for(p=t.extra;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.length+=o&(1<<t.extra)-1,o>>>=t.extra,B-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=23;case 23:for(;h=(m=t.distcode[o&(1<<t.distbits)-1])>>>16&255,l=65535&m,!((c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(0==(240&h)){for(u=c,w=h,d=l;h=(m=t.distcode[d+((o&(1<<u+w)-1)>>u)])>>>16&255,l=65535&m,!(u+(c=m>>>24)<=B);){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}o>>>=u,B-=u,t.back+=u}if(o>>>=c,B-=c,t.back+=c,64&h){A.msg="invalid distance code",t.mode=30;break}t.offset=l,t.extra=15&h,t.mode=24;case 24:if(t.extra){for(p=t.extra;B<p;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}t.offset+=o&(1<<t.extra)-1,o>>>=t.extra,B-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){A.msg="invalid distance too far back",t.mode=30;break}t.mode=25;case 25:if(0===a)break A;if(E=Q-a,t.offset>E){if((E=t.offset-E)>t.whave&&t.sane){A.msg="invalid distance too far back",t.mode=30;break}E>t.wnext?(E-=t.wnext,s=t.wsize-E):s=t.wnext-E,E>t.length&&(E=t.length),f=t.window}else f=r,s=g-t.offset,E=t.length;E>a&&(E=a),a-=E,t.length-=E;do{r[g++]=f[s++]}while(--E);0===t.length&&(t.mode=21);break;case 26:if(0===a)break A;r[g++]=t.length,a--,t.mode=21;break;case 27:if(t.wrap){for(;B<32;){if(0===n)break A;n--,o|=i[I++]<<B,B+=8}if(Q-=a,A.total_out+=Q,t.total+=Q,Q&&(A.adler=t.check=t.flags?Y(t.check,r,Q,g-Q):J(t.check,r,Q,g-Q)),Q=a,(t.flags?o:cA(o))!==t.check){A.msg="incorrect data check",t.mode=30;break}o=0,B=0}t.mode=28;case 28:if(t.wrap&&t.flags){for(;B<32;){if(0===n)break A;n--,o+=i[I++]<<B,B+=8}if(o!==(4294967295&t.total)){A.msg="incorrect length check",t.mode=30;break}o=0,B=0}t.mode=29;case 29:y=oA;break A;case 30:y=QA;break A;case 31:return EA;default:return CA}return A.next_out=g,A.avail_out=a,A.next_in=I,A.avail_in=n,t.hold=o,t.bits=B,(t.wsize||Q!==A.avail_out&&t.mode<30&&(t.mode<27||e!==IA))&&mA(A,A.output,A.next_out,Q-A.avail_out),C-=A.avail_in,Q-=A.avail_out,A.total_in+=C,A.total_out+=Q,t.total+=Q,t.wrap&&Q&&(A.adler=t.check=t.flags?Y(t.check,r,Q,A.next_out-Q):J(t.check,r,Q,A.next_out-Q)),A.data_type=t.bits+(t.last?64:0)+(12===t.mode?128:0)+(20===t.mode||15===t.mode?256:0),(0===C&&0===Q||e===IA)&&y===aA&&(y=sA),y},inflateEnd:function(A){if(!A||!A.state)return CA;var e=A.state;return e.window&&(e.window=null),A.state=null,aA},inflateGetHeader:function(A,e){if(!A||!A.state)return CA;var t=A.state;return 0==(2&t.wrap)?CA:(t.head=e,e.done=!1,aA)},inflateSetDictionary:function(A,e){var t,i=e.length;return A&&A.state?0!==(t=A.state).wrap&&11!==t.mode?CA:11===t.mode&&J(1,e,i,0)!==t.check?QA:mA(A,e,i,i)?(t.mode=31,EA):(t.havedict=1,aA):CA},inflateInfo:"pako inflate (from Nodeca project)"};var FA=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},SA=Object.prototype.toString,vA=H.Z_NO_FLUSH,RA=H.Z_FINISH,UA=H.Z_OK,LA=H.Z_STREAM_END,bA=H.Z_NEED_DICT,MA=H.Z_STREAM_ERROR,NA=H.Z_DATA_ERROR,xA=H.Z_MEM_ERROR;function JA(A){this.options=P({chunkSize:65536,windowBits:15,to:""},A||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||A&&A.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new z,this.strm.avail_out=0;var t=GA.inflateInit2(this.strm,e.windowBits);if(t!==UA)throw new Error(K[t]);if(this.header=new FA,GA.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Z(e.dictionary):"[object ArrayBuffer]"===SA.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=GA.inflateSetDictionary(this.strm,e.dictionary))!==UA))throw new Error(K[t])}function qA(A,e){var t=new JA(e);if(t.push(A),t.err)throw t.msg||K[t.err];return t.result}JA.prototype.push=function(A,e){var t,i,r,I=this.strm,g=this.options.chunkSize,n=this.options.dictionary;if(this.ended)return!1;for(i=e===~~e?e:!0===e?RA:vA,"[object ArrayBuffer]"===SA.call(A)?I.input=new Uint8Array(A):I.input=A,I.next_in=0,I.avail_in=I.input.length;;){for(0===I.avail_out&&(I.output=new Uint8Array(g),I.next_out=0,I.avail_out=g),(t=GA.inflate(I,i))===bA&&n&&((t=GA.inflateSetDictionary(I,n))===UA?t=GA.inflate(I,i):t===NA&&(t=bA));I.avail_in>0&&t===LA&&I.state.wrap>0&&0!==A[I.next_in];)GA.inflateReset(I),t=GA.inflate(I,i);switch(t){case MA:case NA:case bA:case xA:return this.onEnd(t),this.ended=!0,!1}if(r=I.avail_out,I.next_out&&(0===I.avail_out||t===LA))if("string"===this.options.to){var a=W(I.output,I.next_out),o=I.next_out-a,B=j(I.output,a);I.next_out=o,I.avail_out=g-o,o&&I.output.set(I.output.subarray(a,a+o),0),this.onData(B)}else this.onData(I.output.length===I.next_out?I.output:I.output.subarray(0,I.next_out));if(t!==UA||0!==r){if(t===LA)return t=GA.inflateEnd(this.strm),this.onEnd(t),this.ended=!0,!0;if(0===I.avail_in)break}}return!0},JA.prototype.onData=function(A){this.chunks.push(A)},JA.prototype.onEnd=function(A){A===UA&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=T(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg};var YA={Inflate:JA,inflate:qA,inflateRaw:function(A,e){return(e=e||{}).raw=!0,qA(A,e)},ungzip:qA,constants:H}.inflate;function KA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var HA=function(A){s(t,w);var e=KA(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){return YA(new Uint8Array(A)).buffer}}]),t}(),OA=Object.freeze({__proto__:null,default:HA});function PA(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var TA,VA=function(A){s(t,w);var e=PA(t);function t(){return B(this,t),e.apply(this,arguments)}return Q(t,[{key:"decodeBlock",value:function(A){for(var e=new DataView(A),t=[],i=0;i<A.byteLength;++i){var r=e.getInt8(i);if(r<0){var I=e.getUint8(i+1);r=-r;for(var g=0;g<=r;++g)t.push(I);i+=1}else{for(var n=0;n<=r;++n)t.push(e.getUint8(i+n+1));i+=r+1}}return new Uint8Array(t).buffer}}]),t}(),_A=Object.freeze({__proto__:null,default:VA}),XA={exports:{}};TA=XA,\n/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */\nfunction(){var A,e,t,i,r,I,g,n,a,o,B,C,Q,E,s,f,c=(A={defaultNoDataValue:-34027999387901484e22,decode:function(I,g){var n=(g=g||{}).encodedMaskData||null===g.encodedMaskData,a=r(I,g.inputOffset||0,n),o=null!==g.noDataValue?g.noDataValue:A.defaultNoDataValue,B=e(a,g.pixelType||Float32Array,g.encodedMaskData,o,g.returnMask),C={width:a.width,height:a.height,pixelData:B.resultPixels,minValue:B.minValue,maxValue:a.pixels.maxValue,noDataValue:o};return B.resultMask&&(C.maskData=B.resultMask),g.returnEncodedMask&&a.mask&&(C.encodedMaskData=a.mask.bitset?a.mask.bitset:null),g.returnFileInfo&&(C.fileInfo=t(a),g.computeUsedBitDepths&&(C.fileInfo.bitDepths=i(a))),C}},e=function(A,e,t,i,r){var g,n,a,o=0,B=A.pixels.numBlocksX,C=A.pixels.numBlocksY,Q=Math.floor(A.width/B),E=Math.floor(A.height/C),s=2*A.maxZError,f=Number.MAX_VALUE;t=t||(A.mask?A.mask.bitset:null),n=new e(A.width*A.height),r&&t&&(a=new Uint8Array(A.width*A.height));for(var c,h,l=new Float32Array(Q*E),u=0;u<=C;u++){var w=u!==C?E:A.height%C;if(0!==w)for(var d=0;d<=B;d++){var D=d!==B?Q:A.width%B;if(0!==D){var y,k,p,m,G=u*A.width*E+d*Q,F=A.width-D,S=A.pixels.blocks[o];if(S.encoding<2?(0===S.encoding?y=S.rawData:(I(S.stuffedData,S.bitsPerPixel,S.numValidPixels,S.offset,s,l,A.pixels.maxValue),y=l),k=0):p=2===S.encoding?0:S.offset,t)for(h=0;h<w;h++){for(7&G&&(m=t[G>>3],m<<=7&G),c=0;c<D;c++)7&G||(m=t[G>>3]),128&m?(a&&(a[G]=1),f=f>(g=S.encoding<2?y[k++]:p)?g:f,n[G++]=g):(a&&(a[G]=0),n[G++]=i),m<<=1;G+=F}else if(S.encoding<2)for(h=0;h<w;h++){for(c=0;c<D;c++)f=f>(g=y[k++])?g:f,n[G++]=g;G+=F}else for(f=f>p?p:f,h=0;h<w;h++){for(c=0;c<D;c++)n[G++]=p;G+=F}if(1===S.encoding&&k!==S.numValidPixels)throw"Block and Mask do not match";o++}}}return{resultPixels:n,resultMask:a,minValue:f}},t=function(A){return{fileIdentifierString:A.fileIdentifierString,fileVersion:A.fileVersion,imageType:A.imageType,height:A.height,width:A.width,maxZError:A.maxZError,eofOffset:A.eofOffset,mask:A.mask?{numBlocksX:A.mask.numBlocksX,numBlocksY:A.mask.numBlocksY,numBytes:A.mask.numBytes,maxValue:A.mask.maxValue}:null,pixels:{numBlocksX:A.pixels.numBlocksX,numBlocksY:A.pixels.numBlocksY,numBytes:A.pixels.numBytes,maxValue:A.pixels.maxValue,noDataValue:A.noDataValue}}},i=function(A){for(var e=A.pixels.numBlocksX*A.pixels.numBlocksY,t={},i=0;i<e;i++){var r=A.pixels.blocks[i];0===r.encoding?t.float32=!0:1===r.encoding?t[r.bitsPerPixel]=!0:t[0]=!0}return Object.keys(t)},r=function(A,e,t){var i={},r=new Uint8Array(A,e,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,r),"CntZImage"!==i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;e+=10;var I=new DataView(A,e,24);if(i.fileVersion=I.getInt32(0,!0),i.imageType=I.getInt32(4,!0),i.height=I.getUint32(8,!0),i.width=I.getUint32(12,!0),i.maxZError=I.getFloat64(16,!0),e+=24,!t)if(I=new DataView(A,e,16),i.mask={},i.mask.numBlocksY=I.getUint32(0,!0),i.mask.numBlocksX=I.getUint32(4,!0),i.mask.numBytes=I.getUint32(8,!0),i.mask.maxValue=I.getFloat32(12,!0),e+=16,i.mask.numBytes>0){var g=new Uint8Array(Math.ceil(i.width*i.height/8)),n=(I=new DataView(A,e,i.mask.numBytes)).getInt16(0,!0),a=2,o=0;do{if(n>0)for(;n--;)g[o++]=I.getUint8(a++);else{var B=I.getUint8(a++);for(n=-n;n--;)g[o++]=B}n=I.getInt16(a,!0),a+=2}while(a<i.mask.numBytes);if(-32768!==n||o<g.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=g,e+=i.mask.numBytes}else 0==(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)&&(i.mask.bitset=new Uint8Array(Math.ceil(i.width*i.height/8)));I=new DataView(A,e,16),i.pixels={},i.pixels.numBlocksY=I.getUint32(0,!0),i.pixels.numBlocksX=I.getUint32(4,!0),i.pixels.numBytes=I.getUint32(8,!0),i.pixels.maxValue=I.getFloat32(12,!0),e+=16;var C=i.pixels.numBlocksX,Q=i.pixels.numBlocksY,E=C+(i.width%C>0?1:0),s=Q+(i.height%Q>0?1:0);i.pixels.blocks=new Array(E*s);for(var f=0,c=0;c<s;c++)for(var h=0;h<E;h++){var l=0,u=A.byteLength-e;I=new DataView(A,e,Math.min(10,u));var w={};i.pixels.blocks[f++]=w;var d=I.getUint8(0);if(l++,w.encoding=63&d,w.encoding>3)throw"Invalid block encoding ("+w.encoding+")";if(2!==w.encoding){if(0!==d&&2!==d){if(d>>=6,w.offsetType=d,2===d)w.offset=I.getInt8(1),l++;else if(1===d)w.offset=I.getInt16(1,!0),l+=2;else{if(0!==d)throw"Invalid block offset type";w.offset=I.getFloat32(1,!0),l+=4}if(1===w.encoding)if(d=I.getUint8(l),l++,w.bitsPerPixel=63&d,d>>=6,w.numValidPixelsType=d,2===d)w.numValidPixels=I.getUint8(l),l++;else if(1===d)w.numValidPixels=I.getUint16(l,!0),l+=2;else{if(0!==d)throw"Invalid valid pixel count type";w.numValidPixels=I.getUint32(l,!0),l+=4}}var D;if(e+=l,3!==w.encoding)if(0===w.encoding){var y=(i.pixels.numBytes-1)/4;if(y!==Math.floor(y))throw"uncompressed block has invalid length";D=new ArrayBuffer(4*y),new Uint8Array(D).set(new Uint8Array(A,e,4*y));var k=new Float32Array(D);w.rawData=k,e+=4*y}else if(1===w.encoding){var p=Math.ceil(w.numValidPixels*w.bitsPerPixel/8),m=Math.ceil(p/4);D=new ArrayBuffer(4*m),new Uint8Array(D).set(new Uint8Array(A,e,p)),w.stuffedData=new Uint32Array(D),e+=p}}else e++}return i.eofOffset=e,i},I=function(A,e,t,i,r,I,g){var n,a,o,B=(1<<e)-1,C=0,Q=0,E=Math.ceil((g-i)/r),s=4*A.length-Math.ceil(e*t/8);for(A[A.length-1]<<=8*s,n=0;n<t;n++){if(0===Q&&(o=A[C++],Q=32),Q>=e)a=o>>>Q-e&B,Q-=e;else{var f=e-Q;a=(o&B)<<f&B,a+=(o=A[C++])>>>(Q=32-f)}I[n]=a<E?i+a*r:g}return I},A),h=(g=function(A,e,t,i,r,I,g,n){var a,o,B,C,Q,E=(1<<t)-1,s=0,f=0,c=4*A.length-Math.ceil(t*i/8);if(A[A.length-1]<<=8*c,r)for(a=0;a<i;a++)0===f&&(B=A[s++],f=32),f>=t?(o=B>>>f-t&E,f-=t):(o=(B&E)<<(C=t-f)&E,o+=(B=A[s++])>>>(f=32-C)),e[a]=r[o];else for(Q=Math.ceil((n-I)/g),a=0;a<i;a++)0===f&&(B=A[s++],f=32),f>=t?(o=B>>>f-t&E,f-=t):(o=(B&E)<<(C=t-f)&E,o+=(B=A[s++])>>>(f=32-C)),e[a]=o<Q?I+o*g:n},n=function(A,e,t,i,r,I){var g,n=(1<<e)-1,a=0,o=0,B=0,C=0,Q=0,E=[],s=4*A.length-Math.ceil(e*t/8);A[A.length-1]<<=8*s;var f=Math.ceil((I-i)/r);for(o=0;o<t;o++)0===C&&(g=A[a++],C=32),C>=e?(Q=g>>>C-e&n,C-=e):(Q=(g&n)<<(B=e-C)&n,Q+=(g=A[a++])>>>(C=32-B)),E[o]=Q<f?i+Q*r:I;return E.unshift(i),E},a=function(A,e,t,i,r,I,g,n){var a,o,B,C,Q=(1<<t)-1,E=0,s=0,f=0;if(r)for(a=0;a<i;a++)0===s&&(B=A[E++],s=32,f=0),s>=t?(o=B>>>f&Q,s-=t,f+=t):(o=B>>>f&Q,s=32-(C=t-s),o|=((B=A[E++])&(1<<C)-1)<<t-C,f=C),e[a]=r[o];else{var c=Math.ceil((n-I)/g);for(a=0;a<i;a++)0===s&&(B=A[E++],s=32,f=0),s>=t?(o=B>>>f&Q,s-=t,f+=t):(o=B>>>f&Q,s=32-(C=t-s),o|=((B=A[E++])&(1<<C)-1)<<t-C,f=C),e[a]=o<c?I+o*g:n}return e},o=function(A,e,t,i,r,I){var g,n=(1<<e)-1,a=0,o=0,B=0,C=0,Q=0,E=0,s=[],f=Math.ceil((I-i)/r);for(o=0;o<t;o++)0===C&&(g=A[a++],C=32,E=0),C>=e?(Q=g>>>E&n,C-=e,E+=e):(Q=g>>>E&n,C=32-(B=e-C),Q|=((g=A[a++])&(1<<B)-1)<<e-B,E=B),s[o]=Q<f?i+Q*r:I;return s.unshift(i),s},B=function(A,e,t,i){var r,I,g,n,a=(1<<t)-1,o=0,B=0,C=4*A.length-Math.ceil(t*i/8);for(A[A.length-1]<<=8*C,r=0;r<i;r++)0===B&&(g=A[o++],B=32),B>=t?(I=g>>>B-t&a,B-=t):(I=(g&a)<<(n=t-B)&a,I+=(g=A[o++])>>>(B=32-n)),e[r]=I;return e},C=function(A,e,t,i){var r,I,g,n,a=(1<<t)-1,o=0,B=0,C=0;for(r=0;r<i;r++)0===B&&(g=A[o++],B=32,C=0),B>=t?(I=g>>>C&a,B-=t,C+=t):(I=g>>>C&a,B=32-(n=t-B),I|=((g=A[o++])&(1<<n)-1)<<t-n,C=n),e[r]=I;return e},Q={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(A){for(var e=65535,t=65535,i=A.length,r=Math.floor(i/2),I=0;r;){var g=r>=359?359:r;r-=g;do{e+=A[I++]<<8,t+=e+=A[I++]}while(--g);e=(65535&e)+(e>>>16),t=(65535&t)+(t>>>16)}return 1&i&&(t+=e+=A[I]<<8),((t=(65535&t)+(t>>>16))<<16|(e=(65535&e)+(e>>>16)))>>>0},readHeaderInfo:function(A,e){var t=e.ptr,i=new Uint8Array(A,t,6),r={};if(r.fileIdentifierString=String.fromCharCode.apply(null,i),0!==r.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+r.fileIdentifierString;t+=6;var I,g=new DataView(A,t,8),n=g.getInt32(0,!0);if(r.fileVersion=n,t+=4,n>=3&&(r.checksum=g.getUint32(4,!0),t+=4),g=new DataView(A,t,12),r.height=g.getUint32(0,!0),r.width=g.getUint32(4,!0),t+=8,n>=4?(r.numDims=g.getUint32(8,!0),t+=4):r.numDims=1,g=new DataView(A,t,40),r.numValidPixel=g.getUint32(0,!0),r.microBlockSize=g.getInt32(4,!0),r.blobSize=g.getInt32(8,!0),r.imageType=g.getInt32(12,!0),r.maxZError=g.getFloat64(16,!0),r.zMin=g.getFloat64(24,!0),r.zMax=g.getFloat64(32,!0),t+=40,e.headerInfo=r,e.ptr=t,n>=3&&(I=n>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(A,t-I,r.blobSize-14))!==r.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(A,e){var t=e.headerInfo,i=this.getDataTypeArray(t.imageType),r=t.numDims*this.getDataTypeSize(t.imageType),I=this.readSubArray(A,e.ptr,i,r),g=this.readSubArray(A,e.ptr+r,i,r);e.ptr+=2*r;var n,a=!0;for(n=0;n<t.numDims;n++)if(I[n]!==g[n]){a=!1;break}return t.minValues=I,t.maxValues=g,a},readSubArray:function(A,e,t,i){var r;if(t===Uint8Array)r=new Uint8Array(A,e,i);else{var I=new ArrayBuffer(i);new Uint8Array(I).set(new Uint8Array(A,e,i)),r=new t(I)}return r},readMask:function(A,e){var t,i,r=e.ptr,I=e.headerInfo,g=I.width*I.height,n=I.numValidPixel,a=new DataView(A,r,4),o={};if(o.numBytes=a.getUint32(0,!0),r+=4,(0===n||g===n)&&0!==o.numBytes)throw"invalid mask";if(0===n)t=new Uint8Array(Math.ceil(g/8)),o.bitset=t,i=new Uint8Array(g),e.pixels.resultMask=i,r+=o.numBytes;else if(o.numBytes>0){t=new Uint8Array(Math.ceil(g/8));var B=(a=new DataView(A,r,o.numBytes)).getInt16(0,!0),C=2,Q=0,E=0;do{if(B>0)for(;B--;)t[Q++]=a.getUint8(C++);else for(E=a.getUint8(C++),B=-B;B--;)t[Q++]=E;B=a.getInt16(C,!0),C+=2}while(C<o.numBytes);if(-32768!==B||Q<t.length)throw"Unexpected end of mask RLE encoding";i=new Uint8Array(g);var s=0,f=0;for(f=0;f<g;f++)7&f?(s=t[f>>3],s<<=7&f):s=t[f>>3],128&s&&(i[f]=1);e.pixels.resultMask=i,o.bitset=t,r+=o.numBytes}return e.ptr=r,e.mask=o,!0},readDataOneSweep:function(A,e,t,i){var r,I=e.ptr,g=e.headerInfo,n=g.numDims,a=g.width*g.height,o=g.imageType,B=g.numValidPixel*Q.getDataTypeSize(o)*n,C=e.pixels.resultMask;if(t===Uint8Array)r=new Uint8Array(A,I,B);else{var E=new ArrayBuffer(B);new Uint8Array(E).set(new Uint8Array(A,I,B)),r=new t(E)}if(r.length===a*n)e.pixels.resultPixels=i?Q.swapDimensionOrder(r,a,n,t,!0):r;else{e.pixels.resultPixels=new t(a*n);var s=0,f=0,c=0,h=0;if(n>1){if(i){for(f=0;f<a;f++)if(C[f])for(h=f,c=0;c<n;c++,h+=a)e.pixels.resultPixels[h]=r[s++]}else for(f=0;f<a;f++)if(C[f])for(h=f*n,c=0;c<n;c++)e.pixels.resultPixels[h+c]=r[s++]}else for(f=0;f<a;f++)C[f]&&(e.pixels.resultPixels[f]=r[s++])}return I+=B,e.ptr=I,!0},readHuffmanTree:function(A,e){var t=this.HUFFMAN_LUT_BITS_MAX,i=new DataView(A,e.ptr,16);if(e.ptr+=16,i.getInt32(0,!0)<2)throw"unsupported Huffman version";var r=i.getInt32(4,!0),I=i.getInt32(8,!0),g=i.getInt32(12,!0);if(I>=g)return!1;var n=new Uint32Array(g-I);Q.decodeBits(A,e,n);var a,o,B,C,s=[];for(a=I;a<g;a++)s[o=a-(a<r?0:r)]={first:n[a-I],second:null};var f=A.byteLength-e.ptr,c=Math.ceil(f/4),h=new ArrayBuffer(4*c);new Uint8Array(h).set(new Uint8Array(A,e.ptr,f));var l,u=new Uint32Array(h),w=0,d=0;for(l=u[0],a=I;a<g;a++)(C=s[o=a-(a<r?0:r)].first)>0&&(s[o].second=l<<w>>>32-C,32-w>=C?32===(w+=C)&&(w=0,l=u[++d]):(w+=C-32,l=u[++d],s[o].second|=l>>>32-w));var D=0,y=0,k=new E;for(a=0;a<s.length;a++)void 0!==s[a]&&(D=Math.max(D,s[a].first));y=D>=t?t:D;var p,m,G,F,S,v=[];for(a=I;a<g;a++)if((C=s[o=a-(a<r?0:r)].first)>0)if(p=[C,o],C<=y)for(m=s[o].second<<y-C,G=1<<y-C,B=0;B<G;B++)v[m|B]=p;else for(m=s[o].second,S=k,F=C-1;F>=0;F--)m>>>F&1?(S.right||(S.right=new E),S=S.right):(S.left||(S.left=new E),S=S.left),0!==F||S.val||(S.val=p[1]);return{decodeLut:v,numBitsLUTQick:y,numBitsLUT:D,tree:k,stuffedData:u,srcPtr:d,bitPos:w}},readHuffman:function(A,e,t,i){var r,I,g,n,a,o,B,C,E,s=e.headerInfo.numDims,f=e.headerInfo.height,c=e.headerInfo.width,h=c*f,l=this.readHuffmanTree(A,e),u=l.decodeLut,w=l.tree,d=l.stuffedData,D=l.srcPtr,y=l.bitPos,k=l.numBitsLUTQick,p=l.numBitsLUT,m=0===e.headerInfo.imageType?128:0,G=e.pixels.resultMask,F=0;y>0&&(D++,y=0);var S,v=d[D],R=1===e.encodeMode,U=new t(h*s),L=U;if(s<2||R){for(S=0;S<s;S++)if(s>1&&(L=new t(U.buffer,h*S,h),F=0),e.headerInfo.numValidPixel===c*f)for(C=0,o=0;o<f;o++)for(B=0;B<c;B++,C++){if(I=0,a=n=v<<y>>>32-k,32-y<k&&(a=n|=d[D+1]>>>64-y-k),u[a])I=u[a][1],y+=u[a][0];else for(a=n=v<<y>>>32-p,32-y<p&&(a=n|=d[D+1]>>>64-y-p),r=w,E=0;E<p;E++)if(!(r=n>>>p-E-1&1?r.right:r.left).left&&!r.right){I=r.val,y=y+E+1;break}y>=32&&(y-=32,v=d[++D]),g=I-m,R?(g+=B>0?F:o>0?L[C-c]:F,g&=255,L[C]=g,F=g):L[C]=g}else for(C=0,o=0;o<f;o++)for(B=0;B<c;B++,C++)if(G[C]){if(I=0,a=n=v<<y>>>32-k,32-y<k&&(a=n|=d[D+1]>>>64-y-k),u[a])I=u[a][1],y+=u[a][0];else for(a=n=v<<y>>>32-p,32-y<p&&(a=n|=d[D+1]>>>64-y-p),r=w,E=0;E<p;E++)if(!(r=n>>>p-E-1&1?r.right:r.left).left&&!r.right){I=r.val,y=y+E+1;break}y>=32&&(y-=32,v=d[++D]),g=I-m,R?(B>0&&G[C-1]?g+=F:o>0&&G[C-c]?g+=L[C-c]:g+=F,g&=255,L[C]=g,F=g):L[C]=g}}else for(C=0,o=0;o<f;o++)for(B=0;B<c;B++)if(C=o*c+B,!G||G[C])for(S=0;S<s;S++,C+=h){if(I=0,a=n=v<<y>>>32-k,32-y<k&&(a=n|=d[D+1]>>>64-y-k),u[a])I=u[a][1],y+=u[a][0];else for(a=n=v<<y>>>32-p,32-y<p&&(a=n|=d[D+1]>>>64-y-p),r=w,E=0;E<p;E++)if(!(r=n>>>p-E-1&1?r.right:r.left).left&&!r.right){I=r.val,y=y+E+1;break}y>=32&&(y-=32,v=d[++D]),g=I-m,L[C]=g}e.ptr=e.ptr+4*(D+1)+(y>0?4:0),e.pixels.resultPixels=U,s>1&&!i&&(e.pixels.resultPixels=Q.swapDimensionOrder(U,h,s,t))},decodeBits:function(A,e,t,i,r){var I=e.headerInfo,Q=I.fileVersion,E=0,s=A.byteLength-e.ptr>=5?5:A.byteLength-e.ptr,f=new DataView(A,e.ptr,s),c=f.getUint8(0);E++;var h=c>>6,l=0===h?4:3-h,u=(32&c)>0,w=31&c,d=0;if(1===l)d=f.getUint8(E),E++;else if(2===l)d=f.getUint16(E,!0),E+=2;else{if(4!==l)throw"Invalid valid pixel count type";d=f.getUint32(E,!0),E+=4}var D,y,k,p,m,G,F,S,v,R=2*I.maxZError,U=I.numDims>1?I.maxValues[r]:I.zMax;if(u){for(e.counter.lut++,S=f.getUint8(E),E++,p=Math.ceil((S-1)*w/8),m=Math.ceil(p/4),y=new ArrayBuffer(4*m),k=new Uint8Array(y),e.ptr+=E,k.set(new Uint8Array(A,e.ptr,p)),F=new Uint32Array(y),e.ptr+=p,v=0;S-1>>>v;)v++;p=Math.ceil(d*v/8),m=Math.ceil(p/4),y=new ArrayBuffer(4*m),(k=new Uint8Array(y)).set(new Uint8Array(A,e.ptr,p)),D=new Uint32Array(y),e.ptr+=p,G=Q>=3?o(F,w,S-1,i,R,U):n(F,w,S-1,i,R,U),Q>=3?a(D,t,v,d,G):g(D,t,v,d,G)}else e.counter.bitstuffer++,v=w,e.ptr+=E,v>0&&(p=Math.ceil(d*v/8),m=Math.ceil(p/4),y=new ArrayBuffer(4*m),(k=new Uint8Array(y)).set(new Uint8Array(A,e.ptr,p)),D=new Uint32Array(y),e.ptr+=p,Q>=3?null==i?C(D,t,v,d):a(D,t,v,d,!1,i,R,U):null==i?B(D,t,v,d):g(D,t,v,d,!1,i,R,U))},readTiles:function(A,e,t,i){var r=e.headerInfo,I=r.width,g=r.height,n=I*g,a=r.microBlockSize,o=r.imageType,B=Q.getDataTypeSize(o),C=Math.ceil(I/a),E=Math.ceil(g/a);e.pixels.numBlocksY=E,e.pixels.numBlocksX=C,e.pixels.ptr=0;var s,f,c,h,l,u,w,d,D,y,k=0,p=0,m=0,G=0,F=0,S=0,v=0,R=0,U=0,L=0,b=0,M=0,N=0,x=0,J=0,q=new t(a*a),Y=g%a||a,K=I%a||a,H=r.numDims,O=e.pixels.resultMask,P=e.pixels.resultPixels,T=r.fileVersion>=5?14:15,V=r.zMax;for(m=0;m<E;m++)for(F=m!==E-1?a:Y,G=0;G<C;G++)for(L=m*I*a+G*a,b=I-(S=G!==C-1?a:K),d=0;d<H;d++){if(H>1?(y=P,L=m*I*a+G*a,P=new t(e.pixels.resultPixels.buffer,n*d*B,n),V=r.maxValues[d]):y=null,v=A.byteLength-e.ptr,f={},J=0,R=(s=new DataView(A,e.ptr,Math.min(10,v))).getUint8(0),J++,D=r.fileVersion>=5?4&R:0,U=R>>6&255,(R>>2&T)!=(G*a>>3&T))throw"integrity issue";if(D&&0===d)throw"integrity issue";if((l=3&R)>3)throw e.ptr+=J,"Invalid block encoding ("+l+")";if(2!==l)if(0===l){if(D)throw"integrity issue";if(e.counter.uncompressed++,e.ptr+=J,M=(M=F*S*B)<(N=A.byteLength-e.ptr)?M:N,c=new ArrayBuffer(M%B==0?M:M+B-M%B),new Uint8Array(c).set(new Uint8Array(A,e.ptr,M)),h=new t(c),x=0,O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=h[x++]),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L++]=h[x++];L+=b}e.ptr+=x*B}else if(u=Q.getDataTypeUsed(D&&o<6?4:o,U),w=Q.getOnePixel(f,J,u,s),J+=Q.getDataTypeSize(u),3===l)if(e.ptr+=J,e.counter.constantoffset++,O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=D?Math.min(V,y[L]+w):w),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L]=D?Math.min(V,y[L]+w):w,L++;L+=b}else if(e.ptr+=J,Q.decodeBits(A,e,q,w,d),J=0,D)if(O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=q[J++]+y[L]),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L]=q[J++]+y[L],L++;L+=b}else if(O)for(k=0;k<F;k++){for(p=0;p<S;p++)O[L]&&(P[L]=q[J++]),L++;L+=b}else for(k=0;k<F;k++){for(p=0;p<S;p++)P[L++]=q[J++];L+=b}else{if(D)if(O)for(k=0;k<F;k++)for(p=0;p<S;p++)O[L]&&(P[L]=y[L]),L++;else for(k=0;k<F;k++)for(p=0;p<S;p++)P[L]=y[L],L++;e.counter.constant++,e.ptr+=J}}H>1&&!i&&(e.pixels.resultPixels=Q.swapDimensionOrder(e.pixels.resultPixels,n,H,t))},formatFileInfo:function(A){return{fileIdentifierString:A.headerInfo.fileIdentifierString,fileVersion:A.headerInfo.fileVersion,imageType:A.headerInfo.imageType,height:A.headerInfo.height,width:A.headerInfo.width,numValidPixel:A.headerInfo.numValidPixel,microBlockSize:A.headerInfo.microBlockSize,blobSize:A.headerInfo.blobSize,maxZError:A.headerInfo.maxZError,pixelType:Q.getPixelType(A.headerInfo.imageType),eofOffset:A.eofOffset,mask:A.mask?{numBytes:A.mask.numBytes}:null,pixels:{numBlocksX:A.pixels.numBlocksX,numBlocksY:A.pixels.numBlocksY,maxValue:A.headerInfo.zMax,minValue:A.headerInfo.zMin,noDataValue:A.noDataValue}}},constructConstantSurface:function(A,e){var t=A.headerInfo.zMax,i=A.headerInfo.zMin,r=A.headerInfo.maxValues,I=A.headerInfo.numDims,g=A.headerInfo.height*A.headerInfo.width,n=0,a=0,o=0,B=A.pixels.resultMask,C=A.pixels.resultPixels;if(B)if(I>1){if(e)for(n=0;n<I;n++)for(o=n*g,t=r[n],a=0;a<g;a++)B[a]&&(C[o+a]=t);else for(a=0;a<g;a++)if(B[a])for(o=a*I,n=0;n<I;n++)C[o+I]=r[n]}else for(a=0;a<g;a++)B[a]&&(C[a]=t);else if(I>1&&i!==t)if(e)for(n=0;n<I;n++)for(o=n*g,t=r[n],a=0;a<g;a++)C[o+a]=t;else for(a=0;a<g;a++)for(o=a*I,n=0;n<I;n++)C[o+n]=r[n];else for(a=0;a<g*I;a++)C[a]=t},getDataTypeArray:function(A){var e;switch(A){case 0:e=Int8Array;break;case 1:e=Uint8Array;break;case 2:e=Int16Array;break;case 3:e=Uint16Array;break;case 4:e=Int32Array;break;case 5:e=Uint32Array;break;case 6:default:e=Float32Array;break;case 7:e=Float64Array}return e},getPixelType:function(A){var e;switch(A){case 0:e="S8";break;case 1:e="U8";break;case 2:e="S16";break;case 3:e="U16";break;case 4:e="S32";break;case 5:e="U32";break;case 6:default:e="F32";break;case 7:e="F64"}return e},isValidPixelValue:function(A,e){if(null==e)return!1;var t;switch(A){case 0:t=e>=-128&&e<=127;break;case 1:t=e>=0&&e<=255;break;case 2:t=e>=-32768&&e<=32767;break;case 3:t=e>=0&&e<=65536;break;case 4:t=e>=-2147483648&&e<=2147483647;break;case 5:t=e>=0&&e<=4294967296;break;case 6:t=e>=-34027999387901484e22&&e<=34027999387901484e22;break;case 7:t=e>=-17976931348623157e292&&e<=17976931348623157e292;break;default:t=!1}return t},getDataTypeSize:function(A){var e=0;switch(A){case 0:case 1:e=1;break;case 2:case 3:e=2;break;case 4:case 5:case 6:e=4;break;case 7:e=8;break;default:e=A}return e},getDataTypeUsed:function(A,e){var t=A;switch(A){case 2:case 4:t=A-e;break;case 3:case 5:t=A-2*e;break;case 6:t=0===e?A:1===e?2:1;break;case 7:t=0===e?A:A-2*e+1;break;default:t=A}return t},getOnePixel:function(A,e,t,i){var r=0;switch(t){case 0:r=i.getInt8(e);break;case 1:r=i.getUint8(e);break;case 2:r=i.getInt16(e,!0);break;case 3:r=i.getUint16(e,!0);break;case 4:r=i.getInt32(e,!0);break;case 5:r=i.getUInt32(e,!0);break;case 6:r=i.getFloat32(e,!0);break;case 7:r=i.getFloat64(e,!0);break;default:throw"the decoder does not understand this pixel type"}return r},swapDimensionOrder:function(A,e,t,i,r){var I=0,g=0,n=0,a=0,o=A;if(t>1)if(o=new i(e*t),r)for(I=0;I<e;I++)for(a=I,n=0;n<t;n++,a+=e)o[a]=A[g++];else for(I=0;I<e;I++)for(a=I,n=0;n<t;n++,a+=e)o[g++]=A[a];return o}},E=function(A,e,t){this.val=A,this.left=e,this.right=t},{decode:function(A,e){var t=(e=e||{}).noDataValue,i=0,r={};r.ptr=e.inputOffset||0,r.pixels={},Q.readHeaderInfo(A,r);var I=r.headerInfo,g=I.fileVersion,n=Q.getDataTypeArray(I.imageType);if(g>5)throw"unsupported lerc version 2."+g;Q.readMask(A,r),I.numValidPixel===I.width*I.height||r.pixels.resultMask||(r.pixels.resultMask=e.maskData);var a=I.width*I.height;r.pixels.resultPixels=new n(a*I.numDims),r.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var o,B=!e.returnPixelInterleavedDims;if(0!==I.numValidPixel)if(I.zMax===I.zMin)Q.constructConstantSurface(r,B);else if(g>=4&&Q.checkMinMaxRanges(A,r))Q.constructConstantSurface(r,B);else{var C=new DataView(A,r.ptr,2),E=C.getUint8(0);if(r.ptr++,E)Q.readDataOneSweep(A,r,n,B);else if(g>1&&I.imageType<=1&&Math.abs(I.maxZError-.5)<1e-5){var s=C.getUint8(1);if(r.ptr++,r.encodeMode=s,s>2||g<4&&s>1)throw"Invalid Huffman flag "+s;s?Q.readHuffman(A,r,n,B):Q.readTiles(A,r,n,B)}else Q.readTiles(A,r,n,B)}r.eofOffset=r.ptr,e.inputOffset?(o=r.headerInfo.blobSize+e.inputOffset-r.ptr,Math.abs(o)>=1&&(r.eofOffset=e.inputOffset+r.headerInfo.blobSize)):(o=r.headerInfo.blobSize-r.ptr,Math.abs(o)>=1&&(r.eofOffset=r.headerInfo.blobSize));var f={width:I.width,height:I.height,pixelData:r.pixels.resultPixels,minValue:I.zMin,maxValue:I.zMax,validPixelCount:I.numValidPixel,dimCount:I.numDims,dimStats:{minValues:I.minValues,maxValues:I.maxValues},maskData:r.pixels.resultMask};if(r.pixels.resultMask&&Q.isValidPixelValue(I.imageType,t)){var c=r.pixels.resultMask;for(i=0;i<a;i++)c[i]||(f.pixelData[i]=t);f.noDataValue=t}return r.noDataValue=t,e.returnFileInfo&&(f.fileInfo=Q.formatFileInfo(r)),f},getBandCount:function(A){for(var e=0,t=0,i={ptr:0,pixels:{}};t<A.byteLength-58;)Q.readHeaderInfo(A,i),t+=i.headerInfo.blobSize,e++,i.ptr=t;return e}}),l=(s=new ArrayBuffer(4),f=new Uint8Array(s),new Uint32Array(s)[0]=1,1===f[0]),u={decode:function(A,e){if(!l)throw"Big endian system is not supported.";var t,i,r=(e=e||{}).inputOffset||0,I=new Uint8Array(A,r,10),g=String.fromCharCode.apply(null,I);if("CntZImage"===g.trim())t=c,i=1;else{if("Lerc2"!==g.substring(0,5))throw"Unexpected file identifier string: "+g;t=h,i=2}for(var n,a,o,B,C,Q,E=0,s=A.byteLength-10,f=[],u={width:0,height:0,pixels:[],pixelType:e.pixelType,mask:null,statistics:[]},w=0;r<s;){var d=t.decode(A,{inputOffset:r,encodedMaskData:n,maskData:o,returnMask:0===E,returnEncodedMask:0===E,returnFileInfo:!0,returnPixelInterleavedDims:e.returnPixelInterleavedDims,pixelType:e.pixelType||null,noDataValue:e.noDataValue||null});r=d.fileInfo.eofOffset,o=d.maskData,0===E&&(n=d.encodedMaskData,u.width=d.width,u.height=d.height,u.dimCount=d.dimCount||1,u.pixelType=d.pixelType||d.fileInfo.pixelType,u.mask=o),i>1&&(o&&f.push(o),d.fileInfo.mask&&d.fileInfo.mask.numBytes>0&&w++),E++,u.pixels.push(d.pixelData),u.statistics.push({minValue:d.minValue,maxValue:d.maxValue,noDataValue:d.noDataValue,dimStats:d.dimStats})}if(i>1&&w>1){for(Q=u.width*u.height,u.bandMasks=f,(o=new Uint8Array(Q)).set(f[0]),B=1;B<f.length;B++)for(a=f[B],C=0;C<Q;C++)o[C]=o[C]&a[C];u.maskData=o}return u}};TA.exports?TA.exports=u:this.Lerc=u}();var ZA,jA,WA,zA=XA.exports,$A={env:{emscripten_notify_memory_growth:function(A){WA=new Uint8Array(jA.exports.memory.buffer)}}},Ae=function(){function A(){B(this,A)}return Q(A,[{key:"init",value:function(){return ZA||(ZA="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+ee).then((function(A){return A.arrayBuffer()})).then((function(A){return WebAssembly.instantiate(A,$A)})).then(this._init):WebAssembly.instantiate(Buffer.from(ee,"base64"),$A).then(this._init))}},{key:"_init",value:function(A){jA=A.instance,$A.env.emscripten_notify_memory_growth(0)}},{key:"decode",value:function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!jA)throw new Error("ZSTDDecoder: Await .init() before decoding.");var t=A.byteLength,i=jA.exports.malloc(t);WA.set(A,i),e=e||Number(jA.exports.ZSTD_findDecompressedSize(i,t));var r=jA.exports.malloc(e),I=jA.exports.ZSTD_decompress(r,e,i,t),g=WA.slice(r,r+I);return jA.exports.free(i),jA.exports.free(r),g}}]),A}(),ee="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",te={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},ie={};for(var re in te)te.hasOwnProperty(re)&&(ie[te[re]]=parseInt(re,10));ie.BitsPerSample,ie.ExtraSamples,ie.SampleFormat,ie.StripByteCounts,ie.StripOffsets,ie.StripRowCounts,ie.TileByteCounts,ie.TileOffsets,ie.SubIFDs;var Ie={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},ge={};for(var ne in Ie)Ie.hasOwnProperty(ne)&&(ge[Ie[ne]]=parseInt(ne,10));var ae=1,oe=0,Be=1,Ce=2,Qe={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},Ee={};for(var se in Qe)Qe.hasOwnProperty(se)&&(Ee[Qe[se]]=parseInt(se,10));function fe(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var ce=new Ae,he=function(A){s(t,w);var e=fe(t);function t(A){var i;return B(this,t),(i=e.call(this)).planarConfiguration=void 0!==A.PlanarConfiguration?A.PlanarConfiguration:1,i.samplesPerPixel=void 0!==A.SamplesPerPixel?A.SamplesPerPixel:1,i.addCompression=A.LercParameters[ae],i}return Q(t,[{key:"decodeBlock",value:function(A){switch(this.addCompression){case oe:break;case Be:A=YA(new Uint8Array(A)).buffer;break;case Ce:A=ce.decode(new Uint8Array(A)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return zA.decode(A,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}]),t}(),le=Object.freeze({__proto__:null,zstd:ce,default:he});function ue(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,i=c(A);if(e){var r=c(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return f(this,t)}}var we=function(A){s(I,w);var t,i=ue(I);function I(){var A;if(B(this,I),A=i.call(this),"undefined"==typeof createImageBitmap)throw new Error("Cannot decode WebImage as `createImageBitmap` is not available");if("undefined"==typeof document&&"undefined"==typeof OffscreenCanvas)throw new Error("Cannot decode WebImage as neither `document` nor `OffscreenCanvas` is not available");return A}return Q(I,[{key:"decode",value:(t=e(r.mark((function A(e,t){var i,I,g,n;return r.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return i=new Blob([t]),A.next=3,createImageBitmap(i);case 3:return I=A.sent,"undefined"!=typeof document?((g=document.createElement("canvas")).width=I.width,g.height=I.height):g=new OffscreenCanvas(I.width,I.height),(n=g.getContext("2d")).drawImage(I,0,0),A.abrupt("return",n.getImageData(0,0,I.width,I.height).data.buffer);case 8:case"end":return A.stop()}}),A)}))),function(A,e){return t.apply(this,arguments)})}]),I}(),de=Object.freeze({__proto__:null,default:we});';return new Upe(typeof Buffer<"u"?"data:application/javascript;base64,"+Buffer.from(i,"binary").toString("base64"):URL.createObjectURL(new Blob([i],{type:"application/javascript"})))}const Hpe=Object.freeze(Object.defineProperty({__proto__:null,create:Gpe},Symbol.toStringTag,{value:"Module"}));return Yge});
//# sourceMappingURL=geoblacklight.umd.js.map
